{"pages":[{"title":"About","text":"소개 쇼트트랙선수 출신의 어느 SI 개발자입니다.계획, 정리, 문제해결에 관심 많습니다.C#, Java, SQL 조금 다룰 줄 압니다. 프로필 활동명은 ilovemychange입니다.직업은 개발자입니다.분야는 의료입니다.경력은 만 3년입니다.나이는 스물아홉입니다.성별은 남자입니다. 좌우명 Be the change that you wish to see in the world.세상을 변화시키고 싶다면, 당신부터 변화된 삶을 살아라. (마하트마 간디) 블로그를 하는 이유 첫째, 정리하는 능력과 습관을 기르기 위함입니다.둘째, 시간이 지나면 잊혀지는 것들을 기록으로 남기기 위함입니다. 연락처ilovemychange@gmail.com 끝.","link":"/about/index.html"},{"title":"HAPI FHIR 환경구성 개요","text":"오픈소스 HAPI FHIR 환경은 다음과 같은 순서로 구축한다. 상세한 구축 가이드는 그림과 설명을 통해 작성하다보니 꽤 길어져서 여러 편에 걸쳐 나누어 정리해야할 것 같다. 소프트웨어 설치 HAPI FHIR 환경 구성하기 (1/5편) - JDK, Eclipse 설치 HAPI FHIR 환경 구성하기 (2/5편) - Tomcat 설치 HAPI FHIR 환경 구성하기 (3/5편) - MySQL 설치 HAPI FHIR 세팅서버 HAPI FHIR 환경 구성하기 (4/5편) - hapi-fhir-jpa-server 설치하기 클라이언트 HAPI FHIR 환경 구성하기 (5/5편) - hapi-fhir-client 설치하기 (작성중) 끝.","link":"/delete/hapi-fhir-environment-0.html"},{"title":"HAPI FHIR 환경 구성하기 (1&#x2F;5편) - JDK, Eclipse 설치","text":"오픈소스 HAPI FHIR 환경은 다음과 같이 5단계로 구성된다.본 글에서는 1. HAPI FHIR 환경 구성하기 (1/5편) - JDK, Eclipse 설치에 대해 다룬다. HAPI FHIR 환경 구성하기 (1/5편) - JDK, Eclipse 설치 HAPI FHIR 환경 구성하기 (2/5편) - Tomcat 설치 HAPI FHIR 환경 구성하기 (3/5편) - MySQL 설치 HAPI FHIR 환경 구성하기 (4/5편) - hapi-fhir-jpa-server 설치하기 HAPI FHIR 환경 구성하기 (5/5편) - hapi-fhir-client 설치하기 (작성중) OpenJDK 14 설치하기JDK(Java Development Kit)은 자바 어플리케이션을 구축하기 위한 플랫폼 구성요소다. JDK는 대표적으로 OracleJDK와 OpenJDK가 있는데, 이 중에서 오픈소스인 OpenJDK를 설치하도록 한다, (OracleJDK의 경우 현재 라이센스 이슈가 있다.) 그 중에서 가장 최근 릴리즈버전인 OpenJDK 14를 설치한다. 필자는 Windows 환경에서 설치중이므로, 이제부터 Windows를 기준으로 설명하겠다. OpenJDK 14 페이지에 접속하여 Windows .zip 파일을 클릭하여 내려받는다. 내려받은 파일을 압축을 푼다. D드라이브 아래 hapi-fhir라는 폴더를 생성한 후에 압축을 푼 jdk 폴더를 D:/hapi-fhir 경로로 위치시킨다.Hapi-fhir 폴더는 hapi의 각종 소프트웨어와 소스가 위치하게될 프로젝트 폴더이니 기억해두도록 한다. 다운받은 jdk를 시스템 환경변수에 등록해주어야 한다. [제어판] &gt; [시스템] &gt; [고급 시스템 설정] &gt; [고급 탭] &gt; [환경변수] 순으로 타고 들어간다.먼저, [제어판]에서 [시스템]을 선택한다. [시스템] 좌측 메뉴에서 [고급 시스템 설정]을 선택한다. [시스템 속성]의 [고급] 탭에서 [환경 변수]를 선택한다. [시스템 변수]를 새로 만든다. 새 시스템 변수로 “JAVA_HOME”을 등록해준다. 변수값으로는 앞서 내려받은 jdk 폴더 경로를 지정해준다. D:/hapi-fhir/jdk-14.0.2(Jdk 폴더명은 본인이 다운받은 jdk 버전에 따라 약간의 차이가 있을 수 있으니 잘 확인하여 진행한다.)등록한 후에는 [확인] 버튼을 선택하여 빠져나간다. 다음으로는 Path에 JAVA_HOME을 등록해주어야 한다. 시스템 변수 중에 “Path”를 찾아 [편집]한다.Path에 한줄을 추가하여 %JAVA_HOME%`bin 을 등록한다. 환경변수 편집이 끝났으므로, [확인] 버튼을 선택하여 빠져나간다. jdk가 환경변수로 잘 등록되었는지 확인해볼 차례다. Command를 실행하여 java -version 을 실행해본다. 본인이 설치한 jdk의 버전이 아래에 잘 출력되는지 확인한다. Eclipse 설치하기 Eclipse란 Java를 기반으로 한 오픈소스 IDE(통합개발환경)이다. hapi-fhir는 Java로 이루어져있기 때문에 Eclipse를 활용하여 개발환경을 구성하도록 한다. https://www.eclipse.org/downloads/ 링크로 접속하여, Download 64 bit 버튼을 선택한다. 다운로드 버튼을 클릭하여 Eclipse Installer를 내려받는다. Eclipse Installer를 실행하면 다음과 같은 로딩화면이 뜬다. 로딩이 끝날 때까지 조금만 기다린다. Eclipse Installer를 통해 Eclipse의 다양한 패키지들을 선택하여 설치를 진행할 수 있다. 우리는 Eclipse IDE for Enterprise Java Developers를 선택하여 진행한다. JVM 경로와 설치경로(Installation Folder)를 지정한다. JVM는 jdk 설치폴더 경로를 잡아주고, 설치경로는 우리의 프로젝트 폴더(D:\\hapi-fhir)로 잡아준다. 소프트웨어 사용과 관련된 동의서이다. Accept Now를 누르고 진행한다. 다음과 같이 설치가 진행된다. 중간중간 팝업창이 뜨면 계속 진행하면 된다. 설치가 끝났다. Eclipse를 실행해보고 싶다면 Launch를 누른다. 지정한 설치경로 (D:/hapi-fhir) 아래에 다음과 같이 eclipse 폴더가 생성이 된다. 참고로, 시스템 환경변수에 JAVA_HOME을 추가하지 않으면 Eclipse 실행 시에 Java virtual machine을 찾지 못하는 경고창이 뜨게 되므로, 위로 올라가서 시스템 환경변수 등록 절차를 진행하기 바란다. OpenJDK 14 설치와 Eclipse 설치는 이것으로 마무리한다. 끝.","link":"/delete/hapi-fhir-environment-1.html"},{"title":"HAPI FHIR 환경 구성하기 (2&#x2F;5편) - Tomcat 설치","text":"오픈소스 HAPI FHIR 환경은 다음과 같이 5단계로 구성된다.본 글에서는 2. HAPI FHIR 환경 구성하기 (2/5편) - Tomcat 설치에 대해 다룬다. HAPI FHIR 환경 구성하기 (1/5편) - JDK, Eclipse 설치 HAPI FHIR 환경 구성하기 (2/5편) - Tomcat 설치 HAPI FHIR 환경 구성하기 (3/5편) - MySQL 설치 HAPI FHIR 환경 구성하기 (4/5편) - hapi-fhir-jpa-server 설치하기 HAPI FHIR 환경 구성하기 (5/5편) - hapi-fhir-client 설치하기 (작성중) Tomcat은 전세계적으로 가장 많이 사용되는 오픈소스 웹 컨테이너다. 아파치 소프트웨어 재단에서 개발한 서블릿 컨테이너(또는 웹 컨테이너)만 있는 웹 애플리케이션 서버이다. Tomcat은 웹서버와 연동하여 실행할 수 있는 자바 환경을 제공하여 JSP와 자바 서블릿이 실행될 수 있는 환경을 제공하고 있다. Tomcat 8.5 설치하기 Apache Tomcat 사이트(링크: http://tomcat.apache.org/)에 접속하여 Tomcat 8 다운로드 페이지로 이동한다. Tomcat 8은 현재(2020년 9월 11일) 8.5.57 버전까지 릴리즈되었다. “32-bit/64-bit Windows Service Installer”를 선택하여 제품을 내려받는다. 내려받은 Setup파일을 실행하여 설치를 진행한다. 소프트웨어 사용 라이센스에 동의하고 넘어간다. 컴포넌트를 선택하고 Next 진행한다. Tomcat은 디폴트 8080포트로 설정되나, 다른 포트로 접속하고자 한다면 포트번호를 변경한다. 그리고 User Name과 Password를 설정하고 Next로 넘어간다. JVM경로를 지정해준다. jdk를 설치했던 폴더 경로를 다음과 같이 잡도록 한다. 다음으로 진행하기 전에, 프로젝트 폴더(D:/hapi-fhir)내에 Tomcat을 설치할 폴더를 생성하도록 한다. 다음과 같이 Tomcat 8.5라는 폴더를 생성하였다. 방금 전에 생성한 Tomcat 8.5 폴더를 설치 경로로 잡아준 후에 Install을 진행한다. 설치가 완료되었다면, Finish를 눌러 종료한다. (Tomcat 서버를 테스트해보려면, Run Apache Tomcat을 체크한다.) Tomcat이 정상적으로 실행되는지 확인해보기 위해 웹 브라우저를 열어서 “localhost:8080”을 입력한다. 다음과 같은 화면이 뜬다면 정상적으로 설치 및 실행된 것이다. Tomcat 설치는 이것으로 마무리한다. 끝.","link":"/delete/hapi-fhir-environment-2.html"},{"title":"HAPI FHIR 환경 구성하기 (3&#x2F;5편) - MySQL 설치","text":"오픈소스 HAPI FHIR 환경은 다음과 같이 5단계로 구성된다.본 글에서는 3. HAPI FHIR 환경 구성하기 (3/5편) - MySQL 설치에 대해 다룬다. HAPI FHIR 환경 구성하기 (1/5편) - JDK, Eclipse 설치 HAPI FHIR 환경 구성하기 (2/5편) - Tomcat 설치 HAPI FHIR 환경 구성하기 (3/5편) - MySQL 설치 HAPI FHIR 환경 구성하기 (4/5편) - hapi-fhir-jpa-server 설치하기 HAPI FHIR 환경 구성하기 (5/5편) - hapi-fhir-client 설치하기 (작성중) MySQL은 전세계적으로 가장 널리 사용되는 오픈소스 관계형 데이터베이스 관리 시스템( RDBMS)이다. FHIR 데이터를 저장할 데이터베이스로 활용한다. MySQL 설치하기 MySQL Downloads 사이트에 접속한다. (링크: https://www.mysql.com/downloads/) MySQL 제품 중, 무료 버전인 MySQL Community Edition(GPL)을 다운로드 받도록 한다. MySQL Installer for Windows를 선택하여 다운로드받는다. Installer를 활용하면 MySQL 제품들을 한번에 간편히 설치할 수 있다. MySQL Installer 다운로드 페이지에 들어가면 제품이 2가지가 보이는데, 그 중에서 파일 사이즈가 큰 것을 선택하여 다운로드를 진행한다. 현재(2020년 9월 11일) 기준으로 MySQL 최신 버전은 8.0.21이며, 최신버전으로 설치를 진행하였다. Login을 유도하는 창이 나오지만, 자세히보면 아래 쪽에 Login을 하지 않고 바로 다운로드를 진행하는 버튼이 있다. No thanks, just start my download를 선택한다. MySQL Installer를 내려받았으면, 실행하여 설치를 진행한다. Setup Type은 “Developer Default”를 선택한다. 요구사항을 체크하라는 페이지가 나오는데, 별도 체크없이 바로 Execute를 실행하여 전체 제품을 모두 설치한다. Installer가 차근차근 Check Requirements를 진행하는데, 중간중간에 소프트웨어 사용권 계약과 관련한 팝업창들이 뜬다. 동의하고 계속 진행한다. Next를 눌러 계속 진행한다. 만약에 다음과 같은 팝업창이 뜨면 Yes를 선택하고 계속 진행한다. Execute를 선택하여 설치를 진행한다. 설치가 잘 진행되었다면, Next를 눌러준다. Next MySQL Server의 사양을 선택한다. Standalone MySQL Server와 InnoDB Cluster 타입이 있는데, 이 중에서 InnoDB를 선택하고, Create a New InnoDB Cluster를 선택하여 설치를 진행한다. InnoDB Cluster의 Name, User 등을 설정한다. User-Name, Password는 원하는대로 설정하되, 잊어버리지 않게 잘 기억해두도록 한다. 또한 Host Address도 현재 Local PC를 잡아준다. Configuration Type과 Network를 아래와 같이 설정하고 진행한다. 만약 3306 포트를 사용할 수 없다면 다른 포트로 변경한다. Authentication Method는 MySQL에서 추천하는 것을 선택하고 넘어간다. MySQL Root 계정의 Password를 설정한다. Password를 잊어버리면 곤란해질 수 있으니 잘 기억해두도록 한다. 그리고 Add User를 선택하여 FHIR DB 사용자 계정을 만든다. FHIR DB 사용자명은 fhirman으로 설정하였다. (원하는 명칭으로 설정해도 무방하다.) Role은 DB Admin 권한을 부여하였다. 역시 비밀번호를 설정하고 잊어버리지 않게 잘 기억해두도록 한다. 다 입력하였다면 Ok를 선택하여 빠져나간다. fhirman이라는 사용자가 추가된 것을 확인할 수 있다. Next를 눌러 계속 진행한다. Server의 명칭을 설정하고 Next로 넘어간다. Default로 MySQL80으로 설정되어 있어서 별도 수정하지 않고 계속 진행하였으나, 명칭은 운영자가 원하는 대로 설정하여도 무방할 듯 하다. 설정을 적용한다. Execute를 선택한다. MySQL Workbench 활용하여 각종 환경설정하기위에서 설명한 절차대로 진행하였다면, MySQL Workbench가 함께 설치되었을 것이다. (만약 설치가 안되었다면, MySQL 홈페이지에서 별도로 설치가 가능하다)MySQL Workbench는 SQL 개발과 관리, 데이터베이스 설계, 생성 그리고 유지를 위한 단일 개발 통합 환경을 제공하는 비주얼 데이터베이스 설계 도구이다. MySQL Workbench에 대한 사용법은 생활코딩 사이트에서 무료로 제공하고 있으니 필요한 경우 참고하면 유용할 듯하다. MySQL Workbench를 실행하면 다음과 같은 화면이 뜬다. 최초로 MySQL Connection을 만들기 위해 + 버튼을 선택한다. Connection의 이름은 임의로 설정하여도 무방하나, Local PC에 설치하는 것이기 때문에 mysql_local이라고 이름을 지어주었다. 포트는 일반적으로 3306가 디폴트로 설정될 것이나, 앞에서 MySQL Server를 설치할 때 포트번호를 변경하였다면 해당 포트번호를 입력한다. User는 관리자 계정인 root로 접속해본다. Password를 입력하고 Test Connection을 클릭하면 연결이 잘 되었는지 실행결과를 볼 수 있다. 연결이 성공적으로 잘 되었다. Ok를 눌러서 Connection을 생성한다. 메인 화면에 Connection이 생성된 것을 볼 수 있다. 선택하여 MySQL Server에 접속한다. MySQL Server에 접속하여, Schema를 둘러본다. 기본적으로 sys와 mysql_innodb_cluster_metadata 스키마가 생성되어있다. Schemas 창 우클릭 &gt; Create Schema를 선택하여 fhir용으로 사용할 스키마를 생성한다. 스키마 명칭은 hapi-dstu3, Charset을 utf8로 설정하고, Apply를 눌러 진행한다. 자동으로 스키마 생성 SQL 스크립트가 생성된다. 이상이 없다면 Apply를 눌러 계속 진행한다. SQL 실행이 끝났으면 Finish한다. 앞서 생성하였던, fhirman 계정의 권한을 설정해보자. 좌측 Navigator 하단의 Administration 탭을 선택하면 각 계정의 권한을 관리하는 화면이 열린다. 여러 계정들의 리스트 중에소 fhirman을 선택한다. Fhirman 계정의 상세한 권한을 확인할 수 있다. 그 중에서 세번째 탭인 Administrative Roles를 눌러 권한이 잘 주어졌는지 확인한다. 현재는 특별히 제한할 권한이 없으므로, 전체 권한을 모두 부여하였다. 네번째 탭을 눌러 어떤 스키마에 권한을 부여할 것인지도 지정한다. Add Entry를 눌러서 신규로 생성하였던 hapi_dstu3 스키마 권한을 부여한다. hapi_dstu3 스키마에 대한 권한을 전체선택하고 Apply한다. MySQL 설치와 MySQL Workbench를 활용한 각종 환경세팅은 이것으로 마무리한다. 끝.","link":"/delete/hapi-fhir-environment-3.html"},{"title":"HAPI FHIR 환경 구성하기 (4&#x2F;5편) - HAPI FHIR JPA SERVER 설치하기","text":"오픈소스 HAPI FHIR 환경은 다음과 같이 5단계로 구성된다.본 글에서는 4. HAPI FHIR 환경 구성하기 (4/5편) - hapi-fhir-jpa-server 설치하기에 대해 다룬다. HAPI FHIR 환경 구성하기 (1/5편) - JDK, Eclipse 설치 HAPI FHIR 환경 구성하기 (2/5편) - Tomcat 설치 HAPI FHIR 환경 구성하기 (3/5편) - MySQL 설치 HAPI FHIR 환경 구성하기 (4/5편) - hapi-fhir-jpa-server 설치하기 HAPI FHIR 환경 구성하기 (5/5편) - hapi-fhir-client 설치하기 (작성중) HAPI-FHIR 서버 소스 내려받기HAPI란, HL7 Application Programming Interface의 약자로 HL7 FHIR 사양으로 구현한 오픈소스 Java 라이브러리이다. HAPI-FHIR 홈페이지에 접속하여, Documentation 메뉴로 접속한다. 좌측 메뉴에서 [JPA SERVER] &gt; [Get Started] 를 선택하여, 게시되어 있는 Github 소스코드 경로로 접속한다. Github에서 소스코드 ZIP 파일을 내려받는다. 앞으로 FHIR와 관련된 소스코드를 보관할 경로를 만들어보자. 프로젝트 폴더(D:/hapi-fhir) 아래에 workspaces라는 폴더를 생성한다. workspaces 폴더(D:/hapi-fhir/workspaces) 아래에 다시 workspace_jpaserver 라는 폴더를 생성한다. 이 폴더는 HAPI FHIR JPA SERVER 소스코드를 보관할 경로이다. workspace_ jpaserver 폴더(D:/hapi-fhir/workspaces/workspace_jpaserver) 아래에 Github에서 내려받은 ZIP파일 압축을 풀어준다. Eclipse에 프로젝트 임포트하기 앞서 설치하였던 Eclipse를 실행한다. \u0010Eclipse를 실행하면, 가장 먼저 Workspace 경로를 지정하는 화면이 뜰 것이다. 그럼 앞서 HAPI FHIR JPA SERVER 소스코드를 저장한 경로 (D:/hapi-fhir/workspaces/workspace_jpaserver)를 지정하고 Launch한다. Eclipse가 실행되었지만, 아직 어떠한 프로젝트도 떠 있지 않은 빈 화면 상태이다. 앞서 내려받았던 HAPI JPA SERVER 프로젝트를 임포트하기 위해, 좌측 Project Explorer에서 Import projects를 한다. HAPI FHIR JPA SERVER는 빌드 도구로 maven을 사용하기 때문에, Existing Maven Projects를 선택하여 진행한다. Root Directory에 HAPI FHIR JPA SERVER 소스코드 경로를 지정해준다. (D:/hapi-fhir/workspaces/workspace_jpaserver/hapi-fhir-jpaserver-starter-master) 그리고, 각종 maven 라이브러리가 정의되어 있는 pom.xml 파일을 선택한 후에 Finish한다. 그럼 아래와 같이 HAPI FHIR JPA SERVER 프로젝트가 임포트된 것을 확인할 수 있다. 각종 설정값 변경하기hapi.properties 수정src/main/resources/hapi.properties 파일을 열어 아래와 같이 설정값을 수정한다. 수정사항은 크게 3가지이다. fhir_version을 변경한다. datasource 설정을 h2에서 mysql 내용으로 변경한다. hibernate 설정을 변경한다. 1234567891011121314151617181920212223242526272829303132333435#fhir_version 설정을 R4(초기값)에서 DSTU3로 설정한다.#fhir_version = R4fhir_version = DSTU3#datasource 설정을 h2(초기값)에서 MySQL로 변경한다.#datasource.driver=org.h2.Driverdatasource.driver=com.mysql.cj.jdbc.Driver#datasource.url=jdbc:h2:file:./target/database/h2datasource.url=jdbc:mysql://localhost:3306/hapi_dstu3?characterEncoding=UTF-8&amp;serverTimezone=UTCdatasource.username=rootdatasource.password=12345678#hibernate 설정을 h2(초기값)에서 MySQL로 변경한다.#hibernate.dialect=org.hibernate.dialect.H2Dialecthibernate.dialect=org.hibernate.dialect.MySQL5InnoDBDialect#hibernate.search.default.indexBase 경로를 아래와 같이 지정해준다. #다만, 경로에 해당 폴더가 존재하지 않으면 에러가 발생하니 D:/hapi-fhir/hibernate/lucence/indexes 폴더를 반드시 만들어준다.hibernate.search.default.indexBase=D:/hapi-fhir/hibernate/lucence/indexeshibernate.search.lucene_version=LUCENE_CURRENT#jpa-server 기동시 MySQL 스키마를 자동 업데이트하기 위해 아래 설정을 update로 변경한다.hibernate.hbm2ddl.auto=update########################################################################################################### 아래는 선택사항이다. 사용자에 따라 필요시 추가하도록 한다.#(선택사항)SQL을 로그에 찍어보고 싶다면 아래 설정을 true로 변경한다. 초기값은 false일 것이다.hibernate.format.sql=truehibernate.show_sql=true#(선택사항)Create 명령 실행 시 java.lang.reflect.InvocationTargetException:null 오류가 발생하여 아래 설정을 추가하였더니 해결되었다.# 다만, Create 1회만 실행하고 다시 주석처리하여 서버를 재기동 해야한다.hibernate.temp.use_jdbc_metadata_defaults=false pom.xml 수정hapi-fhir-jpaserver-starter-master 프로젝트 가장 상위 경로에 pom.xml이라는 파일이 있을 것이다. 파일을 열어서 아래 내용을 수정한다. H2 데이터베이스 내용이 있다면, 필요없으므로 주석처리한다. 현 프로젝트에서는 MySQL을 사용하므로, MySQL 설정이 필요하다. MySQL 관련된 설정이 있는지 확인하여 만약 없으면 추가한다. 123456789101112131415&lt;!-- H2 데이터베이스 내용을 찾아 아래와 같이 주석처리한다. --&gt;&lt;!-- &lt;dependency&gt; &lt;groupId&gt;com.h2database&lt;/groupId&gt; &lt;artifactId&gt;h2&lt;/artifactId&gt; &lt;/dependency&gt;--&gt;&lt;!-- dependencies 아래에 MySQL 설정이 있는지 확인하고, 없다면 추가한다. --&gt; &lt;dependency&gt; &lt;groupId&gt;mysql&lt;/groupId&gt; &lt;artifactId&gt;mysql-connector-java&lt;/artifactId&gt; &lt;version&gt;8.0.16&lt;/version&gt; &lt;/dependency&gt; @Test 찾아서 모두 주석처리src/test/java/ca/uhn/fhir/jpa/starter 폴더 아래 java 클래스에 선언되어 있는 @Test 를 전부 주석처리한다.@Test 코드를 주석처리하는 이유는, 해당 코드들로 인해서 maven-install 시에 오류가 발생하기 때문이다. @Test 코드를 주석처리한 후에는 maven-install 이 정상적으로 실행되었다.(Ctrl+H를 눌러, File Search를 활용하여 @Test 코드를 전부 서치하는 것을 추천한다. 전부 주석처리한다.) 12//아래와 같이 주석처리한다.//@Test HAPI-FHIR 버전에 따라 다를 수 있지만, 가이드 작성자는 아래의 java 파일들에 @Test 코드들이 선언되어 있었으니, 참고한다. ExampleServerDstu2IT.java ExampleServerDstu3IT.java ExampleServerR4IT.java ExampleServerR5IT.java MultitenantServerR4IT.java Maven Update 및 Maven Install 실행 Maven Update를 진행한다. Maven update란, pom.xml에 정의된 각종 maven 라이브러리를 중앙 레포지토리에서 가져오는 (업데이트하는) 기능이다. 실행방법은 [프로젝트 우클릭] &gt; [Maven] &gt; [Update Project..]이다. Force Update of Snapshots/Releases를 선택하여 업데이트를 진행한다. 최초로 Maven Update를 실행하는 경우에는 약 5분 ~ 10분 정도 소요될 것이다. Maven Install을 실행한다. 실행방법은 [프로젝트 우클릭] &gt; [Run As] &gt; [Maven install]이다. Maven Install이 정상적으로 완료되면, 아래와 같이 Console 창에 Build Success가 출력될 것이다. Eclipse 내에 Tomcat Server 세팅 및 실행하기 [Window] &gt; [Preferences] 를 연다. [Server] &gt; [Runtime Environment]로 들어가서 Server를 Add한다. 앞서 Tomcat 8.5를 설치했으니, 싱크를 맞춰 Apache Tomcat v8.5 버전을 선택하고 넘어간다. 앞서 Tomcat을 설치했던 경로와, jdk를 설치했던 경로를 지정하고 Finish한다. Apache Tomcat v8.5가 생성되었다. Apply and Close를 눌러 저장하고 빠져나간다. 앞서 등록한 Tomcat Server를 HAPI FHIR JPA SERVER 프로젝트의 로컬서버로 등록해본다. [Server] 창 아래 No servers are available. Click this link to create a new server 링크를 클릭한다. Preference에 등록했던 대로, 아래와 같이 디폴트로 선택되어 있을 것이다. (디폴트로 지정되어 있지 않으면 직접 선택해도 된다.) 그대로 Finish하여 저장한다. Tomcat 8.5 로컬서버가 등록되었다. 더블 클릭해본다. Tomcat v8.5 Server at localhost를 더블클릭하면 설정을 변경할 수 있는 창이 뜬다. 여기서 아래와 같이 3가지를 변경한다. Server Options: (1) Push module contexts to separate XML files 와 (2) Modules auto reload by default 두 가지를 체크한다. Timeouts를 늘려준다. (Start 450, Stop 150) Tomcat admin port를 8005로 변경한다. 설정이 끝이 났으므로, 서버를 기동해본다. 서버를 우클릭하여 Start를 누른다. 서버가 에러 없이 잘 기동되는지 Console 창을 살펴본다. 별다른 에러 없이 다음과 같이 Console에 출력되면 서버가 잘 기동된 것이다. 서버가 기동되었으므로, 테스트화면에 접속하여 이상없이 동작하는지를 점검해본다. 브라우저를 열어 테스트화면의 주소를 입력한다. (localhost:8080/hapi-fhir-jpaserver/) 테스트화면의 주소는 hapi.properties 파일 내에도 선언되어 있으니 열어서 확인해보아도 된다. 샘플 테스트를 위해 Patient라는 Resource를 Create 해본다. 실행 방법은 좌측메뉴 [Patient] &gt; [CRUD Operation] &gt; ID 및 Contents 작성 &gt; [Create] 실행 순이다. 샘플로 입력할 Contents 내용은 아래 json 코드를 참고한다. 12345678910111213141516{ &quot;resourceType&quot;: &quot;Patient&quot;, &quot;id&quot;: &quot;1234&quot;, &quot;meta&quot;: { &quot;versionId&quot;: &quot;1&quot;, &quot;lastUpdated&quot;: &quot;2020-08-21T11:10:26.000+09:00&quot;, &quot;source&quot;: &quot;#JP0sa7sXme5pxIaA&quot; }, &quot;text&quot;: { &quot;status&quot;: &quot;generated&quot;, &quot;div&quot;: &quot;&lt;div xmlns=\\&quot;http://www.w3.org/1999/xhtml\\&quot;&gt;&lt;div class=\\&quot;hapiHeaderText\\&quot;/&gt;&lt;table class=\\&quot;hapiPropertyTable\\&quot;&gt;&lt;tbody/&gt;&lt;/table&gt;&lt;/div&gt;&quot; }, &quot;name&quot;: [ { &quot;text&quot;: &quot;Peter James&quot; } ]} 아래와 같이 정상적으로 실행되면, HAPI FHIR JPA SERVER 개발환경이 잘 세팅된 것이다. 끝. #개발/오픈소스/FHIR","link":"/delete/hapi-fhir-environment-4.html"}],"posts":[{"title":"의료 RPA 사업기획안 - Block of Medical RPA","text":"2019년도 여름, 팀에서 새로운 먹거리를 찾기위해 몇몇 팀원분들과 함께 약 2~3개월 동안 신사업 발굴/기획 업무를 담당하였다. 당시 재미있는 신사업 아이템이 여럿 발굴되었고, 그 중에서 필자가 담당하였던 Block of Medical RPA는 운이 좋게도 내부적으로 긍정적인 평가를 받아 고객사(병원)와 사업 협의 중인 단계로 발전하였다. 이에 당시 신사업 아이디어를 어떤 방향으로 기획하였는지 기록으로 남기고자 한다. 다만, 외부 공개가 되면 곤란한 영업비밀이 일부 있어 해당 부분은 제거하였다. Block of Medical RPA란, 각종 자동화 업무들을 블록의 형태로 쌓아가는 모습을 형상화한 아이디어의 명칭이며, 핵심은 RPA 기반의 의료 인력운영 효율화 플랫폼이다. RPA란, Robotic Process Automation의 약자로, UI(User Interface) 상에서 사용자가 수행하던 업무/작업을 자동화하는 기술을 일컫는다. 추진배경사업을 추진하게 된 배경은, 대형병원의 환자수 급증 현상에 있다. 여러 대형병원들이 가진 공통의 고민이자 현재 사회적인 이슈이기도 하다. 병원 입장에서 이를 해결하려면 당장 시급한 것이 바로 인프라, 제도, 인력운영 측면에서의 대책이라 생각했다. 환자가 늘어나면 가장 먼저 인프라에 부하가 오기 때문에 이에 대한 해결책이 필요하다. 건물/공간이 모자라고, 시스템이 감당을 못한다. 제도적으로도 해결책이 필요하다. 정부적 차원에서 현재 환자를 분산할 수 있는 지원책, 의료인력을 확충하는 지원책 등을 마련해주어야 한다. 마지막으로 인력운영 측면에서 해결책도 필요하다. 환자가 많아지는 것은 곧 직원들의 일이 늘어나는 것을 의미하기 때문이다. 현재 여러 상급종합병원의 경우 자체적인 인프라 확장을 진행중이고, 제도적으로도 “전문병원 제도”, “입원전담전문의 제도” 등 지원책이 등장하고 있다. 안타까운 점은 인력운영에 대해서는 뚜렷한 해결책이 없다는 것이다. 시간이 흐를수록 상급종합병원 직원들의 업무량은 끝도없이 늘어가고 있는 실정이다. 물론, 인력을 계속 때려박으면 문제가 해결되지 않을까 싶지만 병원들도 재정상황이 그리 녹록치 못하고, 더군다나 이는 의료계 추세와 맞지 않은 상황이다. 현재 의료계는 직접진료와 정밀의료 서비스 제공을 위해 전문 의료진 위주로 인력을 충원하고, 행정업무는 갈수록 효율화하고 있기 때문이다. 그렇다면 인력운영 효율화를 하기 위해서는 어떤 방법이 있을까? 이는 3가지로 나누어 생각해볼 수 있다. 첫째 업무속도를 향상시켜주는 방법, 둘째 업무 분장을 조정해주는 방법, 셋째 업무량을 줄여주는 방법이다. 조사를 통해 확인해보니 이미 여러 상급종합병원에서 업무속도향상 및 업무분장조정에 대한 대응책을 진행 중이거나 진행완료하였다. 다만, 업무량 자체를 줄여주는 방법에 대해서는 아직까지 도입한 사례는 뚜렷하게 확인하기 어려웠고 이 부분이 아직 개척되지 않은 미지의 영역일 수 있겠다 판단했다. 그렇다면 IT 기술로 업무량을 줄이는데 도움을 줄 수 있을 만한 업무영역은 어떤 것들이 있고, 어떤 IT기술들이 필요한지를 아래와 같이 조사하였다. 결론적으로는 RPA라는 기술이 다방면으로 활동될 수 있다는 점을 찾아냈다. 서두에서도 언급했으나 RPA란, 로보틱 처리 자동화 기술로 Email, Excel, XML, Web/App 등 다양한 작업유형들을 자동화할 수 있는 기술이다. HfS리서치, EY한영, 맥킨지, 가트너 등에서 발표한 내용들을 참고해보았을 때 현재 가장 뜨겁게 주목받고 있는 기술이면서, 한국에서도 금융/제조/유통 산업 중심으로 보급되고 있는 추세이다. RPA는 Robotic &gt; Cognitive Robotic &gt; Intelligent Robotic의 흐름으로 발전되고 있고, 그에 따라 RPA를 도입하는 병원에서는 이와 Align되는 방향으로 로드맵(추진전략)을 세울 수 있을 것으로 판단하였다. 즉, RPA를 단기적으로는 단순/반복 업무에, 중기적으로는 데이터분석 업무에, 장기적으로는 의학적 업무에 도입하는 것이다. 그리고 장기적인 Goal로는 CDSS를 대체할 수 있는 진단솔루션의 역할을 하는 것이다. 추진과제RPA는 좋은 기술이다. 하지만, 기술 그 자체가 상품이 되기는 어렵다고 생각했다. 기술을 고객이 이해할 수 있는 언어로 전달해야 매력적인 상품이 될 수 있겠다 판단했다. 그래서 탄생한 것이 Block of Medical RPA라는 컨셉이다. RPA로 자동화한 업무 프로세스들을 레고블럭처럼 차곡차곡 쌓아가는 모습을 형상화하였다. 이것들을 업무단위(y축)로, 그리고 시스템 단위(x축)으로 쌓아나갔을 때 안정적이게 쌓아올려질 수 있을 것이라는 이미지를 삽입하였다. RPA를 통해 구축될 전반적인 플랫폼의 구성도이다. (먼저, 우리가 도입한 RPA 솔루션은 UiPath의 제품이라는 것을 밝힌다.) Block of Medical RPA와 UiPath RPA는 하나의 상품으로 제공된다. 그리고 이는 Internal Legacy System(병원 내부 시스템)과 External Website(외부 사이트)들과 연계되어 동작한다. UiPath RPA는 업무 자동화 기술을 담당하고, Block of Medical RPA는 그 외의 KPI/ROI 모니터링, 타기관 사례 공유, 신규요구사항관리, 유지보수/변경관리 등의 플랫폼으로서의 기능을 담당한다. RPA 도입 프로세스는 일반적인 SI와 대동소이하지만, “안정화”라는 단계가 매우 중요하다. RPA는 살아 움직이는 시스템 위에서 동작하는 것이다 보니, 구축 단계에서 파악하지 못한 예외적인 케이스들이 많이 도출된다. 어찌보면 고객(병원)이 가장 궁금해할만한 부분일 것 같다. 병원의 어떤 업무들에 RPA를 도입할 수 있을까? 이를 도출하기 위해 함께 일하고 있는 병원 IT 전문가들과 수차례 브레인스토밍을 거쳐, 3가지 카테고리의 21개의 과제를 뽑아낼 수 있었다. 도출된 21개 과제들 중에서, 어떤 과제를 우선적으로 추진할지를 선정하였다. 실현가능성, 기대효과, 활용성이라는 3가지 기준을 가지고 정량평가를 통해 3개의 우선과제를 도출하였다. 우선과제 3개를 파일럿 형태로 적용하지만, 점진적으로 도입을 확대해나가는 모델은 아래와 같은 Double Diamond 프로세스가 될 것이다. 우선과제 3개 중에서, [신규직원 등록 및 각종 데이터 생성 작업]을 샘플로 업무 프로세스 구체화를 진행하였다. 세부적으로 쪼개보니 예상보다 많은 상세 작업들이 있음을 알 수 있다. 프로세스를 상세화하는 이유는, 자동화할 수 있는 범위를 예측하기 위함이다. 실제 RPA를 도입하게 되면, 아래와 유사한 형태로 프로세스를 상세화하고 평가하는 과정을 거치게 된다. 이 업무를 도입했을 때 얼마만큼의 효과가 기대되는지를 서울 A병원을 예시로 시뮬레이션해보았다. 데이터는 국민연금 기반 데이터를 근거로 하였다. 이 업무를 신규입사 뿐 아니라, 퇴사/휴직/파견/수련 등 직원 데이터가 갱신되는 모든 범위로 확장하였을 때 얼마만큼의 효과가 기대되는지를 서울 A병원을 예시로 시뮬레이션해보았다. 데이터는 국민연금 기반 데이터를 근거로 하되, 확인이 불가한 수치는 일부 추정치를 적용하였다. 추진비용서두에서도 언급했듯이, 비용과 관련된 부분은 영업비밀이기 때문에 내용을 제거하였다.","link":"/2019/10/10/block-of-medical-rpa/"},{"title":"기술사 vs 야간대학원(석사)","text":"항목별 비교 항목 기술사 석사 비고 우위 기간 2년 2.5년 총 기간은 비슷 - 노력 온종일 주 3회 저녁 기술사가 약 3-4배 노력 석 비용 1천 ~ 2천 4천~5천 석사가 약 2-3배 비용 기 회사지원 없음 없음 - - 학위대우 박사급 석사급 기술사 희소성이 높음 기 탈락위험 높음 낮음 합격한다는 보장 없음 석 파견시 혼자 공부 가능 즉시 중단 해외에 나가게 될 가능성 검토 기 출퇴근 문제없음 대부분 멀리 석사는 칼퇴 즉시 이동해도 빠듯 기 제반여건 없음 차 구매 필요 기름값/주차비 등 발생 기 개인생활 없음 주말 있음 개인생활 전부포기 vs 일부포기 석 직장생활 야근 가능 야근 불가 직장이 야근 빈번한지? 기 인맥 기술사협회 학우회 당장 인맥이 왜 필요한지? 기 업무기회 PM, 컨설팅, 감리 PM - 기 실질혜택 정년 이후, 고과 고과, 임원승진 - 기 필요시기 과장~차장 대리~과장 - 석 공부내용 도움 됨 도움 안됨 나에게 더 의미 있는 공부는? 기","link":"/2020/10/11/certificate-vs-master/"},{"title":"FHIR 시스템 구축을 위한 사전조사","text":"2020년 하반기, 회사에서 FHIR 의료 데이터 송수신 시스템을 구축하는 파일럿 프로젝트를 진행하면서, 관련하여 사전조사한 정보들을 기록하고자 한다. 먼저 FHIR란, Fast Healthcare Interoperability Resources 의 약자로, HL7에서 개발된 의료정보의 전자교류를 위한 최신 국제표준 프로토콜이다. 의료 환경에서 다루어지는 다양한 정보들을 Resource 형태로 구현하고 이를 결합/제약/확장함으로서 다양한 의료정보들 간 상호운영성을 보장하는 표준안이다. FHIR의 특징FHIR의 특징은 다음과 같다. 개발자에게 구현 라이브러리와 다양한 예제를 제공하여, 빠르고 쉽게 구현 가능하다. 공개 표준으로 누구나 무료로 사용 가능하다. 기존의 표준(HL7 Version 2, CDA 등)과 공존하면서 서로 보완 가능하다. XML, JSON, HTTP, Atom, OAuth 등의 웹 표준을 기반으로 한다. 다양한 ICT환경에 쉽게 적용이 가능하다. 간결하고 쉽게 이해할 수 있다. 개발자가 쉽게 사용할 수 있도록 메뉴얼이 제공된다. FHIR 구축의 목적현 프로젝트 발주처에서는 왜 FHIR를 구축하고자 할까?에 대한 내 생각을 기록해보자면 다음과 같다. 여러 기관/기업/기기 혹은 개인이 사용하는 데이터를 표준에 맞추어 송수신하기 위함이다. 즉, A라는 기관(기업)에서 FHIR로 보낸 데이터를 받아서, 우리 발주처에 맞게 변형하여 데이터를 저장하기 위함이 있고, 우리 발주처에 저장된 데이터를 FHIR 형식으로 변환하여, 데이터가 필요한 다른 기관으로 전송하기 위함도 있다. 그럼 FHIR 데이터를 주고받을 수 있는 잠재적 교류 대상은 어디일까? 넓게 보면 의료와 관련된 모든 기관과 개인이 포함될 것이다. 환자 개인(의 앱 또는 저장소) 병원 (대형/중형/소형/개인병원 등) 기관 약국 금융/보험사 헬스 디바이스 헬스케어 기업등등 FHIR를 구축하기 위한 전체 범위아직까지 국내에서 FHIR를 A부터 Z까지 구축하고 운영하고 있다는 사례를 찾기가 어려워서, FHIR도 결국 일반적인 SI 프로젝트의 일부라고 가정하고 다음과 같이 FHIR 구축의 전체 범위를 예상해보았다. 첫째, Target 시스템과 Workflow 정의먼저 누구와 정보를 교류할 것인지를 정의하는 단계이다. 또한 해당 Target과 어떤 업무를 위해 FHIR를 구축하는 것인지 Workflow를 고려한다. 둘째, Target 시스템과 우리 기관과의 인증체계 정의누구와 정보를 교류할지 정해졌다면, 다음으로 그 Target과 서로가 확실한지 확인할 수 있는 체계를 어떻게 구성할지 정의하는 단계이다. 셋째, Target 시스템과의 데이터 송수신범위 정의우리 기관과 Target 기관의 모든 데이터를 주고받는 것은 한계가 있으므로, 어떤 데이터들을 주고받을지 범위를 정의하는 단계이다. 조금 더 구체적으로 들어가본다면, Target 시스템과 어떤 Resource들을 사용할 것인지 어떤 Contents를 담을 것인지가 정의되어야겠다. 넷째, FHIR 시스템 구축/개발위와 같이 약속된 내용에 대해 시스템을 구축하고 개발하는 단계이다. 다섯째, 인터페이스/테스트Target 시스템과의 인터페이스는 잘 이루어지는지, 올바른 데이터가 송수신되는지, 저장되었는지를 테스트하는 단계이다. 여섯째, 안정화/운영구축된 시스템을 운영하고 유지보수하는 단계이다. (FHIR를 아직 실제로 구축해본 것이 아니기 때문에 실제로는 예상을 뛰어넘는 범위들이 있을 수도 있고, 예상외로 간단히 해결되는 부분들도 있을 걸로 생각한다.) 참고 자료 고객중심형 의료정보시스템을 위한 HL7 FHIR 표준기술 활용가이드라인 개발(2차) HL7 FHIR 란? : 에스피메드 공식 블로그 Healthcare/IT/표준 FHIR로 시작하는 헬스케어 표준 살펴보기 - 보브부 블로그 끝.","link":"/2020/09/05/fhir-firstsearch/"},{"title":"FHIR 프로젝트 범위 확정안","text":"2020년 하반기, 회사에서 FHIR 송수신 시스템을 구축하는 프로젝트에 참여하였는데, 프로젝트 범위를 어떻게 산정하였는지 기록하고자 한다. FHIR라는게 아직 아무도 걸어보지 않은 길이므로 프로젝트 범위를 협의하는 것에서부터 어려운 점들이 발생했다. 진행경과프로젝트가 시작되고 FHIR와 관련하여 진행되었던 경과는 다음과 같다. 요구사항 정의 단계에서 발주처와 수행사 간에 사업범위에 대한 이슈가 발생되어 잠시 진행이 홀딩된 상황이었고, 재협의를 통해 진행방안을 다시 정립하였다. FHIR 사전분석 및 공유 - 2020.08.04.화, 2020.08.26.수 요구사항 정의 회의 - 2020.08.04.화, 2020.08.10.월 FHIR 구축범위 이슈협의 - 2020.08.21.금 HAPI FHIR 검토 및 로컬테스트 (진행중) 진행방안 재협의 (진행중) FHIR 시스템 구축의 전체 범위FHIR 시스템을 신규로 구축하였을 때 예상되는 전체 사업의 범위는 다음과 같다. (FHIR를 아직 실제로 구축해본 것이 아니기 때문에 실제로 수행해보면 크고 작은 변동이 예상되나, 전반적인 흐름은 다음과 같을 것 같다는 예상안이다.) Target 시스템 및 Workflow 정의 Target 시스템의 인증체계 정의 Target 시스템과의 데이터 송수신범위 정의 FHIR 시스템 구축/개발 인터페이스/테스트 안정화/운영 이슈가 있었던 이유는, 현 프로젝트에서 Target 시스템이 정의되어 있지 않았기 때문이다. 그래서 프로젝트 시작 이후로도 연계가 가능한 기관을 물색하였으나, 현재까지 FHIR를 구축하고 운영중인 사례를 찾지 못하였다. 따라서 1번 ~ 3번까지 Target 시스템이 정의되어야만 가능한 업무들을 진행하는데 한계가 있었고, 더불어 6번 실제 운영까지도 연결되기도 어려운 상황이었다. 협의된 사업 범위하지만 FHIR 라는 것이 향후 의료정보 교류에 있어서 중요한 역할을 할 것임에 대해 발주처와 수행사가 서로 공감하는 바가 충분히 있었고, 아직까지는 잠재적이지만 조만간 나타날 Target 시스템을 위하여 임시 FHIR 시스템을 구축하는 것으로 협의를 진행하였다. 따라서 현 사업에서는 4번 ~ 5번에 대한 파일럿 환경을 구성하여 샘플 인터페이스를 진행하여 데이터가 잘 쌓이는지, 어떻게 쌓이는지 등을 테스트하고, 향후 Target 시스템이 정의된 이후에 활용이 가능하도록 각종 가이드를 도출하는 것으로 정하였다. 또한, 파일럿 환경이므로 상용 솔루션을 사용하기보단 가능하다면 오픈소스인 HAPI FHIR를 활용하는 방안을 세웠다. 그에 따라 FHIR 구축에 대한 프로세스와 각 단계마다 도출될 산출물들은 다음과 같이 합의하였다. 분석/설계발주처에 FHIR를 어떻게 구성할 것인지를 밑그림을 그린다. -&gt; 아키텍처 설계 도출 개발발주처의 가상환경(혹은 PC 내)에 오픈소스 HAPI FHIR 시스템를 구축하고, 필요한 각종 API를 개발한다. 그리고 인터페이스 테스트가 가능한 화면을 구성한다. -&gt; 소스코드, 테스트 화면 도출 테스트시스템이 정상 동작하는지, 인터페이스 결과는 문제 없는지 테스트를 수행한다. -&gt; 테스트계획서, 테스트결과서 도출 이관/교육HAPI FHIR 시스템을 구축하는 방법, HAPI를 활용하여 API를 개발하는 방법 등을 제시하고 교육한다. -&gt; 운영자 매뉴얼 (개발 가이드, 환경구축가이드 등 포함) 도출 앞으로 할 일 FHIR 연계가 가능한 기관을 계속 물색할 예정 FHIR 구축에 대한 상세일정 (WBS) 수립 FHIR 분석/설계 진행 끝.","link":"/2020/09/05/fhir-project-plan/"},{"title":"적합한 Resource 선정 방안","text":"FHIR 프로토콜에서 Resource란, 데이터 교환을 위한 의료정보 단위이다. 아래 표와 같이 Resource는 목적에 따라 모듈화되어 있고, 그 종류는 140종이 넘는다. 여기서 FHIR를 활용하려는 기관 입장에서 처한 문제는 Resource가 너무 많고, 이들 전부를 파악하는 것은 현실적으로 어렵다는 것이다. 이런 고민 때문에 적합한 Resource를 선정하는 방법론을 별도로 정의하게 되었다. 대단한 노하우까지는 아니지만, 최소한의 노력으로 Resource를 찾아내기 위해서 아래 다섯 단계의 방법론을 정의하였다. 이는 HL7 FHIR에서 가이드하는 내용은 아니며, 필자의 경험을 토대로 작성한 내용이다. 전송할 데이터 항목을 정의한다. Resource 분류, 명칭 등을 통해 후보군을 탐색한다. 후보군의 Resource 명세서를 검토한다. 적합한 Resource를 선정한다. Resource를 설계한다. 전송할 데이터 항목을 정의타겟 기관과 주고받을 내용을 리스트업한다. 아래 예시를 참고한다. [예시]약처방 데이터를 교류할 예정이라면 다음과 같은 항목들이 사용될 것이다. 약명, 처방의사, 처방환자, 처방일시, 유효기간, 처방일수, 복용방법, 복용량 등 Resource 분류, 명칭으로 후보군 탐색HL7 FHIR 사이트에서 리스트업한 항목들에 매칭될 것으로 예상되는 Resource를 찾는다. (위의 전체 Resource 그림 참고 가능하다.) [예시]약과 관련된 Resource들을 아래와 같이 찾을 수 있다. Medication MedicationKnowledge MedicationRequest MedicationAdministration MedicationStatement 후보군의 Resource 명세서를 검토후보군들 각각의 Resource의 명세서를 열어보는데, 아래 3가지 항목을 주로 살펴본다. Scope and Usage (개요) Structure (구조) Examples (예시) 적합한 Resource를 선정검토 후, 후보군 중에서 가장 적합한 Resource를 선정한다. 약 70~80%의 항목을 커버할 수 있다면, 적합한 Resource로 판단 가능하다. -&gt; [5. Resource 설계]로 진행 후보군 중에서 적합한 Resource를 찾지 못하였다면, 다시 [2. Resource 분류, 명칭으로 후보군 탐색]으로 돌아간다. 아무리 찾아도 적합한 Resource를 찾지 못하였다면, 다시 [1. 전송할 데이터 항목을 정의]로 돌아가서, 데이터 항목을 축소하거나 쪼갠다. 그렇게 해도 해결이 되지 않는 경우에는, 별도로 Profile을 재정의한다. (FHIR 사이트를 참조할 것) Resource를 설계선정이 완료된 Resource를 어떻게 사용할지 설계한다. Resource Element 중 사용여부 정의 (어떤 항목을 사용하고, 사용하지 않을 것인지) Identifier 규칙을 정의 Code 체계를 정의 추가로 필요한 Extension 등을 정의 끝.","link":"/2020/10/19/fhir-resource-search/"},{"title":"FHIR 정보를 얻을 수 있는 사이트","text":"참고 사이트 FHIR v4.0.1 공식사이트 HL7Wiki : 의료 HL7 표준에 대한 가이드를 게시하는 위키 페이지. FHIR에 대해 관심이 있는 기관과 각 기관의 연구내용에 대한 링크 제공. FHIR 공식 추천 블로그 FHIR Place : Ewout Kramer의 블로그, FHIR 개발 및 구현에 대해 다룬다. Hay on FHIR : David Hay의 블로그, 주로 FHIR 구현 문제를 다룬다. Healthcaresec Privacy : John Moehrke의 블로그, FHIR 및 기타 Motorcycleguy : Keith (Motorcycle Guy) Boone의 블로그, 여러 가지 FHIR을 다룬다. FHIR-BizTalk : Howard Edidin의 블로그, 다른 정보와 함께 FHIR을 다룬다. Lightmyfhir : 다양한 주제를 다루는 MITER Corporation의 FHIR 팀 블로그 AEGIS Insights : 상호 운용성, 테스트 및 기타 관련 주제를 다루는 AEGIS.net, Inc 블로그 사이트 FHIRabend- : 독일의 FHIR에 대한 Simone Heckmann의 블로그 Helios Software : FHIR 및 의료 제품 개발에 대한 Steve Munini의 블로그 fhirbase dojo : FHIR 및 데이터베이스에 대한 그룹 블로그 Nicola on FHIR : Nikolai Ryzhikov (Health Samurai의 CTO) FHIR의 엔지니어 과제에 대한 블로그 HAPI FHIR (오픈소스) 관련 HAPI FHIR - The Open Source FHIR API for Java : Java로 구성된 대표적인 FHIR 오픈소스 소프트웨어 (HAPI) 공식 사이트 씨앤텍시스템즈 기술블로그 :: HAPI FHIR 서버 구축 : HAPI FHIR 구축 사례를 제시하는 기술 블로그 상용 솔루션 관련 Azure API for FHIR이란? - Azure API for FHIR | Microsoft Docs Azure API for FHIR(r) | Microsoft Azure FHIR | Cloud Healthcare API | Google Cloud 기타 (연구결과 등) KIEE - The Transactions of the Korean Institute of Electrical Engineers 산후조리앱 관련 고객중심형 의료정보시스템을 위한 HL7 FHIR 표준기술 활용가이드라인 개발(2차) 끝.","link":"/2020/09/05/fhir-site-info/"},{"title":"HAPI FHIR 환경 구성하기 (1&#x2F;7편) - JDK 설치","text":"오픈소스 HAPI FHIR 환경은 다음과 같이 7단계로 구성된다.본 글에서는 1. HAPI FHIR 환경 구성하기 (1/7편) - JDK 설치에 대해 다룬다. HAPI FHIR 환경 구성하기 (1/7편) - JDK 설치 HAPI FHIR 환경 구성하기 (2/7편) - Eclipse 설치 HAPI FHIR 환경 구성하기 (3/7편) - Tomcat 설치 HAPI FHIR 환경 구성하기 (4/7편) - MySQL 설치 및 스키마/계정 설정 HAPI FHIR 환경 구성하기 (5/7편) - hapi-fhir-jpa-server 환경세팅 HAPI FHIR 환경 구성하기 (6/7편) - hapi-fhir 테스트 페이지 활용 HAPI FHIR 환경 구성하기 (7/7편) - hapi-fhir-client 환경세팅 JDK(Java Development Kit)은 자바 어플리케이션을 구축하기 위한 플랫폼 구성요소다. JDK는 대표적으로 OracleJDK와 OpenJDK가 있는데, 이 중에서 오픈소스인 OpenJDK를 설치하도록 한다. (OracleJDK의 경우 현재 라이센스 이슈가 있다.) OpenJDK 버전 중에서는 고객사에서 사용중인 OpenJDK 1.8.0를 설치한다. 필자는 Windows 환경에서 설치 중이므로, Windows를 기준으로 설명하겠다. OpenJDK 1.8.0 - Gihub 페이지에 접속하여 .zip 파일을 클릭하여 내려받는다. 최신 버전을 설치하였으며, 2020년 10월 기준으로 최신버전은 1.8.0.265이다. 내려받은 파일을 압축을 푼다. D:드라이브 아래 hapi-fhir라는 폴더를 생성한 후에 압축을 푼 jdk 폴더를 D:/hapi-fhir 경로로 위치시킨다.Hapi-fhir 폴더는 앞으로 각종 소프트웨어와 소스가 위치하게될 프로젝트 폴더이니 기억해두도록 한다. 다운받은 jdk를 시스템 환경변수에 등록해주어야 한다. [제어판] &gt; [시스템] &gt; [고급 시스템 설정] &gt; [고급 탭] &gt; [환경변수] 순으로 타고 들어간다. 먼저, [제어판]에서 [시스템]을 선택한다. [시스템] 좌측 메뉴에서 [고급 시스템 설정]을 선택한다. [시스템 속성]의 [고급] 탭에서 [환경 변수]를 선택한다. [시스템 변수]를 새로 만든다. 새 시스템 변수로 “JAVA_HOME”을 등록해준다. 변수값으로는 앞서 내려받은 jdk 폴더 경로(D:₩hapi-fhir₩openjdk-1.8.0.265)를 지정해준다. (단, 본인이 다운받은 jdk 버전에 따라 폴더명이 다르게 생성되었을 수 있으니 잘 확인하여 진행한다.) 작성한 후에는 [확인] 버튼을 선택하여 빠져나간다. 다음으로는 Path에 JAVA_HOME을 등록해주어야 한다. 시스템 변수 중에 “Path”를 찾아 [편집]한다.Path에 한줄을 추가하여 %JAVA_HOME%₩bin 을 등록한다. 환경변수 편집이 끝났으므로, [확인] 버튼을 선택하여 빠져나간다. jdk가 환경변수로 잘 등록되었는지 확인해볼 차례다. Command를 실행하여 java -version 을 실행해본다. 본인이 설치한 jdk의 버전이 아래에 잘 출력되는지 확인한다. OpenJDK 설치는 이것으로 마무리한다. 끝.","link":"/2020/09/08/hapi-fhir-manual-1/"},{"title":"HAPI FHIR 환경 구성하기 (2&#x2F;7편) - Eclipse 설치","text":"오픈소스 HAPI FHIR 환경은 다음과 같이 7단계로 구성된다.본 글에서는 2. HAPI FHIR 환경 구성하기 (2/7편) - Eclipse 설치에 대해 다룬다. HAPI FHIR 환경 구성하기 (1/7편) - JDK 설치 HAPI FHIR 환경 구성하기 (2/7편) - Eclipse 설치 HAPI FHIR 환경 구성하기 (3/7편) - Tomcat 설치 HAPI FHIR 환경 구성하기 (4/7편) - MySQL 설치 및 스키마/계정 설정 HAPI FHIR 환경 구성하기 (5/7편) - hapi-fhir-jpa-server 환경세팅 HAPI FHIR 환경 구성하기 (6/7편) - hapi-fhir 테스트 페이지 활용 HAPI FHIR 환경 구성하기 (7/7편) - hapi-fhir-client 환경세팅 Eclipse란, Java를 기반으로 한 오픈소스 IDE(통합개발환경)이다. 이클립스 다운로드 페이지로 접속하여, Download 64 bit 파일을 다운로드한다. 다운로드 버튼을 클릭하여 Eclipse Installer를 내려받는다. 다운로드받은 Eclipse Installer를 실행한다. Installer를 통해 Eclipse의 사용자에게 필요한 패키지를 선택하여 설치할 수 있다. Eclipse IDE for Enterprise Java Developers를 선택하여 진행한다. JVM 경로와 설치경로(Installation Folder)를 지정한다. JVM은 앞서 설치한 jdk 폴더 경로를 지정하고, 설치경로는 프로젝트 폴더(D:\\hapi-fhir)로 지정한다. 소프트웨어 사용과 관련된 동의서이다. Accept Now를 누르고 진행한다. 설치가 진행된다. 중간중간 팝업창이 뜨면 계속 진행하면 된다. 설치가 완료되었다. 지정한 설치경로 (D:/hapi-fhir) 아래에 다음과 같이 eclipse 폴더가 생성이 된다. Eclipse 설치는 이것으로 마무리한다. 끝.","link":"/2020/09/09/hapi-fhir-manual-2/"},{"title":"HAPI FHIR 환경 구성하기 (3&#x2F;7편) - Tomcat 설치","text":"오픈소스 HAPI FHIR 환경은 다음과 같이 7단계로 구성된다.본 글에서는 3. HAPI FHIR 환경 구성하기 (3/7편) - Tomcat 설치에 대해 다룬다. HAPI FHIR 환경 구성하기 (1/7편) - JDK 설치 HAPI FHIR 환경 구성하기 (2/7편) - Eclipse 설치 HAPI FHIR 환경 구성하기 (3/7편) - Tomcat 설치 HAPI FHIR 환경 구성하기 (4/7편) - MySQL 설치 및 스키마/계정 설정 HAPI FHIR 환경 구성하기 (5/7편) - hapi-fhir-jpa-server 환경세팅 HAPI FHIR 환경 구성하기 (6/7편) - hapi-fhir 테스트 페이지 활용 HAPI FHIR 환경 구성하기 (7/7편) - hapi-fhir-client 환경세팅 Tomcat은 전세계적으로 가장 많이 사용되는 오픈소스 웹 컨테이너다. 아파치 소프트웨어 재단에서 개발한 서블릿 컨테이너(또는 웹 컨테이너)만 있는 웹 애플리케이션 서버이다. Tomcat은 웹서버와 연동하여 실행할 수 있는 자바 환경을 제공하여 JSP와 자바 서블릿이 실행될 수 있는 환경을 제공하고 있다. Tomcat 9 설치하기 Apache Tomcat 사이트에 접속하여 Tomcat 9 다운로드 페이지로 이동한다. Tomcat 9은 2020년 10월 기준, 최신버전 9.0.38 까지 릴리즈되었다. “32-bit/64-bit Windows Service Installer”를 선택하여 제품을 내려받는다. 내려받은 Setup파일을 실행하여 설치를 진행한다. 소프트웨어 사용 라이센스에 동의하고 넘어간다. 컴포넌트를 선택하고 Next 진행한다. Tomcat은 디폴트 8080포트로 설정되나, 다른 포트로 접속하고자 한다면 포트번호를 변경한다. 그리고 User Name과 Password를 설정하고 Next로 넘어간다. JVM경로를 지정해준다. 앞서 jdk를 설치한 폴더 경로를 지정한다. 다음으로 진행하기 전에, 프로젝트 폴더(D:/hapi-fhir)내에 Tomcat을 설치할 폴더를 생성하도록 한다. 다음과 같이 Tomcat 9라는 폴더를 생성한다. 방금 전에 생성한 Tomcat 9 폴더를 설치 경로로 잡아준 후에 Install을 진행한다. 설치가 완료되었다면, Finish를 눌러 종료한다. (Tomcat 서버를 테스트해보려면, Run Apache Tomcat을 체크한다.) Tomcat이 정상적으로 실행되는지 확인해보기 위해 웹 브라우저를 열어서 “localhost:8080”을 입력한다. 다음과 같은 화면이 뜬다면 정상적으로 설치 및 실행된 것이다. Tomcat 설치는 이것으로 마무리한다. 끝.","link":"/2020/09/10/hapi-fhir-manual-3/"},{"title":"HAPI FHIR 환경 구성하기 (4&#x2F;7편) - MySQL 설치 및 스키마&#x2F;계정 설정","text":"오픈소스 HAPI FHIR 환경은 다음과 같이 7단계로 구성된다.본 글에서는 4. HAPI FHIR 환경 구성하기 (4/7편) - MySQL 설치 및 스키마/계정 설정에 대해 다룬다. HAPI FHIR 환경 구성하기 (1/7편) - JDK 설치 HAPI FHIR 환경 구성하기 (2/7편) - Eclipse 설치 HAPI FHIR 환경 구성하기 (3/7편) - Tomcat 설치 HAPI FHIR 환경 구성하기 (4/7편) - MySQL 설치 및 스키마/계정 설정 HAPI FHIR 환경 구성하기 (5/7편) - hapi-fhir-jpa-server 환경세팅 HAPI FHIR 환경 구성하기 (6/7편) - hapi-fhir 테스트 페이지 활용 HAPI FHIR 환경 구성하기 (7/7편) - hapi-fhir-client 환경세팅 MySQL은 전세계적으로 가장 널리 사용되는 오픈소스 관계형 데이터베이스 관리 시스템(RDBMS)이다. FHIR 데이터를 저장할 데이터베이스로 활용한다. MySQL 설치하기 MySQL Downloads 사이트에 접속한다. MySQL 제품 중, 무료 버전인 MySQL Community Edition(GPL)을 다운로드 받는다. MySQL Installer for Windows를 선택하여 다운로드받는다. Installer를 활용하면 MySQL 제품들을 한번에 간편히 설치할 수 있다. MySQL Installer 다운로드 페이지에 들어가면 2가지 제품이 나타나는데, 그 중에서 파일 사이즈가 큰 것을 선택하여 다운로드를 진행한다. 2020년 10월 기준으로 MySQL 최신버전은 8.0.21이며, 해당 버전으로 설치를 진행하였다. Login을 유도하는 창이 나오지만, 자세히보면 아래 쪽에 Login을 하지 않고 바로 다운로드를 진행하는 버튼이 있다. No thanks, just start my download를 선택한다. MySQL Installer를 내려받았으면, 실행하여 설치를 진행한다. Setup Type은 Developer Default를 선택한다. Check Requirement는 별도 체크없이 전체 제품을 모두 설치한다. Installer가 차근차근 Check Requirements를 진행하는데, 중간중간에 소프트웨어 사용권 계약과 관련한 팝업창들이 뜬다. 동의하고 계속 진행한다. Next를 눌러 계속 진행한다. 만약에 다음과 같은 팝업창이 뜨면 Yes를 선택하고 계속 진행한다. Execute를 선택하여 설치를 진행한다. 설치가 잘 진행되었다면, Next를 눌러준다. 계속 진행한다. MySQL Server의 사양을 선택한다. Standalone MySQL Server와 InnoDB Cluster 타입이 있는데, 이 중에서 InnoDB Cluster를 선택하고, Create a New InnoDB Cluster를 선택하여 설치를 진행한다. InnoDB Cluster의 Name, User 등을 설정한다. User-Name, Password는 원하는대로 설정하되, 잊어버리지 않게 잘 기억해두도록 한다. 또한 Host Address도 현재 Local PC를 잡아준다. Configuration Type과 Network를 아래와 같이 설정하고 진행한다. 만약 3306 포트를 사용할 수 없다면 다른 포트로 변경한다. Authentication Method는 MySQL에서 추천하는 것을 선택하고 넘어간다. MySQL Root 계정의 Password를 설정한다. Password를 잊어버리면 곤란해질 수 있으니 잘 기억해두도록 한다. 그리고 Add User를 선택하여 FHIR DB 사용자 계정을 추가한다. FHIR DB 사용자명은 fhirman으로 설정하였다. (원하는 명칭으로 설정해도 무방하다.) Role은 DB Admin 권한을 부여하였다. 역시 비밀번호를 설정하고 잊어버리지 않게 잘 기억해두도록 한다. 다 입력하였다면 Ok를 선택하여 빠져나간다. fhirman이라는 사용자가 추가된 것을 확인할 수 있다. Next를 눌러 계속 진행한다. Server의 명칭을 설정하고 Next로 넘어간다. Default로 MySQL80으로 설정되어 있어서 별도 수정하지 않고 계속 진행하였으나, 명칭은 운영자가 원하는 대로 설정하여도 무방할 듯 하다. 설정을 적용한다. Execute를 선택한다. MySQL Workbench 활용하여 스키마, 계정 설정하기위에서 설명한 절차대로 진행하였다면, MySQL Workbench가 함께 설치되었을 것이다. (만약 설치가 안되었다면, MySQL 홈페이지에서 별도로 설치가 가능하다) MySQL Workbench는 SQL 개발과 관리, 데이터베이스 설계, 생성 그리고 유지를 위한 단일 개발 통합 환경을 제공하는 비주얼 데이터베이스 설계 도구이다. MySQL Workbench에 대한 사용법은 생활코딩 사이트에서 무료로 제공하고 있으니 필요한 경우 참고하면 유용할 듯하다. MySQL Workbench를 실행하면 다음과 같은 화면이 뜬다. 최초로 MySQL Connection을 만들기 위해 + 버튼을 선택한다. Connection의 이름은 임의로 설정하여도 무방하나, Local PC에 설치하는 것이기 때문에 mysql_local로 명명하였다. 포트는 일반적으로 3306가 디폴트로 설정될 것이나, 앞에서 MySQL Server를 설치할 때 포트번호를 변경하였다면 해당 포트번호를 입력한다. User는 관리자 계정인 root로 접속해본다. Password를 입력하고 Test Connection을 클릭하면 연결이 잘 되었는지 실행결과를 볼 수 있다. 연결이 성공적으로 잘 되었다. Ok를 눌러서 Connection을 생성한다. 메인 화면에 Connection이 생성된 것을 볼 수 있다. 선택하여 MySQL Server에 접속한다. MySQL Server에 접속하여, Schema를 둘러본다. 기본적으로 sys와 mysql_innodb_cluster_metadata 스키마가 생성되어있다. Schemas 창 우클릭 &gt; Create Schema를 선택하여 fhir용으로 사용할 스키마를 생성한다. 스키마 명칭은 hapi-r4, Charset을 utf8로 설정하고, Apply를 눌러 진행한다. 자동으로 스키마 생성 SQL 스크립트가 생성된다. 이상이 없다면 Apply를 눌러 계속 진행한다. SQL 실행이 끝났으면 Finish한다. 앞서 MySQL Server 설치 중에 생성하였던 fhirman 계정의 상세 권한을 설정한다. 좌측 Navigator 하단의 [Administration] 탭의 [Users and Privileges]을 선택하면 각 계정의 권한을 관리하는 화면이 열린다. 여러 계정 리스트 중 fhirman을 선택한다. Fhirman 계정의 상세한 권한을 확인할 수 있다. 그 중에서 세번째 탭인 [Administrative Roles]를 눌러 권한이 잘 주어졌는지 확인한다. 현재는 특별히 제한할 권한이 없으므로, 전체 권한을 모두 부여하였다. 네번째 탭 [Schema Privileges]을 눌러 어떤 스키마에 권한을 부여할 것인지도 지정한다. Add Entry를 눌러서 신규로 생성하였던 hapi_r4 스키마 권한을 부여한다. hapi_r4 스키마에 대한 권한을 전체 선택(Select ALL)하고 Apply한다. MySQL 설치와 MySQL Workbench를 활용한 각종 환경세팅은 이것으로 마무리한다. 끝.","link":"/2020/09/11/hapi-fhir-manual-4/"},{"title":"HAPI FHIR 환경 구성하기 (5&#x2F;7편) - hapi-fhir-jpa-server 환경세팅","text":"오픈소스 HAPI FHIR 환경은 다음과 같이 7단계로 구성된다.본 글에서는 5. HAPI FHIR 환경 구성하기 (5/7편) - hapi-fhir-jpa-server 환경세팅에 대해 다룬다. HAPI FHIR 환경 구성하기 (1/7편) - JDK 설치 HAPI FHIR 환경 구성하기 (2/7편) - Eclipse 설치 HAPI FHIR 환경 구성하기 (3/7편) - Tomcat 설치 HAPI FHIR 환경 구성하기 (4/7편) - MySQL 설치 및 스키마/계정 설정 HAPI FHIR 환경 구성하기 (5/7편) - hapi-fhir-jpa-server 환경세팅 HAPI FHIR 환경 구성하기 (6/7편) - hapi-fhir 테스트 페이지 활용 HAPI FHIR 환경 구성하기 (7/7편) - hapi-fhir-client 환경세팅 HAPI란, HL7 Application Programming Interface의 약자로 HL7 FHIR 사양으로 구현한 오픈소스 Java 라이브러리이다. HAPI-FHIR 서버 소스 내려받기 HAPI-FHIR 홈페이지에 접속하여, Documentation 메뉴로 접속한다. 좌측 메뉴에서 [JPA SERVER] &gt; [Get Started] 를 선택하여, 게시되어 있는 Github 소스코드 경로로 접속한다. Github에 접속되었으면, 5.1.0 버전을 선택한다. 소스코드 ZIP 파일을 내려받는다. 앞으로 FHIR와 관련된 소스코드를 보관할 경로를 만들어보자. 프로젝트 폴더(D:/hapi-fhir) 아래에 workspaces라는 폴더를 생성한다. workspaces 폴더(D:/hapi-fhir/workspaces) 아래에 다시 workspace_jpaserver 라는 폴더를 생성한다. 이 폴더는 HAPI FHIR JPA SERVER 소스코드를 보관할 경로이다. workspace_ jpaserver 폴더(D:/hapi-fhir/workspaces/workspace_jpaserver) 아래에 Github에서 내려받은 ZIP파일 압축을 풀어준다. Eclipse에 프로젝트 임포트하기 앞서 설치하였던 Eclipse를 실행한다. \u0010Eclipse를 실행하면, 가장 먼저 Workspace 경로를 지정하는 화면이 뜰 것이다. 그럼 앞서 HAPI FHIR JPA SERVER 소스코드를 저장한 경로 (D:/hapi-fhir/workspaces/workspace_jpaserver)를 지정하고 Launch한다. Eclipse가 실행되었지만, 아직 어떠한 프로젝트도 떠 있지 않은 빈 화면 상태이다. 앞서 내려받았던 HAPI JPA SERVER 프로젝트를 임포트하기 위해, 좌측 Project Explorer에서 Import projects를 한다. HAPI FHIR JPA SERVER는 빌드 도구로 maven을 사용하기 때문에, Existing Maven Projects를 선택하여 진행한다. Root Directory에 HAPI FHIR JPA SERVER 소스코드 경로를 지정해준다. (D:/hapi-fhir/workspaces/workspace_jpaserver/hapi-fhir-jpaserver-starter-master) 그리고, 각종 maven 라이브러리가 정의되어 있는 pom.xml 파일을 선택한 후에 Finish한다. 아래와 같이 HAPI FHIR JPA SERVER 프로젝트가 임포트된 것을 확인할 수 있다. 각종 설정값 변경하기hapi.properties 수정src/main/resources/hapi.properties 파일을 열어 아래와 같이 설정값을 수정한다. 필수 수정사항은 4가지이다. fhir_version을 R4로 설정한다. 1fhir_version = R4 datasource 설정을 h2에서 mysql 내용으로 변경한다. 1234567#datasource 설정을 h2(초기값)에서 MySQL로 변경한다.#datasource.driver=org.h2.Driverdatasource.driver=com.mysql.cj.jdbc.Driver#datasource.url=jdbc:h2:file:./target/database/h2datasource.url=jdbc:mysql://localhost:3306/hapi_r4?characterEncoding=UTF-8&amp;serverTimezone=UTCdatasource.username=fhirmandatasource.password=12345678 &lt;------비밀번호를 입력하기 hibernate 설정을 변경하고, D:₩hapi-fhir₩hibernate₩lucence₩indexes 폴더를 생성한다. (폴더를 생성하지 않으면 에러가 발생할 것이다) 12345678#hibernate.dialect=org.hibernate.dialect.H2Dialecthibernate.dialect=org.hibernate.dialect.MySQL5InnoDBDialecthibernate.search.default.indexBase=D:/hapi-fhir/hibernate/lucence/indexeshibernate.search.lucene_version=LUCENE_CURRENT#jpa-server 기동시 MySQL 스키마를 자동 업데이트하기 위해 아래 설정을 update로 변경한다.hibernate.hbm2ddl.auto=update EMPI 모드로 기동하기 위해 아래와 같이 변경한다. EMPI란 Enterprise Master Patient Index의 약자로, 외부에서 들어오는 환자(또는 의료진)을 감시하여 내부에 존재하는 환자(또는 의료진)과 동일인으로 판단되면 Resource간에 링크를 만드는 기능이다. 12345# Enable Websocket Subscription Channelsubscription.websocket.enabled=true# EMPIempi.enabled=true (선택사항) SQL을 Console 로그에 찍어보고 싶다면, 아래 설정을 true로 변경한다. 초기값은 false일 것이다. 12hibernate.format.sql=truehibernate.show_sql=true pom.xml 수정hapi-fhir-jpaserver-starter-master 프로젝트 가장 상위 경로에 pom.xml이라는 파일이 있을 것이다. 파일을 열어서 아래 내용을 수정한다. H2 데이터베이스 내용이 있다면, 필요없으므로 주석처리한다. 현 프로젝트에서는 MySQL을 사용하므로, MySQL 설정이 필요하다. MySQL 관련된 설정이 있는지 확인하여 만약 없으면 추가한다. 123456789101112131415&lt;!-- H2 데이터베이스 내용을 찾아 아래와 같이 주석처리한다. --&gt;&lt;!-- &lt;dependency&gt; &lt;groupId&gt;com.h2database&lt;/groupId&gt; &lt;artifactId&gt;h2&lt;/artifactId&gt; &lt;/dependency&gt;--&gt;&lt;!-- dependencies 아래에 MySQL 설정이 있는지 확인하고, 없다면 추가한다. --&gt; &lt;dependency&gt; &lt;groupId&gt;mysql&lt;/groupId&gt; &lt;artifactId&gt;mysql-connector-java&lt;/artifactId&gt; &lt;version&gt;8.0.16&lt;/version&gt; &lt;/dependency&gt; empi-rules.json 수정src₩main₩resources₩empi-rules.json 파일을 열어, 버전(“version”: “1”)이 명시되어 있는지 확인하고, 없다면 아래와 같이 추가하도록 한다. (버전이 없으면 에러가 발생한다.) 1234567{ &quot;version&quot;: &quot;1&quot;, &quot;CandidateSearchParams&quot; : [ {..} @Test 찾아서 모두 주석처리src/test/java/ca/uhn/fhir/jpa/starter 폴더 아래 java 클래스에 선언되어 있는 @Test 를 전부 주석처리한다. @Test 코드를 주석처리하는 이유는, 해당 코드들로 인해서 maven-install 시에 오류가 발생하기 때문이다. @Test 코드를 주석처리한 후에는 maven-install 이 정상적으로 실행되었다. (Ctrl+H를 눌러, File Search를 활용하여 @Test 코드를 전부 서치하는 것을 추천한다. 전부 주석처리한다.) 12//아래와 같이 주석처리한다.//@Test HAPI-FHIR 버전에 따라 다를 수 있지만, 가이드 작성자는 아래의 java 파일들에 @Test 코드들이 선언되어 있었으니, 참고한다. ExampleServerDstu2IT.java ExampleServerDstu3IT.java ExampleServerR4IT.java ExampleServerR5IT.java MultitenantServerR4IT.java Maven Update 및 Maven Install 실행 Maven Update를 진행한다. Maven update란, pom.xml에 정의된 각종 maven 라이브러리를 중앙 레포지토리에서 가져오는 (업데이트하는) 기능이다. 실행방법은 [프로젝트 우클릭] &gt; [Maven] &gt; [Update Project..]이다. Force Update of Snapshots/Releases를 선택하여 업데이트를 진행한다. 최초로 Maven Update를 실행하는 경우에는 네트워크 환경에 따라 약 10분 이상 소요될 수 있다. Maven Install을 실행한다. 실행방법은 [프로젝트 우클릭] &gt; [Run As] &gt; [Maven install]이다. Maven Install이 정상적으로 완료되면, 아래와 같이 Console 창에 Build Success가 출력될 것이다. Maven Install이 완료되면, target 폴더 아래에 관련된 소스들이 생성된다. Eclipse 내에 Tomcat Server 세팅 및 실행하기 Eclipse 상단 메뉴에서 [Window] &gt; [Preferences] 를 연다. [Server] &gt; [Runtime Environment]로 들어가서 Server를 Add한다. 앞서 Tomcat 9.0.38 버전을 설치했으니, 싱크를 맞춰 Apache Tomcat v9.0 버전을 선택하고 넘어간다. 앞서 Tomcat을 설치했던 경로와, jdk를 설치했던 경로를 지정하고 Finish한다. Apache Tomcat v9.0가 생성되었다. Apply and Close를 눌러 저장하고 빠져나간다. 앞서 등록한 Tomcat Server를 HAPI FHIR JPA SERVER 프로젝트의 로컬서버로 등록해본다. [Server] 창 아래 No servers are available. Click this link to create a new server 링크를 클릭한다. 아래와 같이 선택되어 있는지 확인한 후에 Next하여 넘어간다. Tomcat 서버가 참조할 모듈(war파일) hapi-fhir-jpaserver-starter-master를 Add한 후에 Finish하여 빠져나간다. Tomcat 로컬서버가 등록되었다. 더블 클릭하여 몇가지 설정을 변경한다. Tomcat v9.0 Server at localhost를 더블클릭하면 설정을 변경할 수 있는 창이 뜬다. 여기서 아래와 같이 3가지를 변경하고 저장한다. Server Options: (1) Push module contexts to separate XML files 와 (2) Modules auto reload by default 두 가지를 체크한다. Timeouts를 늘려준다. (Start 450, Stop 150) Tomcat admin port를 8005로 변경한다. 서버 실행 및 테스트 설정이 끝이 났으므로, 서버를 기동해본다. 서버를 우클릭하여 Start를 누른다. 서버가 에러 없이 잘 기동되는지 Console 창을 살펴본다. 별다른 에러 없이 다음과 같이 Console에 출력되면 서버가 잘 기동된 것이다. 서버가 기동되었으므로, 테스트화면에 접속하여 이상없이 동작하는지를 점검해본다. 브라우저를 열어 테스트화면의 주소를 입력한다. (localhost:8080/hapi-fhir-jpaserver/) 테스트화면의 주소는 hapi.properties 파일 내에도 선언되어 있으니 열어서 확인해보아도 된다. 샘플 테스트를 위해 Patient라는 Resource를 Create 해본다. 실행 방법은 좌측메뉴 [Patient] &gt; [CRUD Operation] &gt; ID 및 Contents 작성 &gt; [Create] 실행 순이다. 샘플로 입력할 Contents 내용은 아래 json 코드를 참고한다. 환자의 이름만 있는 가장 간단한 형태의 Patient Resource이다. 123456{ &quot;resourceType&quot;: &quot;Patient&quot;, &quot;name&quot;: [ { &quot;text&quot;: &quot;Peter James&quot; } ]} 아래와 같이 정상적으로 실행되면, HAPI FHIR JPA SERVER 개발환경이 잘 세팅된 것이다. HAPI FHIR JPA SERVER 환경세팅은 이것으로 마무리한다. 끝.","link":"/2020/09/12/hapi-fhir-manual-5/"},{"title":"HAPI FHIR 환경 구성하기 (6&#x2F;7편) - hapi-fhir 테스트 페이지 활용","text":"오픈소스 HAPI FHIR 환경은 다음과 같이 7단계로 구성된다.본 글에서는 6. HAPI FHIR 환경 구성하기 (6/7편) - hapi-fhir 테스트 페이지 활용에 대해 다룬다. HAPI FHIR 환경 구성하기 (1/7편) - JDK 설치 HAPI FHIR 환경 구성하기 (2/7편) - Eclipse 설치 HAPI FHIR 환경 구성하기 (3/7편) - Tomcat 설치 HAPI FHIR 환경 구성하기 (4/7편) - MySQL 설치 및 스키마/계정 설정 HAPI FHIR 환경 구성하기 (5/7편) - hapi-fhir-jpa-server 환경세팅 HAPI FHIR 환경 구성하기 (6/7편) - hapi-fhir 테스트 페이지 활용 HAPI FHIR 환경 구성하기 (7/7편) - hapi-fhir-client 환경세팅 HAPI FHIR JPA SERVER를 정상적으로 기동하면, HAPI FHIR 테스트 페이지에 접속할 수 있다. 브라우저를 실행하여 다음 링크에 접속한다. (http://localhost:8080/hapi-fhir-jpaserver/) 최초 실행 페이지는 다음과 같다. 좌측 메뉴 구성은 다음과 같다.(1) Option은 서버 옵션을 설정하는 버튼들이 모여있다.(2) Server는 Home으로 이동하는 버튼이다.(3) Resources는 특정한 Resources를 CRUD하는 페이지로 이동하는 링크이다. 특정 Resource를 선택하면, 다음과 같은 화면이 나타난다. Patient Resource를 예시로 선택하였다. 먼저, Search 탭을 살펴보자. 각종 Parameter, Sorting 방식을 설정하고 조회를 실행할 수 있다.(1) 조회를 실행하는 버튼이다.(2) 조회에 사용할 Parameter를 설정할 수 있다. Resource의 각종 Element들을 Parameter로 선택할 수 있도록 콤보박스가 나타난다. 미선택시 전부 조회된다.(3) 조회 정보에 추가로 포함할 것들을 선택할 수 있다.(4) 정렬 방식을 선택할 수 있다.(5) 그외 Limit(검색 최대 개수) 등을 선택할 수 있다. 다음으로 CRUD 탭을 살펴보자.(1) Read 실행버튼이다. 우측에 ID를 필수로 입력해야 한다.(2) History 조회버튼이다. Resource CRUD가 발생한 이력을 조회할 수 있다.(3) Delete 실행버튼이다. 우측에 ID를 필수로 입력해야 한다.(4) Create 실행버튼이다. 우측에 Contents(JSON전문)을 필수로 입력해야 한다. ID는 선택사항이다.(5) Update 실행버튼이다. 우측에 ID와 Contents를 필수 입력해야 한다.(6) Validate는 Contents가 올바른 포멧인지 점검할 수 있는 기능이다. 이것으로 테스트 페이지 활용에 대해 마친다. 끝.","link":"/2020/09/13/hapi-fhir-manual-6/"},{"title":"착수보고 준비 (2&#x2F;2) - 착수보고 행사 준비 및 진행","text":"착수보고의 굵직한 3가지 업무 중 2. 착수보고 행사 준비 및 진행에 대해 기록을 남기려 한다. 1. 착수보고서 작성과 관련해서는 이전 글을 참고하기 바란다. 필자는 착수보고 행사를 체크리스트 형태로 만들어서 누락이 발생하지 않도록 계획하고, 당일까지 체크리스트를 관리하였다. 개요 보고의 목적을 파악했는가? Ex. 프로젝트의 시작을 알리고, 그 동안의 진행경과를 보고하는 것이다. 참석 대상과 인원을 파악했는가? (이를 토대로 회의장소 및 식사장소, 예산 등을 잡아야 하니 중요함) Ex. 발주처 스폰서 3명, A~Z팀 팀장급 이상 15명, 담당자 16명, 수행사 15명, 수행사 스폰서 5명, 협력사 스폰서 5명) 행사 일시는 언제인가? Ex. 2020년 08월 01일 10:00 ~ 11:00 행사 장소는 어디인가? Ex. A동 10층 컨퍼런스홀 행사의 진행자는 누구인가? Ex. 발주처 PM (보통은 발주처의 PM이 맡는 경우가 많으니, 발주처 PM에게 사전에 요청하는 것이 좋음) 행사 식순은? Ex.(1) 사업단장 인사말(2) 수행사 임원 인사말(3) 착수보고 (수행사 PM)(4) Q&amp;A(5) 각 영역별 담당자 소개 및 다과회(6) 종료 보고 관련 목차를 확정하였는가? 각 업무영역에서 작성해주어야 하는 내용이 있는가? 그렇다면 요청하였는가? 보고서 작성이 완료되었는가? 보고서를 수행사 본사에 사전 보고하고 검토받았는가? 보고서를 발주처에 검토받았는가? 식사/다과 관련 가용 예산은 얼마인가? (PM 통해 확인) 식사/회식/다과 중 어떤 형태로 진행할 것인지? Ex. 코로나로 인해 다과회만 진행하고, 스폰서들만 점심식사 진행 다과 또는 식사/회식 예약 후보지 물색 Ex. A 제과점, B 제과점Ex. A 중식당, B 한식당 예약 진행 (필요하다면 메뉴까지 예약) 공지 참석자 전체 명단을 확보했는가? 행사 장소 약도를 확보했는가? 주차 가능 공간을 확인했는가? 참석자 전원에게 참석요청 공지 발송 (행사장 약도와 보고자료, 주차가능공간 등 별도 첨부) 행사환경 사전점검 홀/회의실 좌석수는 넉넉한가? 빔프로젝터/마이크는 문제 없는가? 장소가 깨끗한가? (가능하다면) 보고 리허설을 1회 이상 진행하였는가? 당일 발표용 프리젠터를 준비하였는가? 행사 안내표지를 부착하였는가? (행사장 입구에 부착) 보고자료를 행사장 PC로 내려받았는가? 행사장 입구에 다과를 세팅하였는가? 손소독제를 비치하였는가? (코로나로 인해) 행사장 입구에 보고자료 (하드카피)를 세팅하였는가? 쓰레기통을 준비하였는가? 끝.","link":"/2020/08/02/kickoff-prepare/"},{"title":"착수보고 준비 (1&#x2F;2) - 착수보고서 작성","text":"SI 프로젝트에서 착수보고란, 프로젝트의 시작을 알리는 행사다. 보통 프로젝트 투입 후 첫째 주 또는 둘째 주에 진행하고, 프로젝트와 직간접적으로 유관된 부서의 참여자들을 모두 초청한다. 특히 프로젝트의 각종 스폰서(임원들)가 참여하므로 결코 가볍지 않은 행사라고 볼 수 있다. 이 글을 작성하는 이유는, 착수보고라는 것은 어떤 형태로 진행되고, 어떻게 준비해야 하는지 차후 프로젝트를 진행하더라도 혼란이 없도록 기록을 남겨두기 위함이다. 필자는 착수보고라는 것을 처음으로 맞딱뜨린 입장에서 보고서는 어떻게 작성해야 하는지, 보고회는 어떻게 준비해야 하는지 전혀 경험이나 지식이 없었기 때문에 많은 시행착오를 겪을 수밖에 없었다. 부족함이 많았지만 지금 정리해두는 내용을 토대로 다음 번 프로젝트때는 좀더 전문가답게 업무를 진행할 수 있었으면 하는 바람이다. 필자가 생각하기에 착수보고는 크게 3가지의 굵직한 업무로 나뉜다. 착수보고서 작성 착수보고 행사 준비 및 진행 착수보고 발표 여기서, 필자는 1번과 2번의 업무를 담당하였고, 3번은 프로젝트 PM께서 직접 진행하였다. 그래서 필자가 소관하였던 1번과 2번에 대해서만 기록을 남기고, 이번 글에서는 그 중에 1. 착수보고서 작성에 대해서 적어보려 한다. 착수보고서를 작성하기에 앞서먼저, 가장 실수하기 쉬운 부분은, 보고서이기 때문에 뭔가 거창해야 할 것 같지만 착수보고는 정말 심플하고 간단하고 짧아야 한다. 착수보고는 “우리가 이러한 재미있는 프로젝트를 진행하려고 합니다. 여기 계신 여러분들께서 많은 도움이 필요합니다”라는 메시지만 전달이 되면 끝이다. 대체 얼마나 심플해야 하냐고? 필자는 착수보고를 다음과 같이 구성하였다. 무엇을 1.1 사업 개요 1.2 사업 목적 1.3 목표 시스템 어떻게 2.1 추진 방향성 2.2 전체 일정 2.3 조직도 앞으로 3.1 향후 일정 3.2 지원 요청 3.3 우리의 다짐 장표는 각각 1장 씩 총 9장으로 구성되었다. (표지와 마지막 QnA 페이지를 포함하면 11장) 발표로 했을때는 각 장당 약 1분 30초가 소요되니 약 13~15분 정도이다. 사실 작성자의 역량에 따라 더 심플하게 구성할 수 있다면 더 심플하게 가도 된다. (필자가 참고했던 타 샘플 착수보고서는 7장이었다..) 그럼 각각의 장표에는 어떤 내용이 담겨야 하는지에 대해 구체적으로 살펴보자. 무엇을프로젝트의 각종 유관 부서 참여자들을 전부 초대했지만, 안타깝게도 그들은 이 프로젝트에 대해 아직 잘 모른다. 그들에게 차근차근 이 프로젝트가 무엇인지를 설명해주어야 한다. 중요한 것은 쉽게 설명해야 한다는 것이다. 보고서도 물론 아주 쉬워야 한다. 복잡한 내용은 최소화하도록 한다. IT 담당자가 아닌 임원이나 현업 담당자들도 다수 포함되어 있기 때문이다. 먼저 이 사업의 전반적인 개요를 설명하고, 왜 이런 사업이 탄생하였는지 사업의 목적과, 어떤 시스템을 만들 것인지에 대한 밑그림인 목표시스템을 설명한다. 사업 개요사업의 개요에는 5가지의 내용이 담기면 된다. “프로젝트명”이 무엇인지, “수행사”가 어느 회사인지, “참여 인원”들은 몇명인지, “사업 기간”은 언제부터 언제까지인지, “프로젝트룸”은 어디에 위치하였는지. 사업 목적사업의 목적에는 이 프로젝트를 추진하게된 “배경”(고객이 간지러워하는 부분)을 담고, 어떤 방향으로 이를 개선할 것인지 “목적”을 담아내면 된다. 목표 시스템목표 시스템에는 제안서에 담길법한 거창한 인프라 아키텍처를 담는 것은 아니다. 눈높이를 현업 담당자에게 맞춰서, 프로젝트가 끝나면 어떤 시스템들이 구성이 되겠구나 한눈에 들어올 수 있게 그려내면 된다. 어떻게앞에서 무엇을 하겠다는 것을 제시하였으니, 어떻게 그것을 달성해낼 것인지 이야기를 풀어나가면 자연스러울 것이다. 필자의 경우에는 크게 전략과 일정, 조직으로 콘텐츠를 구성하였다. 추진 전략추진 전략 (또는 추진 방향성)에는 프로젝트팀에서 어떤 방향으로 프로젝트를 이끌어나갈 것인지 전략과 실행방안을 간략히 담아내면 된다. 다만 그 전략은 반드시 프로젝트를 성공하기 위한 현실적이면서도 핵심적인 요소여야 한다. 예상컨데 추진전략은 이미 제안서나 제안PT에도 작성을 하였을 것이다. 당부하고 싶은 것은, 제안서와 제안PT를 작성하는 단계에서는 발주처의 상황을 잘 모르고 작성하였기 때문에 뜬구름 잡는 이야기가 많았을 것이다. 그렇기에 착수보고에서는 철저히 발주처의 상황을 고려하여 현실적인 전략이 도출되어야만 한다. 전체 일정프로젝트의 시작부터 끝까지 전체적인 일정을 담아내면 된다. 다만 너무 상세한 일정까지 표현하면 눈에 들어오지 않으므로, 주요한 마일스톤만 잘 찍어주면 된다. 보는 사람 입장에서 “아 ~ 5월부터 개발 시작이구나, 8월부터는 테스트 시작이네? 12월에 오픈하는구나” 이 정도 주요 이정표들만 눈에 들어오면 되겠다. 조직도조직도는, 트리 구조로 프로젝트의 사업단장부터 각 파트별 전문가들까지 가급적이면 모든 사람들이 직책과 실명 위주로 표현되는 것이 좋다. (다만 플젝 인원이 수백명이라 그러면 다 담지는 힘들겠다.. 그땐 다른 방법을 강구해보길) 필자가 수행한 프로젝트의 경우 전체 유관자가 약 40~50명 정도여서 장표 1장에 전부 표현이 가능했다. 가능하다면 발주처 직원과 수행사 직원을 색깔 등으로 구분하여 누가 내 카운터 파트너인지를 확실히 알 수 있으면 더 좋겠다. 앞으로무엇을 어떻게 하겠다는 그림을 앞에서 그려주었으니, 이제는 마무리를 할 단계이다. 이제는 수행사 입장에서 조금의 속내를 드러낼 시간이다. 앞으로는 정말 바쁘게 일을 시작해야 하니 발주처 직원들의 많은 참여를 이끌어내야 한다. 향후 일정당장 내일부터, 또는 당장 다음주부터는 어떤 일들이 벌어질지 이야기가 진행될 수 있도록 장표를 구성한다. 목적은 발주처 현업들의 적극적인 참여를 요청하고 약간의 긴장감(?)을 조성하기 위함이다. 지원 요청비록 첫째 주, 또는 둘째 주밖에 안되었지만, 프로젝트를 막상 시작하려고 하니 많은 어려움이나 제약사항들이 있을 것이다. 프로젝트 스폰서들께 도움을 요청할 것이 있다면 이 시간을 통해 운을 띄워보는 것도 좋은 방법이다. 다만 어디까지나 프로젝트의 시작을 알리는 행사이니 너무 심각한 내용을 담지는 말고, 운을 띄우는 정도로 활용하는 것이 좋다. 혹은 이 프로젝트 성공을 위해 핵심적으로 해결해야 하는 예상 위험요소들을 간략히 담는 것도 좋겠다. 우리의 다짐여느 발표와 마찬가지로 마지막으로 하고 싶은 한마디이다. 열심히 하겠다는 내용도 좋고, 프로젝트팀의 모토나 캐치프레이즈가 있다면 그것을 담아도 괜찮을 것이다. 만약 초반에 발표를 무겁게 시작했다면, 마지막에 분위기를 풀어줄 수 있도록 재치있게 마무리하는 것도 좋겠다. 반대로 초반에 발표를 조금 재치있게 시작했다면 마지막에는 좀더 진중한 멘트로 마무리해도 좋을 것이다. 이 부분은 철저히 보고서 작성자와 PM의 역량에 달려있는 부분이니 설명을 줄이도록 하겠다. 끝.","link":"/2020/08/01/kickoff-report/"},{"title":"HAPI FHIR 환경 구성하기 (7&#x2F;7편) - hapi-fhir-client 환경세팅","text":"오픈소스 HAPI FHIR 환경은 다음과 같이 7단계로 구성된다.본 글에서는 7. HAPI FHIR 환경 구성하기 (7/7편) - hapi-fhir-client 환경세팅에 대해 다룬다. HAPI FHIR 환경 구성하기 (1/7편) - JDK 설치 HAPI FHIR 환경 구성하기 (2/7편) - Eclipse 설치 HAPI FHIR 환경 구성하기 (3/7편) - Tomcat 설치 HAPI FHIR 환경 구성하기 (4/7편) - MySQL 설치 및 스키마/계정 설정 HAPI FHIR 환경 구성하기 (5/7편) - hapi-fhir-jpa-server 환경세팅 HAPI FHIR 환경 구성하기 (6/7편) - hapi-fhir 테스트 페이지 활용 HAPI FHIR 환경 구성하기 (7/7편) - hapi-fhir-client 환경세팅 HAPI FHIR Client는 HAPI FHIR JPA SERVER에 연결할 수 있는 클라이언트이다. 설치 방법 HAPI FHIR Document에서 [CLIENT] &gt; [Get Started] 페이지에 접속한 뒤, hapi-fhirstarters-client-skeleton 링크를 클릭하여 Github 페이지로 이동한다. Github에 접속하여 fhirstarters라는 상위 레포지토리로 이동한다. Fhirstarters ZIP 파일을 다운로드한다. Client 소스코드를 저장할 Workspace를 생성한다. D:₩hapi-fhir₩workspaces 경로에 workspace_client라는 폴더를 생성한다. workspace_client 폴더에, 앞서 Github에서 내려받은 ZIP파일을 압축 해제한다. Eclipse를 실행한다. workspace_client를 디렉토리로 설정한 후 Eclipse를 기동한다. 아래와 같이 빈 화면이 실행될 것이다. 먼저 Project를 추가한다. 좌측 [Project Explorer] &gt; [Import project] 를 선택한다. [Maven] &gt; [Existing Maven Projects]를 선택한다. Root Directory를 D:₩hapi-fhir₩workspaces₩workspace_client₩fhirstarter-master₩java₩happy-fhirstarters-client-skeleton로 설정한 후 Finish한다. 다음과 같이 hapi-fhirstarters-client-skeleton 프로젝트가 추가된 것을 확인할 수 있다. 프로젝트를 우클릭하여 [Maven] &gt; [Update Project…]를 선택한다. Force Update of Snapshots/Releases를 선택한 후 Ok하여 Update를 진행한다. TestApplication의 main 함수에, 실행시킬 소스코드를 작성하고 TestApplication을 Run하면 실행결과를 Console을 통해 확인할 수가 있다. TestApplication의 소스코드 예제는 아래에서 확인 가능하다. 소스코드 예제 (작업중)Read 예제1 Create 예제1 Update 예제1 Delete 예제1 끝.","link":"/2020/09/14/hapi-fhir-manual-7/"},{"title":"모바일 디바이스 선정 가이드","text":"현 프로젝트에서 발주처의 모바일 표준체계를 구축하고 있는데, 다양한 표준들 중에서 모바일 디바이스를 어떻게 선정하면 좋을지 가이드하는 업무가 있어서 정리해보려고 한다. 모바일 디바이스 선정 가이드는, 모바일 앱 개발을 위한 사전준비 단계나 분석설계 단계에서 앱을 지원하는 특정 디바이스 또는 디바이스 지원범위를 적절하게 선정할 수 있도록 하는 것을 목적으로 한다. 즉 모바일 프로세스 전반 중에 모바일 디바이스 선정 가이드를 활용할 수 있는 단계는 다음과 같다. (1) 사전준비 &lt;&lt;&lt;(2) 제안요청(3) 분석설계 &lt;&lt;&lt;(4) 개발(5) 테스트(6) 검수(7) 운영(8) 폐기 업무 담당자가 모바일의 디바이스 종류, 운영체제, 해상도 등의 특징을 이해하고 검토할 수 있도록 가이드는 다음과 같이 구성하였다. 디바이스 선정방안1.1 사용자 환경 고려1.2 정보조회량 고려1.3 가용 사용시간 고려 OS 선정방안2.1 OS 점유율2.2 Android 버전2.3 iOS 버전 해상도 선정방안3.1 Android 해상도3.2 iOS 해상도 별첨. 삼성전자 최근 3년 디바이스 리스트별첨. 애플 최근 3년 디바이스 리스트별첨. 엘지 최근 3년 디바이스 리스트별첨. PDA 제품 선정 방안별첨. PDA 제품 사양 검토 예시 디바이스 선정방안소유 주체에 따른 지원범위크게 보면 구축하고자 하는 앱이 B2B 서비스인지, B2C 서비스인지에 따라 디바이스를 선정하는 방\u001e법은 달라진다. 디바이스가 회사의 자산인 경우(여기서는 B2B라고 하겠다)에 태블릿이나 스마트폰, PDA 중에 특정 디바이스가 서비스 대상이 될 수 있다. B2B가 아니라 불특정 다수의 개인들에게 서비스하는 경우(여기서는 B2C라고 하겠다)에는 불특정한 태블릿과 스마트폰들이 서비스 대상이 될 것이다. 운영체제에 따른 지원범위 B2B 서비스의 경우 특정 디바이스가 선정되면, 해당 디바이스의 운영체제 하에서만 구동되므로 어떤 운영체제에서 지원할 것인지 선정하는 문제는 바로 해결된다. B2C 서비스의 경우는 불특정 다수에게 서비스하기 때문에 기본적으로 Multi-OS 지원이 필요하다. 출시일에 따른 지원범위 일반적으로 B2B의 경우 최근 3년 이내에 출시된 장비를 도입하므로, 검토대상이 최근 3년 내 디바이스로 범위가 좁혀진다. 단, B2C의 경우에는 디바이스 교체주기를 고려하여 지원 디바이스 범위를 선정하여야 한다. 안드로이드의 경우에는 교체주기가 평균 3년, iOS의 경우에는 교체주기가 평균 4년인 것을 감안하여 발주처의 상황에 맞게 적정 범위를 선정하는게 좋겠다. 예를 들어 젊은 층이 사용하는 트렌디한 서비스라면 지원범위가 타이트해도 될 것이고, 많은 연령층이 사용하는 서비스라면 지원범위가 좀더 폭넓어야 할 것이다. 가이드 샘플 디바이스들어가기에 앞서, 샘플 디바이스는 삼성전자의 최근 5개의 기종으로 정하였다. 삼성을 기준으로 잡은 이유는 작년말(2019말) 기준으로 세계 스마트폰 출하량 1위, 태블릿 2위에 오른 대표 브랜드이기 때문이다. 다만, 타 제조사 제품(애플, LG 등)을 도입하려고 해도 동일하게 방법론을 적용할 수 있다. 갤럭시탭 S7+ (태블릿)갤럭시탭 S7 (태블릿)갤럭시탭 A (태블릿)갤럭시 노트20 (스마트폰)갤럭시 S20 (스마트폰) 구분 제품명 제품크기 (mm) 화면크기 (inch) 해상도 (pixel) 무게 (g) 사용시간 (시간) 출시일 태블릿 갤럭시탭 S7+ 285 x 185 12.4 2800 x 1752 575 8 2020-09 태블릿 갤럭시탭 S7 253.8 x 165.3 11 2560 x 1600 498 15 2020-09 태블릿 갤럭시탭 A 210 x 124.4 8 1280 x 800 345 - 2019-10 스마트폰 갤럭시 노트20 161.6 x 75.2 6.6 2400 x 1080 192 16 2020-08 스마트폰 갤럭시 S20 151.7 x 69.1 6.2 3200 x 1440 163 17 2020-03 검토 항목검토 항목은 3가지로, (1) 사용자 환경, (2) 정보조회량, (3) 가용 사용시간이 있다. 사용자 환경 고려 업무활동 반경 또는 이동 반경에 따라 디바이스를 선정한다. 구분 업무활동 반경 / 이동거리가 넓은 경우 업무활동 반경 / 이동거리가 좁은 경우 적정 디바이스 갤럭시 S20, 갤럭시 노트20 갤럭시탭 S7+, 갤럭시탭 S7, 갤럭시탭 A 정보조회량 고려 조회/입력되는 정보량 및 입력 업무 수반 여부, 입력빈도에 따라 디바이스를 선정한다. 구분 정보조회량/입력량/빈도가 많은 경우 정보조회량/입력량/빈도가 적은 경우 적정 디바이스 갤럭시탭 S7+, 갤럭시탭 S7, 갤럭시탭 A 갤럭시 S20, 갤럭시 노트20 가용 사용시간 고려 완충 후 업무 사용시간 및 업무 중 충전 가능여부에 따라 디바이스를 선정한다. 구분 지속 사용시간이 긴 경우 지속 사용시간이 짧은 경우 적정 디바이스 갤럭시탭 S7, 갤럭시 노트20, 갤럭시 S20 갤럭시탭 S7+, 갤럭시탭 A 구분 충전이 가능한 경우 충전이 불가한 경우 적정 디바이스 갤럭시탭 S7+, 갤럭시탭 A 갤럭시탭 S7, 갤럭시 노트20, 갤럭시 S20 OS 선정방안국내 PC 시장의 OS는 사실상 MS Window가 장악하고 있는 것과 대비하여, 모바일에서는 어떤 디바이스를 선택하는가에 따라 OS가 달라질 수 있다. 더군다나 OS에 따라 사용자의 UI/UX부터 개발하는 방식까지 모든게 달라지기 때문에, 사전에 반드시 검토할 필요가 있다. OS 점유율StatCounter에 따르면, 현재 (2020년 9월) 기준으로 세계 시장에서 모바일 OS의 점유율은 다음과 같다.참고: Mobile Operating System Market Share Worldwide | StatCounter Global Stats Android 74.25% iOS 25.15% 그 외 OS 0.6% 즉, Android와 iOS를 지원하게 되면 전체 사용자의 99.6%를 수용할 수 있게 된다. 따라서 국내의 대부분 모바일 서비스들은 Android와 iOS를 지원 대상으로 하고 있다. Android 버전 선정Android 공식 사이트에 따르면, 각각의 버전에 따른 점유율은 다음과 같다. (2020년 08월 22일 기준)출처: 안드로이드 공식 사이트 - 안드로이드 버전별 점유율 Version CodeName Distribution (%) Release Date 9.x Pie 10.4 2018-08-06 8.0.x ~ 8.1.x Oreo 28.4 2017-08-22 7.0.x ~ 7.1.x Nougat 19.2 2016-08-23 6.x Marshmallow 16.9 2015-10-15 5.0.x ~ 5.1.x Lollipop 14.5 2014-10-16 4.4.x Kitkat 6.9 2013-10-31 4.1.x ~ 4.3.x Jelly Bean 3.2 2012-07-09 4.0.x Ice Cream Sandwich 0.3 2011-10-19 2.3.x Gingerbread 0.3 2010-12-06 안드로이드의 지원범위는 전체의 80% 이상을 수용할 수 있도록, Lollipop 이상을 지원한다. iOS 버전 선정Apple 공식 사이트에 따르면, 각각의 버전에 따른 점유율은 다음과 같다. (2020년 08월 22일 기준)출처: App Store - 지원 - Apple Developer - iOS 버전별 점유율 지난 4년간 도입된 아이폰의 OS버전 점유율 Version Distribution (%) Release Date iOS13 92 2019-09-20 iOS12 7 2018-12-18 이하 버전 2 - 전체 아이폰의 OS버전 점유율 Version Distribution (%) Release Date iOS13 81 2019-09-20 iOS12 13 2018-12-18 이하 버전 6 - 아이폰의 지원범위는 전체의 80% 이상을 수용할 수 있도록, iOS 12 이상을 지원한다. 지난 4년간 도입된 아이패드의 OS버전 점유율 Version Distribution (%) Release Date iPadOS 93 2019-06-03 iOS 12 5 2018-12-18 이하 버전 1 - 전체 아이패드의 OS버전 점유율 Version Distribution (%) Release Date iPadOS 73 2019-06-03 iOS 12 16 2018-12-18 이하 버전 11 - 아이패드의 지원범위는 전체의 80% 이상을 수용할 수 있도록, iOS 12와 iPad OS를 지원한다. 해상도 선정방안해상도는 선정된 표준 디바이스를 기준으로, 아래 해상도 테이블을 참고하여 전체의 80% 이상을 지원할 수 있는 범위를 고려하여야 한다. Android 해상도Android의 화면크기에 따른 해상도 점유율을 정리한 자료이다.출처: 안드로이드 공식 사이트 - 안드로이드 버전별 점유율 ldpi mdpi tvdpi hdpi xhdpi xxhdpi Total Small 0.1% 0.1% Normal 0.4% 0.3% 17.0% 41.1% 25.9% Large 1.8% 2.0% 0.7% 2.6% 2.1% Xlarge 3.5% 1.9% 0.5% Total 0.1% 5.7% 2.3% 19.6% 44.3% 28.0% iOS 해상도iPhone 4S ~ iPhone 8 Plus의 해상도 / 연관 디바이스 / 화면크기 / 출시일을 정리한 자료이다.출처: iOS Quick Reference for iPhone, iPad, and Apple Watch iPhone 4S iPhone 5S iPhone 8 iPhone 8 Plus Resolution 640 x 960 640 x 1136 750 x 1334 1242 x 2208 Associated Devices iPhone4 iPhone5, iPhone5c, iPhoneSE iPhone6, iPhone6S, iPhone7, iPhoneSE2 iPhone6Plus, iPhone6SPlus, iPhone7Plus Size (inch) 3.5 4 4.7 5.5 Release 2011-10 2013-09 2017-09 2017-09 iPhone XS Max iPhone 11 iPhone 11 Pro iPhone 11 Pro Max Resolution 1125 x 2436 828 x 1792 1125 x 2436 1242 x 2688 Associated Devices - iPhoneXR iPhoneX, iPhoneXS - Screen Size 6.5 6.1 5.8 6.5 Release 2018-09 2019-09 2019-09 2019-09 참고한 사이트 국내 OS 별, 디바이스별 점유율 :: 꾸준함의 위대함 안드로이드 / android 해상도에 대한 이해 아이폰 전체 해상도 정리 모바일 디바이스별 해상도 및 상세스펙 확인방법 - IT 기획 연구소 모바일 디자인 가이드 – Tarot’s Design &amp; Frontend Dev. 끝.","link":"/2020/09/08/mobile-device-guide/"},{"title":"제안서 작성 및 제출 단계 - 준비 (1&#x2F;4)","text":"제안서 작성 및 제출 단계는 총 4가지 [준비] - [작성] - [검수] - [제출]로 구성된다. 준비 (1/4) 작성 (2/4) (작성중) 검수 (3/4) 제출 (4/4) 본 글에서는 그 중에서 [준비] 단계에 대해 다루겠다. 준비 단계는 다음과 같이 상세 6가지 단계로 정리된다. 킥오프 (제안팀 구성, 협력구도 선정) 제안요청서(RFP) 분석 최근 제안서 / 유사 제안서 수급 제안 템플릿 제작 의뢰 (to 디자이너) 제안 스토리보드 및 WBS 작성 + 제안전략 도출 제안서 작성의 R&amp;R 정리 단계에 대한 구분은 필자의 판단으로 임의로 나눈 것이며, 업계의 표준은 아닐 수 있다.아래는 각각의 상세 단계에는 어떤 일들이 일어나는지, 어떤 것들을 주의해야 하는지 등 필자의 노하우에 대한 기록이다. 킥오프 (제안팀 구성, 협력구도 선정)제안서 작성업무는 제안팀 킥오프를 통해 시작된다. 킥오프는 PM을 통해 주최되고, 사업에 대한 개요와 협력구도, 일정, 제안팀구성 등에 대한 제안 계획을 설명하는 자리이다. 고객사로부터 RFP가 나온 경우에는 RFP도 공유받게 될 것이다. 즉, 이 자리를 통해 “어떤 사업이구나”, “내가 어떤 사람들과 일하겠구나”, “제안서는 언제 제출이구나” 등등의 정보를 얻을 수 있을 것이다. 최강입찰제안서:쉬플리코리아에 따르면, 제안팀은 남은 인력이 아니라, 필요한 인력으로 구성하라고 제언한다. 제안서는 무에서 유를 창조하는 작업이기 때문에, 제안멤버가 누구냐에 따라 제안서의 퀄리티가 크게 좌우되는 일이라고 볼 수 있다. 또한, 완벽한 제안서를 작성하기 위해서는 그레이 영역을 줄여줄 수 있는 전문가가 필요하다. 전략가, 프로젝트관리전문가, TA, SA, DBA, 개발자, 솔루션전문가 등 이 사업을 제안하는데 있어서 필요한 자원을 활용할 수 있어야 한다. 필자가 생각하기에, 킥오프가 중요한 이유는 제안팀의 분위기가 결정되는 행사이기 때문이다. 필자의 경험에 의하면, 제안서를 작성하는 업무를 선천적으로 좋아하는 사람은 거의 없다. 몇주간 매우 빡센 하루하루를 보낼 것이 자명하기 때문에, 본인이 제안팀에 소속되었다는 것을 오히려 꺼릴 가능성이 높다. 그렇기 때문에 킥오프의 핵심은, PM 입장에서 제안팀을 똘똘 뭉치게 할 수 있도록 리더십을 발휘하는 것이다. PM마저 대충대충, 회사가 시켜서 하는 것처럼 보여지면 그 제안은 이미 반쯤 실패했다고 봐도 된다. 이 제안이 어떤 의미가 있는지에 대해 설명하고 제안팀원들에게 명확한 비전을 제시해주는 것이 좋겠다. 제안요청서(RFP) 분석RFP란, Request for Proposal의 약자로, 흔히 제안요청서라고 부른다. 해외에서는 Bidding Document라고 하기도 한다. 제안요청서도 소규모의 프로젝트의 경우 적게는 30~40 페이지에서, 대규모 프로젝트의 경우 많게는 1,000페이지 이상이 되는 방대한 분량의 문서이다. RFP에는 고객의 요청사항의 모든 것이 담겨있다. 제안팀은 보통 RFP를 개별로 1부씩 출력해서 몇회독을 실시할 만큼, RFP의 문구 하나하나 놓치지 않기 위해 노력한다. (제안이 끝날 때쯤이면 어느 문구가 어느 페이지에 있는지 생각날 정도..) 제출마감일을 기반으로 제안팀 마일스톤 도출 평가항목을 기반으로 예상 획득점수 도출 및 경쟁사 대비 수주확도 판단 RFP의 목차를 기반으로 제안서 목차 개발 RFP 전체 요구사항 항목에 1:1 매칭되는 체크리스트(조견표) 작성 RFP에 지속적으로 등장하는 주요 용어들에 대한 표준용어집 작성 제안팀 마일스톤 도출첫째, 가장 우선적으로 파악해야 할 것은, 당연하지만 제출마감일이다. 이를 기반으로 현실적인 제안팀 스케줄을 계획해야 한다. 그러나 안타깝게도 제출마감일을 넉넉하게 주는 친절한 발주처는 거의 없다. 대부분은 2주~3주 안에 제출하는 일정을 제시할 것이다. 그렇기 때문에 제출마감일을 기준으로 날짜를 역산하여 어떻게든 완성된 제안서를 만들어낼 수 있도록 스케줄을 짜야만 한다. 예상 획득점수 파악 및 수주확도 판단둘째, RFP에서 가장 중요한 내용을 꼽으라면, 단연코 평가항목이다. 우리 회사의 당락을 결정하는 부분이기 때문이다. RFP를 받으면 평가항목을 표로 나열하고, 우리 회사가 각 항목에 대해 몇점을 받을 수 있을지를 최대한 빨리 도출해내야 한다. 그리고 높은 점수를 얻지 못하는 부분들을 어떻게 만회할 것인지 전략을 세워야 한다. 여기서 ‘최대한 빨리’라는 의미는 경쟁사보다 한발 앞서 움직여야 한다는 의미이다. Ex1) 해당 분야에서 10년 이상 경력의 기술자/엔지니어를 최소 5명 투입해야 한다는 평가항목이 있다면, 만약 사내에 그런 엔지니어가 없다면 경쟁사보다 빠르게 시장에 있는 기술자/엔지니어를 확보해야만 한다.Ex2) 제안사가 해당 분야에서 최근 10년 내에 50억 이상 프로젝트 수주 이력이 10건 이상 있어야 한다는 평가항목이 있는데, 만약에라도 우리회사는 이력이 부족하다면 경쟁사보다 빠르게 컨소시엄사를 물색해야 한다. 제안서 목차 개발셋째, 제안서의 뼈대를 잡는 목차 작업이 필요하다. 국내 제안서는 일반적으로 다음과 같은 대목차를 잡는다. 1장. 사업 개요 2장. 제안사 소개 3장. 제안 내용 4장. 프로젝트 관리 5장. 추가제안 소목차는 사업 특성에 따라 크게 달라지므로 구체적으로 설명하기는 어렵지만, RFP의 흐름을 그대로 따라가는 것이 가장 좋다. 그 이유는, 평가자는 RFP와 제안서를 양쪽에 놓고 비교하면서 평가를 진행할 것이기 때문이다. 두 문서의 흐름이 동일하게 맞춰져있다면 평가하기 한결 수월할 것이 분명하다. 예를 들어, RFP에 다음과 같은 내용이 적혀 있다고 가정해보자. 프로젝트 관리방안에 품질관리, 위험관리, 자원관리, 원가관리, 일정관리, 형상관리를 제시하시오. 그럼 4장. 프로젝트 관리에 다음과 같이 구성하는 것이 좋겠다. 4.1 품질관리4.2 위험관리4.3 자원관리4.4 원가관리4.5 일정관리4.6 형상관리… 등 요구사항 체크리스트(조견표) 작성넷째, 요구사항 체크리스트란 조견표라고 불리는 문서이다. RFP에 명시된 모든 요구사항에 대해 제안서의 어느 목차/페이지에 작성되어 있는지를 1:1로 매칭하여 아래의 예시 형태로 작성하는 것이다. (작성하고 나면 조견표만 수십 페이지가 만들어진다.) RFP 요구사항 중요도 제안서 목차 페이지 만족여부 AA 시스템 구축 Critical IV-1.1 시스템 구축 52 만족 BB 인프라 구성 Critical IV-5.2 인프라 구성 156 만족 어떤 제안서든 간에 조견표를 첨부하는 것이 좋다. (RFP에 아예 조견표를 써서 제출하라고 되어 있는 경우도 많다.) 평가자 입장에서 제안서가 RFP의 요구사항에 대한 구현방안을 어디에 어떻게 작성했는지 수백 수천장의 제안서 안에서 특정 내용을 찾아내는 것은 여간 힘든 작업이 아니기 때문이다. 그러다가 평가자가 못보고 지나치기라도 하는 날에는 꼼짝없이 점수가 누락되고 이는 탈락으로 직결될 수 있으니 조견표는 반드시 첨부하는게 좋겠다. 표준용어집 작성다섯째, 표준용어집은 간과하고 지나가기 쉬운데, 그러다가 나중에 후회하는 경우가 많다. 제안서는 여러 작업자, 혹은 여러 협력사가 동시에 작업하는 방대한 문서이기 때문에, 만약에 표준 용어를 정의하지 않고 작업하면 나중에 취합하다가 참사가 발생할 수 있다. 예를 들어, 우리가 제안하는 제품이 갤럭시 노트라고 가정해보자. 이를 ‘갤럭시 노트’라고 통일하여 쓰자고 약속하지 않으면, 아래와 같이 다양한 단어들이 제안서에 중구난방으로 작성되어있을 것이다. 그럼 고객 입장에서 제안서를 볼 때 적잖이 당황할지도 모른다. Ex. 갤럭시 노트, 갤럭시 Note, 갤럭시 NOTE, 갤럭시 note, Galaxy 노트, Galaxy Note, GALAXY NOTE, 갤노트 등 뒤늦게 깨닫고 나중에 바로 잡으려고 하면 막상 쉽지 않으니, 처음에 표준용어집을 잘 정의하는 것이 좋다. 기본적으로 다음과 같은 것들은 표준용어로 정의해두는 것이 좋다. 대소문자 사용과 띄어쓰기까지 정확히 통일해야 한다. 그리고 그것이 RFP에 등장하는 용어라면, RFP 기준으로 맞추는 것이 가장 혼란이 적다. 회사명 (Ex. Samsung, HYUNDAI Motors, LG 등) 핵심 제품명 (Ex. 갤럭시 노트, Sonata 등) 핵심 서비스/시스템명 (Eclipse IDE, MySQL 등) 핵심 역할/전문가 (PM, PL, SA, TA 등) RFP에 등장하는 각종 용어/약어 최근 제안서 / 유사 제안서 수급제안서는 무에서 유를 창조하는 활동이지만, 참고할만한 다른 제안서가 있다면 이야기가 달라진다. 참고 제안서에 작성된 문구, 내용, 아이디어, 디자인 모든 것을 벤치마킹하여 새로운 제안서를 만들어낼 수 있기 때문이다. 특히, 제안 작업에 경험이 많지 않은 팀에게는 참고 제안서가 꼭 필요할 것이다. 여력이 된다면 아래 3가지의 참고 제안서를 수급하면 좋다. 우리 회사에서 가장 최근에 제출했던 제안서 (동일년도 것이 좋음) 회사소개, 프로젝트관리 챕터를 참고할 수 있다. 특히 회사소개에 들어가는 각종 회사 정보 (매출, 이익, 기술자수, 특허, 품질자격 등)를 아주 손쉽게 확보할 수 있다. 유사 분야에 가장 최근에 제출했던 제안서 제안전략, 프로젝트관리, 기술제안서(시스템구성 등) 챕터를 참고할 수 있다. 특히 제안전략을 어떻게 세워야 하는지, 유사 분야에서는 프로젝트관리 방법론을 어떻게 적용하였는지를 손쉽게 확보할 수 있다. 프로젝트에 투입되는 솔루션사의 제안서 기술 제안서, 추가 제안 챕터를 참고할 수 있다. 솔루션의 각종 기능들의 상세 설명들을 확보할 수 있다. 제안 템플릿 제작 의뢰 (to 디자이너)제안 템플릿이란, 레이아웃, 로고, 글씨체 등이 설정되어 있는 문서의 템플릿, 형식을 의미한다. 제안 템플릿은 제안팀에서 직접 제작해도 되지만, 높은 퀄리티를 이끌어내기 위해 제안서 전문 디자이너에게 의뢰하기도 한다. (필자의 회사에서는 제안 작업이 있을 때마다 외주 디자이너에게 템플릿 제작을 의뢰하였다.) 디자이너를 활용하기 어려운 경우에는, 사내에 PPT/Word 스킬이나 디자인 감각이 출중한 직원이 있다면 그 직원과 협업하는 것도 방법이 될 수 있다. 디자이너와 협업하는 경우라면, 제안팀에서는 먼저 제안 템플릿이 어떻게 만들어져야 하는지 요구사항을 정리하여 디자이너에게 전달해야 한다. 그러면 디자이너는 해당 요구사항에 맞게 템플릿 제작을 제작하여 제안팀에 회신해줄 것이다. 간혹 전적으로 설계부터 제작까지 디자이너에게 의뢰하기도 하나, 필자는 이 방법을 비추천한다. 디자이너는 우리가 제안서를 어떻게 써 나갈지 모르기 때문에, 요구사항을 제대로 내지 않는다면 일반적인 스타일의 제안 템플릿을 만들어주거나, 타 제안에 사용했던 템플릿을 재활용할 가능성이 높다. 요구사항에 포함되면 좋은 내용요구사항에는 아래와 같은 내용들이 포함되면 좋다. 그 동안 필자가 디자이너와 협업하면서 서로 주고받았던 내용들을 정리하였다. 문서 형태 (PPT인지 Word인지 등) 용지 크기 (A4 기본, A3, A2가 있는지 없는지 등), 용지 방향 (가로인지, 세로인지) 머릿글, 바닥글에 포함될 내용 (좌측상단, 중앙상단, 우측상단, 좌측하단, 중앙하단, 우측하단 별로) 목차 뎁스 (몇레벨까지 내려가는지) -&gt; Ex) 1.1.1.1 (4레벨까지) 목차 표현법 (Ex. 3.1.2.1. 또는 3.1.2.1 또는 III.1.2.1 등) 페이지수 표현법 (Ex. 126 또는 IV-126 등, 페이지 표기 위치) 그외 디자인을 위한 각종 힌트들 Ex1. 제안서 스타일을 잡을 수 있도록 고객사가 선호하는 CI 색상 제시해주면 좋음Ex2. 제안서 표지 컨셉을 잡을 수 있도록 이 사업의 컨셉을 알려주면 좋음Ex3. 회사 로고, 고객사 로고 파일 등 디자이너가 작업해주는 것들위와 같이 제작의뢰를 마치고 나면, 디자이너는 아래와 같은 내용이 담긴 제안 템플릿을 제작해줄 것이다. 템플릿을 받으면, 제안팀이 원하는 대로 잘 작업되었는지를 빠르게 스캔한 후에 빠진 것이 있거나, 추가 요구사항이 있다면 디자이너에게 빠르게 의뢰하는 것이 좋다. 표지 디자인 목차 디자인 문서 디자인, 각종 레이아웃 (머릿글, 바닥글 등) 글꼴 (한글글꼴/영문글꼴 등) 글씨크기 (목차/타이틀/본문 별로) 줄간격 이미지, 표 레이아웃/사용법 각종 공통 도형, 박스, 화살표 등 도구 제안 스토리보드 및 WBS 작성 + 제안전략 도출작성중 제안서 작성의 R&amp;R 정리작성중","link":"/2020/10/10/proposal-document-1/"},{"title":"제안서 작성 및 제출 단계 (3&#x2F;4편) - 검수","text":"제안서 작성 및 제출 단계는 총 4가지 [준비] - [작성] - [검수] - [제출]로 구성된다. 준비 (1/4) 작성 (2/4) (작성중) 검수 (3/4) 제출 (4/4) 본 글에서는 그 중에서 [검수] 단계에 대해 다루겠다. 준비 단계는 다음과 같이 상세 6가지 단계로 정리된다. 소프트카피 검수 (1차) 하드카피 검수 (2차) 테스트 출력본 검수 (3차) 출력 진행 출력본 최종 검수 영업자료+기술자료 취합 단계에 대한 구분은 필자의 판단으로 임의로 나눈 것이며, 업계의 표준은 아닐 수 있다. 아래는 각각의 상세 단계에는 어떤 일들이 일어나는지, 어떤 것들을 주의해야 하는지 등 필자의 노하우에 대한 기록이다. 소프트카피 검수 (1차)소프트카피란, 문서를 PC상에서 보는 형태를 뜻한다. 제안서 작성이 완료되면, 우선 소프트카피 버전으로 검수를 진행한다. 가급적이면 본인이 작성한 것보다, 다른 팀원들이 작성한 것을 위주로 보는 것이 좋다. (내가 작성한 것은 문제점이 잘 안보이기 때문에…) 소프트카피 검수는 디테일한 내용을 살피기보다는 일단 빠르게 처음부터 끝까지 훑는 것을 목표로 한다. 주로 살펴볼 내용은 다음과 같다. 오타 찾기Word나 PPT의 경우에 오타 아래에 빨간색 밑줄이 그어지므로 해당 기능만 유심히 살펴보아도 대부분의 오타를 제거할 수 있다. 특히 띄어쓰기가 2회씩 쓰여있는 것은 Control+F(찾기) 기능을 활용하여 전부 제거한다. 표준용어 미준수 찾기표준용어집에 정의했던 약속대로 사용되지 않은 단어들을 찾아서 수정한다. 아무리 표준용어를 잘 정의했더라도 꽤 많이 발견될 것이다. 목차번호, 페이지번호 오류 찾기여러 작업자들끼리 제안서를 쓰다보면 목차번호나 페이지번호가 실수가 발생할 수 있다. 특히 제안서가 많이 수정할수록 목차번호와 페이지번호가 많이 틀어지게 되니 주의하는 것이 좋다. 하드카피 검수 (2차)하드카피란, 문서를 종이로 출력한 형태를 뜻한다. 소프트카피 검수 때는 빠르게 쓱 스캔했다면, 하드카피 검수에서는 작성된 내용이나 문구에 문제는 없는지 면밀하게 검토해보는 단계이다. 또한, 화면상으로는 보이지 않다가 종이로 뽑아보니 보이는 것들도 꽤 많다. 주로 살펴볼 내용은 다음과 같다. 중복된 내용 찾기여러 작업자들끼리 제안서를 쓰다보니 분명 타 챕터와 중복된 내용들이 다수 발생했을 가능성이 높다. 똑같은 내용이 반복되면 고객 입장에서 보기 안좋을 수 있으니, 가능하면 최소화한다. 위험한 문구제안서는 프로젝트 수행범위의 근거가 되는 가장 중요한 문서이다. 그렇기 때문에 제안사 입장에서 (속히말해) 덤탱이 씌일 수 있는 문구들은 최소화하는 것이 좋다. 한 예시로, 어감만 살짝 바꿔도 위험을 줄일 수 있는 것들도 존재한다. (수정전) A 장비에 문제 발생할 경우, 고객사에서 요청시 제안사는 신규 장비로 대체합니다.(수정후) A 장비에 문제 발생할 경우, 제안사는 문제 원인에 대한 점검 실시 후 교체에 대해 고객사와 협의하여 결정합니다. 글꼴, 글자크기, 글자색상이와 같이 종이로 뽑아야 비로소 보이는 것들이 꽤 있으니 잘 살펴본다. 테스트 출력본 검수 3차하드카피 검수(2차)까지 완료되었다면, 이제 본격적인 출력을 진행하기 위해 제본소로 이동한다. 그러나, 바로 본 출력을 진행하지는 않고 보통은 제본소에서 한번 더 하드카피 검수를 진행한다. 이는 제본소의 종이와 잉크로 찍어냈을 때 어떻게 나오는지, 혹시 문제는 없는지 테스트 출력본을 통해 최종적으로 확인하기 위함이다. 더불어 오타가 없는지 마지막으로 점검해야 한다. 재미있는 점은, 제본소에서도 수정사항이 어마어마하게 나온다. 그래서 현장에서 즉시 제안서 수정이 필요할 수 있으니 가급적이면 노트북을 챙겨가는 것이 좋다. 제본소에 회의실이 있다면 거기서 즉시 하드카피 검수를 진행해도 되지만, 제본소가 좁은 경우에는 자료를 가지고 근처 카페로 가거나 사무실로 돌아가서 검수를 진행해야 할 수도 있다. 따라서 제본소를 선정하기 전에 제본소의 환경을 미리 살펴보거나 전화로 물어보는 것이 좋다. 보통 제안서 전문 제본소는 여분의 PC와 회의실을 마련해두고 있는 경우가 많다. 출력 진행3차 검수까지 완료되었다면, 제본소에 출력을 요청한다. 다만, 바로 출력을 진행하기 전에 몇 가지 제본소와 최종 협의할 내용들이 있다. 보통은 제본소와 사전에 협의하는 내용이지만, 혹시라도 실수가 발생하지 않도록 출력 직전에 최종 확정하는 것이 바람직하다. 항목은 아래를 참고한다. 바인더 종류, 바인더 두께, 제안서 1개를 바인더를 몇개로 쪼갤 것인지 등 간지 종류/색상, 간지 분량 종이 두께 (80g, 100g, 120g 등) 컬러출력 범위 양면/단면 여부 하드카피 출력 부수 소프트카피(CD, USB 등) 제작 부수 패키징할 박스 종류 제본 시간은 제안서의 분량에 따라서 얼마나 걸릴지 천차만별이지만, 최소 반나절(3시간) 이상 소요될 것을 예상하는 것이 좋다. 필자의 경우 약 500장 분량의 제안서를 15부 제출하는 케이스가 있었는데, 출력을 시작하고 나서 최소 4시간은 걸렸던 걸로 기억한다. 제출본 최종 검수출력이 완료되어가는 시점 즈음에는, 제본소 직원에게 이야기하여 가장 빨리 완성되는 1본을 먼저 달라고 하여 최종 검수를 진행해야 한다. 제출 직전의 마지막 점검인 셈이다. 이 때는 사소한 오타 보다는, 제안 내용 상에서 정말 크리티컬한 문제가 있는지 위주로 살펴보아야 한다. 혹시라도 큰 문제가 있다면, 특정 부분을 수정하여 중간중간 종이를 교체를 해야 하는 경우가 발생하기도 한다. 다만, 마지막까지 수정된 문서(파일)은 꼭 잊지 않고 챙겨야한다. 최종적으로 출력을 진행한 파일들은 제본소에서 다시 가지고 나와야 하기 때문이다. 출력된 최종본은 유실되지 않도록 잘 챙겨서 USB에 담아오거나, 본사 메일로 전송해야 한다. 영업자료+기술자료 취합제안서는 제안팀에서 작성하는 자료 이외에도, 영업팀에서 작성하는 내용들도 다수 있다. 예로, 가격제안서가 있다. 가격제안서의 경우에는 제출이 완료된 후에도 외부로 유출되지 않는 것이 각별하게 중요하므로, 제본소에 맡기지 않고 자체적으로 출력을 할 가능성이 높다. 꼭 가격제안서가 아니라더라 제본소에서 출력하지 않고 자체적으로 출력하여 가져온 자료들은 하나로 합치는 작업이 필요할 것이니, 이에 대한 염두가 반드시 필요하다. [검수] 단계에 대한 기록은 이것으로 마치겠다. 끝.","link":"/2020/10/12/proposal-document-3/"},{"title":"제안서 작성 및 제출 단계 (4&#x2F;4편) - 제출","text":"제안서 작성 및 제출 단계는 총 4가지 [준비] - [작성] - [검수] - [제출]로 구성된다. 준비 (1/4) 작성 (2/4) (작성중) 검수 (3/4) 제출 (4/4) 본 글에서는 그 중에서 [제출] 단계에 대해 다루겠다. 준비 단계는 다음과 같이 상세 6가지 단계로 정리된다. 패키징 제출 (필요시 해외발송) 단계에 대한 구분은 필자의 판단으로 임의로 나눈 것이며, 업계의 표준은 아닐 수 있다. 아래는 각각의 상세 단계에는 어떤 일들이 일어나는지, 어떤 것들을 주의해야 하는지 등 필자의 노하우에 대한 기록이다. 패키징패키징이란, 제안서를 어떤 방법으로 잘 포장하여 고객에게 전달할 것인지에 대한 방법을 뜻한다. 보통은 제본소에서 알아서(?) 해주기 마련이지만, 몇가지 체크할 사항이 있다. 먼저, 박스 사이즈이다. 제안서의 분량에 따라 작은 박스를 써도 될수도 있고, 거대한 박스를 써야할 수도 있다. 또한, 제안서 제출 부수에 따라 박스 1개로 해결되지 않는 경우가 많다. 필자의 경우 2차례 제안 모두 박스를 최소 3개에서 많게는 7개 이상 사용하였는데, 그러면 각각의 박스마다 제안서를 어떻게 나눠담는 것이 고객입장에서 꺼내보기 편할지도 고민스러운 부분이었다. 다만, 너무 작은 박스를 사용하면, 속된 말로 좀 없어보일 수 있으니 전략적으로 생각해보는 것이 좋다. 고객사에서 여러 제안사들에서 제출한 박스들을 줄줄이 세워놓는데, 우리 회사의 제안박스가 뭔가 비실비실해보이지 않는(?) 것이 좋을 것이다. 둘째는, 박스 디자인이다. 박스의 재질, 색상부터, 손잡이의 디자인까지 꽤 다양한 제품들이 있으므로 잘 검토해보아야 한다. 박스는 그냥 제안서만 안전하게 들어가면 되는거 아냐?라고 생각할 수 있지만, 고객입장이 가장 먼저 받아보게 되는 것이 박스이다. (마치 소개팅 첫인상처럼..) 그래서 가급적이면 박스 디자인을 신경쓰는 것이 좋다. 고객사에서 선호하는 색상이 있다면 박스색상을 맞추는 것도 좋고, 제안서 수량이 많아서 박스가 무거워졌다면 고급스러운 손잡이가 달린 박스를 사용하는 것도 좋은 전략이 될 수 있다. 박스를 뜯어볼 고객에게 어떻게든 긍정적인 인상을 남겨줄 수 있도록 말이다. 다만, 박스의 품질에 따라 비용이 꽤 차이가 나기 때문에, 예산을 잘 따져보고 선택하는 것이 좋겠다. 셋째는, 박스 표지이다. 여기에는 제안서의 표지를 좀더 크게 출력하게 붙이기도 하고, 회사에서 공통적으로 배포한 박스 표지가 있다면 그것을 사용하기도 한다. 표지를 부착하는 이유는, 고객이 여러 회사들의 제안서 박스를 받을텐데, 표지가 붙어있지 않으면 어느회사에서 제출한 것인지 딱 봐서 알 수가 없기 때문이다. 그래서, 가급적이면 우리 회사의 로고가 잘 나타나는게 좋고, 사업명 정도는 반드시 들어가는게 좋다. 여담이지만, 고객사에 제안박스가 줄줄이 놓여있으면 많은 관련자들이 오고가면서 관심을 가질 것이다. 어떤 사업인지를 묻기도 하고, 규모는 어느정도되는지, 특히 어떤 제안사들이 참여했는지를 궁금해할 수도 있다. 그때, 잘 만들어진 우리 회사의 제안 박스들이 놓여있다면 고객에게 자신감을 줄 수도 있고, 더불어 우리회사가 돋보이게 할 수도 있는 것이다. 이 관점에서 패키징을 검토해보자. 제출 (필요시 해외발송)패키징이 완료되었다면, 이제 마지막으로 제안서를 고객사에 제출하는 일만 남았다. 제출을 잘 하기 위해서는 두 가지를 챙겨야 한다. 첫째, 마감일정/시간을 체크하여 그 시간 내에 반드시 제출할 수 있도록 해야 한다. 수천만원을 들여 제안서를 써놓고 시간을 놓쳐 탈락되는 불상사는 절대 일어나서는 안되겠다. 국내 제출인 경우에는 어느 거리이든 당일 내에 제출이 가능하겠지만, 해외제출인 경우에는 아주 복잡한 문제이다. 직접 비행기를 타고 날라가서 제출할 것인지, 퀵으로 보낼 것인지, 안전하게 마감시간 내에 제출할 수 있는 모든 수단과 방법을 다 동원해야 할 것이다. 필자 경험상, 동남아 국가에 DHL을 통해 빠른 배송을 보냈을 때, 배송만 이틀 정도 소요되었던 걸로 기억한다. 그것을 현지에서 누군가 픽업하여 고객사에 전달해주어야 하는데, 그것까지 따지면 아무리 최소로 잡아도 3일은 걸린다고 볼 수 있다. 둘째, 여유가 있다면 우리 회사가 몇 번째로 제출할 것인지를 전략적으로 선택해야 한다. 그 이유는 제안서 제출 순서에 따라, 통상적으로 제안발표회 순서가 역으로 정해진다. 이를 테면, 3개 제안사가 참여했는데 우리 회사가 제안서를 3등으로 제출하였다면, 제안발표는 우리회사가 1등으로 해야 한다. 다시 말해, 우리 회사가 몇 번째로 발표를 하는 것이 효과적일까를 고민해보아야 한다. 아래 예시를 참고한다. 강한 임팩트로 기선제압을 하고자 한다면 첫번째 발표가 좋을 것이다. 다만, 첫 발표자는 사업에 대해 자세하게 설명해줘야하는 세심함이 필요하다. (평가자들이 사업에 대해 잘 모르니..) 안정적으로 발표를 진행하고 싶다면 중간 순서가 좋을 것이다. 앞선 타사 발표로 고객이 사업에 대해 충분히 이해했고, 점점 몰입되고 있을 것이기 때문이다. 다만, 뚜렷한 강점이 없으면 양쪽에 끼어 자칫 기억에서 잊혀지기 쉽다. 여러가지 정황을 살피면서 신중을 기하고 싶다면 마지막 발표가 좋을 것이다. 전략적인 발표를 하기 좋기 때문에 대부분 마지막에 하는 것을 선호한다. 다만, 발표 시간이 길다면 평가자 입장에서 마지막 순서는 아주 힘들고 지루할 수도 있다. 그리고, 가능하다면 고객사에 도착 전에 미리 연락해두는 것이 좋다. 갑자기 찾아가면 출입이 원활하지 못한 문제가 발생할 수도 있고, 막상 찾아갔는데 고객사 직원들이 회의가고 자리에 없는 당황스러운 상황이 생길 수도 있다. 미리 연락을 넣으면서 혹시 경쟁사에서 이미 제출했는지, 아니면 아직 안왔는지 등의 정보를 넌지시 물어보는 것도 좋겠다. [제출] 단계에 대한 기록은 이것으로 마치겠다. 끝.","link":"/2020/10/13/proposal-document-4/"},{"title":"레드마인 기타 기능 설계하기","text":"레드마인과 관련된 글은 다음과 같이 5편으로 구성된다. 본 글에서는 3. 레드마인 기타 기능 설계하기에 대해 다룬다. 레드마인 설치하기 레드마인 그룹 설계하기 레드마인 기타 기능 설계하기 레드마인 일감 프로세스 설계하기 레드마인 일감 상세 설계하기 (작성중) 레드마인에는 “일감”이라고 하는 강력한 메인 기능이 있다. 하지만 그 외로도 뉴스, 문서, 위키, 게시판, 파일 등 매우 다양한 기능들을 제공하고 있다. 이를 잘만 활용한다면 레드마인이 단지 결함관리시스템, 이슈추적시스템이 아니라 프로젝트 참여자들이 업무적으로 소통할 수 있는 커뮤니티로도 정착될 수 있을듯하다. 뉴스뉴스는, 레드마인 사용자들에게 공지사항을 작성하는 기능이다. 기능은 별도 커스터마이징하지 않고, 다만 어떤 목적으로 사용할 것인지 정의가 필요하다. 업무와 관련된 공지사항을 등록할 것인지, 아니면 경조사에 대한 공지사항을 등록할 것인지 이것은 필요에 따라 취사선택한다. Ex. 업무 공지, 회의 공지, 테스트 공지, 경조사 공지 등 이를 선택할 때 고려해야 할 사항은 다음과 같다. 메일처럼 수신자/참조자가 뚜렷하게 있는 것이 아니기에 공지사항에 등록했다고 모두가 유심히 살펴보진 않을 수 있다는 것이다. 수행사 뿐 아니라 고객도 보는 창구이다. 사용자들이 레드마인에 상시 접속하는 것이 아니기 때문에 공지사항을 확인하는데는 시간이 걸린다. 문서문서는, 여러가지 문서파일을 게시글 형태로 묶어서 업로드할 수 있는 기능이다. 예를 들어, “각종 가이드 문서 배포”라는 제목의 글을 쓰고, 그 글에 A 가이드, B 가이드, C 가이드 등 여러 문서를 첨부할 수 있는 형태라고 보면 된다. 어떤 문서를 업로드할 것인지는 레드마인의 목적에 따라, 프로젝트의 상황에 따라 역시 취사선택하면 되겠다. 필자가 생각하기에는 다음과 같은 가이드 문서들을 올리면 사용자들이 필요할 때마다 참고할 수 있을 듯하다. 다만, 레드마인에 업로드하였을 때 보안 상에 문제는 없을지 반드시 검토하기 바란다. Ex1. 레드마인 사용법 가이드Ex2. 테스트 품질 지표Ex3. 단위 테스트, 통합 테스트 가이드 문서Ex4. 통합 테스트 시나리오등 위키레드마인에는 위키를 작성할 수 있는 기능이 있다. 별도로 DokuWiki 등을 구축하지 않아도 위키를 사용할 수 있으니 레드마인 하나로 두마리 토끼를 잡을 수 있는 편리한 기능인 것 같다. (다만, DokuWiki 수준의 다양한 기능을 제공하지는 않는 것 같아 아쉬움은 있다.) 간단하게 사용한다면, 레드마인 사용법 가이드 혹은 레드마인 운영 규칙 정도를 작성해두어도 좋을 것 같고, 조금 더 넓은 범위로 사용한다면, 개발가이드나 환경구축 가이드, 소프트웨어 설치 가이드 등을 작성할 수 있을 듯하다. 역시 보안 상에 문제가 없을지를 반드시 검토한 후에 사용하길 바란다. Ex1. 레드마인 사용법 가이드, 레드마인 운영규칙, 회원관리 규칙 등Ex2. 개발가이드, 환경구축 가이드, 소프트웨어 설치 가이드 등 게시판게시판은, 목적에 따라 여러가지 게시판을 구분하여 만들고 운영할 수 있는 기능이다. 게시판이라는 곳은 커뮤니티가 될 수도 있고, 가상의 회의실이 될 수도 있고, 의견을 나누는 아고라가 될 수도 있다. 용도는 너무나도 다양하기 때문에, 게시판을 만드는 사람의 아이디어나 의도가 가장 중요하겠다. 필자는 게시판을 다음과 같이 활용하면 어떨까 고민해보았다. Ex1. 건의사항 게시판: 프로젝트 또는 업무와 관련한 다양한 건의사항을 게시하고 답변을 받을 수 있는 공간Ex2. 위험이슈 관리 게시판: 각종 위험이슈를 등록하고, 진척사항을 추적/업데이트하는 공간Ex3. Q&amp;A 게시판: 타파트에 궁금한 것이 있을 때, 질문을 올리고 답변을 받을 수 있는 공간등 파일파일은, 파일 1개 단위로 업로드할 수 있는 기능이다. 위에서 설명한 [문서] 기능과 유사하면서도 다르다. 파일을 1개 단위로 업로드하기 때문에 너무 많은 파일들이 올라가면 페이지수가 여러장으로 늘어나면서 나중에는 찾기 어려워지는 문제가 발생할 수 있다. 그래서 중요한 파일들만 올리는 용도로 사용하는 것이 좋겠다. 혹은 누군가와 주고받아야 하는 파일이 있는데 메일로는 용량이 너무 커서 보내기 어려울 때, 이 기능을 활용하여 파일을 공유하고, 일정 시간이 지나면 지우는 것도 방법이 되겠다. Ex. 소스파일, 소프트웨어 설치파일, 이미지 파일 등 끝.","link":"/2020/08/18/redmine-etc/"},{"title":"레드마인 그룹 설계하기","text":"레드마인과 관련된 글은 다음과 같이 5편으로 구성된다. 본 글에서는 2. 레드마인 그룹 설계하기에 대해 다룬다. 레드마인 설치하기 레드마인 그룹 설계하기 레드마인 기타 기능 설계하기 레드마인 일감 프로세스 설계하기 레드마인 일감 상세 설계하기 (작성중) 레드마인에는 회원을 관리하는 유용한 기능이 있다. 회원들을 그룹핑할 수도 있고, 해당 그룹에는 특정한 권한 범위를 설정할 수도 있다. 회원관리 기능 사용법에 대해서는 생활코딩 &gt; 프로젝트관리 &gt; 레드마인 &gt; 회원 &gt; 회원관리에 자세하게 소개되어 있어서 참고하면 된다. 필자 본인이 속해 있는 개발 프로젝트에는, 여느 SI 프로젝트와 같이 다양한 참여자들이 존재하였고, 각각의 R&amp;R에 따라 레드마인에서도 권한과 활동범위를 지정해줄 필요성이 있었다. 필자는 다음과 같이 그룹을 구분지었다. 레드마인 관리자 PMO 현업 TF 수행사 PL (Part Leader) 수행사 개발팀 기간계 개발팀 (선택 사항) 각 그룹의 역할과 권한에 대해서는 아래에 구체적으로 설명하겠다. 레드마인 관리자레드마인 관리자는, 말 그대로 레드마인 시스템을 관리하고 운영하는 사람을 말한다. 레드마인의 모든 권한이 열려있는 “슈퍼 유저”라고 볼 수도 있겠다. 회원관리/생성/수정/삭제부터 프로젝트 관리/생성/수정/삭제, 게시판 관리/생성/수정/삭제, 일감 관리/생성/수정/삭제 등의 모든 권한을 가지도록 했다. 프로젝트 중에는 필자 본인이 [레드마인 관리자]의 역할을 맡았으나, 추후에 레드마인은 고객사에 인도해야 하기 때문에 해당 프로젝트 발주처 부서의 담당자도 레드마인 관리자로 등록하였다. 레드마인 전체 권한 소유(레드마인 설정, 프로젝트 생성, 게시판 생성, 회원 등록, 뉴스 공지, 일감 등록/삭제/수정 등) PMOPMO는 Project Management Office의 약자로, 프로젝트 관리의 롤을 맡은 다양한 참여자들이다. 필자가 속한 프로젝트에서는 발주처 쪽에서 PM과 사업관리, 그리고 해당 프로젝트의 스폰서들까지 총 5명이 있었고, 수행사 쪽에서는 PM과 사업관리 2명이 있었다. 이들은 사실 레드마인에서 특별하게 Action을 하는 일은 없으나, 레드마인을 통해 현업 및 수행팀의 업무 진척상황들을 모니터링하고, 이슈가 발생하였다면 그것을 해결하고, 레드마인 데이터를 엑셀로 내려받아 각종 프로젝트 품질지표를 측정하는 역할을 하는 사람들이다. 참고: PMO란? : 네이버 블로그 해당 프로젝트의 전체 권한 소유(게시판 생성, 뉴스 공지, 일감 등록/삭제/수정 등) 현업 TFTF란 Task Force를 뜻하고, 발주처의 직원들 중에 일부 프로젝트를 지원하기 위해 구성된 현장의 전문가 조직을, 현업 TF라고 부르는 경우가 많다. 이들의 역할은 AS-IS 시스템의 주사용자 입장에서 TO-BE 시스템에서 개선되어야 할 것들의 요구사항을 제시하고, 시스템이 구축된 이후에는 해당 요구사항대로 잘 구현이 되었는지를 테스트하는 것이다. 즉, 테스트 결과를 레드마인에 입력하고, 테스트가 실패하였다면 어떤 지점에서 에러가 발생하였는지 결함을 등록하게 될 것이다. 그리고 결함이 수정되었다면 테스트를 통해 시스템이 올바르게 동작하는지를 점검하는 역할까지 수행하게 된다. 일감 등록, 편집 (+본인이 등록한 글은 삭제 가능)게시판 글 작성, 댓글 달기 수행사 PLPL이란, Part Leader로 주로 수행사에서 개발팀을 리딩하는 역할을 하는 사람이다. 위에서 설명한 현업 TF와 주로 소통하며, 소통한 내용을 토대로 수행사 개발팀(설계자, 개발자, 디자이너)에게 각종 업무를 할당하게 된다. 또한 현업 TF와 함께 테스트를 수행하는 주체가 되기도 하며, 직접 결함을 등록하기도 한다. 현업 TF를 통해 결함이 보고되었을 때 이것이 결함이 맞는지를 점검하고, 해당 프로그램을 담당하는 개발자에게 결함조치를 할당하는 역할을 한다. 참고: IT용어 개발자, PL, PM, IT 컨설턴트 상세 설명 : 네이버 블로그 일감 등록, 편집 (+본인이 등록한 글은 삭제 가능)뉴스 공지, 게시판 글 작성, 댓글 달기 수행사 개발팀수행사 개발팀이란, 설계자, 개발자, 디자이너 등이 소속된 수행사의 개발조직이다. 프로그램을 설계하고 개발하는 주체이며, 수행사 PL을 통해 각종 업무를 할당받게 된다. 일감 등록, 편집 (+본인이 등록한 글은 삭제 가능)게시판 글 작성, 댓글 달기 기간계 개발팀 (선택사항)기간계 개발팀이란, 발주처에 구축되어 있는 각종 시스템을 운영하고 개발하는 발주처 소속의 개발팀이다. 이들은 발주처 직원일수도 있고 때로는 아웃소싱 조직일 수도 있다. 선택사항이라고 표시한 이유는, 우리 시스템에서 기간계 시스템과 인터페이스하는 프로그램이 전혀 없거나, 또는 얼마 없다면 굳이 레드마인에 기간계 개발팀을 초대할 필요가 없이 직접 다이렉트로 소통하는게 낫기 때문이다. 다만, 기간계와 인터페이스하는 프로그램이 상당부분 존재하고, 그것이 프로젝트 성공에 큰 영향이 있다면, 레드마인 내에도 이들 그룹을 초대하여 진척에 대해 관리하는 것이 바람직할 것이다. 일감 편집 가능 끝.","link":"/2020/08/16/redmine-group/"},{"title":"제안 작업이란,","text":"2020년 상반기, 감사하게도 회사에서 제안 작업 두 차례 참여하는 업무기회가 주어졌다. 한번은 국내사업(10억 이상 규모)이었고, 한번은 해외사업(500억 이상 규모)였다. 필자는 개발 직군이지만, 1년 내내 개발만 하는 것은 아니다. 개발이 끝나면 각종 산출물들을 작성하고, 새로운 일을 시작하기 전에는 각종 기획서도 작성한다. 더불어 SI 프로젝트를 시작하기 전에는 제안 작업이라는 것을 한다. 제안 작업이란, 발주처에서 발행한 제안요청서(RFP, Request for proposal)를 근거로 제안서를 준비하여 제출하고, 제안PT를 준비하고 제안발표회를 진행하는 제안과 관련된 모든 업무를 뜻한다. 더불어 제안 작업을 한다는 것은 해당 사업이 경쟁입찰이라는 뜻으로 볼 수 있다. 다시 말해, 우리 회사 말고도 이 사업을 따내고자 하는 경쟁사가 있을 가능성이 있다는 것이다. 실제로 진행과정 중에 여러 경쟁사가 발주처의 선택을 받기 위해 영업적으로, 기술적으로 피튀기는 공방을 거친다. 그 과정을 거치고 나면, 발주처에서는 우선협상대상자라는 것을 선정하고, 계약을 진행한 후에 본 사업이 시작된다. 필자는 개발팀의 입장에서 제안 작업이 어떤 프로세스로 진행되는지를 기록하고자 한다. (PM과 영업적인 내용은 배제) 제안작업을 하면서, 필자 스스로 부족한 점을 많이 느꼈다. 앞으로도 살면서 적게는 4~5번, 많게는 10번 이상의 제안을 더 경험하지 않을까 예상하기 때문에, 기록한 내용을 토대로 다음번 제안에서는 더 발전한 결과물을 이끌어냈으면 하는 바람이다. 제안 작업의 전체 프로세스제안 작업은 다음과 같이 크게 두 가지 단계로 나뉜다. (1) 제안서 작성 및 제출 단계(2) 제안PT 준비 및 발표 단계 먼저, 제안서를 작성하고 제출하는 단계가 있다. 제안서는 적게는 200페이지, 많게는 3,000페이지가 넘는 경우가 있을 정도로 방대한 분량의 문서이다. 그러나 안타깝게도 제안팀에게 주어지는 시간은 짧게는 겨우 2주, 길게는 4~5주 뿐이다. 그 시간 안에 무에서 유를 창조하기 위해 제안팀은 매일 밤을 지새우는 강도높은 작업을 수행하기도 한다. 제안서를 제출하고 나면, 곧바로 제안발표회라는 일정이 잡힌다. 제안발표회란, 고객들에게 제안한 내용을 간략히 발표하고 평가를 받는 행사이다. 이를 위해 제안PT를 준비하고 발표하는 단계를 진행한다. 제안PT란 짧게는 10분, 길게는 30분 이상을 발표해야 하는 고통스러운 일이다. 발표는 보통 PM이 진행하지만, 그 뒷단에서 발표자료를 만들고, QnA를 준비하는 등의 업무를 담당하는 여러 담당자들이 존재한다. 제안서 작성 및 제출 단계제안서 작성 및 제출 단계는 [준비] - [작성] - [검수] - [제출] 순으로 상세 21개 프로세스로 구성된다. 사업의 특성에 따라 이 프로세스는 간소화될 수도 있고 혹은 더 복잡해질 수도 있으나, 필자가 생각하는 필수적인 프로세스를 모두 담았다. 준비 킥오프 (제안팀 구성, 협력구도 선정) RFP 분석 최근 제안서 / 유사 제안서 수급 제안 템플릿 제작 의뢰 (to 디자이너) 제안 스토리보드 및 WBS 작성 + 제안전략 도출 제안서 작성의 R&amp;R 정리 작성 작성 시작 작성 후 취합 조견표 작성 상급자 리뷰 (영문 제안의 경우) 번역 (to 번역가 또는 번역가능한 직원) (영문 제안의 경우) 번역본 검수 (to 외국인직원) 제안서 디자인 작업 의뢰 (to 디자이너) 검수 검수 1차 (소프트카피) 검수 2차 (하드카피) 검수 3차 (출력 직전 제본소에서) 제출본 출력 (to 제본소) 제출본 최종 검수 영업자료+기술자료 취합 제출 패키징 제출 (필요시 해외발송) 제안PT 준비 및 발표 단계제안PT 준비 및 발표 단계는 [준비] - [장표작성] - [발표회준비] - [발표회진행] 순으로 상세 15개 프로세스로 구성된다. 위와 마찬가지로 사업의 특성에 따라 이 프로세스는 간소화될 수도 있고 혹은 더 복잡해질 수도 있으나, 필자가 생각하는 필수적인 프로세스를 모두 담았다. 준비 샘플 제안PT / 유사 제안PT 수급 제안PT 템플릿 제작 (to 디자이너) 제안PT 스토리보드 작성 + 제안전략 도출 제안PT R&amp;R 정리 장표 작성 작성 시작 작성 후 취합 제안PT 장표 리뷰 제안PT 디자인 작업 의뢰 (to 디자이너) 발표회 준비 발표 스크립트 작성 예상 QnA 작성 제안PT 발표 리허설 1차 (팀원 대상) 제안PT 발표 리허설 2차 (영업팀 대상) 제안PT 발표 리허설 3차 (임원 대상) 발표회 진행 발표본 출력 제안발표회 진행 각각의 단계에서 유의해야 할 점은 다른 글에서 다루도록 하겠다. 끝.","link":"/2020/09/27/proposal-process/"},{"title":"레드마인 설치하기","text":"프로젝트 수행 중에 레드마인을 직접 세팅하고 커스터마이징해볼 기회가 생겨서 추후 다른 프로젝트에서 활용할 때도 참고할 수 있도록 기록을 남겨두고자 한다. 레드마인과 관련된 글은 다음과 같이 5편으로 구성된다. 본 글에서는 1. 레드마인 설치하기에 대해 다룬다. 레드마인 설치하기 레드마인 그룹 설계하기 레드마인 기타 기능 설계하기 레드마인 일감 프로세스 설계하기 레드마인 일감 상세 설계하기 (작성중) 설치 설치는 레드마인 설치 따라하기 (Windows 7/10)를 참고하여 진행하였다. 설치파일은 Bitnami - Download Redmine에서 다운로드 가능하다. 추후 리눅스에 설치하는 경우에는, Bitnami에서 제공하는 Docker를 활용한 레드마인 설치를 참고하면 될 듯하다. 레드마인 사용법 감사하게도 레드마인의 대부분의 사용법은 생활코딩 사이트에 교육영상이 있다. 생활코딩 &gt; 프로젝트관리도구 &gt; 레드마인을 참고하여 약 1시간 정도 공부하니 설치부터, 주요기능, 회원, 프로젝트, 일감, 로드맵, 위키, 저장소 기능에 대해 익힐 수 있었다. 레드마인을 커스터마이징하고자 한다면 반드시 사용자 정의항목을 맞딱뜨리게 될 것이다. 즉, 일감의 하위 입력 필드는 사용자의 필요에 따라 커스터마이징할 수 있다. 필자는 사용자 정의 항목 추가하기 블로그를 참고하여 진행하였다. 테마 적용기본 테마가 밋밋하다면, 테마 적용 따라하기를 참고하여 색다른 테마를 입혀볼 것을 추천한다. 레드마인에서 제공하는 Theme List - Redmine에서 전체 테마리스트를 볼 수 있다. 가장 인기있는 테마는 A1, PurpleMine2 등이 있다. 필자는 Flatly_light_redmine 테마를 활용하였다. Plug-In 설치레드마인에서 제공하는 각종 추가 기능을 활용하고 싶다면, 레드마인 공식 플러그인 리스트를 참고하면 된다. 전체 플러그인이 다 필요하지는 않을테니, 이 중에서 입맛에 맞게 설치하여 쓰면 된다. 다만, 그동안 레드마인을 써본 유저들이 주로 추천하는 플러그인들이 있어 링크 남기도록 하겠다. 유용한 플러그인 Top 5, 유용한 플러그인 Top 10 레드마인 플러그인 설치 따라하기 플러그인을 다운로드 받은 후에는 아래 명령어를 통해 서버에 반영이 가능하다. 12bundle install --without development test --no-deploymentbundle exec rake redmine:plugins NAME=redmine_agile RAILS_ENV=production 그 외서버 이전이 필요한 경우에는 서버 이전하기 - 잡동사니 블로그를 참고한다. 끝.","link":"/2020/08/15/redmine-setup/"},{"title":"업무일지 2020년 09월 1주차","text":"2020년 9월 1주차 개인 업무일지이다. 언제 어떤 일들을 했는지 기억하기 위하여 남긴다. Schedule2020.09.01.화 모바일 OSA 내부 정리 회의 (10:20 ~ 11:30) FHIR 내부 정리 회의 (13:00 ~ 14:00) 모바일 OSA 내부 정리 회의 (14:00 ~ 16:00) FHIR 협업 시작 with JYH, 진행경과 인수인계 받음 (16:40 ~ 17:40) 2020.09.02.수 FHIR 진행방안 사전 논의 with JYH FHIR 전체 범위 조사 with JYH FHIR 진행방안 자료작성 FHIR 진행방안 내부 검토 with PL님, PM님 (16:30 ~ 17:30) FHIR 진행방안 최종 수정 및 전체 공유 2020.09.03.목 모바일 OSA To-Be 구성방안 작성 주간보고 리뷰 (13:00 ~ 14:00) FHIR 진행방안 및 모바일 OSA To-Be 구성방안 보고 (15:00 ~ 16:00) 모바일 표준체계 가이드 리뷰 회의 (16:00 ~ 17:00) 2020.09.04.금 사업관리 잔여업무 (산출물 템플릿 2차 배포) 인수인계 모바일 OSA 내부 업무조정 회의 (09:30~) FHIR 상세일정 회의 FHIR 테스트페이지 관련 회의 (14:00 ~ 14:10) 모바일 게이트웨이 설계자료 검토 회의 (14:10 ~ 15:00) FHIR 로컬 환경 구축 + 가이드 작성 (15:00 ~ 17:50) 잘한 점/개선사항/배운 점 궁금한 것은 적극적으로 물어보고, 되도록 그 자리에서 해결하는 것이 좋다. 알고 있는 것에 대해서는 팩트를 기반으로 명확하게 이야기한다. 명확하게 설명하지 못하면 상대방은 내 주장을 추측 또는 가설로 받아들일 수 있다. (OSA As-Is 내부 회의 중) 언행을 겸손하게 하되, 행동으로는 증명해야 한다. 그 반대가 되지 않도록 주의. 회의에서 조금 더 적극적으로 발언을 해도 되겠다. (발주처 PM께서 세번째 지적한 포인트) 나에게는 정리되지 않는 것들을 정리하는 강점이 있다. 문제가 되고 있는 것들을 정리하여 해결책을 제시하는 일을 맡았을 때 잘 할 수 있다. 생각이 정리되지 않는 어려움를 겪고 있는 사람들이 있다면 생각의 흐름을 정리할 수 있도록 내가 적극적으로 도와줄 것. 도움을 받은 일이 있다면 확실하게 감사의 인사를 하자. 상대방의 장점을 보고 그 장점을 발휘할 수 있도록 북돋워주어야 한다. 함께 지내다보면 어쩔 수 없이 단점이 보이더라도 단점을 흉보는 게 아니라 내가 상대방의 단점을 보완해줄 수 있는 방법을 찾아야 한다. 끝.","link":"/2020/09/04/word_202009_1/"},{"title":"업무일지 2020년 09월 2주차","text":"2020년 9월 2주차 개인 업무일지이다. 언제 어떤 일들을 했는지 기억하기 위하여 남긴다. Schedule2020.09.07.월 대상 단말 선정 가이드 리뷰 및 보완 2020.09.08.화 FHIR 소프트웨어 구성, 서버 아키텍처 구성 검토 FHIR 아키텍처 설계서 (시스템 구성도) 작성 FHIR 아키텍처 설계 내부회의 (14:30 ~ 15:30) FHIR 로컬환경 설치 - hapi-fhir-jpa-server config 2020.09.09.수 FHIR 로컬환경 설치 * FHIR 로컬환경 설치 - MySQL innoDB sandbox cluster 테스트, innoDB classic 테스트 FHIR 3098 에러 서칭 2020.09.10.목금일은 해외 컨퍼런스콜이 있어 본사로 출근. ITRS 제안서 및 기술PT 준비 지원 기술 컨설턴트와 사전 미팅 ITRS 기술PT 및 질의응답 컨퍼런스콜 (12:00 ~ 14:00) 2020.09.11.금 FHIR 로컬 테스트 및 에러 추적 FHIR 환경구축 가이드 작성 잘한 점/개선사항/배운 점 항상 명확한 근거(이유) 중심으로 생각하고 일할 것. 왜 이렇게 했는지? “그냥”, “쉬워서”, “편해서”는 설득력 있는 방식이 아니다. 업무의 우선순위와 마감기한을 정하고 진행할 것. 다만, 내가 생각하는 우선순위와 상사가 생각하는 우선순위가 간혹 다를 수 있다. 그 싱크를 잘 맞춰가면서 혼란을 줄이자. “이거 이상한데?” 싶은 것들을 그냥 지나치지 말자. 경험이 많은 분들에게 질문과 검토요청을 귀찮을 정도로 해야만 내가 하나라도 더 배울 수 있\u001d다. 옆 사람이 고민하고 있는 문제는 함께 관심을 가지고 고민해주는 것이 좋다. 머리를 맞대면 분명 더 좋은 방법이 보이기 마련이다. 또한 도움을 받았던 사람은 다음 번에 어떤 방법으로든 반대로 도움을 줄 것이다. 누군가에게 요청할 것이 있을 때는 반드시 미리 이야기하자. 부탁할 사람에게 급작스런 업무로드가 발생하지 않도록 하는 것이 비즈니스 매너이다. 반대로, 갑작스럽 요청이 잦아지면 그 사람과는 다음 번에 같이 일하기 싫어질 수 있다는 것을 유념하자. 멀티태스킹보다 한가지 업무에 몰입하는 것이 오히려 높은 생산성을 낼 수 있다. (참고: 여러가지 업무 전환 ‘멀티태스킹’, 생산성 떨어뜨린다 : 네이버 포스트) 다양한 업무들에 호기심이 생기겠지만 현재 메인으로 맡고 있는 업무가 가장 중요하고 거기에 힘을 집중하도록 하자. 끝.","link":"/2020/09/11/work_202009_2/"},{"title":"레드마인 일감 프로세스 설계하기","text":"레드마인과 관련된 글은 다음과 같이 5편으로 구성된다. 본 글에서는 4. 레드마인 일감 프로세스 설계하기에 대해 다룬다. 레드마인 설치하기 레드마인 그룹 설계하기 레드마인 기타 기능 설계하기 레드마인 일감 프로세스 설계하기 레드마인 일감 상세 설계하기 (작성중) 레드마인의 가장 강력한 기능인 “일감”을 제대로 다루기 위해서는, 먼저 일감을 누가 어떻게 시작하고 진행하고 종료할 것인지 프로세스를 잡아야 한다. 레드마인은 거의 모든 것을 커스터마이징할 수 있도록 개방적으로 프로그램이 설계되어 있기 때문에, 프로세스를 어떻게 잡아야 하는지를 전적으로 사용자가 원하는대로 정해도 된다. 프로그램을 수정하는 것은 프로세스를 잡은 다음에 고민해도 된다. 필자는 일단 일감을 결함으로 한정하고, 프로세스를 다음과 같이 대표적으로 5가지 케이스로 나누었다. 프로세스는 어떤 발주처와 프로젝트를 진행하느냐에 따라, 혹은 어떤 구성원들과 일하느냐에 따라 언제나 변경될 수 있기 때문에 참고용으로만 의미가 있을 것이다. (즉, 안타깝지만 다른 프로젝트에서는 어차피 재설계해야 한다.) 기본 프로세스 수행사 자체진행 프로세스 조치불가 프로세스 거절 프로세스 결함 재접수 프로세스 기본 프로세스결함이 정상적으로 처리되는 기본 프로세스이다. 대부분의 결함은 이 프로세스대로 처리될 것이다. 현업TF에서 결함을 신규등록하고, PL은 해당 결함을 담당 개발자에게 할당한다. 개발자는 결함을 할당받아 결함을 조치한다. 조치가 완료된 결함은 PL이 중간테스트를 진행한다. 중간테스트가 통과하면 최종적으로 현업TF에서 최종테스트를 진행한다. 문제가 없으면 결함은 종료된다. 담당자 현업TF PL 개발자 개발자 PL PL 현업TF 현업TF 일감의 상태 신규 -&gt; 진행 조치완료 -&gt; 중간완료 -&gt; 최종완료 Action 결함등록 개발자 지정 결함 조치 결함 해결 PL테스트 시작 PL 테스트 완료 현업테스트 시작 현업테스트 완료 수행사 자체진행 프로세스발주처에서 관여하지 않고 수행사에서 자체적으로 진행하는 프로세스이다. 기본 프로세스에서 “현업TF”가 빠진 케이스라고 보면 된다. 이는 다시 두 가지 케이스 나뉠 수 있는데, 첫번째, PL이 결함을 발견하고 등록하는 케이스와, 두번째, 개발자가 스스로 결함을 발견하고 등록하는 케이스이다. PL이 결함을 등록하는 케이스PL이 결함을 발견한 경우이고, PL이 결함을 등록하는 것부터 프로세스가 시작된다. 담당자 PL 개발자 개발자 PL PL 일감의 상태 신규 진행 조치완료 -&gt; 최종완료 Action 결함등록, 개발자 지정 결함 조치 결함 해결 PL테스트 시작 PL 테스트 완료 개발자가 결함을 등록하는 케이스개발자가 결함을 발견한 경우이고, 개발자가 결함을 등록하는 것부터 프로세스가 시작된다. 담당자 개발자 개발자 개발자 PL PL 일감의 상태 신규 진행 조치완료 -&gt; 최종완료 Action 결함등록 개발자 본인 지정, 결함 조치 결함 해결 PL테스트 시작 PL 테스트 완료 조치불가 프로세스때때로 다양한 사유로 조치가 불가한 경우들이 발생한다. 그것이 기술적인 사유일 때도 있고, 정책적인 사유일 수도 있다. 그럴 때에는 다음과 같은 프로세스로 진행된다. 담당자 현업TF PL 개발자 개발자 PL PL 일감의 상태 신규 -&gt; 진행 의견 -&gt; 조치불가 Action 결함등록 개발자 지정 결함 조치 조치불가 의견 작성 PL 검토 PL 의사결정 거절 프로세스결함이 등록되었으나 이것이 사업범위를 넘어서는 요구사항일 경우에는, 수행사에서 조치를 거절하는 경우도 발생한다. 이는 다시 두 가지 케이스로 나뉠 수 있는데, 첫번째, PL이 즉시 거절하는 케이스와, 두번째, 개발자 확인 후 거절하는 케이스이다. PL이 즉시 거절하는 케이스최초로 결함을 검토한 PL이 즉시 결함처리를 거절하는 케이스이다. 담당자 현업TF PL PL 일감의 상태 신규 -&gt; 거절 Action 결함등록 PL 검토 PL 의사결정 개발자 확인 후 거절하는 케이스PL은 결함을 개발자에게 할당하였으나, 개발자가 검토하여 다시 PL에게 의견을 보고하고, 보고받은 PL이 결함처리를 거절하는 케이스이다. 담당자 현업TF PL 개발자 개발자 PL PL 일감의 상태 신규 -&gt; 진행 의견 -&gt; 거절 Action 결함등록 개발자 지정 결함 조치 거절 의견 작성 PL 검토 PL 의사결정 결함 재접수 프로세스개발자가 결함을 조치완료하였지만, 테스트 중에 결함이 재발생하는 경우들이 있다. (제대로 조치가 안되었거나, 조치했지만 다른 에러 케이스가 발생하는 경우 등등) 이는 다시 두 가지 케이스 나뉠 수 있는데, 첫번째, PL테스트 실패 후 결함 재접수 케이스와, 두번째, 현업테스트 실패 후 결함 재접수 케이스이다. PL테스트 실패 후 결함 재접수 케이스개발자가 조치완료 후 PL이 테스트 중에 결함을 발견하여, 다시 개발자에게 결함을 재접수하는 케이스이다. 담당자 현업TF PL 개발자 개발자 PL PL 개발자 일감의 상태 신규 -&gt; 진행 조치완료 -&gt; 진행 진행 Action 결함등록 개발자 지정 결함 조치 결함 해결 PL테스트 시작 PL테스트 실패, 결함 재접수 결함 재조치 시작 현업테스트 실패 후 결함 재접수 케이스개발자가 조치완료 후 현업TF가 테스트 중에 결함을 발견하여, 다시 개발자에게 결함을 재접수하는 케이스이다. 담당자 현업TF PL 개발자 개발자 PL PL 현업TF 현업TF 개발자 일감의 상태 신규 -&gt; 진행 조치완료 -&gt; 중간완료 -&gt; 진행 진행 Action 결함등록 개발자 지정 결함 조치 결함 해결 PL테스트 시작 PL 테스트 완료 현업테스트 시작 현업테스트 실패, 결함 재접수 결함 재조치 시작 끝.","link":"/2020/08/20/remine-process-design/"},{"title":"표준 산출물 작성 가이드","text":"2020년 여름, 참여중인 프로젝트에서 사업관리 역할을 일부 겸하면서, 프로젝트 팀원들이 함께 사용할 수 있는 표준 산출물 템플릿과 작성가이드를 만드는 업무를 진행하였다. 산출물은 프로젝트 종료시에 발주처에 납품해야 하는 가장 핵심적인 결과물들인데, 템플릿이 어떻게 구성되느냐에 따라 향후 작성될 산출물들의 퀄리티가 좌지우지될 수 있기 때문에 보기보다 중요한 업무이다. 그래서 몇가지 기억해둘만한 요소를 기록하고자 한다. 산출물 목록 문서 명명 규칙 버전 관리 규칙 문서 스타일 ID 생성 규칙 산출물 목록발주처와 합의한 산출물 목록이다. 산출물의 범위는 프로젝트 규모에 따라, 구축하는 시스템의 특성에 따라 달라지니 참고만 한다. 착수 및 계획 단계의 산출물이다. 사업수행계획서 실행 및 통제, 종료 단계의 산출물이다. 주간보고서, 월간보고서, 완료보고서, WBS 분석 단계의 산출물이다. 요구사항정의서, 총괄테스트계획서 설계 단계의 산출물이다. 아키텍처설계서, 인터페이스설계서, 화면설계서, 프로그램목록, 데이터베이스설계서 개발 단계의 산출물이다. 소스코드, 업무프로세스절차서, 표준산출물템플릿, UI/UX 표준, 단계별 가이드 테스트 단계의 산출물이다. 단위테스트 계획서, 단위테스트 결과서, 통합테스트 계획서, 통합테스트 결과서 이행/교육 리허설결과서, 사용자메뉴얼, 운영자메뉴얼, 교육결과서 (미제출이나 내부적으로 관리할 문서) 위험이슈관리대장, 변경요청서, 변경관리대장, 결함관리대장, 회의록 등 문서ID 명명 규칙일반적으로 10억대 이상의 중형 프로젝트만 진행하더라도 산출되는 문서가 20종이 넘고, 파트별로 쪼개지는 문서까지 합하면 약 50개가 넘는 문서가 탄생할 걸로 예상이 된다. 거기에 각각의 버전이 나뉘면서 수백개의 문서가 뒤섞이게 될 것이다. 100억대 이상의 대형 프로젝트는 수천개의 문서가 탄생하니, 내가 보고 싶은 문서를 찾는 것조차도 보통 일이 아닐 것이다. 따라서 원하는 문서를 빠르게 찾기 위해서는 해당 문서의 고유한 문서명칭을 잘 짓는 것이 중요하다. 현 프로젝트에서는 아래와 같은 규칙으로 문서 명명규칙을 세웠다. [프로젝트코드]—[프로세스약어코드]—[문서종류코드&amp;일련번호]—[산출물명]—[시스템명] _ [V버전]Ex. MGS-AN-F01-요구사항정의서-메일_V1.1Ex. MGS-DE-F01-데이터베이스설계서-푸시_V2.0 프로젝트코드: 현재 프로젝트를 나타내는 약어 (Ex. MGS, 모바일 그룹웨어 시스템) 프로세스약어코드: 아래 표를 참고한다. 2자리의 영문자 코드이다. 문서종류코드: 아래 표를 참고한다. 1자리의 영문자 코드이다. 일련번호: 2자리의 숫자이다. 01부터 99까지 순서대로 부여한다. 산출물명: 산출물의 한글 명칭을 작성한다. 시스템명: 시스템이 구분되어 산출물이 쪼개지는 경우, 해당 시스템의 명칭을 작성한다. (Ex. 메일, 푸시) 버전: 아래 버전관리규칙을 참고한다. 프로세스약어코드 정의 프로세스약어코드 프로세스 설명 AN 분석(Analysis) DE 설계(Design) DV 개발(Develop) TS 테스트(Test) DP 이행 PM 프로젝트관리 SC 범위관리 SH 일정관리(=진척관리) CO 원가관리 CM 형상관리 QM 품질관리 RM 자원관리 CC 의사소통관리 RK 위험 및 이슈관리 SE 보안관리 ET 교육훈련 TT 기술이전 IM 검수관리 문서종류코드 정의 문서종류코드 설명 R 보고서(Report) F 산출물(Formal) P 절차(Process) G 가이드(Guide) E 기타(etc) 버전 관리 규칙문서는 소스코드처럼 형상관리시스템을 잘 사용하지 않으므로, 자체적으로 버전관리 규칙을 철저히 지켜주는 것이 좋다. 버전관리 규칙을 지키지 않으면, 나중에 어떤 버전이 최신인지 여러 담당자들끼리 작업이 꼬이는 문제가 반드시 발생할 것이다. 현 프로젝트에서는 아래와 같은 규칙으로 버전을 관리하기로 했다. 베이스라인 이전 담당자가 초안 작성 시, V0.1을 부여한다. 형상이 변경할 때마다, 버전을 0.1씩 증가시킨다. 베이스라인 수립 베이스라인은 V1.0으로 정의한다. 베이스라인이란, 발주처와 수행사가 합의 완료한 산출물의 최초 버전이라는 의미이다. 베이스라인 이후 형상 항목의 내용 변경 시, V1.1부터 0.1씩 증가시킨다. (리비전에 대해서는 관련자에게만 공지한다.) 형상관리 대상 및 메이저 항목의 변경 시,맨 앞자리 버전을 증가시킨다 (Ex. 1.0 -&gt; 2.0) 문서 스타일가장 기본적이면서 필수적으로 지켜야할 문서의 스타일은 다음과 같다. 문서 종류: MS Office (Word/PPT/Excel) 사업명: RFP에 공고된 사업명 기준으로 분명하게 적을 것 문서크기: A4 로고: 좌측하단에는 발주처 로고, 우측하단에는 수행사 로고 글꼴: 맑은 고딕 첫 페이지에 결재라인 명시 (Ex. PL -&gt; PM -&gt; 사업단장) 넘버링 체계 1 1.1 1.1.1 1.1.1.1 Task ID 생성 규칙일을 하다보면, 분명 추적관리가 필요한 Task들이 있을 것이다. 예를 들어 A라는 특정한 결함을 찾아가고 싶은데 수천개의 결함들 중에서 내가 원하는 결함을 어떻게 찾아갈 수 있을까? 그럴 때 해당 결함에 ID가 부여되어 있으면 추적이 용이할 것이다. 현 프로젝트에서는 추적을 위해 각각의 Task ID를 다음과 같이 생성하기로 규칙을 세웠다. [프로젝트 코드]—[서브시스템코드]—[업무코드&amp;일련번호]Ex. MGS-PUSH-RQ0001Ex. MGS-COMM-ID0033예시설명. 모바일그룹웨어 구축 프로젝트의 푸시파트 요구사항 1번예시설명. 모바일그룹웨어 구축 프로젝트의 공통파트 통합테스트 결함 33번 프로젝트코드: 현재 프로젝트를 나타내는 약어 (Ex. MGS, 모바일 그룹웨어 시스템) 서브시스템코드: 프로젝트팀 내에 구성된 각 파트별 약어, 3~4자리 코드이다. 아래 예시를 참고한다. Task 코드: 아래 표를 참고한다. 2자리의 영문자 코드이다. 일련번호: 4자리의 숫자이다. 0001부터 9999까지 순서대로 부여한다. 서브시스템코드(예시)예시이므로 참고만 하고, 수행하는 프로젝트에 맞게 서브시스템코드는 재정의한다. 서브시스템코드 설명 MAIL 메일 파트 PUSH 푸시 파트 INFRF 인프라 파트 COMM 공통 파트 Task 코드추적이 필요한 대부분의 Task를 아래와 같이 정의하였으나, 혹시 추가로 필요한 경우에는 추가하여 사용한다. Task 코드 의미 RQ 요구사항(Requirement) SC 화면(Screen) PG 프로그램(Program) IF 인터페이스(Interface) UC 단위테스트 케이스(Unit Test Case) UD 단위테스트 결함(Unit Test Defect) IS 통합테스트 시나리오(Integrated Test Scenario) IC 통합테스트 케이스(Integrated Test Case) ID 통합테스트 결함(Integrated Test Defect) RS 리허설 시나리오(Rehearsal Scenario) RC 리허설 케이스(Rehearsal Case) RD 리허설 결함(Rehearsal Defect) TR 교육(Training) IU 이슈(Issue) RK 위험(Risk) CH 변경요청(Change) 끝.","link":"/2020/08/08/standard-formal-guide/"},{"title":"업무일지 2020년 09월 4주차","text":"2020년 9월 4주차 개인 업무일지이다. 언제 어떤 일들을 했는지 기억하기 위하여 남긴다. Schedule2020.09.21.월 EMPI 기능분석, 사용법 검토 HAPI JPA EMPI Server 기동 테스트 (완료) 2020.09.22.화 EMPI 기능분석, 사용법 검토 FHIR 5.1.0 버전 에러 추적 FHIR 환경설치 가이드 보완 후 공유 2020.09.23.수 EMPI 기능 설명서 작성 (운영자메뉴얼에 추가) 2020.09.24.목 FHIR 진행경과 보고 및 추가 분석결과 공유회 준비 FHIR 진행경과 보고 및 추가 분석결과 공유회 진행 (13:00 ~ 14:00) FHIR 테스트계획서 초안 작성 2020.09.25.금 Resource, Profile, Extension 스터디 및 자료작성 FHIR 클라이언트 설치/사용방법 작성 (운영자메뉴얼에 추가) FHIR 운영자메뉴얼 취합 잘한 점/개선사항/배운 점 스터디와 업무는 다르다. 스터디는 계획이 있을 수 있지만 실적이 얼마나 나올지 명확하지 않다. 반면에 업무는 계획 대비 실적이 명확해야 한다. 내가 케어할 수 없는 업무영역에 대해서는 강하게 컷트해야 하는 상황도 있다. 난 지금까지 직장생활 중에 할 수 없다라는 말을 해본적이 잘 없는데, 앞으로는 점점 생길 것 같다. 일단 내가 가장 먼저 해야할 일은, 이게 끊어내야 하는 상황인지 아닌지를 판단하는 것이다. 일을 혼자 껴않고 있지 말고, 먼저 나눠줄 수 있는 것을 선별해서 떼어내는 작업을 먼저 하자. 많은 칭찬을 받는 것은 좋은 일이지만, 칭찬으로 인해 자만하거나 버릇이 없어지는 것을 우려하는 시각도 있다. 손님은 언제나 반갑게 맞이해주자. 끝.","link":"/2020/09/25/work_202009_4/"},{"title":"업무일지 2020년 09월 3주차","text":"2020년 9월 3주차 개인 업무일지이다. 언제 어떤 일들을 했는지 기억하기 위하여 남긴다. Schedule2020.09.14.월 시스템 아키텍처 내부회의 1차 (09:00 ~ 09:40) FHIR 환경 구축 가이드 작성 (HAPI-FHIR jpaserver 구성) 시스템 아키텍처 내부회의 2차 (14:00 ~ 15:00) 2020.09.15.화 FHIR 환경구축 가이드 작성 (Word 버전) FHIR 환경구축 가이드 초안 v0.1 내부 공유 2020.09.16.수 FHIR 로컬 클라이언트 환경 구축 FHIR 로컬환경 테스트 FHIR 환경구축 가이드 수정본 v0.2 내부 공유 FHIR 테스트 진행방안 회의 with jyh 2020.09.17.목 주간보고 내부 리뷰 FHIR 리소스 Create/Read/Update/Delete 패턴 분석 2020.09.18.금 UI/UX 표준가이드 검수 MySQL super_read_only 관련 서칭 HAPI-FHIR 신규버전 (5.2.0) 설치 및 테스트 FHIR 환경구축 가이드 보완 및 공유 잘한 점/개선사항/배운 점 협업 업무를 할때, 협업 파트너와 생각의 싱크를 계속 맞추는 것이 중요하다. 생각의 싱크를 맞추지 않고 내 생각대로만 밀고 나가면, 상대방은 내 이해력이 부족하거나 혹은 독단적인 스타일이라고 판단할 수 있다. 그리고 생각의 싱크는 반드시 대화와 자료를 통해서 맞추어져야 한다. 내가 무슨 일을 어떻게 하고 있는지 주변 사람들이 알 수 있도록 계속해서 공유하는 것이 좋다. 이것도 일종의 생각의 싱크를 맞추는 작업이라고 볼 수 있다. 공유는 입으로만 하지 말고 반드시 자료/결과물과 함께 이야기하는 것이 좋다. 사소하더라도 동료에게 좋은 일(긍정적인 변화)이 생겼다면, 주변 사람들에게 공유하고 축하받을 수 있도록 하자. (시험 합격, 가족행사 등) 화면설계에 들어가기 전에 앞서, 업무 프로세스부터 정의하고 시작하는 것이 좋다. 업무 프로세스를 정의하지 않으면 추후 화면설계가 뒤틀릴 가능성이 높다. (즉, 프로세스가 잡히지 않았는데 화면이 먼저 나오는 것은 순서가 맞지 않다) 고객이 프로세스를 잡지 않았다면, 먼저 잡고 갈 수 있도록 리딩해줄 필요가 있다. 뭔가에 대한 피드백을 꼭 원하면, 전체메일로 보내지말고 특정인을 지정해서 보내는 것이 좋다. 전체공지처럼 보내면, 담당자가 불분명하고 책임소지가 분산되기 때문에 아무도 회신이 오지 않을 가능성이 높다. (반대로, 아무도 회신이 오지 않고 조용히 넘어가기를 바란다면 전체공지를 하는 것이 오히려 전략적인 방법일 수 있다) 끝.","link":"/2020/09/18/work_202009_3/"},{"title":"업무일지 2020년 09월 5주차 (10월 1주차)","text":"2020년 9월 5주차 (10월 1주차) 개인 업무일지이다. 언제 어떤 일들을 했는지 기억하기 위하여 남긴다. Schedule금주는 추석연휴(09.30~10.02)로 인해 Working Day가 2일이다. 2020.09.28.월 각종 본사 행정 업무 (경비처리, 동료평가 등) HAPI FHIR 테스트페이지 사용법 가이드 작성 Resource 설명서 작성 (Resource, Extension, Profile) 2020.09.29.화 FHIR To-Do 점검 및 진행방안 재확정 회의 (09:00 ~ 10:00) Resource 설명서 작성 (Operation) - 완료 FHIR Client CRUD 예제 작성 - 완료 잘한 점/개선사항/배운 점 소프트웨어 버전은 처음부터 신중하게 선택해야 한다. 고객사의 정책이 어떤지, 함께 납품하는 시스템들은 어떤 버전을 사용하는지 등등. 끝.","link":"/2020/09/29/work_202009_5/"},{"title":"업무일지 2020년 10월 2주차","text":"2020년 10월 2주차 개인 업무일지이다. 언제 어떤 일들을 했는지 기억하기 위하여 남긴다. Schedule2020.10.05.월 FHIR 소프트웨어 버전 변경 검토 (OpenJDK 14 -&gt; 1.8 / Tomcat 8.5 -&gt; 9) FHIR 환경구축 가이드 수정 (변경된 소프트웨어 버전 반영) Linux에서 HAPI-FHIR JPA 서버 기동 테스트 2020.10.06.화 테스트계획서 보완 (연계테스트 시나리오 구체화) FHIR 단위테스트 수행 2020.10.07.수 FHIR 단위테스트 수행 및 테스트케이스(결과서) 작성 시나리오 테스트 계획 - Sample 데이터 확보 2020.10.08.목 운영자메뉴얼 최종 보완하여 공유 - Linux 기동 방법 추가, 오타 검수 시나리오 테스트 계획 수립 (오후에 공유하기) 2020.10.09.금한글날(휴일) 잘한 점/개선사항/배운 점 일을 시작하기 전에, 한번에 끝낼 수 있는 방법을 생각해야 한다. 두번 작업해야 하는 일은 문제가 있는 것이다. 도움은 반드시 상대방이 필요할 때 주어야 한다. 그래도 굳이 도움을 주고 싶다면, 내가 도울 일이 없을지를 상대방에게 물어보는게 좋다. 내 생각을 이야기할 때는 쉽사리 결론이나 의사결정을 단정짓지 않는 것이 좋다. 의사결정은 의사결정권자(관리자)의 몫이니 내 권한을 넘지 않도록 조심하는게 좋다. 일을 할 때는 가급적이면 몰래몰래 하는 것보다, (1) 눈에 보이게 (2) 예상 가능하게 하는 것이 좋다. 잘하고 싶다고 해서 혼자 너무 멀리 앞서나가고 있는 것은 아닌지를 경계해야 한다. 예상 가능한 범위 안에서 움직이되, 가능하다면 딱 10% 정도의 초과 아웃풋이 나오는 수준을 제시하자. 끝.","link":"/2020/10/09/work_202010_2/"},{"title":"업무일지 2020년 10월 3주차","text":"2020년 10월 3주차 개인 업무일지이다. 언제 어떤 일들을 했는지 기억하기 위하여 남긴다. Schedule2020.10.12.월 시나리오 테스트 데이터 확보 2020.10.13.화연차(대장내시경 검진) 2020.10.14.수 FHIR 진행상황 메일 전체 공유 (PM님, PL님 등) FHIR 테스트수행 및 결과서 작성 2020.10.15.목 FHIR 테스트수행 및 결과서 작성 FHIR 시스템 Demo 시연회 준비 2020.10.16.금 FHIR 시스템 Demo 시연회 준비 및 진행 시연회 후 피드백 정리 잘한 점/개선사항/배운 점 일을 잘하지는 못하더라도, 못한다는 소리를 듣지 않는 방법은 명확하다. 자신에게 10만큼 주어진 일을 10만큼 정확하게 해내는 것이다. 10을 주어주고 100의 결과물을 강요하는 관리자는 없기 때문이다. 그러나, 문제는 10이라는 일을 똑바로 해놓지 않고 그 밖의 일을 여기저기 찌르는 사람이 꼭 있다는 것이다. 혹시 내가 그렇지는 않은지 간간이 되돌아볼 필요가 있다. 어떤 발표나 교육이든 내가 남 앞에 설 수 있는 자리라면 있는 힘껏 최선을 다해 준비해야 한다. 내 능력을 온전히 내 마음껏 증명할 수 있는 기회이기 때문이다. 끝.","link":"/2020/10/16/work_202010_3/"},{"title":"주사실환자목록 소스코드","text":"개요화면설명 화면명: 주사실환자목록 설명: 동관/신관/소아/소아항암 주사실의 환자 목록을 조회하는 화면 활용기술 Client: C# Visual Studio, DevExpress Server: Java Spring, SQL DB: Oracle 공수 개발기간: 약 3개월 전체 소스코드 분량: 약 3,500 line 이미지 Client12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576777879808182838485868788899091929394959697989910010110210310410510610710810911011111211311411511611711811912012112212312412512612712812913013113213313413513613713813914014114214314414514614714814915015115215315415515615715815916016116216316416516616716816917017117217317417517617717817918018118218318418518618718818919019119219319419519619719819920020120220320420520620720820921021121221321421521621721821922022122222322422522622722822923023123223323423523623723823924024124224324424524624724824925025125225325425525625725825926026126226326426526626726826927027127227327427527627727827928028128228328428528628728828929029129229329429529629729829930030130230330430530630730830931031131231331431531631731831932032132232332432532632732832933033133233333433533633733833934034134234334434534634734834935035135235335435535635735835936036136236336436536636736836937037137237337437537637737837938038138238338438538638738838939039139239339439539639739839940040140240340440540640740840941041141241341441541641741841942042142242342442542642742842943043143243343443543643743843944044144244344444544644744844945045145245345445545645745845946046146246346446546646746846947047147247347447547647747847948048148248348448548648748848949049149249349449549649749849950050150250350450550650750850951051151251351451551651751851952052152252352452552652752852953053153253353453553653753853954054154254354454554654754854955055155255355455555655755855956056156256356456556656756856957057157257357457557657757857958058158258358458558658758858959059159259359459559659759859960060160260360460560660760860961061161261361461561661761861962062162262362462562662762862963063163263363463563663763863964064164264364464564664764864965065165265365465565665765865966066166266366466566666766866967067167267367467567667767867968068168268368468568668768868969069169269369469569669769869970070170270370470570670770870971071171271371471571671771871972072172272372472572672772872973073173273373473573673773873974074174274374474574674774874975075175275375475575675775875976076176276376476576676776876977077177277377477577677777877978078178278378478578678778878979079179279379479579679779879980080180280380480580680780880981081181281381481581681781881982082182282382482582682782882983083183283383483583683783883984084184284384484584684784884985085185285385485585685785885986086186286386486586686786886987087187287387487587687787887988088188288388488588688788888989089189289389489589689789889990090190290390490590690790890991091191291391491591691791891992092192292392492592692792892993093193293393493593693793893994094194294394494594694794894995095195295395495595695795895996096196296396496596696796896997097197297397497597697797897998098198298398498598698798898999099199299399499599699799899910001001100210031004100510061007100810091010101110121013101410151016101710181019102010211022102310241025102610271028102910301031103210331034103510361037103810391040104110421043104410451046104710481049105010511052105310541055105610571058105910601061106210631064106510661067106810691070107110721073107410751076107710781079108010811082108310841085108610871088108910901091109210931094109510961097109810991100110111021103110411051106110711081109111011111112111311141115111611171118111911201121112211231124112511261127112811291130113111321133113411351136113711381139114011411142114311441145114611471148114911501151115211531154115511561157115811591160116111621163116411651166116711681169117011711172117311741175117611771178117911801181118211831184118511861187118811891190119111921193119411951196119711981199120012011202120312041205120612071208120912101211121212131214121512161217121812191220122112221223122412251226122712281229123012311232123312341235123612371238123912401241124212431244124512461247124812491250125112521253125412551256125712581259126012611262126312641265126612671268126912701271127212731274127512761277127812791280128112821283128412851286128712881289129012911292129312941295129612971298129913001301130213031304130513061307130813091310131113121313131413151316131713181319132013211322132313241325132613271328132913301331133213331334133513361337133813391340134113421343134413451346134713481349135013511352135313541355135613571358135913601361136213631364136513661367136813691370137113721373137413751376137713781379138013811382138313841385138613871388138913901391139213931394139513961397139813991400140114021403140414051406140714081409141014111412141314141415141614171418141914201421142214231424142514261427142814291430143114321433143414351436143714381439144014411442144314441445144614471448144914501451145214531454145514561457145814591460146114621463146414651466146714681469147014711472147314741475147614771478147914801481148214831484148514861487148814891490149114921493149414951496149714981499150015011502150315041505150615071508150915101511151215131514151515161517151815191520152115221523152415251526152715281529153015311532153315341535153615371538153915401541154215431544154515461547154815491550155115521553155415551556155715581559156015611562156315641565156615671568156915701571157215731574157515761577157815791580158115821583158415851586158715881589159015911592159315941595159615971598159916001601160216031604160516061607160816091610161116121613161416151616161716181619162016211622162316241625162616271628162916301631163216331634163516361637163816391640164116421643164416451646164716481649165016511652165316541655165616571658165916601661166216631664166516661667166816691670167116721673167416751676167716781679168016811682168316841685168616871688168916901691169216931694169516961697169816991700170117021703170417051706170717081709171017111712171317141715171617171718171917201721172217231724172517261727172817291730173117321733173417351736173717381739174017411742174317441745174617471748174917501751175217531754175517561757175817591760176117621763176417651766176717681769177017711772177317741775177617771778177917801781178217831784178517861787178817891790179117921793179417951796179717981799180018011802180318041805180618071808180918101811181218131814181518161817181818191820182118221823182418251826182718281829183018311832183318341835183618371838183918401841184218431844184518461847184818491850185118521853185418551856185718581859186018611862186318641865186618671868186918701871187218731874187518761877187818791880188118821883188418851886188718881889189018911892189318941895189618971898189919001901190219031904190519061907190819091910191119121913191419151916191719181919192019211922192319241925192619271928192919301931193219331934193519361937193819391940194119421943194419451946194719481949195019511952195319541955195619571958195919601961196219631964196519661967196819691970197119721973197419751976197719781979198019811982198319841985198619871988198919901991199219931994199519961997199819992000200120022003200420052006200720082009201020112012201320142015201620172018201920202021202220232024202520262027202820292030203120322033203420352036203720382039204020412042204320442045204620472048204920502051205220532054205520562057205820592060206120622063206420652066206720682069207020712072207320742075207620772078207920802081208220832084208520862087208820892090209120922093209420952096209720982099210021012102210321042105210621072108210921102111211221132114211521162117211821192120212121222123212421252126212721282129213021312132213321342135213621372138213921402141214221432144214521462147214821492150215121522153215421552156215721582159216021612162216321642165216621672168216921702171217221732174217521762177217821792180218121822183218421852186218721882189219021912192219321942195219621972198219922002201220222032204220522062207220822092210221122122213221422152216221722182219222022212222222322242225222622272228222922302231223222332234223522362237223822392240224122422243224422452246224722482249225022512252225322542255225622572258225922602261226222632264226522662267226822692270227122722273227422752276227722782279228022812282228322842285228622872288228922902291229222932294229522962297229822992300230123022303230423052306230723082309231023112312231323142315231623172318231923202321232223232324232523262327232823292330233123322333233423352336233723382339234023412342234323442345234623472348234923502351235223532354235523562357235823592360236123622363236423652366236723682369237023712372237323742375237623772378237923802381238223832384238523862387238823892390239123922393239423952396239723982399240024012402240324042405240624072408240924102411241224132414241524162417241824192420242124222423242424252426242724282429243024312432243324342435243624372438243924402441244224432444244524462447244824492450245124522453245424552456245724582459246024612462246324642465246624672468246924702471247224732474247524762477247824792480248124822483248424852486248724882489249024912492249324942495249624972498249925002501250225032504250525062507250825092510251125122513251425152516251725182519252025212522252325242525252625272528252925302531253225332534253525362537253825392540254125422543254425452546254725482549255025512552255325542555255625572558255925602561256225632564256525662567256825692570257125722573257425752576257725782579258025812582258325842585258625872588258925902591259225932594259525962597259825992600260126022603260426052606260726082609261026112612261326142615261626172618261926202621262226232624262526262627262826292630263126322633263426352636263726382639264026412642264326442645264626472648264926502651265226532654265526562657265826592660266126622663266426652666266726682669267026712672267326742675267626772678267926802681268226832684268526862687268826892690269126922693269426952696269726982699270027012702270327042705270627072708270927102711271227132714271527162717271827192720272127222723272427252726272727282729using AMIS3.UIFramework;using AMIS3.UIFramework.DataModel;using AMIS3.UIFramework.FxExtension;using AMIS3.UIFramework.UI;using System;using System.Collections.Generic;using System.Data;using System.Drawing;using AMIS3.MC.NR.ZZLIB002;using AMIS3.ZZ.ZZ.ZZ.Common.Helpers;using DevExpress.XtraGrid.Views.Grid;using System.Windows.Forms;using AMIS3.ZZ.ZZ.ZZ.Common.Message;using System.Threading.Tasks;using System.Linq;namespace AMIS3.MC.NR.PM327{ public partial class VMCNRPM327S : ScreenBase, ISmartToolbar { #region ========================= [ 변수 선언 ] ========================== /// &lt;summary&gt; /// 액션버튼 아이템 /// &lt;/summary&gt; public List&lt;ActionButtonItem&gt; ActionButtonItems { get; set; } /// &lt;summary&gt; /// 주사실대기상태코드 조회테이블 /// &lt;/summary&gt; private DataTable dtIrWaitStatCd = new DataTable(); /// &lt;summary&gt; /// 외래주사실 수행일자별 수행대상 목록 보관용 DataTable /// &lt;/summary&gt; private DataTable _dtList = new DataTable(); /// &lt;summary&gt; /// 재원시간 저장용 DataTable /// &lt;/summary&gt; private DataTable dtSaveIrStayTmc = new DataTable(); /// &lt;summary&gt; /// 환자진료정보 /// &lt;/summary&gt; private PatMdexInfo patInfo = new PatMdexInfo(); DataTable dtPwsn = new DataTable(); #endregion =============================================================== #region ========================== [ 초 기 화 ] ========================== /// &lt;summary&gt; /// 컴포넌트 초기화 /// &lt;/summary&gt; public VMCNRPM327S() { InitializeComponent(); keyHelper.Add(new KeyCommand(Keys.Alt | Keys.D1, (s, ee) =&gt; { OnOpenVMCNRAM017S(); })); // 팝업 호출 } /// &lt;summary&gt; /// OnLoad Event /// &lt;/summary&gt; /// &lt;param name=&quot;e&quot;&gt;&lt;/param&gt; protected override void OnLoad(EventArgs e) { base.OnLoad(e); switch (SecurityService.WorkLocCd) { case &quot;10601&quot;: rdoOrdrPformLocCd.EditValue = &quot;OPIV&quot;; break; // 동관주사실 case &quot;22439&quot;: rdoOrdrPformLocCd.EditValue = &quot;OPIV3&quot;; break; // 신관주사실 case &quot;22372&quot;: rdoOrdrPformLocCd.EditValue = &quot;PEDIV&quot;; break; // 소아주사실 case &quot;22377&quot;: rdoOrdrPformLocCd.EditValue = &quot;PIVC&quot;; break; // 소아항암주사실 } dtIrWaitStatCd = CodeHelper.GetCommonCode(&quot;NR0165&quot;); rdoDiv.EditValue = &quot;DT&quot;; flwpnlPformTrgetListByPformDt.Visible = true; flwpnlPformTrgetListByPat.Visible = false; lblSubTitle.Text = &quot;수행일자별 수행대상 목록&quot;; grdList.MainView = gvListByDt; dtpPform.EditValue = DateTime.Now.ToString(&quot;yyyy-MM-dd&quot;); dtpOrdrDirectDt.FromDateTime = DateTime.Now; dtpOrdrDirectDt.ToDateTime = DateTime.Now; gvListByDt.SetIndicateNumber(45); gvListByPat.SetIndicateNumber(30); InitializeControls(); InitializeActionButtons(); InitializeDtSaveIrStayTmc(); InitializeGridColumn(); rdoPformDiv.Visible = true; btnSearch_Click(null, null); } /// &lt;summary&gt; /// OnShown Event /// &lt;/summary&gt; /// &lt;param name=&quot;e&quot;&gt;&lt;/param&gt; protected override void OnShown(EventArgs e) { base.OnShown(e); if (base.MainPatient != null) { patInfo.SelectedPatInfo[(int)SelectedPatInfo.PATNO] = base.MainPatient.patno; patInfo.SelectedPatInfo[(int)SelectedPatInfo.VIST_SN] = base.MainPatient.vistSn.ToStringDefault(&quot;&quot;); } } /// &lt;summary&gt; /// 콘트롤 초기화 /// &lt;/summary&gt; private void InitializeControls() { if (grdList.DataSource != null) (grdList.DataSource as DataTable).Rows.Clear(); if (patInfo == null) patInfo = new PatMdexInfo(); } /// &lt;summary&gt; /// 액션버튼 초기화 /// &lt;/summary&gt; private void InitializeActionButtons() { int idx = 0; if (rdoDiv.EditValue.ToStringDefault(&quot;&quot;) == &quot;DT&quot;) { ActionButtonItems = new List&lt;ActionButtonItem&gt;(); if (rdoOrdrPformLocCd.EditValue.ToStringDefault(&quot;&quot;) == &quot;PIVC&quot;) { ActionButtonItems.Add(new ActionButtonItem() { Text = &quot;저장&quot;, Idx = idx++, IsImportant = true, ClickAction = OnSave, Name = &quot;OnSave&quot;, Permissions = &quot;R&quot; }); ActionButtonItems.Add(new ActionButtonItem() { Text = &quot;통합검사결과조회&quot;, Idx = idx++, IsImportant = false, ClickAction = OnOpenVSPSZZZ010S, Name = &quot;OnOpenVMCOOOD022S&quot;, Permissions = &quot;R&quot; }); } ActionButtonItems.Add(new ActionButtonItem() { Text = &quot;간호투약\\r\\n수행기록&quot;, Idx = idx++, IsImportant = false, ClickAction = OnOpenVMCNRDA003S, Name = &quot;actOpenVMCNRDA003S&quot;, Permissions = &quot;R&quot; }); ActionButtonItems.Add(new ActionButtonItem() { Text = &quot;오더\\r\\n전체보기&quot;, Idx = idx++, IsImportant = false, ClickAction = OnOpenVMCOOOD058S, Name = &quot;actOpenVMCOOOD058S&quot;, Permissions = &quot;R&quot; }); ActionButtonItems.Add(new ActionButtonItem() { Text = &quot;외래\\r\\n간호기록&quot;, Idx = idx++, IsImportant = false, ClickAction = OnOpenVMCMRNR035S, Name = &quot;actOpenVMCMRNR035S&quot;, Permissions = &quot;R&quot; }); ActionButtonItems.Add(new ActionButtonItem() { Text = &quot;기록조회&quot;, Idx = idx++, IsImportant = false, ClickAction = OnOpenVMCMRDR004S, Name = &quot;actOpenVMCOOOD058S&quot;, Permissions = &quot;R&quot; }); if (rdoOrdrPformLocCd.EditValue.ToStringDefault(&quot;&quot;) == &quot;PIVC&quot;) { ActionButtonItems.Add(new ActionButtonItem() { Text = &quot;암병원주사실 입퇴실기록&quot;, Idx = idx++, IsImportant = false, ClickAction = OnOpenVMCMRNR126S, Name = &quot;actOpenVMCMRNR126S&quot;, Permissions = &quot;R&quot; }); ActionButtonItems.Add(new ActionButtonItem() { Text = &quot;간호처방등록&quot;, Idx = idx++, IsImportant = false, ClickAction = OnOpenVMCOOOD022S, Name = &quot;OnOpenVMCOOOD022S&quot;, Permissions = &quot;R&quot; }); } ActionButtonItems.Add(new ActionButtonItem() { Text = &quot;수혈수행\\r\\n관리&quot;, Idx = idx++, IsImportant = false, ClickAction = OnOpenVMCNRDA004S, Name = &quot;actOpenVMCNRDA004S&quot;, Permissions = &quot;R&quot; }); ActionButtonItems.Add(new ActionButtonItem() { Text = &quot;낙상입력&quot;, Idx = idx++, IsImportant = false, ClickAction = OnOpenVMCMRNR116S, Name = &quot;actOpenVMCMRNR116S&quot;, Permissions = &quot;R&quot; }); ActionButtonItems.Add(new ActionButtonItem() { Text = &quot;신체계측&quot;, Idx = idx++, IsImportant = false, ClickAction = OnOpenVMCNRPM257S, Name = &quot;actOpenVMCNRPM257S&quot;, Permissions = &quot;R&quot; }); ActionButtonItems.Add(new ActionButtonItem() { Text = &quot;환자팔찌 및 환자바코드 출력&quot;, Idx = idx++, IsImportant = false, ClickAction = OnOpenVMCNRWS765S, Name = &quot;OnCallBandPatBarcode&quot;, Permissions = &quot;W&quot; }); ActionButtonItems.Add(new ActionButtonItem() { Text = &quot;투약카드&quot;, Idx = idx++, IsImportant = false, ClickAction = OnOpenVMCNRDA006S, Name = &quot;OnOpenVMCNRDA006S&quot;, Permissions = &quot;W&quot; }); if (rdoOrdrPformLocCd.EditValue.ToStringDefault(&quot;&quot;) == &quot;OPIV&quot;) { ActionButtonItems.Add(new ActionButtonItem() { Text = &quot;전광판 접수&quot;, Idx = idx++, IsImportant = false, ClickAction = OnNewRcep, Name = &quot;actRcep&quot;, Permissions = &quot;W&quot; }); ActionButtonItems.Add(new ActionButtonItem() { Text = &quot;외래주사실 조제관리&quot;, Idx = idx++, IsImportant = false, ClickAction = OnOpenVMCPHDS060S, Name = &quot;OnOpenVMCPHDS060S&quot;, Permissions = &quot;R&quot; }); } ActionButtonItems.Add(new ActionButtonItem() { Text = &quot;SMS문자전송(단일)-환자용&quot;, Idx = idx++, IsImportant = false, ClickAction = OnOpenVETSYMS005S_Patient, Name = &quot;OnOpenVETSYMS005S&quot;, Permissions = &quot;R&quot; }); ActionButtonItems.Add(new ActionButtonItem() { Text = &quot;SMS문자전송(단일)-직원용&quot;, Idx = idx++, IsImportant = false, ClickAction = OnOpenVETSYMS005S_Employee, Name = &quot;OnOpenVETSYMS005S&quot;, Permissions = &quot;R&quot; }); if (rdoOrdrPformLocCd.EditValue.ToStringDefault(&quot;&quot;) == &quot;PIVC&quot;) { ActionButtonItems.Add(new ActionButtonItem() { Text = &quot;시술Time\\r\\nOut기록지&quot;, Idx = idx++, IsImportant = false, ClickAction = OnOpenVSPSEEJ050S, Name = &quot;OnOpenVSPSEEJ050S&quot;, Permissions = &quot;R&quot; }); ActionButtonItems.Add(new ActionButtonItem() { Text = &quot;검체채혈\\r\\n-업무구분별&quot;, Idx = idx++, IsImportant = false, ClickAction = OnOpenVSPSSSP030S, Name = &quot;OnOpenVSPSSSP030S&quot;, Permissions = &quot;R&quot; }); } ActionButtonItems.Add(new ActionButtonItem() { Text = &quot;이송신청\\r\\n(환자별)&quot;, Idx = idx++, IsImportant = false, ClickAction = OnOpenVWAWPTF022S, Name = &quot;OnCallBandPatBarcode&quot;, Permissions = &quot;W&quot; }); ActionButtonItems.Add(new ActionButtonItem() { Text = &quot;주사실 처방코드 분류관리&quot;, Idx = idx++, IsImportant = false, ClickAction = OnManageCode, Name = &quot;OnManageCode&quot;, Permissions = &quot;W&quot; }); ActionButtonItems.Add(new ActionButtonItem() { Text = &quot;검사예약일자 가져오기&quot;, Idx = idx++, IsImportant = false, ClickAction = OnUpdateHopeDt, Name = &quot;OnCallBandPatBarcode&quot;, Permissions = &quot;W&quot; }); this.btnAction.Items = ActionButtonItems; btnAction.Visible = true; btnAction.FallDownMenuWidth = 162; DocumentService.ChangeActionButtons(this); } else { grdList.ContextMenuStrip = null; btnAction.Visible = false; DocumentService.ChangeActionButtons(this); } } /// &lt;summary&gt; /// 스마트위젯 셋팅 /// &lt;/summary&gt; /// &lt;param name=&quot;sender&quot;&gt;&lt;/param&gt; /// &lt;param name=&quot;e&quot;&gt;&lt;/param&gt; private void gvList_RowClick(object sender, DevExpress.XtraGrid.Views.Grid.RowClickEventArgs e) { if (e.Button == MouseButtons.Right) { ASmartWidget stwPopup = new ASmartWidget(this); if (rdoDiv.EditValue.ToStringDefault(&quot;&quot;) == &quot;DT&quot;) { if (rdoOrdrPformLocCd.EditValue.ToStringDefault(&quot;&quot;) == &quot;OPIV&quot;) { stwPopup.AddItem(ASmartWidget.ItemKind.Work, &quot;전광판 접수&quot;, null, null, () =&gt; OnNewRcep()); stwPopup.AddItem(ASmartWidget.ItemKind.Work, &quot;환자팔찌 및 환자바코드 출력&quot;, null, null, () =&gt; OnOpenVMCNRWS765S()); stwPopup.AddItem(ASmartWidget.ItemKind.Work, &quot;투약카드 출력&quot;, null, null, () =&gt; OnMdctCardPrint()); stwPopup.AddItem(ASmartWidget.ItemKind.Work, &quot;외래주사실 조제관리&quot;, null, null, () =&gt; OnOpenVMCPHDS060S()); stwPopup.AddItem(ASmartWidget.ItemKind.Work, &quot;오더전체보기&quot;, null, null, () =&gt; OnOpenVMCOOOD058S()); stwPopup.AddItem(ASmartWidget.ItemKind.Work, &quot;간호투약수행기록&quot;, null, null, () =&gt; OnOpenVMCNRDA003S()); stwPopup.AddItem(ASmartWidget.ItemKind.Work, &quot;외래간호기록&quot;, null, null, () =&gt; OnOpenVMCMRNR035S()); stwPopup.AddItem(ASmartWidget.ItemKind.Work, &quot;기록조회&quot;, null, null, () =&gt; OnOpenVMCMRDR004S()); stwPopup.AddItem(ASmartWidget.ItemKind.Work, &quot;수혈수행관리&quot;, null, null, () =&gt; OnOpenVMCNRDA004S()); stwPopup.AddItem(ASmartWidget.ItemKind.Work, &quot;낙상입력&quot;, null, null, () =&gt; OnOpenVMCMRNR116S()); stwPopup.AddItem(ASmartWidget.ItemKind.Work, &quot;신체계측&quot;, null, null, () =&gt; OnOpenVMCNRPM257S()); stwPopup.AddItem(ASmartWidget.ItemKind.Work, &quot;SMS문자전송(단일)-환자용&quot;, null, null, () =&gt; OnOpenVETSYMS005S_Patient()); stwPopup.AddItem(ASmartWidget.ItemKind.Work, &quot;SMS문자전송(단일)-직원용&quot;, null, null, () =&gt; OnOpenVETSYMS005S_Employee()); stwPopup.AddItem(ASmartWidget.ItemKind.Work, &quot;이송신청(환자별)&quot;, null, null, () =&gt; OnOpenVWAWPTF022S()); } else { if (rdoOrdrPformLocCd.EditValue.ToStringDefault(&quot;&quot;) == &quot;PIVC&quot;) { stwPopup.AddItem(ASmartWidget.ItemKind.Work, &quot;저장&quot;, null, null, () =&gt; OnSave()); stwPopup.AddItem(ASmartWidget.ItemKind.Work, &quot;통합검사결과조회&quot;, null, null, () =&gt; OnOpenVSPSZZZ010S()); } stwPopup.AddItem(ASmartWidget.ItemKind.Work, &quot;간호투약수행기록&quot;, null, null, () =&gt; OnOpenVMCNRDA003S()); stwPopup.AddItem(ASmartWidget.ItemKind.Work, &quot;오더전체보기&quot;, null, null, () =&gt; OnOpenVMCOOOD058S()); stwPopup.AddItem(ASmartWidget.ItemKind.Work, &quot;외래간호기록&quot;, null, null, () =&gt; OnOpenVMCMRNR035S()); stwPopup.AddItem(ASmartWidget.ItemKind.Work, &quot;기록조회&quot;, null, null, () =&gt; OnOpenVMCMRDR004S()); if (rdoOrdrPformLocCd.EditValue.ToStringDefault(&quot;&quot;) == &quot;PIVC&quot;) { stwPopup.AddItem(ASmartWidget.ItemKind.Work, &quot;암병원주사실 입퇴실기록&quot;, null, null, () =&gt; OnOpenVMCMRNR126S()); stwPopup.AddItem(ASmartWidget.ItemKind.Work, &quot;간호처방등록&quot;, null, null, () =&gt; OnOpenVMCOOOD022S()); } stwPopup.AddItem(ASmartWidget.ItemKind.Work, &quot;수혈수행관리&quot;, null, null, () =&gt; OnOpenVMCNRDA004S()); stwPopup.AddItem(ASmartWidget.ItemKind.Work, &quot;낙상입력&quot;, null, null, () =&gt; OnOpenVMCMRNR116S()); stwPopup.AddItem(ASmartWidget.ItemKind.Work, &quot;신체계측&quot;, null, null, () =&gt; OnOpenVMCNRPM257S()); stwPopup.AddItem(ASmartWidget.ItemKind.Work, &quot;환자팔찌 및 환자바코드 출력&quot;, null, null, () =&gt; OnOpenVMCNRWS765S()); stwPopup.AddItem(ASmartWidget.ItemKind.Work, &quot;투약카드 출력&quot;, null, null, () =&gt; OnMdctCardPrint()); stwPopup.AddItem(ASmartWidget.ItemKind.Work, &quot;SMS문자전송(단일)-환자용&quot;, null, null, () =&gt; OnOpenVETSYMS005S_Patient()); stwPopup.AddItem(ASmartWidget.ItemKind.Work, &quot;SMS문자전송(단일)-직원용&quot;, null, null, () =&gt; OnOpenVETSYMS005S_Employee()); if (rdoOrdrPformLocCd.EditValue.ToStringDefault(&quot;&quot;) == &quot;PIVC&quot;) { stwPopup.AddItem(ASmartWidget.ItemKind.Work, &quot;시술TimeOut기록지&quot;, null, null, () =&gt; OnOpenVSPSEEJ050S()); stwPopup.AddItem(ASmartWidget.ItemKind.Work, &quot;검체채혈-업무구분별&quot;, null, null, () =&gt; OnOpenVSPSSSP030S()); } stwPopup.AddItem(ASmartWidget.ItemKind.Work, &quot;이송신청(환자별)&quot;, null, null, () =&gt; OnOpenVWAWPTF022S()); } stwPopup.Show(this); } } } /// &lt;summary&gt; /// 그리드컬럼 초기화 /// &lt;/summary&gt; private void InitializeGridColumn() { if (rdoOrdrPformLocCd.EditValue.ToStringDefault(&quot;&quot;) == &quot;OPIV&quot;) // 동관 { colpatno.VisibleIndex = 0; // 병원등록번호 colpatNm.VisibleIndex = 1; // 환자성명 colOrdrRefndExscYn.VisibleIndex = 2; // 환불 colirTaskNm.VisibleIndex = 3; // 환자구분 colirWaitStatNm.VisibleIndex = 4; // 대기상태 colfldwRegYn.VisibleIndex = 5; // 낙상 colageCnte.VisibleIndex = 6; // 나이 colsexDivNm.VisibleIndex = 7; // 성별 colmddpCd.VisibleIndex = 8; // 진료과 colAtnnNm.VisibleIndex = 9; // 진료의성명 colrcivDtm.VisibleIndex = 10; // 수납일시 colIrOrdrDt.VisibleIndex = 11; // 처방일자 colPatBirthdt.VisibleIndex = 12; // 생년월일 colInhospDiagEngNm.VisibleIndex = 13; // 진단명 colpatno.Visible = true; // 병원등록번호 colpatNm.Visible = true; // 환자성명 colirTaskNm.Visible = true; // 환자구분 colirWaitStatNm.Visible = true; // 대기상태 colfldwRegYn.Visible = true; // 낙상 colageCnte.Visible = true; // 나이 colsexDivNm.Visible = true; // 성별 colmddpCd.Visible = true; // 진료과 colAtnnNm.Visible = true; // 진료의성명 colrcivDtm.Visible = true; // 수납일시 colIrOrdrDt.Visible = true; // 처방일자 colPatBirthdt.Visible = true; // 생년월일 colInhospDiagEngNm.Visible = true; // 진단명 colOrdrRefndExscYn.Visible = true; // 환불 colaboRhBlty.Visible = false; // 혈액형 colChildAntnIrStayTmc.Visible = false; // 재원시간 colchildAntnIrEroomTm.Visible = false; // 입실시간 colchildAntnIrLrTm.Visible = false; // 퇴실시간 colBldtrOrdrYn.Visible = false; // 수혈처방여부 colHlinOrdrYn.Visible = false; // 행위처방여부 colIsAndrYn.Visible = false; // 항암제처방여부 colFtrOrdrYn.Visible = false; // 미래처방 여부 colpwsnYn.Visible = false; // 동명 colDnrYnMark.Visible = false; // DNR여부 colpatNm.Width = 55; colInhospDiagEngNm.Width = 218; // 진단명 colInhospDiagEngNm.MinWidth = 218; // 진단명 } else if (rdoOrdrPformLocCd.EditValue.ToStringDefault(&quot;&quot;) == &quot;PIVC&quot;) // 소아항암 { colpatno.VisibleIndex = 0; // 병원등록번호 colfldwRegYn.VisibleIndex = 1; // 낙상 colpatNm.VisibleIndex = 2; // 환자성명 colOrdrRefndExscYn.VisibleIndex = 3; // 환불 colAtnnNm.VisibleIndex = 4; // 진료의성명 (원래 뒤쪽에 있었는데 앞쪽으로 옮겨달라고 요청받음 by 윤혜영샘 2019.04.04) colPatBirthdt.VisibleIndex = 5; // 생년월일 colageCnte.VisibleIndex = 6; // 나이 colsexDivNm.VisibleIndex = 7; // 성별 colaboRhBlty.VisibleIndex = 8; // 혈액형 colFtrOrdrYn.VisibleIndex = 9; colIsAndrYn.VisibleIndex = 10; // 항암제 처방여부 colChildAntnIrStayTmc.VisibleIndex = 11; // 재원시간 colchildAntnIrEroomTm.VisibleIndex = 12; // 입실시간 colchildAntnIrLrTm.VisibleIndex = 13; // 퇴실시간 colInhospDiagEngNm.VisibleIndex = 14; // 진단명 colmddpCd.VisibleIndex = 15; // 진료과 colrcivDtm.VisibleIndex = 16; // 수납일시 colIrOrdrDt.VisibleIndex = 17; // 처방일자 colDnrYnMark.VisibleIndex = 18; // DNR여부 colpatno.Visible = true; // 병원등록번호 colfldwRegYn.Visible = true; // 낙상 colpatNm.Visible = true; // 환자성명 colageCnte.Visible = true; // 나이 colsexDivNm.Visible = true; // 성별 colaboRhBlty.Visible = true; // 혈액형 colmddpCd.Visible = true; // 진료과 colAtnnNm.Visible = true; // 진료의성명 colrcivDtm.Visible = true; // 수납일시 colIrOrdrDt.Visible = true; // 처방일자 colPatBirthdt.Visible = true; // 생년월일 colInhospDiagEngNm.Visible = true; // 진단명 colIsAndrYn.Visible = true; // 항암제처방여부 colChildAntnIrStayTmc.Visible = true; // 재원시간 colchildAntnIrEroomTm.Visible = true; // 입실시간 colchildAntnIrLrTm.Visible = true; // 퇴실시간 colFtrOrdrYn.Visible = true; // 미래처방 여부 colDnrYnMark.Visible = true; // DNR여부 colOrdrRefndExscYn.Visible = true; // 환불 colChildAntnIrStayTmc.ColumnEdit = repCmbStayTmc; colirTaskNm.Visible = false; // 환자구분 colirWaitStatNm.Visible = false; // 대기상태 colpwsnYn.Visible = false; // 동명 colBldtrOrdrYn.Visible = false; // 수혈처방여부 colHlinOrdrYn.Visible = false; // 행위처방여부 colpatNm.Width = 55; colInhospDiagEngNm.Width = 218; // 진단명 colInhospDiagEngNm.MinWidth = 218; // 진단명 } else if(rdoOrdrPformLocCd.EditValue.ToStringDefault(&quot;&quot;) == &quot;OPIV3&quot;) // 신관 { colpatno.VisibleIndex = 0; // 병원등록번호 colpatNm.VisibleIndex = 1; // 환자성명 colOrdrRefndExscYn.VisibleIndex = 2; // 환불 colfldwRegYn.VisibleIndex = 3; // 낙상 colageCnte.VisibleIndex = 4; // 나이 colsexDivNm.VisibleIndex = 5; // 성별 colmddpCd.VisibleIndex = 6; // 진료과 colAtnnNm.VisibleIndex = 7; // 진료의성명 colrcivDtm.VisibleIndex = 8; // 수납일시 colIrOrdrDt.VisibleIndex = 9; // 처방일자 colPatBirthdt.VisibleIndex = 10; // 생년월일 colInhospDiagEngNm.VisibleIndex = 11; // 진단명 colpatno.Visible = true; // 병원등록번호 colpatNm.Visible = true; // 환자성명 colfldwRegYn.Visible = true; // 낙상 colageCnte.Visible = true; // 나이 colsexDivNm.Visible = true; // 성별 colmddpCd.Visible = true; // 진료과 colAtnnNm.Visible = true; // 진료의성명 colrcivDtm.Visible = true; // 수납일시 colIrOrdrDt.Visible = true; // 처방일자 colPatBirthdt.Visible = true; // 생년월일 colInhospDiagEngNm.Visible = true; // 진단명 colOrdrRefndExscYn.Visible = true; // 환불 colirTaskNm.Visible = false; // 환자구분 colirWaitStatNm.Visible = false; // 대기상태 colaboRhBlty.Visible = false; // 혈액형 colChildAntnIrStayTmc.Visible = false; // 재원시간 colchildAntnIrEroomTm.Visible = false; // 입실시간 colchildAntnIrLrTm.Visible = false; // 퇴실시간 colBldtrOrdrYn.Visible = false; // 수혈처방여부 colHlinOrdrYn.Visible = false; // 행위처방여부 colIsAndrYn.Visible = false; // 항암제처방여부 colFtrOrdrYn.Visible = false; // 미래처방 여부 colpwsnYn.Visible = false; // 동명 colDnrYnMark.Visible = false; // DNR여부 colpatNm.Width = 55; colInhospDiagEngNm.Width = 300; // 진단명 colInhospDiagEngNm.MinWidth = 300; // 진단명 } else if(rdoOrdrPformLocCd.EditValue.ToStringDefault(&quot;&quot;) == &quot;PEDIV&quot;) // 소아 { colpatno.VisibleIndex = 0; // 병원등록번호 colpatNm.VisibleIndex = 1; // 환자성명 colOrdrRefndExscYn.VisibleIndex = 2; // 환불 colfldwRegYn.VisibleIndex = 3; // 낙상 colageCnte.VisibleIndex = 4; // 나이 colsexDivNm.VisibleIndex = 5; // 성별 colmddpCd.VisibleIndex = 6; // 진료과 colAtnnNm.VisibleIndex = 7; // 진료의성명 colrcivDtm.VisibleIndex = 8; // 수납일시 colIrOrdrDt.VisibleIndex = 9; // 처방일자 colPatBirthdt.VisibleIndex = 10; // 생년월일 colInhospDiagEngNm.VisibleIndex = 11; // 진단명 colpatno.Visible = true; // 병원등록번호 colpatNm.Visible = true; // 환자성명 colfldwRegYn.Visible = true; // 낙상 colageCnte.Visible = true; // 나이 colsexDivNm.Visible = true; // 성별 colmddpCd.Visible = true; // 진료과 colAtnnNm.Visible = true; // 진료의성명 colrcivDtm.Visible = true; // 수납일시 colIrOrdrDt.Visible = true; // 처방일자 colPatBirthdt.Visible = true; // 생년월일 colInhospDiagEngNm.Visible = true; // 진단명 colOrdrRefndExscYn.Visible = true; // 환불 colirTaskNm.Visible = false; // 환자구분 colirWaitStatNm.Visible = false; // 대기상태 colaboRhBlty.Visible = false; // 혈액형 colChildAntnIrStayTmc.Visible = false; // 재원시간 colchildAntnIrEroomTm.Visible = false; // 입실시간 colchildAntnIrLrTm.Visible = false; // 퇴실시간 colBldtrOrdrYn.Visible = false; // 수혈처방여부 colHlinOrdrYn.Visible = false; // 행위처방여부 colIsAndrYn.Visible = false; // 항암제처방여부 colFtrOrdrYn.Visible = false; // 미래처방 여부 colpwsnYn.Visible = false; // 동명 colDnrYnMark.Visible = false; // DNR여부 colpatNm.Width = 75; // 소아주사실 colInhospDiagEngNm.Width = 300; // 진단명 colInhospDiagEngNm.MinWidth = 300; // 진단명 } else // 전체 { colirTaskNm.VisibleIndex = 0; // 환자구분 colirWaitStatNm.VisibleIndex = 2; // 대기상태 colfldwRegYn.VisibleIndex = 3; // 낙상 colpatno.VisibleIndex = 4; // 병원등록번호 colpatNm.VisibleIndex = 5; // 환자성명 colOrdrRefndExscYn.VisibleIndex = 6; // 환불 colageCnte.VisibleIndex = 6; // 나이 colsexDivNm.VisibleIndex = 7; // 성별 colmddpCd.VisibleIndex = 8; // 진료과 colAtnnNm.VisibleIndex = 9; // 진료의성명 colrcivDtm.VisibleIndex = 10; // 수납일시 colIrOrdrDt.VisibleIndex = 11; // 처방일자 colPatBirthdt.VisibleIndex = 12; // 생년월일 colInhospDiagEngNm.VisibleIndex = 13; // 진단명 colirTaskNm.Visible = true; // 환자구분 colirWaitStatNm.Visible = true; // 대기상태 colfldwRegYn.Visible = true; // 낙상 colpatno.Visible = true; // 병원등록번호 colpatNm.Visible = true; // 환자성명 colageCnte.Visible = true; // 나이 colsexDivNm.Visible = true; // 성별 colmddpCd.Visible = true; // 진료과 colAtnnNm.Visible = true; // 진료의성명 colrcivDtm.Visible = true; // 수납일시 colIrOrdrDt.Visible = true; // 처방일자 colPatBirthdt.Visible = true; // 생년월일 colInhospDiagEngNm.Visible = true; // 진단명 colOrdrRefndExscYn.Visible = true; // 환불 colaboRhBlty.Visible = false; // 혈액형 colChildAntnIrStayTmc.Visible = false; // 재원시간 colchildAntnIrEroomTm.Visible = false; // 입실시간 colchildAntnIrLrTm.Visible = false; // 퇴실시간 colBldtrOrdrYn.Visible = false; // 수혈처방여부 colHlinOrdrYn.Visible = false; // 행위처방여부 colIsAndrYn.Visible = false; // 항암제처방여부 colFtrOrdrYn.Visible = false; // 미래처방 여부 colDnrYnMark.Visible = false; colpwsnYn.Visible = false; // 동명 colpatNm.Width = 55; colInhospDiagEngNm.Width = 218; // 진단명 colInhospDiagEngNm.MinWidth = 218; // 진단명 } } /// &lt;summary&gt; /// 재원환자 데이터테이블 초기화 /// &lt;/summary&gt; private void InitializeDtSaveIrStayTmc() { dtSaveIrStayTmc.Columns.Add(&quot;ordrNo&quot;, typeof(string)); dtSaveIrStayTmc.Columns.Add(&quot;patno&quot;, typeof(string)); dtSaveIrStayTmc.Columns.Add(&quot;vistSn&quot;, typeof(string)); dtSaveIrStayTmc.Columns.Add(&quot;ordrDirectDt&quot;, typeof(string)); dtSaveIrStayTmc.Columns.Add(&quot;childAntnIrResvDt&quot;, typeof(string)); dtSaveIrStayTmc.Columns.Add(&quot;childAntnIrStayTmc&quot;, typeof(string)); dtSaveIrStayTmc.Columns.Add(&quot;childAntnIrResvTm&quot;, typeof(string)); dtSaveIrStayTmc.Columns.Add(&quot;bedCd&quot;, typeof(string)); dtSaveIrStayTmc.Columns.Add(&quot;mdctLocCd&quot;, typeof(string)); dtSaveIrStayTmc.Columns.Add(&quot;ordrTblDstgCd&quot;, typeof(string)); } #endregion =============================================================== #region ======================== [ 조회 / 저장 ] ========================= /// &lt;summary&gt; /// 조회 실행 /// &lt;/summary&gt; private async void OnSearchAction(Boolean bShowMsg) { InitializeControls(); if (rdoDiv.EditValue.ToStringDefault(&quot;&quot;) == &quot;DT&quot;) { updateHopeDt(false); Task irPatInfoForCheckPwsn = retrieveIrPatInfoForCheckPwsn(); // 1. 선택된 주사실의 당일 전체 환자를 조회한다. (동명이인 체크용) Task irPatInfoByDt = retrieveIrPatInfoByDt(); // 2. 선택된 주사실의 현재 조건에 걸린 환자를 조회한다. (동명이인 체크용) await Task.WhenAll(irPatInfoForCheckPwsn, irPatInfoByDt); // 3. 1번+2번이 모두 완료될 때까지 기다린다. DataTable dt = _dtList.Clone(); for (int i = 0; i &lt; _dtList.Rows.Count; i++) { DataRow drList = _dtList.Rows[i]; DataRow dr = null; if (drList[&quot;irTaskCdSeq&quot;].ToLong() == 1) // 환자의 수납일시별 등록된 처방이 여러건인경우 우선순위에 따라 처음1건만 표시 { dr = dt.NewRow(); dr[&quot;hopeDt&quot;] = drList[&quot;hopeDt&quot;].ToString(); // 희망일자 dr[&quot;pformDt&quot;] = drList[&quot;pformDt&quot;].ToString(); // 수행일자 dr[&quot;patno&quot;] = drList[&quot;patno&quot;].ToString(); // 등록번호 dr[&quot;vistSn&quot;] = drList[&quot;vistSn&quot;].ToLong(); // 방문일련번호 dr[&quot;rcivDtm&quot;] = drList[&quot;rcivDtm&quot;].ToString(); // 수납일시 dr[&quot;irOrdrDt&quot;] = drList[&quot;irOrdrDt&quot;].ToString(); // 처방일자 dr[&quot;patNm&quot;] = drList[&quot;patNm&quot;].ToString(); // 환자명 dr[&quot;patBirthdt&quot;] = drList[&quot;patBirthdt&quot;].ToString(); // 생년월일 dr[&quot;ageCnte&quot;] = drList[&quot;ageCnte&quot;].ToString(); // 나이 dr[&quot;sexDivNm&quot;] = drList[&quot;sexDivNm&quot;].ToString(); // 성별 dr[&quot;aboRhBlty&quot;] = drList[&quot;aboRhBlty&quot;].ToString(); // 혈액형 dr[&quot;mbphNo&quot;] = drList[&quot;mbphNo&quot;].ToString(); // 전화번호 dr[&quot;ordrPformLocCd&quot;] = drList[&quot;ordrPformLocCd&quot;].ToString(); // 처방수행장소 dr[&quot;fldwRegYn&quot;] = drList[&quot;fldwRegYn&quot;].ToString(); // 낙상등록여부 dr[&quot;inhospDiagEngNm&quot;] = drList[&quot;inhospDiagEngNm&quot;].ToString(); // 원내진단영문명 dr[&quot;mddpCd&quot;] = drList[&quot;mddpCd&quot;].ToString(); // 진료과코드 dr[&quot;atnnEmpno&quot;] = drList[&quot;atnnEmpno&quot;].ToString(); // 진료의사번 dr[&quot;atnnNm&quot;] = drList[&quot;atnnNm&quot;].ToString(); // 진료의성명 dr[&quot;bldtrOrdrYn&quot;] = drList[&quot;bldtrOrdrYn&quot;].ToString(); // 수혈처방여부 dr[&quot;hlinOrdrYn&quot;] = drList[&quot;hlinOrdrYn&quot;].ToString(); // 행위처방여부 dr[&quot;rcivBySn&quot;] = drList[&quot;rcivBySn&quot;].ToLong(); // 수납별일련번호 dr[&quot;sendLOrdrDelYn&quot;] = drList[&quot;sendLOrdrDelYn&quot;].ToString(); // 전송후처방삭제여부 dr[&quot;irWaitStatCd&quot;] = drList[&quot;irWaitStatCd&quot;].ToString(); // 주사실대기상태코드 dr[&quot;irWaitStatNm&quot;] = drList[&quot;irWaitStatNm&quot;].ToString(); // 주사실대기상태명 dr[&quot;pwsnYn&quot;] = drList[&quot;pwsnYn&quot;].ToString(); // 동명이인여부 dr[&quot;empDscntYn&quot;] = drList[&quot;empDscntYn&quot;].ToString(); // 직원할인여부 dr[&quot;childAntnIrEroomTm&quot;] = drList[&quot;childAntnIrEroomTm&quot;].ToString(); // 입실시각 dr[&quot;childAntnIrLrTm&quot;] = drList[&quot;childAntnIrLrTm&quot;].ToString(); // 퇴실시각 dr[&quot;childAntnIrStayTmc&quot;] = drList[&quot;childAntnIrStayTmc&quot;].ToString(); // 재실시각 dr[&quot;isAndrYn&quot;] = drList[&quot;isAndrYn&quot;].ToString(); // 항암제처방여부 dr[&quot;ftrOrdrYn&quot;] = drList[&quot;ftrOrdrYn&quot;].ToString(); // 미래처방여부 dr[&quot;irTaskNm&quot;] = drList[&quot;irTaskNm&quot;].ToString(); // 주사실업무명 dr[&quot;dnrYnMark&quot;] = drList[&quot;dnrYnMark&quot;].ToString(); // DNR여부 dr[&quot;ordrPformNo&quot;] = drList[&quot;ordrPformNo&quot;].ToString(); // 처방코드 dr[&quot;ordrRefndExscYn&quot;] = drList[&quot;ordrRefndExscYn&quot;].ToString(); // 처방환불존재여부 dr[&quot;irTaskCd&quot;] = drList[&quot;irTaskCdTemp&quot;].ToString(); // 주사실업무코드임시 dr[&quot;irTaskCdJusa&quot;] = drList[&quot;irTaskCdJusa&quot;].ToString(); // 주사실업무코드_주사실접수용(2019.04.03) // 동명이인처리 클라이언트로 옮김 - 속도개선 (2018.08.24) string QueryForPwsn = &quot;patno &lt;&gt; '&quot; + drList[&quot;patno&quot;].ToString() + &quot;' &quot; + &quot;and patNm = '&quot; + drList[&quot;patNm&quot;].ToString() + &quot;' &quot;; if(dtPwsn != null &amp;&amp; dtPwsn.Rows.Count &gt; 0) { DataRow[] drsPwns = dtPwsn.Select(QueryForPwsn); if (drsPwns != null &amp;&amp; drsPwns.Length &gt; 0) // 동명이인 존재 { drList[&quot;pwsnYn&quot;] = &quot;Y&quot;; dr[&quot;pwsnYn&quot;] = &quot;Y&quot;; } } if (string.IsNullOrEmpty(drList[&quot;irWaitNo&quot;].ToString())) { dr[&quot;irZoneNo&quot;] = drList[&quot;irZoneNoTemp&quot;].ToString(); // 주사실구역번호임시 } else { dr[&quot;irWaitNo&quot;] = drList[&quot;irWaitNo&quot;].ToString(); // 주사실대기번호 dr[&quot;irZoneNo&quot;] = drList[&quot;irZoneNo&quot;].ToString(); // 주사실구역번호 } // 동일환자인데 수납일시만 다른 처방이 있으면 바로 다음 Row로 인덱스 변경 string QueryDifferentRciv = &quot;patno = '&quot; + drList[&quot;patno&quot;].ToString() + &quot;' &quot; + &quot;and vistSn = '&quot; + drList[&quot;vistSn&quot;].ToString() + &quot;' &quot; + &quot;and hopeDt = '&quot; + drList[&quot;hopeDt&quot;].ToString() + &quot;' &quot; + &quot;and rcivDtm &lt; '&quot; + drList[&quot;rcivDtm&quot;].ToString() + &quot;' &quot;; DataRow[] drsDifferentRciv = dt.Select(QueryDifferentRciv, &quot;rcivDtm ASC&quot;); if (drsDifferentRciv != null &amp;&amp; drsDifferentRciv.Length &gt; 0) { int index = dt.Rows.IndexOf(drsDifferentRciv[drsDifferentRciv.Length - 1]); dt.Rows.InsertAt(dr, index + 1); } else { dt.Rows.Add(dr); } dt.AcceptChanges(); } } grdList.DataSource = dt; AMessageBox.ShowInstant(this, dt.Rows.Count.ToStringDefault(&quot;0&quot;) + &quot;건이 조회되었습니다.&quot;); } else { retrieveIrPatInfoByPat(); } } /// &lt;summary&gt; /// 동명이인 체크를 위한 당일 전체 환자명단 조회 /// &lt;/summary&gt; /// &lt;returns&gt;&lt;/returns&gt; private async Task retrieveIrPatInfoForCheckPwsn() { PreData searchParamPwsn = new PreData(); searchParamPwsn[&quot;pformDt&quot;] = dtpPform.DateTime.ToString(&quot;yyyyMMdd&quot;); searchParamPwsn[&quot;irPformDiv&quot;] = &quot;&quot;; searchParamPwsn[&quot;ordrPformLocCd&quot;] = rdoOrdrPformLocCd.EditValue.ToStringDefault(&quot;&quot;); AmcData responseDataPwsn = await CommService.CallServiceAsync(&quot;SMCNR4317R&quot;, new AmcData { preDatas = new PreDatas { { &quot;IPD_Request&quot;, searchParamPwsn } } }, this, LoadingType.BlockSearch); dtPwsn = responseDataPwsn.recordSets[&quot;ORS_IrPat&quot;].ToDataTable(); } /// &lt;summary&gt; /// 선택된 조건의 주사실환자리스트 조회 /// &lt;/summary&gt; /// &lt;returns&gt;&lt;/returns&gt; private async Task retrieveIrPatInfoByDt() { _dtList = null; PreData searchParam = new PreData(); searchParam[&quot;pformDt&quot;] = dtpPform.DateTime.ToString(&quot;yyyyMMdd&quot;); // 수행일자 searchParam[&quot;hopeDt&quot;] = dtpPform.DateTime.ToString(&quot;yyyyMMdd&quot;); // 희망일자 searchParam[&quot;irPformDiv&quot;] = rdoPformDiv.EditValue.ToStringDefault(&quot;&quot;); // 수행구분 searchParam[&quot;ordrPformLocCd&quot;] = rdoOrdrPformLocCd.EditValue.ToStringDefault(&quot;&quot;); // 주사실구분 searchParam[&quot;rcivYn&quot;] = rdoRcivYn.EditValue.ToStringDefault(&quot;Y&quot;); // 수납여부 AmcData responseData = await CommService.CallServiceAsync(&quot;SMCNR4313R&quot;, new AmcData { preDatas = new PreDatas { { &quot;IPD_Request&quot;, searchParam } } }, this, LoadingType.BlockSearch); _dtList = responseData.recordSets[&quot;ORS_IrPat&quot;].ToDataTable(); } /// &lt;summary&gt; /// 환자별 조회 /// &lt;/summary&gt; private void retrieveIrPatInfoByPat() { PreData searchParam = new PreData(); searchParam[&quot;patno&quot;] = txtCondPatno.Text.Trim(); // 병원등록번호 searchParam[&quot;inqryStDt&quot;] = dtpOrdrDirectDt.FromDateTime.ToString(&quot;yyyyMMdd&quot;); // 처방일자 From searchParam[&quot;inqryEndDt&quot;] = dtpOrdrDirectDt.ToDateTime.ToString(&quot;yyyyMMdd&quot;); // 처방일자 To searchParam[&quot;ordrPformLocCd&quot;] = rdoOrdrPformLocCd.EditValue.ToStringDefault(&quot;&quot;); // 주사실구분 AmcData responseData = CommService.CallService(&quot;SMCNR4314R&quot;, new AmcData { preDatas = new PreDatas { { &quot;IPD_Request&quot;, searchParam } } }); grdList.DataSource = responseData.recordSets[&quot;ORS_IrPat&quot;].ToDataTable(); AMessageBox.ShowInstant(this, responseData.header.message); } /// &lt;summary&gt; /// 저장 실행 /// &lt;/summary&gt; private async void OnSave() { if (dtSaveIrStayTmc == null || dtSaveIrStayTmc.Rows.Count &lt; 1) { AMessageBox.ShowInstant(&quot;변경된 내용이 없습니다.&quot;); return; } AmcData requestData = new AmcData { preDatas = new PreDatas { { &quot;IPD_Request&quot;, null } }, recordSets = new RecordSets { { &quot;IRS_DtByChildAntnIrResvPat&quot;, dtSaveIrStayTmc.ToRecordSet(true) } } }; AmcData responseData = await CommService.CallServiceAsync(&quot;SMCNR0680T&quot;, requestData); if (responseData.IsSuccess == true) { AMessageBox.ShowInstant(this, &quot;저장하였습니다.&quot;); dtSaveIrStayTmc.Clear(); } else { AMessageBox.ShowInstant(this, responseData.header.message); } } /// &lt;summary&gt; /// 희망일자 업데이트 실행 /// &lt;/summary&gt; private void OnUpdateHopeDt() { updateHopeDt(true); } /// &lt;summary&gt; /// 검사예약일자 가져와 주사실희망일자 변경 /// &lt;/summary&gt; private void updateHopeDt(bool ShowMessage = true) { PreData searchParam = new PreData(); searchParam[&quot;pformDt&quot;] = DateTime.Now.ToString(&quot;yyyyMMdd&quot;); AmcData amcDataSearchParam = new AmcData { preDatas = new PreDatas { {&quot;IPD_Request&quot;, searchParam } } }; AmcData responseData = CommService.CallService(&quot;SMCNR4318U&quot;, amcDataSearchParam); if (responseData.IsSuccess &amp;&amp; ShowMessage) { AMessageBox.ShowInstant(responseData.header.message); } else if (responseData.IsFail) { AMessageBox.Show(&quot;&quot;, responseData.header.message); } } #endregion =============================================================== #region =========================== [ 호 출 ] =========================== /// &lt;summary&gt; /// 간호관심코드 /// &lt;/summary&gt; private void OnManageCode() { Dictionary&lt;string, string&gt; paramDic = new Dictionary&lt;string, string&gt;(); paramDic.Add(&quot;nursAtenTaskNm&quot;, &quot;주사실 처방코드 분류관리&quot;); paramDic.Add(&quot;nursAtenTaskCd&quot;, &quot;IRTASKCD&quot;); paramDic.Add(&quot;nursAtenClsfCd&quot;, &quot;O&quot;); paramDic.Add(&quot;cdDiv&quot;, &quot;L&quot;); paramDic.Add(&quot;guMinCd&quot;, &quot;00000&quot;); paramDic.Add(&quot;handle&quot;, &quot;N&quot;); paramDic.Add(&quot;ordrByCd&quot;, &quot;F&quot;); DocumentService.ShowDialogPopup(&quot;AMIS3.MC.NR.AM017.dll&quot;, &quot;VMCNRAM017S&quot;, Point.Empty, paramDic.ToJson(), (dlg) =&gt; { }); } /// &lt;summary&gt; /// 공통화면호출 함수 /// &lt;/summary&gt; private void OnCommonFormOpen(Dictionary&lt;string, string&gt; dic, string pSenderID, string pTargetID, string pMessageID, Boolean pIsGuid, string pDLL) { AmisMessageData&lt;string&gt; messageData = new AmisMessageData&lt;string&gt;(); //전달할 Data형식을 string으로 정의 messageData.SenderID = pSenderID; // 보내는 사용자ID(Local인 경우 'SYSTEM') messageData.SenderScreenID = this.Name; // 보낸쪽 ID는 현재 스크린의 NAME으로 설정 messageData.TargetID = pTargetID; // 받는쪽 ID를 설정 messageData.MessageID = pMessageID; // 메세지 ID 보내고 받는 쪽에서 상호간 정의한다.(업무코드2자리 + 일련번호3자리) messageData.IsGuid = pIsGuid; // 받는 TargetID가 GUID인지 여부 messageData.Data = dic.ToJson(); // 전달할 Data this.SendDataToScreen(messageData, pDLL); //실제로 데이터를 보낸다. } /// &lt;summary&gt; /// 신체계측 화면 호출 /// &lt;/summary&gt; private void OnOpenVMCNRPM257S() { Dictionary&lt;string, string&gt; dic = new Dictionary&lt;string, string&gt;(); if (rdoDiv.EditValue.ToStringDefault(&quot;&quot;) == &quot;DT&quot;) { if (gvListByDt != null &amp;&amp; gvListByDt.FocusedRowHandle &gt;= 0) { dic[&quot;patno&quot;] = gvListByDt.GetFocusedRowCellValue(&quot;patno&quot;).ToString(); OnCommonFormOpen(dic, &quot;SYSTEM&quot;, &quot;VMCNRPM257S&quot;, &quot;PM327&quot;, false, &quot;AMIS3.MC.NR.PM257.dll&quot;); sendDataToPatDto(); } } else { dic[&quot;patno&quot;] = txtCondPatno.Text.ToStringDefault(&quot;&quot;); OnCommonFormOpen(dic, &quot;SYSTEM&quot;, &quot;VMCNRPM257S&quot;, &quot;PM327&quot;, false, &quot;AMIS3.MC.NR.PM257.dll&quot;); sendDataToPatDto(); } } /// &lt;summary&gt; /// 오더전체조회 화면 호출 /// &lt;/summary&gt; private void OnOpenVMCOOOD058S() { Dictionary&lt;string, string&gt; dic = new Dictionary&lt;string, string&gt;(); if (rdoDiv.EditValue.ToStringDefault(&quot;&quot;) == &quot;DT&quot;) { if (gvListByDt != null &amp;&amp; gvListByDt.FocusedRowHandle &gt;= 0) { dic[&quot;patno&quot;] = gvListByDt.GetFocusedRowCellValue(&quot;patno&quot;).ToString(); dic[&quot;vistSn&quot;] = gvListByDt.GetFocusedRowCellValue(&quot;vistSn&quot;).ToString(); dic[&quot;ordrDirectDt&quot;] = dtpPform.DateTime.ToString(&quot;yyyyMMdd&quot;); // 수행일자 OnCommonFormOpen(dic, &quot;SYSTEM&quot;, &quot;VMCOOOD058S&quot;, &quot;PM327&quot;, false, &quot;AMIS3.MC.OO.OD058.dll&quot;); sendDataToPatDto(); } } else { if (gvListByPat != null &amp;&amp; gvListByPat.FocusedRowHandle &gt;= 0) { dic[&quot;patno&quot;] = gvListByPat.GetFocusedRowCellValue(&quot;patno&quot;).ToString(); dic[&quot;vistSn&quot;] = gvListByPat.GetFocusedRowCellValue(&quot;vistSn&quot;).ToString(); dic[&quot;ordrDirectDt&quot;] = dtpPform.DateTime.ToString(&quot;yyyyMMdd&quot;); // 수행일자 OnCommonFormOpen(dic, &quot;SYSTEM&quot;, &quot;VMCOOOD058S&quot;, &quot;PM327&quot;, false, &quot;AMIS3.MC.OO.OD058.dll&quot;); sendDataToPatDto(); } } } /// &lt;summary&gt; /// 낙상 화면 호출 /// &lt;/summary&gt; private void OnOpenVMCMRNR116S() { string sPatno = String.Empty; long vistSn = 0; if (rdoDiv.EditValue.ToStringDefault(&quot;&quot;) == &quot;DT&quot;) { if (gvListByDt != null &amp;&amp; gvListByDt.FocusedRowHandle &gt;= 0) { sPatno = gvListByDt.GetFocusedRowCellValue(&quot;patno&quot;).ToString(); vistSn = long.Parse(gvListByDt.GetFocusedRowCellValue(&quot;vistSn&quot;).ToString()); } else return; } else { if (gvListByPat != null &amp;&amp; gvListByPat.FocusedRowHandle &gt;= 0) { sPatno = gvListByPat.GetFocusedRowCellValue(&quot;patno&quot;).ToString(); vistSn = long.Parse(gvListByPat.GetFocusedRowCellValue(&quot;vistSn&quot;).ToString()); } else return; } string sWorkLocCd = SecurityService.WorkLocCd; string sMessageData = sPatno + &quot;,&quot; + sWorkLocCd; AmisMessageData&lt;string&gt; msgDetailScreen = new AmisMessageData&lt;string&gt;(); //전달할 Data형식을 string으로 정의 msgDetailScreen.SenderID = &quot;SYSTEM&quot;; //보내는 사용자ID(Local인 경우 'SYSTEM') msgDetailScreen.SenderScreenID = this.Name; //보낸쪽 ID는 현재 스크린의 NAME으로 설정 msgDetailScreen.TargetID = &quot;VMCMRNR116S&quot;; //받는쪽 ID를 설정 msgDetailScreen.MessageID = &quot;MC001&quot;; //메세지 ID 보내고 받는 쪽에서 상호간 정의한다.(업무코드2자리 + 일련번호3자리) msgDetailScreen.IsGuid = false; //받는 TargetID가 GUID인지 여부 msgDetailScreen.Patno = sPatno; //추가: 환자등록번호 msgDetailScreen.VistSn = vistSn; //추가: 내원일련번호 msgDetailScreen.Data = sMessageData; //전달할 Data msgDetailScreen.IsFillPatientVO = true; this.SendDataToScreen(msgDetailScreen, &quot;AMIS3.MC.MR.NR116.dll&quot;); //실제로 데이터를 보낸다. } /// &lt;summary&gt; /// 간호투약수행관리 화면 호출 /// &lt;/summary&gt; private void OnOpenVMCNRDA003S() { Dictionary&lt;string, string&gt; dic = new Dictionary&lt;string, string&gt;(); if (rdoDiv.EditValue.ToStringDefault(&quot;&quot;) == &quot;DT&quot;) { if (gvListByDt != null &amp;&amp; gvListByDt.FocusedRowHandle &gt;= 0) { dic[&quot;patno&quot;] = gvListByDt.GetFocusedRowCellValue(&quot;patno&quot;).ToString(); OnCommonFormOpen(dic, &quot;SYSTEM&quot;, &quot;VMCNRDA003S&quot;, &quot;PM327&quot;, false, &quot;AMIS3.MC.MR.DA003.dll&quot;); sendDataToPatDto(); } } else { if(gvListByPat != null &amp;&amp; gvListByPat.FocusedRowHandle &gt;= 0) { dic[&quot;patno&quot;] = txtCondPatno.Text.ToStringDefault(&quot;&quot;); OnCommonFormOpen(dic, &quot;SYSTEM&quot;, &quot;VMCNRDA003S&quot;, &quot;PM327&quot;, false, &quot;AMIS3.MC.MR.DA003.dll&quot;); sendDataToPatDto(); } } } /// &lt;summary&gt; /// 외래간호기록 화면 호출 /// &lt;/summary&gt; private void OnOpenVMCMRNR035S() { Dictionary&lt;string, string&gt; dic = new Dictionary&lt;string, string&gt;(); if (rdoDiv.EditValue.ToStringDefault(&quot;&quot;) == &quot;DT&quot;) { if (gvListByDt != null &amp;&amp; gvListByDt.FocusedRowHandle &gt;= 0) { dic[&quot;patno&quot;] = gvListByDt.GetFocusedRowCellValue(&quot;patno&quot;).ToString(); dic[&quot;vistSn&quot;] = gvListByDt.GetFocusedRowCellValue(&quot;vistSn&quot;).ToString(); dic[&quot;vistDt&quot;] = dtpPform.DateTime.ToString(&quot;yyyyMMdd&quot;); OnCommonFormOpen(dic, &quot;SYSTEM&quot;, &quot;VMCMRNR035S&quot;, &quot;PM327&quot;, false, &quot;AMIS3.MC.MR.NR035.dll&quot;); sendDataToPatDto(); } } else { if(gvListByPat != null &amp;&amp; gvListByPat.FocusedRowHandle &gt;= 0) { dic[&quot;patno&quot;] = gvListByPat.GetFocusedRowCellValue(&quot;patno&quot;).ToString(); dic[&quot;vistSn&quot;] = gvListByPat.GetFocusedRowCellValue(&quot;vistSn&quot;).ToString(); dic[&quot;vistDt&quot;] = dtpPform.DateTime.ToString(&quot;yyyyMMdd&quot;); OnCommonFormOpen(dic, &quot;SYSTEM&quot;, &quot;VMCMRNR035S&quot;, &quot;PM327&quot;, false, &quot;AMIS3.MC.MR.NR035.dll&quot;); sendDataToPatDto(); } } } /// &lt;summary&gt; /// 수혈기록 화면 호출 /// &lt;/summary&gt; private void OnOpenVMCNRDA004S() { Dictionary&lt;string, string&gt; dic = new Dictionary&lt;string, string&gt;(); if (rdoDiv.EditValue.ToStringDefault(&quot;&quot;) == &quot;DT&quot;) { if (gvListByDt != null &amp;&amp; gvListByDt.FocusedRowHandle &gt;= 0) { dic[&quot;patno&quot;] = gvListByDt.GetFocusedRowCellValue(&quot;patno&quot;).ToString(); OnCommonFormOpen(dic, &quot;SYSTEM&quot;, &quot;VMCNRDA004S&quot;, &quot;PM327&quot;, false, &quot;AMIS3.MC.NR.DA004.dll&quot;); sendDataToPatDto(); } } else { if (gvListByPat != null &amp;&amp; gvListByPat.FocusedRowHandle &gt;= 0) { dic[&quot;patno&quot;] = txtCondPatno.Text.ToStringDefault(&quot;&quot;); OnCommonFormOpen(dic, &quot;SYSTEM&quot;, &quot;VMCNRDA004S&quot;, &quot;PM327&quot;, false, &quot;AMIS3.MC.NR.DA004.dll&quot;); sendDataToPatDto(); } } } /// &lt;summary&gt; /// 기록조회 화면호출 /// &lt;/summary&gt; private void OnOpenVMCMRDR004S() { Dictionary&lt;string, string&gt; dic = new Dictionary&lt;string, string&gt;(); if (rdoDiv.EditValue.ToStringDefault(&quot;&quot;) == &quot;DT&quot;) { if (gvListByDt != null &amp;&amp; gvListByDt.FocusedRowHandle &gt;= 0) { dic[&quot;patno&quot;] = gvListByDt.GetFocusedRowCellValue(&quot;patno&quot;).ToString(); OnCommonFormOpen(dic, &quot;SYSTEM&quot;, &quot;VMCMRDR004S&quot;, &quot;PM327&quot;, false, &quot;AMIS3.MC.MR.DA004.dll&quot;); sendDataToPatDto(); } } else { if (gvListByPat != null &amp;&amp; gvListByPat.FocusedRowHandle &gt;= 0) { dic[&quot;patno&quot;] = gvListByPat.GetFocusedRowCellValue(&quot;patno&quot;).ToString(); OnCommonFormOpen(dic, &quot;SYSTEM&quot;, &quot;VMCMRDR004S&quot;, &quot;PM327&quot;, false, &quot;AMIS3.MC.MR.DA004.dll&quot;); sendDataToPatDto(); } } } /// &lt;summary&gt; /// 외래주사실 조제관리 화면호출 /// &lt;/summary&gt; private void OnOpenVMCPHDS060S() { OnCommonFormOpen(null, &quot;SYSTEM&quot;, &quot;VMCPHDS060S&quot;, &quot;PM327&quot;, false, &quot;AMIS3.MC.PH.DS060.dll&quot;); sendDataToPatDto(); } /// &lt;summary&gt; /// 암병원주사실입퇴실기록 화면 호출 /// &lt;/summary&gt; private void OnOpenVMCMRNR126S() { string sPatno = String.Empty; var dicSendData = new Dictionary&lt;string, string&gt;(); if (rdoDiv.EditValue.ToStringDefault(&quot;&quot;) == &quot;DT&quot;) { if (gvListByDt != null &amp;&amp; gvListByDt.FocusedRowHandle &gt;= 0) { dicSendData.Add(&quot;patno&quot;, gvListByDt.GetFocusedRowCellValue(&quot;patno&quot;).ToString()); dicSendData.Add(&quot;vistSn&quot;, gvListByDt.GetFocusedRowCellValue(&quot;vistSn&quot;).ToString()); dicSendData.Add(&quot;vistDt&quot;, gvListByDt.GetFocusedRowCellValue(&quot;hopeDt&quot;).ToString()); dicSendData.Add(&quot;vistTm&quot;, DateTime.Now.ToString(&quot;HHmm&quot;)); dicSendData.Add(&quot;mddpCd&quot;, gvListByDt.GetFocusedRowCellValue(&quot;mddpCd&quot;).ToString()); dicSendData.Add(&quot;locCd&quot;, &quot;&quot;); dicSendData.Add(&quot;dchrgDt&quot;, &quot;&quot;); dicSendData.Add(&quot;inqryTypCd&quot;, &quot;&quot;); dicSendData.Add(&quot;mdexDivCd&quot;, &quot;&quot;); dicSendData.Add(&quot;from&quot;, &quot;&quot;); dicSendData.Add(&quot;to&quot;, &quot;&quot;); dicSendData.Add(&quot;lvl&quot;, &quot;&quot;); dicSendData.Add(&quot;formDrawupNo&quot;, &quot;&quot;); dicSendData.Add(&quot;formCd&quot;, &quot;&quot;); dicSendData.Add(&quot;cancelVistYn&quot;, &quot;&quot;); OnCommonFormOpen(dicSendData, &quot;SYSTEM&quot;, &quot;VMCMRNR126S&quot;, &quot;PM327&quot;, false, &quot;AMIS3.MC.MR.NR126.dll&quot;); sendDataToPatDto(); } } else { if (gvListByPat != null &amp;&amp; gvListByPat.FocusedRowHandle &gt;= 0) { dicSendData.Add(&quot;patno&quot;, gvListByPat.GetFocusedRowCellValue(&quot;patno&quot;).ToString()); dicSendData.Add(&quot;vistSn&quot;, gvListByPat.GetFocusedRowCellValue(&quot;vistSn&quot;).ToString()); dicSendData.Add(&quot;vistDt&quot;, gvListByPat.GetFocusedRowCellValue(&quot;hopeDt&quot;).ToString()); dicSendData.Add(&quot;vistTm&quot;, DateTime.Now.ToString(&quot;HHmm&quot;)); dicSendData.Add(&quot;mddpCd&quot;, gvListByPat.GetFocusedRowCellValue(&quot;mddpCd&quot;).ToString()); dicSendData.Add(&quot;locCd&quot;, &quot;&quot;); dicSendData.Add(&quot;dchrgDt&quot;, &quot;&quot;); dicSendData.Add(&quot;inqryTypCd&quot;, &quot;&quot;); dicSendData.Add(&quot;mdexDivCd&quot;, &quot;&quot;); dicSendData.Add(&quot;from&quot;, &quot;&quot;); dicSendData.Add(&quot;to&quot;, &quot;&quot;); dicSendData.Add(&quot;lvl&quot;, &quot;&quot;); dicSendData.Add(&quot;formDrawupNo&quot;, &quot;&quot;); dicSendData.Add(&quot;formCd&quot;, &quot;&quot;); dicSendData.Add(&quot;cancelVistYn&quot;, &quot;&quot;); OnCommonFormOpen(dicSendData, &quot;SYSTEM&quot;, &quot;VMCMRNR126S&quot;, &quot;PM327&quot;, false, &quot;AMIS3.MC.MR.NR126.dll&quot;); sendDataToPatDto(); } } } /// &lt;summary&gt; /// 시술TimeOut기록지 화면 호출 /// &lt;/summary&gt; private void OnOpenVSPSEEJ050S() { var dicSendData = new Dictionary&lt;string, string&gt;(); if (rdoDiv.EditValue.ToStringDefault(&quot;&quot;) == &quot;DT&quot;) { if (gvListByDt != null &amp;&amp; gvListByDt.FocusedRowHandle &gt;= 0) { dicSendData.Add(&quot;patno&quot;, gvListByDt.GetFocusedRowCellValue(&quot;patno&quot;).ToString()); dicSendData.Add(&quot;vistSn&quot;, gvListByDt.GetFocusedRowCellValue(&quot;vistSn&quot;).ToString()); dicSendData.Add(&quot;examActDeptCd&quot;, &quot;&quot;); dicSendData.Add(&quot;examNursRecDrawupNo&quot;, &quot;&quot;); dicSendData.Add(&quot;drawupSn&quot;, &quot;&quot;); dicSendData.Add(&quot;formClsfCd&quot;, &quot;&quot;); dicSendData.Add(&quot;startDt&quot;, &quot;&quot;); dicSendData.Add(&quot;endDt&quot;, &quot;&quot;); dicSendData.Add(&quot;mdexDivCd&quot;, &quot;&quot;); dicSendData.Add(&quot;lookType&quot;, &quot;&quot;); sendDataToPatDto(); OnCommonFormOpen(dicSendData, &quot;SYSTEM&quot;, &quot;VSPSEEJ050S&quot;, &quot;PM327&quot;, false, &quot;AMIS3.SP.SE.EJ050.dll&quot;); } } else { if (gvListByPat != null &amp;&amp; gvListByPat.FocusedRowHandle &gt;= 0) { dicSendData.Add(&quot;patno&quot;, gvListByPat.GetFocusedRowCellValue(&quot;patno&quot;).ToString()); dicSendData.Add(&quot;vistSn&quot;, gvListByPat.GetFocusedRowCellValue(&quot;vistSn&quot;).ToString()); dicSendData.Add(&quot;examActDeptCd&quot;, &quot;&quot;); dicSendData.Add(&quot;examNursRecDrawupNo&quot;, &quot;&quot;); dicSendData.Add(&quot;drawupSn&quot;, &quot;&quot;); dicSendData.Add(&quot;formClsfCd&quot;, &quot;&quot;); dicSendData.Add(&quot;startDt&quot;, &quot;&quot;); dicSendData.Add(&quot;endDt&quot;, &quot;&quot;); dicSendData.Add(&quot;mdexDivCd&quot;, &quot;&quot;); dicSendData.Add(&quot;lookType&quot;, &quot;&quot;); sendDataToPatDto(); OnCommonFormOpen(dicSendData, &quot;SYSTEM&quot;, &quot;VSPSEEJ050S&quot;, &quot;PM327&quot;, false, &quot;AMIS3.SP.SE.EJ050.dll&quot;); } } } /// &lt;summary&gt; /// 환자팔찌 및 환자바코드 출력 /// &lt;/summary&gt; private void OnOpenVMCNRWS765S() { Dictionary&lt;string, string&gt; dic = new Dictionary&lt;string, string&gt;(); if (patInfo.SelectedPatInfo[(int)SelectedPatInfo.PATNO].Equals(string.Empty) || patInfo.SelectedPatInfo[(int)SelectedPatInfo.VIST_SN].Equals(string.Empty)) return; dic.Add(&quot;patno&quot;, patInfo.SelectedPatInfo[(int)SelectedPatInfo.PATNO]); if (patInfo.SelectedPatInfo[(int)SelectedPatInfo.VIST_SN] != null) { dic.Add(&quot;vistSn&quot;, patInfo.SelectedPatInfo[(int)SelectedPatInfo.VIST_SN]); } else { return; } dic.Add(&quot;prtTyp&quot;, &quot;1&quot;); dic.Add(&quot;userLocGrpcd&quot;, &quot;O&quot;); // 병동환자면 W, 응급환자면 E, 외래환자면 O //dic.Add(&quot;vistDt&quot;, gvListByDt.GetFocusedRowCellValue(&quot;pformDt&quot;).ToString()); dic.Add(&quot;mddpCd&quot;, gvListByDt.GetFocusedRowCellValue(&quot;mddpCd&quot;).ToString()); List&lt;Dictionary&lt;string, string&gt;&gt; dicList = new List&lt;Dictionary&lt;string, string&gt;&gt;(); dicList.Add(dic); string parameter = dicList.ToJson(); DocumentService.ShowDialogPopup(this, &quot;AMIS3.MC.NR.WS765.dll&quot;, &quot;VMCNRWS765S&quot;, Point.Empty, parameter, (dlg) =&gt; { }); } /// &lt;summary&gt; /// 투약카드출력 화면 호출 /// 수행장소가 전체일 경우에는 현재 로그인된 사용자의 장소를 따른다. /// &lt;/summary&gt; private void OnOpenVMCNRDA006S() { KeyValueData keyValueDataInfo = new KeyValueData(); string patno = gvListByDt.GetFocusedDataRow().Field&lt;string&gt;(&quot;patno&quot;); string patNm = gvListByDt.GetFocusedDataRow().Field&lt;string&gt;(&quot;patNm&quot;); long vistSn = gvListByDt.GetFocusedDataRow().Field&lt;long&gt;(&quot;vistSn&quot;); if (String.IsNullOrEmpty(patno)) { AMessageBox.ShowInstant(this, &quot;선택된 환자가 없습니다.&quot;); return; } keyValueDataInfo.Add(&quot;patno&quot;, patno); keyValueDataInfo.Add(&quot;patNm&quot;, patNm); keyValueDataInfo.Add(&quot;vistSn&quot;, vistSn.ToString()); keyValueDataInfo.Add(&quot;ordrDirectDt&quot;, dtpPform.EditValue.ToDate().ToString(&quot;yyyyMMdd&quot;)); keyValueDataInfo.Add(&quot;pformPosblTmYn&quot;, &quot;Y&quot;); // 재출력여부 Form frm = Application.OpenForms.Cast&lt;Form&gt;().ToList().Find(x =&gt; x.Name == &quot;VMCNRDA006S&quot;); if (frm == null) { AmisMessageData&lt;string&gt; amisMsgData = new AmisMessageData&lt;string&gt;(); amisMsgData.SenderID = SecurityWrapper.Instance.SecurityService.UserID; amisMsgData.IsTargetActive = true; amisMsgData.SenderScreenID = this.Name; amisMsgData.MessageID = &quot;MDCTCARD&quot;; amisMsgData.TargetID = &quot;VMCNRDA006S&quot;; amisMsgData.Data = keyValueDataInfo.ToJson(); SendDataToScreen(amisMsgData, &quot;AMIS3.MC.NR.DA006.dll&quot;); } else { AmisMessageData&lt;Dictionary&lt;string, string&gt;&gt; amisMsgData = new AmisMessageData&lt;Dictionary&lt;string, string&gt;&gt;(); amisMsgData.SenderID = SecurityWrapper.Instance.SecurityService.UserID; amisMsgData.IsTargetActive = true; amisMsgData.SenderScreenID = this.Name; amisMsgData.MessageID = &quot;MDCTCARD&quot;; amisMsgData.TargetID = &quot;VMCNRDA006S&quot;; amisMsgData.Data = keyValueDataInfo; frm.Activate(); (frm as IScreenBase).OnDataReceived(amisMsgData); } } /// &lt;summary&gt; /// 투약카드 직접출력 호출 /// &lt;/summary&gt; private void OnMdctCardPrint() { IScreenBase mdtcCardCtrl = null; if (flwpnlActionButton.FindControl(&quot;VMCNRDA006P1&quot;) == null) { mdtcCardCtrl = DocumentService.SetScreenControlReturnInstance(flwpnlActionButton, &quot;AMIS3.MC.NR.DA006.dll&quot;, &quot;VMCNRDA006P1&quot;); } else { mdtcCardCtrl = flwpnlActionButton.Controls.Find(&quot;VMCNRDA006P1&quot;, false)[0] as IScreenBase; } if (mdtcCardCtrl == null) return; string patno = String.Empty, patNm = String.Empty, pformLocCd = String.Empty, vistSn = String.Empty; if (rdoDiv.EditValue.ToStringDefault(&quot;&quot;) == &quot;DT&quot;) { patno = gvListByDt.GetFocusedRowCellValue(&quot;patno&quot;).ToStringDefault(); patNm = gvListByDt.GetFocusedRowCellValue(&quot;patNm&quot;).ToStringDefault(); vistSn = gvListByDt.GetFocusedRowCellValue(&quot;vistSn&quot;).ToStringDefault(); pformLocCd = gvListByDt.GetFocusedRowCellValue(&quot;ordrPformLocCd&quot;).ToStringDefault(); } else { patno = gvListByPat.GetFocusedRowCellValue(&quot;patno&quot;).ToStringDefault(); patNm = gvListByPat.GetFocusedRowCellValue(&quot;patNm&quot;).ToStringDefault(); vistSn = gvListByPat.GetFocusedRowCellValue(&quot;vistSn&quot;).ToStringDefault(); pformLocCd = gvListByPat.GetFocusedRowCellValue(&quot;ordrPformLocCd&quot;).ToStringDefault(); } Dictionary&lt;string, object&gt; keyValueDataInfo = new Dictionary&lt;string, object&gt;(); keyValueDataInfo.Add(&quot;patno&quot;, patno); keyValueDataInfo.Add(&quot;patNm&quot;, patNm); keyValueDataInfo.Add(&quot;vistSn&quot;, vistSn); keyValueDataInfo.Add(&quot;ordrSrchTyp&quot;, &quot;M&quot;); keyValueDataInfo.Add(&quot;pformLocCd&quot;, pformLocCd); keyValueDataInfo.Add(&quot;usrLocGrpCd&quot;, pformLocCd); keyValueDataInfo.Add(&quot;ordrDirectDt&quot;, dtpPform.EditValue.ToDateString(ADateForamt.YYYYMMDD)); keyValueDataInfo.Add(&quot;skipProcessMsg&quot;, &quot;N&quot;); keyValueDataInfo.Add(&quot;pformPosblTmYn&quot;, &quot;Y&quot;); // 재출력여부, 2019-04-26 mdtcCardCtrl.OnDataReceived(keyValueDataInfo); } /// &lt;summary&gt; /// 동관주사실 전광판제어 새로고침 /// &lt;/summary&gt; public void OnRefreshVMCNRPM420S() { Dictionary&lt;string, object&gt; sendDic = new Dictionary&lt;string, object&gt;(); SendObjectDicToScreen(&quot;VMCNRPM420S&quot;, &quot;PM420&quot;, null, &quot;AMIS3.MC.NR.PM420.dll&quot;); } /// &lt;summary&gt; /// 타화면 데이터 수신 /// &lt;/summary&gt; /// &lt;typeparam name=&quot;T&quot;&gt;&lt;/typeparam&gt; /// &lt;param name=&quot;data&quot;&gt;&lt;/param&gt; public override void OnDataReceived&lt;T&gt;(AmisMessageData&lt;T&gt; data) { AmisMessageData&lt;string&gt; amisData = data as AmisMessageData&lt;string&gt;; if (amisData.MessageID == &quot;PM327&quot;) { OnSearchAction(true); } } /// &lt;summary&gt; /// SMS 문자전송(단일) 화면 호출 /// &lt;/summary&gt; private void OnOpenVETSYMS005S_Patient() { if (gvListByDt.GetFocusedRowCellValue(&quot;patno&quot;) == null || gvListByDt.GetFocusedRowCellValue(&quot;patno&quot;).ToString() == &quot;&quot;) { AMessageBox.ShowInstant(&quot;환자가 선택되지 않았습니다.&quot;); return; } if (gvListByDt.GetFocusedRowCellValue(&quot;mbphNo&quot;) == null || gvListByDt.GetFocusedRowCellValue(&quot;mbphNo&quot;).ToString() == &quot;&quot;) { AMessageBox.ShowInstant(&quot;환자의 전화번호가 확인되지 않습니다.&quot;); return; } string mbphNo = gvListByDt.GetFocusedRowCellValue(&quot;mbphNo&quot;).ToString(); string patno = gvListByDt.GetFocusedRowCellValue(&quot;patno&quot;).ToString(); string patNm = gvListByDt.GetFocusedRowCellValue(&quot;patNm&quot;).ToString(); SMSMessage smsMsgTO = new SMSMessage(); smsMsgTO.msgRevrClsf = &quot;P&quot;; //수신자분류 : P(환자)-default, E(직원) smsMsgTO.revrTelno = mbphNo; //수신자전화번호 smsMsgTO.msgSendReqDtm = DateTime.Now; //메시지전송요청일시 smsMsgTO.msgRevrId = patno; //메시지수신자ID smsMsgTO.msgRevrNm = patNm; //메시지수신자명 smsMsgTO.etcCnteDic.Add(&quot;PAT_NM&quot;, patNm); //표준문구 대체 파라미터(Dictionary) smsMsgTO.etcCnteDic.Add(&quot;DEPT_NM&quot;, &quot;&quot;); //표준문구 대체 파라미터(Dictionary) smsMsgTO.smsSendPuposCnte = &quot;소아항암주사실SMS&quot;; //SMS발송목적내용(필수) Dictionary&lt;string, object&gt; SendDic = new Dictionary&lt;string, object&gt;(); SendDic.Add(&quot;smsMsg&quot;, smsMsgTO); this.SendObjectDicToScreen(&quot;VETSYMS005S&quot;, &quot;Msg01&quot;, SendDic, &quot;AMIS3.ET.SY.MS005.dll&quot;); } /// &lt;summary&gt; /// SMS 문자전송(직원) 화면 호출 /// &lt;/summary&gt; private void OnOpenVETSYMS005S_Employee() { /** * 동관주사실을 선택했을 때만 수신자/메시지내용을 셋팅하고 * 나머지 주사실은 메시지내용 셋팅하지 않고 빈화면을 호출합니다. */ string patno = string.Empty; string patNm = string.Empty; string msgCnte = string.Empty; if (gvListByDt.GetFocusedRowCellValue(&quot;patno&quot;) != null &amp;&amp; gvListByDt.GetFocusedRowCellValue(&quot;patno&quot;).ToString() != &quot;&quot;) patno = gvListByDt.GetFocusedRowCellValue(&quot;patno&quot;).ToString(); if (gvListByDt.GetFocusedRowCellValue(&quot;patNm&quot;) != null &amp;&amp; gvListByDt.GetFocusedRowCellValue(&quot;patNm&quot;).ToString() != &quot;&quot;) patNm = gvListByDt.GetFocusedRowCellValue(&quot;patNm&quot;).ToString(); Dictionary&lt;string, object&gt; SendDic = new Dictionary&lt;string, object&gt;(); switch (rdoOrdrPformLocCd.EditValue.ToStringDefault(&quot;&quot;)) { case &quot;OPIV&quot;: // 동관주사실 메시지 세팅 //------------------------------------------------------------- // DataTable에 수신자번호(mbphNo), 수신자정보(desc) 세팅 DataTable dtMbph = new DataTable(); dtMbph.Columns.Add(&quot;mbphNo&quot;, typeof(string)); dtMbph.Columns.Add(&quot;desc&quot;, typeof(string)); DataRow drMbph = dtMbph.NewRow(); drMbph[&quot;mbphNo&quot;] = &quot;889949&quot;; drMbph[&quot;desc&quot;] = &quot;동관주사실 김진미(H930223)&quot;; dtMbph.Rows.Add(drMbph); //------------------------------------------------------------- // 동관주사실 메시지 내용 : Ex) 홍길동 55443322 마약 타다주세요 if (gvListByDt.GetFocusedRowCellValue(&quot;patno&quot;) != null &amp;&amp; gvListByDt.GetFocusedRowCellValue(&quot;patno&quot;).ToString() != &quot;&quot;) msgCnte = patNm + &quot; &quot; + patno + &quot; 마약 타다주세요&quot;; else AMessageBox.ShowInstant(&quot;환자 선택후 [SMS문자전송(단일)-직원용] 오픈하면\\r\\n메시지내용을 자동완성합니다. \\r\\n\\r\\nEx) 홍길동 12345678 마약 타다주세요&quot;); //------------------------------------------------------------- SendDic.Add(&quot;cardex&quot;, &quot;true&quot;); // cardex를 &quot;true&quot;로 보내야 SMS직원용 탭이 열린다. SendDic.Add(&quot;smsSendPuposCnte&quot;, &quot;동관주사실-직원SMS&quot;); // SMS전송목적 SendDic.Add(&quot;patno&quot;, patno); // 병원등록번호 SendDic.Add(&quot;msgRevrId&quot;, &quot;H930223&quot;); // 수신자사번 SendDic.Add(&quot;msgRevrNm&quot;, &quot;김진미&quot;); // 수신자명 SendDic.Add(&quot;msgCnte&quot;, msgCnte); // 메시지내용 SendDic.Add(&quot;mbphList&quot;, dtMbph); // 수신번호 break; case &quot;OPIV3&quot;: // 신관주사실 메시지 세팅 SendDic.Add(&quot;cardex&quot;, &quot;true&quot;); // cardex를 &quot;true&quot;로 보내야 SMS직원용 탭이 열린다. SendDic.Add(&quot;smsSendPuposCnte&quot;, &quot;신관주사실-직원SMS&quot;); SendDic.Add(&quot;patno&quot;, patno); // 병원등록번호 break; case &quot;PEDIV&quot;: // 소아주사실 메시지 세팅 SendDic.Add(&quot;cardex&quot;, &quot;true&quot;); // cardex를 &quot;true&quot;로 보내야 SMS직원용 탭이 열린다. SendDic.Add(&quot;smsSendPuposCnte&quot;, &quot;소아주사실-직원SMS&quot;); SendDic.Add(&quot;patno&quot;, patno); // 병원등록번호 break; case &quot;PIVC&quot;: // 소아항암주사실 메시지 세팅 SendDic.Add(&quot;cardex&quot;, &quot;true&quot;); // cardex를 &quot;true&quot;로 보내야 SMS직원용 탭이 열린다. SendDic.Add(&quot;smsSendPuposCnte&quot;, &quot;소아항암주사실-직원SMS&quot;); SendDic.Add(&quot;patno&quot;, patno); // 병원등록번호 break; default: // 디폴트 메시지 세팅 SendDic.Add(&quot;cardex&quot;, &quot;true&quot;); // cardex를 &quot;true&quot;로 보내야 SMS직원용 탭이 열린다. SendDic.Add(&quot;smsSendPuposCnte&quot;, &quot;주사실-직원SMS&quot;); SendDic.Add(&quot;patno&quot;, patno); // 병원등록번호 break; } this.SendObjectDicToScreen(&quot;VETSYMS005S&quot;, &quot;Msg01&quot;, SendDic, &quot;AMIS3.ET.SY.MS005.dll&quot;); } /// &lt;summary&gt; /// 간호처방등록 화면 호출 /// &lt;/summary&gt; private void OnOpenVMCOOOD022S() { Dictionary&lt;string, object&gt; SendDic = new Dictionary&lt;string, object&gt;(); if (rdoDiv.EditValue.ToStringDefault(&quot;&quot;) == &quot;DT&quot;) { if (gvListByDt != null &amp;&amp; gvListByDt.FocusedRowHandle &gt;= 0) { SendDic.Add(&quot;patno&quot;, gvListByDt.GetFocusedRowCellValue(&quot;patno&quot;).ToString()); SendDic.Add(&quot;vistSn&quot;, gvListByDt.GetFocusedRowCellValue(&quot;vistSn&quot;).ToString()); } else { AMessageBox.ShowInstant(&quot;환자를 선택해주세요.&quot;); } } else { if (gvListByPat != null &amp;&amp; gvListByPat.FocusedRowHandle &gt;= 0) { SendDic.Add(&quot;patno&quot;, gvListByPat.GetFocusedRowCellValue(&quot;patno&quot;).ToString()); SendDic.Add(&quot;vistSn&quot;, gvListByPat.GetFocusedRowCellValue(&quot;vistSn&quot;).ToString()); } else { AMessageBox.ShowInstant(&quot;환자를 선택해주세요.&quot;); } } sendDataToPatDto(); SendObjectDicToScreen(&quot;VMCOOOD022S&quot;, &quot;PM420&quot;, SendDic, &quot;AMIS3.MC.OO.OD022.dll&quot;); } /// &lt;summary&gt; /// 통합검사결과조회 화면 호출 /// &lt;/summary&gt; private void OnOpenVSPSZZZ010S() { Dictionary&lt;string, object&gt; SendDic = new Dictionary&lt;string, object&gt;(); if (rdoDiv.EditValue.ToStringDefault(&quot;&quot;) == &quot;DT&quot;) { if (gvListByDt != null &amp;&amp; gvListByDt.FocusedRowHandle &gt;= 0) { SendDic.Add(&quot;patno&quot;, gvListByDt.GetFocusedRowCellValue(&quot;patno&quot;).ToString()); //SendDic.Add(&quot;vistSn&quot;, gvListByDt.GetFocusedRowCellValue(&quot;vistSn&quot;).ToString()); } else { AMessageBox.ShowInstant(&quot;환자를 선택해주세요.&quot;); } } else { if (gvListByPat != null &amp;&amp; gvListByPat.FocusedRowHandle &gt;= 0) { SendDic.Add(&quot;patno&quot;, gvListByPat.GetFocusedRowCellValue(&quot;patno&quot;).ToString()); //SendDic.Add(&quot;vistSn&quot;, gvListByPat.GetFocusedRowCellValue(&quot;vistSn&quot;).ToString()); } else { AMessageBox.ShowInstant(&quot;환자를 선택해주세요.&quot;); } } sendDataToPatDto(); SendObjectDicToScreen(&quot;VSPSZZZ010S&quot;, &quot;Msg01&quot;, SendDic, &quot;AMIS3.SP.SZ.ZZ010.dll&quot;); } /// &lt;summary&gt; /// 검체채혈 화면 호출 /// &lt;/summary&gt; private void OnOpenVSPSSSP030S() { Dictionary&lt;string, object&gt; SendDic = new Dictionary&lt;string, object&gt;(); if (rdoDiv.EditValue.ToStringDefault(&quot;&quot;) == &quot;DT&quot;) { if (gvListByDt != null &amp;&amp; gvListByDt.FocusedRowHandle &gt;= 0) { SendDic.Add(&quot;patno&quot;, gvListByDt.GetFocusedRowCellValue(&quot;patno&quot;).ToString()); SendDic.Add(&quot;vistSn&quot;, gvListByDt.GetFocusedRowCellValue(&quot;vistSn&quot;).ToString()); } else { AMessageBox.ShowInstant(&quot;환자를 선택해주세요.&quot;); } } else { if (gvListByPat != null &amp;&amp; gvListByPat.FocusedRowHandle &gt;= 0) { SendDic.Add(&quot;patno&quot;, gvListByPat.GetFocusedRowCellValue(&quot;patno&quot;).ToString()); SendDic.Add(&quot;vistSn&quot;, gvListByPat.GetFocusedRowCellValue(&quot;vistSn&quot;).ToString()); } else { AMessageBox.ShowInstant(&quot;환자를 선택해주세요.&quot;); } } sendDataToPatDto(); SendObjectDicToScreen(&quot;VSPSSSP030S&quot;, &quot;PM420&quot;, SendDic, &quot;AMIS3.SP.SS.SP030.dll&quot;); } /// &lt;summary&gt; /// 이송신청(환자별) 화면 호출 /// &lt;/summary&gt; private void OnOpenVWAWPTF022S() { Dictionary&lt;string, object&gt; SendDic = new Dictionary&lt;string, object&gt;(); if (rdoDiv.EditValue.ToStringDefault(&quot;&quot;) == &quot;DT&quot;) { if (gvListByDt != null &amp;&amp; gvListByDt.FocusedRowHandle &gt;= 0) { SendDic.Add(&quot;patno&quot;, gvListByDt.GetFocusedRowCellValue(&quot;patno&quot;).ToString()); SendDic.Add(&quot;vistSn&quot;, gvListByDt.GetFocusedRowCellValue(&quot;vistSn&quot;).ToString()); } else { AMessageBox.ShowInstant(&quot;환자를 선택해주세요.&quot;); } } else { if (gvListByPat != null &amp;&amp; gvListByPat.FocusedRowHandle &gt;= 0) { SendDic.Add(&quot;patno&quot;, gvListByPat.GetFocusedRowCellValue(&quot;patno&quot;).ToString()); SendDic.Add(&quot;vistSn&quot;, gvListByPat.GetFocusedRowCellValue(&quot;vistSn&quot;).ToString()); } else { AMessageBox.ShowInstant(&quot;환자를 선택해주세요.&quot;); } } SendObjectDicToScreen(&quot;VWAWPTF022S&quot;, &quot;PM420&quot;, SendDic, &quot;AMIS3.WA.WP.TF022.dll&quot;); sendDataToPatDto(); } #endregion =============================================================== #region =========================== [ 기 능 ] =========================== /// &lt;summary&gt; /// 접수 처리 (동관) /// &lt;/summary&gt; private void OnNewRcep() { OnChangeIrStatByDtAction(&quot;SMCNR5279I&quot;, &quot;P&quot;); OnRefreshVMCNRPM420S(); } /// &lt;summary&gt; /// 주사실 대기상태 변경 /// - 주사대기상태코드 N:준비 P:접수 W:대기 R:입실 O:완료 T:통과 /// &lt;/summary&gt; /// &lt;param name=&quot;actionDiv&quot;&gt;준비/접수/대기/입실/완료/통과 중 어떤 액션인지&lt;/param&gt; /// &lt;param name=&quot;IrWaitStatCd&quot;&gt;현재 주사실대기상태코드&lt;/param&gt; private void OnChangeIrStatByDtAction(string pServiceId, string pIrWaitStatCd) { PreData searchParam = new PreData(); searchParam[&quot;ordrPformLocCd&quot;] = gvListByDt.GetFocusedRowCellValue(&quot;ordrPformLocCd&quot;).ToString(); // 처방수행장소코드 searchParam[&quot;irWaitNo&quot;] = gvListByDt.GetFocusedRowCellValue(&quot;irWaitNo&quot;).ToString(); // 주사실대기번호 searchParam[&quot;boardMarkDt&quot;] = gvListByDt.GetFocusedRowCellValue(&quot;hopeDt&quot;).ToString(); // 전광판표시일자 searchParam[&quot;patno&quot;] = gvListByDt.GetFocusedRowCellValue(&quot;patno&quot;).ToString(); // 병원등록번호 searchParam[&quot;patNm&quot;] = gvListByDt.GetFocusedRowCellValue(&quot;patNm&quot;).ToString(); // 환자성명 searchParam[&quot;vistSn&quot;, ADataType.L] = gvListByDt.GetFocusedRowCellValue(&quot;vistSn&quot;).ToLong(); // 내원일련번호 searchParam[&quot;irTaskCd&quot;] = gvListByDt.GetFocusedRowCellValue(&quot;irTaskCdJusa&quot;).ToString(); // 주사실업무코드 searchParam[&quot;irWaitStatCd&quot;] = pIrWaitStatCd; // 주사실대기상태코드 searchParam[&quot;irPrevWaitStatCd&quot;] = gvListByDt.GetFocusedRowCellValue(&quot;irWaitStatCd&quot;).ToString(); // 주사실이전대기상태코드 searchParam[&quot;arivlTm&quot;] = gvListByDt.GetFocusedRowCellValue(&quot;rcivDtm&quot;).ToString().Substring(8, 4); // 도착시각 = 수납시각 searchParam[&quot;rcivDt&quot;] = gvListByDt.GetFocusedRowCellValue(&quot;rcivDtm&quot;).ToString().Substring(0, 8); // 수납일자 searchParam[&quot;rcivTm&quot;] = gvListByDt.GetFocusedRowCellValue(&quot;rcivDtm&quot;).ToString().Substring(8, 4); // 수납시각 searchParam[&quot;irPatTypCd&quot;] = (gvListByDt.GetFocusedRowCellValue(&quot;bldtrOrdrYn&quot;).ToString() == &quot;Y&quot;) ? &quot;B&quot; : &quot;&quot;; // 수혈처방 (B: BLOOD) // 접수상태 if (pIrWaitStatCd == &quot;P&quot;) { searchParam[&quot;rcepTm&quot;] = DateTime.Now.ToString(&quot;HHmmss&quot;); // 접수시각 searchParam[&quot;waitStTm&quot;] = &quot; &quot;; // 대기시작시각 searchParam[&quot;eroomTm&quot;] = &quot; &quot;; // 입실시각 searchParam[&quot;pformFinshTm&quot;] = &quot; &quot;; // 완료시각 searchParam[&quot;lrTm&quot;] = &quot; &quot;; // 퇴실시각 } // 퇴실상태 //else if (pIrWaitStatCd == &quot;L&quot;) // searchParam[&quot;lrTm&quot;] = DateTime.Now.ToString(&quot;HHmmss&quot;); // 퇴실시각 // 수납별일련번호 - 동일환자의 동일수납일시인 경우는 번호가 동일함. (환자번호, 수납별일련번호로 처방을 판단함) DataView dv = new DataView(_dtList); dv.RowFilter = &quot;patno = '&quot; + gvListByDt.GetFocusedRowCellValue(&quot;patno&quot;).ToString() + &quot;' and rcivBySn = '&quot; + gvListByDt.GetFocusedRowCellValue(&quot;rcivBySn&quot;).ToString() + &quot;'&quot;; dv.ToTable(); AmcData requestData = new AmcData { header = new HeaderData { debug = 0 }, preDatas = new PreDatas { { &quot;IPD_Request&quot;, searchParam } }, recordSets = new RecordSets { { &quot;IRS_Request&quot;, dv.ToTable() == null ? null : dv.ToTable().ToRecordSet() } } }; try { AmcData responseData = CommService.CallService(pServiceId, requestData); AMessageBox.ShowInstant(this, responseData.header.message); if (responseData != null &amp;&amp; responseData.IsSuccess) OnSearchAction(false); } catch (Exception ex) { AMessageBox.Show(&quot;&quot;, ex.Message); } } #endregion =============================================================== #region ========================== [ 이 벤 트 ] ========================== /// &lt;summary&gt; /// 조회버튼 클릭 이벤트 /// &lt;/summary&gt; /// &lt;returns&gt;&lt;/returns&gt; private void btnSearch_Click(object sender, EventArgs e) { string sMessage = string.Empty; if (rdoDiv.EditValue.ToStringDefault(&quot;&quot;) == &quot;PATNO&quot;) { if (string.IsNullOrEmpty(txtCondPatno.Text.Trim())) { sMessage = string.Format(MessageInfo.INPUT_RERUIRED, new string[] { &quot;등록번호&quot; }); AMessageBox.ShowInstant(this, sMessage); return; } } OnSearchAction(true); } /// &lt;summary&gt; /// 더블클릭 이벤트 /// &lt;/summary&gt; /// &lt;param name=&quot;sender&quot;&gt;&lt;/param&gt; /// &lt;param name=&quot;e&quot;&gt;&lt;/param&gt; private void gvListByDt_DoubleClick(object sender, EventArgs e) { sendDataToPatDto(); } /// &lt;summary&gt; /// 수행상태 라디오버튼 변경 이벤트 /// &lt;/summary&gt; /// &lt;param name=&quot;sender&quot;&gt;&lt;/param&gt; /// &lt;param name=&quot;e&quot;&gt;&lt;/param&gt; private void rdoPformDiv_SelectedIndexChanged(object sender, EventArgs e) { OnSearchAction(true); } /// &lt;summary&gt; /// 수납구분 라디오버튼 변경 이벤트 /// &lt;/summary&gt; /// &lt;param name=&quot;sender&quot;&gt;&lt;/param&gt; /// &lt;param name=&quot;e&quot;&gt;&lt;/param&gt; private void rdoRcivYn_SelectedIndexChanged(object sender, EventArgs e) { OnSearchAction(true); } /// &lt;summary&gt; /// 수행장소 라디오버튼 변경 이벤트 /// &lt;/summary&gt; /// &lt;param name=&quot;sender&quot;&gt;&lt;/param&gt; /// &lt;param name=&quot;e&quot;&gt;&lt;/param&gt; private void rdoOrdrPformLocCd_SelectedIndexChanged(object sender, EventArgs e) { InitializeControls(); InitializeGridColumn(); rdoPformDiv.Visible = true; OnSearchAction(true); } /// &lt;summary&gt; /// 조회조건 변경 이벤트 /// &lt;/summary&gt; /// &lt;param name=&quot;sender&quot;&gt;&lt;/param&gt; /// &lt;param name=&quot;e&quot;&gt;&lt;/param&gt; private void rdoDiv_SelectedIndexChanged(object sender, EventArgs e) { if (rdoDiv.EditValue.ToStringDefault(&quot;&quot;) == &quot;DT&quot;) { flwpnlPformTrgetListByPformDt.Visible = true; flwpnlPformTrgetListByPat.Visible = false; lblSubTitle.Text = &quot;수행일자별 수행대상 목록&quot;; grdList.MainView = gvListByDt; } else { flwpnlPformTrgetListByPformDt.Visible = false; flwpnlPformTrgetListByPat.Visible = true; lblSubTitle.Text = &quot;환자별 수행대상 목록&quot;; grdList.MainView = gvListByPat; } InitializeControls(); } /// &lt;summary&gt; /// Row 변경 시 주사실 구분에 따라 액션버튼 변경 /// &lt;/summary&gt; /// &lt;param name=&quot;sender&quot;&gt;&lt;/param&gt; /// &lt;param name=&quot;e&quot;&gt;&lt;/param&gt; private void gvListByDt_FocusedRowChanged(object sender, DevExpress.XtraGrid.Views.Base.FocusedRowChangedEventArgs e) { if (_dtList != null &amp;&amp; gvListByDt.FocusedRowHandle &gt;= 0) { InitializeActionButtons(); } if (_dtList != null &amp;&amp; _dtList.Rows.Count &gt; 0 &amp;&amp; gvListByDt.FocusedRowHandle &gt;= 0) { patInfo.SelectedPatInfo[(int)SelectedPatInfo.PATNO] = gvListByDt.GetFocusedRowCellValue(&quot;patno&quot;).ToString(); patInfo.SelectedPatInfo[(int)SelectedPatInfo.VIST_SN] = gvListByDt.GetFocusedRowCellValue(&quot;vistSn&quot;).ToStringDefault(&quot;&quot;); } } /// &lt;summary&gt; /// 상태별 row 배경색 변경 이벤트 /// &lt;/summary&gt; /// &lt;param name=&quot;sender&quot;&gt;&lt;/param&gt; /// &lt;param name=&quot;e&quot;&gt;&lt;/param&gt; private void gvListByDt_RowCellStyle(object sender, DevExpress.XtraGrid.Views.Grid.RowCellStyleEventArgs e) { DevExpress.XtraGrid.Views.Grid.GridView view = sender as DevExpress.XtraGrid.Views.Grid.GridView; string strValue = view.GetRowCellValue(e.RowHandle, &quot;irWaitStatCd&quot;).ToStringDefault(&quot;&quot;); // 주사실대기상태코드 N:준비 P:접수 W:대기 R:입실 O:완료 T:통과 // 직원/직원가족할인여부 if (gvListByDt.GetRowCellValue(e.RowHandle, &quot;empDscntYn&quot;).ToStringDefault(&quot;&quot;).Equals(&quot;Y&quot;)) { if (e.Column.FieldName == &quot;patNm&quot;) { e.Appearance.FontStyleDelta = FontStyle.Italic; } } } /// &lt;summary&gt; /// 병원등록번호 입력값 변경 /// &lt;/summary&gt; /// &lt;param name=&quot;sender&quot;&gt;&lt;/param&gt; /// &lt;param name=&quot;e&quot;&gt;&lt;/param&gt; private void txtCondPatno_EditValueChanged(object sender, EventArgs e) { if (!String.IsNullOrEmpty(lblCondPatNm.Text)) { lblCondPatNm.Text = String.Empty; } if (txtCondPatno.EditValue.ToString().Length == txtCondPatno.Properties.MaxLength) { SearchPatInfo(); } } /// &lt;summary&gt; /// Edit 되는 Colum Filtering /// &lt;/summary&gt; /// &lt;param name=&quot;sender&quot;&gt;&lt;/param&gt; /// &lt;param name=&quot;e&quot;&gt;&lt;/param&gt; private void gvListByDt_ShowingEditor(object sender, System.ComponentModel.CancelEventArgs e) { GridView view = sender as GridView; if (view.FocusedColumn.FieldName != &quot;childAntnIrStayTmc&quot;) { e.Cancel = true; } } /// &lt;summary&gt; /// 셀값 변경 이벤트 /// &lt;/summary&gt; /// &lt;param name=&quot;sender&quot;&gt;&lt;/param&gt; /// &lt;param name=&quot;e&quot;&gt;&lt;/param&gt; private void gvListByDt_CellValueChanged(object sender, DevExpress.XtraGrid.Views.Base.CellValueChangedEventArgs e) { GridView view = sender as GridView; DataRow dr = view.GetFocusedDataRow(); dtSaveIrStayTmc.Clear(); if (e.Column.FieldName == &quot;childAntnIrStayTmc&quot;) { DataRow drSaveIrStayTmc = dtSaveIrStayTmc.NewRow(); drSaveIrStayTmc[&quot;ordrNo&quot;] = gvListByDt.GetFocusedRowCellValue(&quot;ordrPformNo&quot;).ToString(); drSaveIrStayTmc[&quot;patno&quot;] = gvListByDt.GetFocusedRowCellValue(&quot;patno&quot;).ToString(); drSaveIrStayTmc[&quot;vistSn&quot;] = gvListByDt.GetFocusedRowCellValue(&quot;vistSn&quot;).ToString(); drSaveIrStayTmc[&quot;ordrDirectDt&quot;] = gvListByDt.GetFocusedRowCellValue(&quot;irOrdrDt&quot;).ToString(); drSaveIrStayTmc[&quot;childAntnIrResvDt&quot;] = gvListByDt.GetFocusedRowCellValue(&quot;hopeDt&quot;).ToString(); drSaveIrStayTmc[&quot;childAntnIrResvTm&quot;] = &quot;&quot;; drSaveIrStayTmc[&quot;bedCd&quot;] = &quot;&quot;; drSaveIrStayTmc[&quot;mdctLocCd&quot;] = &quot;&quot;; drSaveIrStayTmc[&quot;childAntnIrStayTmc&quot;] = gvListByDt.GetFocusedRowCellValue(&quot;childAntnIrStayTmc&quot;).ToString(); drSaveIrStayTmc[&quot;ordrTblDstgCd&quot;] = &quot;JUSA&quot;; dtSaveIrStayTmc.Rows.Add(drSaveIrStayTmc); } } #endregion =============================================================== #region ======================== [ 스타일 이벤트 ] ======================= /// &lt;summary&gt; /// 수행일자별 그리드 텍스트 변경 /// &lt;/summary&gt; /// &lt;param name=&quot;sender&quot;&gt;&lt;/param&gt; /// &lt;param name=&quot;e&quot;&gt;&lt;/param&gt; private void gvListByDt_CustomColumnDisplayText(object sender, DevExpress.XtraGrid.Views.Base.CustomColumnDisplayTextEventArgs e) { if ((e.Column.FieldName == &quot;patBirthdt&quot;) || (e.Column.FieldName == &quot;irOrdrDt&quot;)) { if (e.Value != null &amp;&amp; !string.IsNullOrEmpty(e.Value.ToString())) { e.DisplayText = string.Format(&quot;{0:yyyy-MM-dd}&quot;, e.Value.ToDate()); } } else if (e.Column.FieldName == &quot;rcivDtm&quot;) // 수납일자 { if (e.Value != null &amp;&amp; !string.IsNullOrEmpty(e.Value.ToString())) { e.DisplayText = string.Format(&quot;{0:yyyy-MM-dd HH:mm}&quot;, e.Value.ToDate()); } } else if (e.Column.FieldName == &quot;childAntnIrEroomTm&quot; || e.Column.FieldName == &quot;childAntnIrLrTm&quot; || e.Column.FieldName == &quot;childAntnIrStayTmc&quot;) // 입실시간/ 퇴실시간 { if (!string.IsNullOrEmpty(e.Value.ToString())) { if (e.Value.ToString().Trim().Length == 4) { e.DisplayText = e.Value.ToString().Insert(2, &quot;:&quot;); } else if (e.Value.ToString().Trim().Length == 6) { e.DisplayText = e.Value.ToString().Insert(2, &quot;:&quot;).Insert(5, &quot;:&quot;); } } } } /// &lt;summary&gt; /// 환자별 그리드 텍스트 변경 /// &lt;/summary&gt; /// &lt;param name=&quot;sender&quot;&gt;&lt;/param&gt; /// &lt;param name=&quot;e&quot;&gt;&lt;/param&gt; private void gvListByPat_CustomColumnDisplayText(object sender, DevExpress.XtraGrid.Views.Base.CustomColumnDisplayTextEventArgs e) { if (e.Column.FieldName == &quot;patBirthdt&quot;) // 생년월일 { if (e.Value != null &amp;&amp; !string.IsNullOrEmpty(e.Value.ToString())) { e.DisplayText = string.Format(&quot;{0:yyyy-MM-dd}&quot;, e.Value.ToDate()); } } else if (e.Column.FieldName == &quot;rcivDtm&quot;) // 수납일자 { if (e.Value != null &amp;&amp; !string.IsNullOrEmpty(e.Value.ToString())) { e.DisplayText = string.Format(&quot;{0:yyyy-MM-dd HH:mm:ss}&quot;, e.Value.ToDate()); } } else if (e.Column.FieldName == &quot;pformDt&quot; || e.Column.FieldName == &quot;hopeDt&quot;) // 수행일자 { if (e.Value != null &amp;&amp; !string.IsNullOrEmpty(e.Value.ToString())) { e.DisplayText = string.Format(&quot;{0:yyyy-MM-dd}&quot;, e.Value.ToDate()); } } } /// &lt;summary&gt; /// 환자별 그리드 스타일 지정 /// &lt;/summary&gt; /// &lt;param name=&quot;sender&quot;&gt;&lt;/param&gt; /// &lt;param name=&quot;e&quot;&gt;&lt;/param&gt; private void gvListByPat_RowStyle(object sender, DevExpress.XtraGrid.Views.Grid.RowStyleEventArgs e) { if (gvListByPat.GetRowCellValue(e.RowHandle, &quot;hlinOrdrYn&quot;).ToStringDefault(&quot;&quot;).Equals(&quot;Y&quot;)) { e.HighPriority = true; e.Appearance.BackColor = GridColor.F9F5C5; // 행위처방여부 : 연노랑 } if (rdoOrdrPformLocCd.EditValue.ToStringDefault(&quot;&quot;) == &quot;PEDIV&quot;) { if (gvListByPat.GetRowCellValue(e.RowHandle, &quot;isOrdrYn&quot;).ToStringDefault(&quot;&quot;).Equals(&quot;Y&quot;)) { e.HighPriority = true; e.Appearance.BackColor = Color.Yellow; // 소아-수액처방여부 : 노랑 } } if (gvListByPat.GetRowCellValue(e.RowHandle, &quot;bldtrOrdrYn&quot;).ToStringDefault(&quot;&quot;).Equals(&quot;Y&quot;)) { e.HighPriority = true; e.Appearance.BackColor = Color.LightPink; // 수혈처방여부 : 연핑크 } } /// &lt;summary&gt; /// 수행일자별 그리드 색상지정 /// &lt;/summary&gt; /// &lt;param name=&quot;sender&quot;&gt;&lt;/param&gt; /// &lt;param name=&quot;e&quot;&gt;&lt;/param&gt; private void gvListByDt_RowStyle(object sender, DevExpress.XtraGrid.Views.Grid.RowStyleEventArgs e) { if(rdoOrdrPformLocCd.EditValue.ToStringDefault(&quot;&quot;) == &quot;OPIV&quot;) // 동관주사실은 처치가 있어야 노랑색으로 표시 { if(gvListByDt.GetRowCellValue(e.RowHandle, &quot;irTaskCd&quot;).ToStringDefault(&quot;&quot;).Equals(&quot;C&quot;)) { e.HighPriority = true; e.Appearance.BackColor = GridColor.F9F5C5; // 처치 : 연노랑 } } else { if (gvListByDt.GetRowCellValue(e.RowHandle, &quot;hlinOrdrYn&quot;).ToStringDefault(&quot;&quot;).Equals(&quot;Y&quot;) || gvListByDt.GetRowCellValue(e.RowHandle, &quot;irTaskCd&quot;).ToStringDefault(&quot;&quot;).Equals(&quot;C&quot;)) { e.HighPriority = true; e.Appearance.BackColor = GridColor.F9F5C5; // 행위처방 or 처치 : 연노랑 string sPatno = gvListByDt.GetRowCellValue(e.RowHandle, &quot;patno&quot;).ToStringDefault(&quot;&quot;); string sVistSn = gvListByDt.GetRowCellValue(e.RowHandle, &quot;vistSn&quot;).ToStringDefault(&quot;&quot;); // 소아항암 주사실의 예외 for (int i = 0; i &lt; _dtList.Rows.Count; i++) { if (_dtList.Rows[i][&quot;ordrPformLocCd&quot;].ToString() == &quot;PIVC&quot;) { if (_dtList.Rows[i][&quot;patno&quot;].ToString() == sPatno &amp;&amp; _dtList.Rows[i][&quot;vistSn&quot;].ToString() == sVistSn) { if (_dtList.Rows[i][&quot;irTaskCd&quot;].ToString() != &quot;C&quot;) { if (_dtList.Rows[i][&quot;irTaskCdTemp&quot;].ToString() != &quot;C&quot;) { e.HighPriority = true; e.Appearance.BackColor = GridColor.FFFFFF; // 행위처방+주사가 함께 있으면 색상표시하지 않음. } } } } } } } // 소아주사실-수액처방여부 if (rdoOrdrPformLocCd.EditValue.ToStringDefault(&quot;&quot;) == &quot;PEDIV&quot;) { if (gvListByDt.GetRowCellValue(e.RowHandle, &quot;isOrdrYn&quot;).ToStringDefault(&quot;&quot;).Equals(&quot;Y&quot;)) { e.HighPriority = true; e.Appearance.BackColor = Color.Yellow; } } // 수혈처방여부 if (gvListByDt.GetRowCellValue(e.RowHandle, &quot;bldtrOrdrYn&quot;).ToStringDefault(&quot;&quot;).Equals(&quot;Y&quot;)) { e.HighPriority = true; e.Appearance.BackColor = Color.LightPink; } // 소아항암주사실-입실시각/퇴실시각 작성여부 if (rdoOrdrPformLocCd.EditValue.ToStringDefault(&quot;&quot;) == &quot;PIVC&quot;) { if (gvListByDt.GetRowCellValue(e.RowHandle, &quot;childAntnIrEroomTm&quot;) != null &amp;&amp; gvListByDt.GetRowCellValue(e.RowHandle, &quot;childAntnIrEroomTm&quot;).ToString().Trim() != &quot;&quot; &amp;&amp; gvListByDt.GetRowCellValue(e.RowHandle, &quot;childAntnIrLrTm&quot;) != null &amp;&amp; gvListByDt.GetRowCellValue(e.RowHandle, &quot;childAntnIrLrTm&quot;).ToString().Trim() != &quot;&quot;) //CHILD_ANTN_IR_EROOM_TM, CHILD_ANTN_IR_LR_TM { e.HighPriority = true; e.Appearance.BackColor = GridColor.C7E7F4; // 연파랑 } } } /// &lt;summary&gt; /// 환자별 그리드 스타일 지정 /// &lt;/summary&gt; /// &lt;param name=&quot;sender&quot;&gt;&lt;/param&gt; /// &lt;param name=&quot;e&quot;&gt;&lt;/param&gt; private void gvListByPat_RowCellStyle(object sender, DevExpress.XtraGrid.Views.Grid.RowCellStyleEventArgs e) { DevExpress.XtraGrid.Views.Grid.GridView view = sender as DevExpress.XtraGrid.Views.Grid.GridView; // 직원/직원가족할인여부 if (gvListByPat.GetRowCellValue(e.RowHandle, &quot;empDscntYn&quot;).ToStringDefault(&quot;&quot;).Equals(&quot;Y&quot;)) { if (e.Column.FieldName == &quot;patNm&quot;) { e.Appearance.FontStyleDelta = FontStyle.Italic; } } } /// &lt;summary&gt; /// 수행일자별 그리드 이미지 지정 /// &lt;/summary&gt; /// &lt;param name=&quot;sender&quot;&gt;&lt;/param&gt; /// &lt;param name=&quot;e&quot;&gt;&lt;/param&gt; private void gvListByDt_CustomDrawCell(object sender, DevExpress.XtraGrid.Views.Base.RowCellCustomDrawEventArgs e) { if (e.Column.FieldName == &quot;fldwRegYn&quot;) // 낙상 { if (gvListByDt.GetRowCellValue(e.RowHandle, &quot;fldwRegYn&quot;).ToString() == &quot;Y&quot;) { e.Graphics.DrawImage(Properties.Resources.낙상, new Rectangle(e.Bounds.X, e.Bounds.Y, 17, 16)); } } if (e.Column.FieldName == &quot;patNm&quot;) { if (gvListByDt.GetRowCellValue(e.RowHandle, &quot;pwsnYn&quot;).ToString() == &quot;Y&quot;) // 동명이인 Y { e.Appearance.BackColor = Color.HotPink; } } } /// &lt;summary&gt; /// 환자별 그리드 이미지 지정 /// &lt;/summary&gt; /// &lt;param name=&quot;sender&quot;&gt;&lt;/param&gt; /// &lt;param name=&quot;e&quot;&gt;&lt;/param&gt; private void gvListByPat_CustomDrawCell(object sender, DevExpress.XtraGrid.Views.Base.RowCellCustomDrawEventArgs e) { if (e.Column.FieldName == &quot;fldwRegYn&quot;) // 낙상 { if (gvListByPat.GetRowCellValue(e.RowHandle, &quot;fldwRegYn&quot;).ToString() == &quot;Y&quot;) { e.Graphics.DrawImage(Properties.Resources.낙상, new Rectangle(e.Bounds.X, e.Bounds.Y, 17, 16)); } } } #endregion =============================================================== #region =========================== [ 기 타 ] =========================== /// &lt;summary&gt; /// 환자정보조회 /// &lt;/summary&gt; private void SearchPatInfo() { lblCondPatNm.Text = String.Empty; InitializeControls(); PreData searchParam = new PreData(); searchParam[&quot;patno&quot;] = txtCondPatno.Text.Trim(); AmcData requestData = new AmcData { header = new HeaderData { debug = 0 }, preDatas = new PreDatas { { &quot;IPD_Request&quot;, searchParam } } }; AmcData responseData = CommService.CallService(&quot;SMCNR9013R&quot;, requestData); DataTable dt = responseData.recordSets[&quot;ORS_PatInfoList&quot;].ToDataTable(); if (dt.Rows.Count &gt; 0 &amp;&amp; responseData.IsSuccess) { lblCondPatNm.Text = dt.Rows[0][&quot;patNm&quot;].ToString(); } } /// &lt;summary&gt; /// 환자상세 연동 /// &lt;/summary&gt; private void sendDataToPatDto() { DataRow row = this.gvListByDt.GetFocusedDataRow(); if (row == null) return; AMIS3.UIFramework.DataModel.PatientVO patientVO = new AMIS3.UIFramework.DataModel.PatientVO(); patientVO.patno = row[&quot;patNo&quot;].ToString(); // 필수 patientVO.vistSn = long.Parse(row[&quot;vistSn&quot;].ToString()); base.RequestChangePatientInfo(row[&quot;patNo&quot;].ToString(), long.Parse(row[&quot;vistSn&quot;].ToString()), patientVO); } /// &lt;summary&gt; /// 동관주사실 코드관리 /// &lt;/summary&gt; private void OnOpenVMCNRAM017S() { Dictionary&lt;string, string&gt; paramDic = new Dictionary&lt;string, string&gt;(); paramDic.Add(&quot;nursAtenTaskNm&quot;, &quot;주사실 처방코드&quot;); paramDic.Add(&quot;nursAtenTaskCd&quot;, &quot;IRTASKCD&quot;); paramDic.Add(&quot;nursAtenClsfCd&quot;, &quot;O&quot;); paramDic.Add(&quot;cdDiv&quot;, &quot;L&quot;); paramDic.Add(&quot;guMinCd&quot;, &quot;10601&quot;); paramDic.Add(&quot;handle&quot;, &quot;N&quot;); DocumentService.ShowDialogPopup(&quot;AMIS3.MC.NR.AM017.dll&quot;, &quot;VMCNRAM017S&quot;, Point.Empty, paramDic.ToJson()); } #endregion =============================================================== #region ========================== [ 단 축 키 ] ========================== /// &lt;summary&gt; /// 조회 Ctrl+R /// &lt;/summary&gt; protected override void RefreshMethod() { btnSearch_Click(null, null); base.RefreshMethod(); } #endregion =============================================================== #region ========================== [ 미 사 용 ] ========================== /// &lt;summary&gt; /// 미사용 함수 /// &lt;/summary&gt; /// &lt;param name=&quot;aPatno&quot;&gt;&lt;/param&gt; /// &lt;param name=&quot;aVisitSn&quot;&gt;&lt;/param&gt; /// &lt;param name=&quot;patientVO&quot;&gt;&lt;/param&gt; public override void OnChangePatientInfo(string aPatno, long aVisitSn, PatientVO patientVO) { patInfo.SelectedPatInfo[(int)SelectedPatInfo.PATNO] = aPatno; //병원등록번호 patInfo.SelectedPatInfo[(int)SelectedPatInfo.VIST_SN] = Convert.ToString(aVisitSn); //내원일련번호 } #endregion }} ServerController1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374package kr.amc.amis.mc.nr.pm.rest;import java.util.List;import org.springframework.beans.factory.annotation.Autowired;import org.springframework.stereotype.Controller;import org.springframework.web.bind.annotation.RequestBody;import org.springframework.web.bind.annotation.RequestMapping;import org.springframework.web.bind.annotation.ResponseBody;import kr.amc.amil.amcmessage.AMCData;import kr.amc.amil.amcmessage.AMCDataFactory;import kr.amc.amil.amcmessage.annotation.PreDataParam;import kr.amc.amil.amcmessage.annotation.RecordSetParam;import kr.amc.amis.mc.nr.pm.entity.FtrOrdrResvInfoInqryDTO;import kr.amc.amis.mc.nr.pm.entity.FtrOrdrResvInfoTO;import kr.amc.amis.mc.nr.pm.entity.IrACIPformTrgetListByPatDTO;import kr.amc.amis.mc.nr.pm.entity.IrACIPformTrgetListByPformDtDTO;import kr.amc.amis.mc.nr.pm.entity.IrPformTrgetListByPatDTO;import kr.amc.amis.mc.nr.pm.entity.IrPformTrgetListByPformDtDTO;import kr.amc.amis.mc.nr.pm.entity.ResvDtlInfoDTO;import kr.amc.amis.mc.nr.pm.entity.ToDlineInfoDTO;import kr.amc.amis.mc.nr.pm.service.IrPtmnProcService;@Controllerpublic class IrPtmnController { @Autowired IrPtmnProcService irPtmnProcService; @RequestMapping(&quot;SMCNR4313R&quot;) @ResponseBody public AMCData retrievePformTrgetListByPformDt(@RequestBody AMCData amcData, @PreDataParam(&quot;IPD_Request&quot;) IrPformTrgetListByPformDtDTO irPformTrgetListByPformDtDTO) throws Exception { // 외래주사실 수행일자별 수행대상 목록 List&lt;IrPformTrgetListByPformDtDTO&gt; lstResult = irPtmnProcService.retrievePformTrgetListByPformDt(irPformTrgetListByPformDtDTO); AMCData resData = AMCDataFactory.createForResponse(); resData.putRecordSet(&quot;ORS_IrPat&quot;, lstResult); return resData; } @RequestMapping(&quot;SMCNR4314R&quot;) @ResponseBody public AMCData retrievePformTrgetListByPat(@RequestBody AMCData amcData, @PreDataParam(&quot;IPD_Request&quot;) IrPformTrgetListByPatDTO irPformTrgetListByPatDTO) throws Exception { // 외래주사실 환자별 수행대상 목록 List&lt;IrPformTrgetListByPatDTO&gt; lstResult = irPtmnProcService.retrievePformTrgetListByPat(irPformTrgetListByPatDTO); AMCData resData = AMCDataFactory.createForResponse(); resData.putRecordSet(&quot;ORS_IrPat&quot;, lstResult); return resData; } @RequestMapping(&quot;SMCNR4317R&quot;) @ResponseBody public AMCData retrievePformTrgetListForPwsn(@RequestBody AMCData amcData, @PreDataParam(&quot;IPD_Request&quot;) IrPformTrgetListByPformDtDTO irPformTrgetListByPformDtDTO) throws Exception { // 외래주사실 수행일자별 수행대상 목록 List&lt;IrPformTrgetListByPformDtDTO&gt; lstResult = irPtmnProcService.retrievePformTrgetListForPwsn(irPformTrgetListByPformDtDTO); AMCData resData = AMCDataFactory.createForResponse(); resData.putRecordSet(&quot;ORS_IrPat&quot;, lstResult); return resData; } @RequestMapping(&quot;SMCNR4318U&quot;) @ResponseBody public AMCData saveDoctCall(@RequestBody AMCData amcData, @PreDataParam(&quot;IPD_Request&quot;) IrPformTrgetListByPformDtDTO param) throws Exception { // 검사예약일자 조회하여 주사실희망일자 변경 irPtmnProcService.updateHopeDtFromExamResvDt(param); // 주사실처방전 출력 정보 Insert irPtmnProcService.registerInjOrdrRptInfo(param); AMCData resData = AMCDataFactory.createForResponse(); return resData; }} Service123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131/** * * @desc 주사실환자관리PC 클래스에 대한 기능과 용도를 기술한다. * * @author 남상원 * @version 1.0, 2016/07/12 * @see */package kr.amc.amis.mc.nr.pm.service;import java.util.List;import org.apache.commons.lang.StringUtils;import org.springframework.beans.factory.annotation.Autowired;import org.springframework.stereotype.Service;import org.springframework.transaction.annotation.Transactional;import kr.amc.amil.context.ContextUtil;import kr.amc.amil.context.MessageUtil;import kr.amc.amil.exception.AMISBizException;import kr.amc.amil.utils.data.DTOUtil;import kr.amc.amis.mc.nr.da.entity.PformTrgetOrdrSmryBasicDTO;import kr.amc.amis.mc.nr.pm.entity.FtrOrdrResvInfoInqryDTO;import kr.amc.amis.mc.nr.pm.entity.FtrOrdrResvInfoTO;import kr.amc.amis.mc.nr.pm.entity.IrACIPformTrgetListByPatDTO;import kr.amc.amis.mc.nr.pm.entity.IrACIPformTrgetListByPformDtDTO;import kr.amc.amis.mc.nr.pm.entity.IrPformTrgetListByPatDTO;import kr.amc.amis.mc.nr.pm.entity.IrPformTrgetListByPformDtDTO;import kr.amc.amis.mc.nr.pm.entity.ResvDtlInfoDTO;import kr.amc.amis.mc.nr.pm.entity.ToDlineInfoDTO;import kr.amc.amis.mc.nr.pm.store.mapper.FtrOrdrPrtcolInfoEMapper;import kr.amc.amis.mc.nr.pm.store.mapper.IrPatInfoMapper;import kr.amc.amis.mc.nr.pm.store.mapper.McNrPmCirPtmnBasicMapper;import kr.amc.amis.mc.nr.da.store.mapper.PformTrgetOrdrSmryBasicMapper;import kr.amc.amis.wa.wm.ext.proxy.WmProxy;import kr.amc.amis.wa.wm.ext.spec.WaWmOrExtService;import kr.amc.amis.wa.wm.ext.spec.sdo.zz.WaWmExtOutTO;import kr.amc.amis.wa.wm.share.entity.zz.WaWmExtInTO;import kr.amc.amis.mc.nr.pm.service.CirPtmnProcService;import kr.amc.amis.mc.nr.pm.entity.CirPtnmDTO;@Servicepublic class IrPtmnProcService { @Autowired IrPatInfoMapper irPatInfoMapper; @Transactional(rollbackFor = Exception.class) public List&lt;IrPformTrgetListByPformDtDTO&gt; retrievePformTrgetListByPformDt( IrPformTrgetListByPformDtDTO irPformTrgetListByPformDtDTO) { // 외래주사실 수행일자별 수행대상 목록 조회 List&lt;IrPformTrgetListByPformDtDTO&gt; lstResult = irPatInfoMapper .retrievePformTrgetListByPformDt(irPformTrgetListByPformDtDTO); MessageUtil.success(&quot;MC_NR_PM.success.retrievePformTrgetListByPformDt&quot;, new String[] { String.valueOf(lstResult.size()) }); return lstResult; } @Transactional(rollbackFor = Exception.class) public List&lt;IrPformTrgetListByPatDTO&gt; retrievePformTrgetListByPat(IrPformTrgetListByPatDTO irPformTrgetListByPatDTO) { // 외래주사실 환자별 수행대상 목록 조회 List&lt;IrPformTrgetListByPatDTO&gt; lstResult = irPatInfoMapper.retrievePformTrgetListByPat(irPformTrgetListByPatDTO); MessageUtil.success(&quot;MC_NR_PM.success.retrievePformTrgetListByPformDt&quot;, new String[] { String.valueOf(lstResult.size()) }); return lstResult; } @Transactional(rollbackFor = Exception.class) public List&lt;IrPformTrgetListByPformDtDTO&gt; retrievePformTrgetListForPwsn( IrPformTrgetListByPformDtDTO irPformTrgetListByPformDtDTO) { // 외래주사실 수행일자별 수행대상 목록 조회 List&lt;IrPformTrgetListByPformDtDTO&gt; lstResult = irPatInfoMapper .retrievePformTrgetListForPwsn(irPformTrgetListByPformDtDTO); MessageUtil.success(&quot;MC_NR_PM.success.retrievePformTrgetListByLeaveARoom&quot;, new String[] { String.valueOf(lstResult.size()) }); return lstResult; } /** * 검사예약일자 조회하여 주사실희망일자 업데이트 **/ @Transactional(rollbackFor = Exception.class) public int updateHopeDtFromExamResvDt(IrPformTrgetListByPformDtDTO param) { int succeeded = 0; List&lt;IrPformTrgetListByPformDtDTO&gt; params = irPatInfoMapper.retrieveExamResvDtForPformHopeDtUpdate(param); if(params != null &amp;&amp; params.size() &gt; 0) { for(IrPformTrgetListByPformDtDTO DTO : params) { PformTrgetOrdrSmryBasicDTO pformTrgetOrdrSmryBasicDTO = new PformTrgetOrdrSmryBasicDTO(); pformTrgetOrdrSmryBasicDTO.setOrdrPformNo(DTO.getOrdrPformNo()); pformTrgetOrdrSmryBasicDTO.setHopeDt(DTO.getHopeDt()); pformTrgetOrdrSmryBasicDTO.setFinlUpidEmpno(ContextUtil.getUserId()); succeeded += pformTrgetOrdrSmryBasicMapper.updatePformTrgetOrdrHopeDt(pformTrgetOrdrSmryBasicDTO); } } MessageUtil.success(&quot;MC_NR_PM.success.updateHopeDtFromExamResvDt&quot;, new String[] { String.valueOf(succeeded) }); return succeeded; } } Mapper12345678910111213141516171819202122232425262728293031package kr.amc.amis.mc.nr.pm.store.mapper;import java.util.List;import org.apache.ibatis.annotations.Mapper;import kr.amc.amis.mc.nr.pm.entity.IrACIPformTrgetListByPatDTO;import kr.amc.amis.mc.nr.pm.entity.IrACIPformTrgetListByPformDtDTO;import kr.amc.amis.mc.nr.pm.entity.IrPformTrgetListByPatDTO;import kr.amc.amis.mc.nr.pm.entity.IrPformTrgetListByPformDtDTO;import kr.amc.amis.mc.nr.pm.entity.RemicDtlResvInfoDTO;import kr.amc.amis.mc.nr.pm.entity.RemicDtlResvInqryDTO;import kr.amc.amis.mc.nr.pm.entity.RemicInjtPformTmDTO;@Mapperpublic interface IrPatInfoMapper { // 외래주사실 수행일자별 수행대상 목록 조회 List&lt;IrPformTrgetListByPformDtDTO&gt; retrievePformTrgetListByPformDt(IrPformTrgetListByPformDtDTO remicDtlResvInqryDTO); // 외래주사실 환자별 수행대상 목록조회 List&lt;IrPformTrgetListByPatDTO&gt; retrievePformTrgetListByPat(IrPformTrgetListByPatDTO irPformTrgetListByPatDTO); // 동명이인 조회 List&lt;IrPformTrgetListByPformDtDTO&gt; retrievePformTrgetListForPwsn(IrPformTrgetListByPformDtDTO irPformTrgetListByPformDtDTO); List&lt;IrPformTrgetListByPformDtDTO&gt; retrieveExamResvDtForPformHopeDtUpdate(IrPformTrgetListByPformDtDTO param); } Mapper.xml (SQL)123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182183184185186187188189190191192193194195196197198199200201202203204205206207208209210211212213214215216217218219220221222223224225226227228229230231232233234235236237238239240241242243244245246247248249250251252253254255256257258259260261262263264265266267268269270271272273274275276277278279280281282283284285286287288289290291292293294295296297298299300301302303304305306307308309310311312313314315316317318319320321322323324325326327328329330331332333334335336337338339340341342343344345346347348349350351352353354355356357358359360361362363364365366367368369370371372373374375376377378379380381382383384385386387388389390391392393394395396397398399400401402403404405406407408409410411412413414415416417418419420421422423424425426427428429430431432433434435436437438439440441442443444445446447448449450451452453454455456457458459460461462463464465466467468469470471472473474475476477478479480481482483484485486487488489490491492493494495496497498499500501502503504505506507508509510511512513514515516517518519520521522523524525526527528529530531532533534535536537538539540541542543544545546547548549550551552553554555556557558559560561562563564565566567568569570571572573&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;&lt;!DOCTYPE mapper PUBLIC &quot;-//mybatis.org//DTD Mapper 3.0//EN&quot; &quot;http://mybatis.org/dtd/mybatis-3-mapper.dtd&quot;&gt;&lt;mapper namespace=&quot;kr.amc.amis.mc.nr.pm.store.mapper.IrPatInfoMapper&quot;&gt; &lt;!-- 외래주사실 수행일자별 수행대상 목록 조회 --&gt; &lt;select id=&quot;retrievePformTrgetListByPformDt&quot; parameterType=&quot;kr.amc.amis.mc.nr.pm.entity.IrPformTrgetListByPformDtDTO&quot; resultType=&quot;kr.amc.amis.mc.nr.pm.entity.IrPformTrgetListByPformDtDTO&quot;&gt; &lt;![CDATA[ SELECT /* SQLID=kr.amc.amis.mc.nr.pm.store.mapper.IrPatInfoMapper.retrievePformTrgetListByPformDt */ JUSA.* , ( SELECT 'Y' FROM V_MRNRRFLIF FLIF /* 낙상사정등록내역 */ WHERE FLIF.PATNO = JUSA.PATNO AND FLIF.DRAWUP_DT = JUSA.HOPE_DT AND FLIF.REC_VALD_CD = 'V' AND FLIF.FLDW_ASSM_CHK_YN = 'Y' AND ROWNUM = 1 ) AS FLDW_REG_YN /* 낙상등록여부 */ , ( SELECT ( SELECT INHOSP_DIAG_ENG_NM FROM V_MSMACDGCD /* 원내진단코드 뷰 */ WHERE INHOSP_DIAG_CD = DIAG.INHOSP_DIAG_CD AND USE_YN = 'Y' AND ROWNUM = 1 ) FROM V_OOOSMDIAG DIAG /* 원내진단코드 뷰 */ WHERE DIAG.PATNO = JUSA.PATNO AND DIAG.VIST_SN = JUSA.VIST_SN AND DIAG.MAINDIAG_YN = 'Y' AND ROWNUM = 1 ) AS INHOSP_DIAG_ENG_NM /* 원내진단영문명 */ , ( SELECT 'Y' FROM V_OOODMBLOD BLOD /* 수혈처방기본 */ , NRDAMATBS ATBL WHERE ATBL.PATNO = JUSA.PATNO AND ATBL.VIST_SN = JUSA.VIST_SN AND ATBL.ORDR_PFORM_LOC_CD = JUSA.ORDR_PFORM_LOC_CD AND ATBL.HOPE_DT = JUSA.HOPE_DT AND BLOD.ORDR_NO = ATBL.ORDR_PFORM_NO AND BLOD.ORDR_TITL_CD != '16' /* 의사가 입력한 처방 */ AND BLOD.VALD_YN = 'Y' AND BLOD.ORDR_CANCEL_CD = 'N' AND BLOD.MDEX_DIV_CD = 'O' AND BLOD.RCIV_STAT_CD IN ('1', '9') AND ROWNUM = 1 ) AS BLDTR_ORDR_YN /* 수혈처방여부 */ , ( SELECT 'Y' FROM V_OOODMEXAM EXAM /* 검사치료처방기본 */ , NRDAMATBS ATBL WHERE ATBL.PATNO = JUSA.PATNO AND ATBL.VIST_SN = JUSA.VIST_SN AND ATBL.ORDR_PFORM_LOC_CD = JUSA.ORDR_PFORM_LOC_CD AND ATBL.HOPE_DT = JUSA.HOPE_DT AND EXAM.ORDR_NO = ATBL.ORDR_PFORM_NO AND EXAM.ORDR_TITL_CD != '16' /* 의사가 입력한 처방 */ AND EXAM.VALD_YN = 'Y' AND EXAM.ORDR_CANCEL_CD = 'N' AND EXAM.ORDR_DELI_SYSM_CD = 'O' AND EXAM.MDEX_DIV_CD = 'O' AND EXAM.RCIV_STAT_CD IN ('1', '9') AND ROWNUM = 1 ) AS HLIN_ORDR_YN /* 행위처방여부 */ , ( SELECT 'Y' FROM V_OOODMMEDI MEDI , V_PHINMMEDI PHDI , NRDAMATBS ATBL WHERE ATBL.PATNO = JUSA.PATNO AND ATBL.VIST_SN = JUSA.VIST_SN AND ATBL.ORDR_PFORM_LOC_CD = JUSA.ORDR_PFORM_LOC_CD AND ATBL.HOPE_DT = JUSA.HOPE_DT AND MEDI.ORDR_NO = ATBL.ORDR_PFORM_NO AND NVL(MEDI.PREP_ORDR_CLSF_CD, '0') != 'P' /* PRE처방이 아닌것 */ AND MEDI.ORDR_TITL_CD != '16' /* 의사가 입력한 처방 */ AND MEDI.ACTING_ORGL_ORDR_NO IS NULL /* 원처방만 */ AND MEDI.VALD_YN = 'Y' AND MEDI.ORDR_CANCEL_CD = 'N' AND PHDI.PHRM_CD = MEDI.ORDR_CD AND PHDI.MANAGE_MEDI_KND_CD = 'F' /* 수액 */ AND MEDI.RCIV_STAT_CD IN ('1', '9') AND ROWNUM = 1 ) AS IS_ORDR_YN /* 수액처방여부 */ , ( SELECT 'Y' FROM V_OOODMMEDI MEDI , V_PHINMMEDI PHDI , NRDAMATBS ATBL WHERE ATBL.PATNO = JUSA.PATNO AND ATBL.VIST_SN = JUSA.VIST_SN AND ATBL.ORDR_PFORM_LOC_CD = JUSA.ORDR_PFORM_LOC_CD AND ATBL.HOPE_DT = JUSA.HOPE_DT AND MEDI.ORDR_NO = ATBL.ORDR_PFORM_NO AND MEDI.VALD_YN = 'Y' AND MEDI.ORDR_CANCEL_CD = 'N' AND PHDI.PHRM_CD = MEDI.ORDR_CD AND PHDI.RMRS_LCLAS_CD = '010' /* 항암제여부 */ AND MEDI.RCIV_STAT_CD IN ('1', '9') AND ROWNUM = 1 ) AS IS_ANDR_YN /* 항암제 처방여부 */ , ( SELECT ABOX.ABO_BLTY || ABOX.RH_BLTY FROM V_SSBIRABOX ABOX WHERE ABOX.PATNO = JUSA.PATNO AND ROWNUM = 1 ) AS ABO_RH_BLTY /* 혈액형 */ , ( SELECT CHLA.CHILD_ANTN_IR_EROOM_TM FROM NRPMMCHLO CHLA WHERE CHLA.PATNO = JUSA.PATNO AND CHLA.VIST_SN = JUSA.VIST_SN AND CHLA.CHILD_ANTN_IR_RESV_DT = JUSA.HOPE_DT AND CHLA.VALD_YN = 'Y' ORDER BY CHILD_ANTN_IR_EROOM_TM DESC FETCH FIRST 1 ROWS ONLY ) AS CHILD_ANTN_IR_EROOM_TM /* 소아항암 입실시각 */ , ( SELECT CHLB.CHILD_ANTN_IR_LR_TM FROM NRPMMCHLO CHLB WHERE CHLB.PATNO = JUSA.PATNO AND CHLB.VIST_SN = JUSA.VIST_SN AND CHLB.CHILD_ANTN_IR_RESV_DT = JUSA.HOPE_DT AND CHLB.VALD_YN = 'Y' ORDER BY CHILD_ANTN_IR_LR_TM DESC FETCH FIRST 1 ROWS ONLY ) AS CHILD_ANTN_IR_LR_TM /* 소아항암 퇴실시각 */ , CASE WHEN NVL(( SELECT CHLC.CHILD_ANTN_IR_STAY_TMC FROM NRPMMCHLO CHLC WHERE CHLC.PATNO = JUSA.PATNO AND CHLC.VIST_SN = JUSA.VIST_SN AND CHLC.CHILD_ANTN_IR_RESV_DT = JUSA.HOPE_DT AND CHLC.VALD_YN = 'Y' ORDER BY CHILD_ANTN_IR_STAY_TMC DESC FETCH FIRST 1 ROWS ONLY ), '') &gt; 0 THEN NVL(TO_CHAR(( SELECT CHLD.CHILD_ANTN_IR_STAY_TMC FROM NRPMMCHLO CHLD WHERE CHLD.PATNO = JUSA.PATNO AND CHLD.VIST_SN = JUSA.VIST_SN AND CHLD.CHILD_ANTN_IR_RESV_DT = JUSA.HOPE_DT AND CHLD.VALD_YN = 'Y' ORDER BY CHILD_ANTN_IR_STAY_TMC DESC FETCH FIRST 1 ROWS ONLY )), '') ELSE '' END AS CHILD_ANTN_IR_STAY_TMC /* 재실시간 */ , ( SELECT (CASE WHEN COUNT(1) &gt; 0 THEN 'Y' ELSE 'N' END) FROM V_WPDCDFAML FAML WHERE FAML.PATNO = JUSA.PATNO AND JUSA.HOPE_DT BETWEEN FAML.APPLY_ST_DT AND FAML.APPLY_END_DT AND FAML.VALD_YN = 'Y' ) AS EMP_DSCNT_YN /* 직원, 직원가족할인, 할인여부 */ , ( SELECT CASE WHEN MDAW.FTR_ORDR_YN = 'Y' THEN 'Y' END FROM NRNCMMDAW MDAW WHERE MDAW.PATNO = JUSA.PATNO AND MDAW.VIST_SN = JUSA.VIST_SN AND MDAW.MDEX_DT = JUSA.HOPE_DT AND ROWNUM = 1 ) AS FTR_ORDR_YN , ( SELECT DECODE (COUNT (CONS.PATNO), 0, 'N', 'Y') FROM OOOSRCONS CONS WHERE CONS.PATNO = JUSA.PATNO AND CONS.VIST_SN = JUSA.VIST_SN AND CONS.INCONS_CLSF_CD = 'DNR' AND CONS.VALD_YN = 'Y' AND CONS.REG_CANCEL_YN = 'Y' ) AS DNR_YN_MARK , ( SELECT 'Y' AS ORDR_REFND_EXSC_YN FROM V_OOODMMEDI MEDI , NRDAMATBS ATBS WHERE MEDI.RCIV_STAT_CD IN ('2', '6', '8') /* RCIV_STAT_CD - 2&amp;6 : 환불입력, 8: 환불완료 */ AND MEDI.ORDR_NO = ATBS.ORDR_PFORM_NO AND ATBS.PATNO = JUSA.PATNO AND ATBS.VIST_SN = JUSA.VIST_SN AND ATBS.ORDR_PFORM_LOC_CD = JUSA.ORDR_PFORM_LOC_CD AND MEDI.VALD_YN = 'Y' AND ROWNUM = 1 UNION SELECT 'Y' AS ORDR_REFND_EXSC_YN FROM V_OOODMEXAM EXAM , NRDAMATBS ATBS WHERE EXAM.RCIV_STAT_CD IN ('2', '6', '8') /* RCIV_STAT_CD - 2&amp;6 : 환불입력, 8: 환불완료 */ AND EXAM.ORDR_NO = ATBS.ORDR_PFORM_NO AND ATBS.PATNO = JUSA.PATNO AND ATBS.VIST_SN = JUSA.VIST_SN AND ATBS.ORDR_PFORM_LOC_CD = JUSA.ORDR_PFORM_LOC_CD AND EXAM.VALD_YN = 'Y' AND ROWNUM = 1 UNION SELECT 'Y' AS ORDR_REFND_EXSC_YN FROM V_OOODMBLOD BLOD , NRDAMATBS ATBS WHERE BLOD.RCIV_STAT_CD IN ('2', '6', '8') /* RCIV_STAT_CD - 2&amp;6 : 환불입력, 8: 환불완료 */ AND BLOD.ORDR_NO = ATBS.ORDR_PFORM_NO AND ATBS.PATNO = JUSA.PATNO AND ATBS.VIST_SN = JUSA.VIST_SN AND ATBS.ORDR_PFORM_LOC_CD = JUSA.ORDR_PFORM_LOC_CD AND BLOD.VALD_YN = 'Y' AND ROWNUM = 1 ) AS ORDR_REFND_EXSC_YN /* 처방환불존재여부 - 처방 중 1건이라도 환불이 존재하는지 확인 */ , FN_ZZ_GET_USER_NM(JUSA.ATNN_EMPNO, 'K') AS ATNN_NM /* 진료의성명 */ , RANK() OVER (PARTITION BY JUSA.PATNO ORDER BY JUSA.ORDR_PFORM_LOC_CD, JUSA.RCIV_DTM ,JUSA.ORDR_DIRECT_DT) AS RCIV_BY_SN /* 내원별, 수납별일련번호 */ , ROW_NUMBER() OVER (PARTITION BY JUSA.PATNO, JUSA.VIST_SN, JUSA.ORDR_PFORM_LOC_CD, JUSA.RCIV_DTM ,JUSA.ORDR_DIRECT_DT ORDER BY DECODE(IR_TASK_CD_TEMP, 'C', 1, 'H', 2, 'M', 3, 'R', 4, 'N', 5, 'X', 6)) AS IR_TASK_CD_SEQ /* 주사실업무코드순서 - (처치, 헤파빅, 레미케이드, 조제주사, 단순주사, 행위 순) 동관주사실 김영미 선생님 요청사항임 */ FROM ( SELECT ATBS.ORDR_PFORM_NO AS ORDR_PFORM_NO /* 처방수행번호 */ , ATBS.PFORM_DT AS PFORM_DT /* 수행일자 */ , ATBS.HOPE_DT AS HOPE_DT /* 희망일자 */ , ATBS.PATNO AS PATNO /* 병원등록번호 */ , ATBS.VIST_SN AS VIST_SN /* 내원일련번호 */ , ATIN.PFORM_STAT_CD AS PFORM_STAT_CD /* 수행상세-수행상태코드*/ , NVL(ATBS.REAL_ORDR_LOC_USE_CD , ATBS.ORDR_PFORM_LOC_CD) AS ORDR_PFORM_LOC_CD /* 처방수행장소코드 */ , ATBK.ORDR_CD AS ORDR_CD /* 처방코드 */ , INFO.PAT_NM AS PAT_NM /* 환자성명 */ , INFO.SEX_DIV_NM AS SEX_DIV_NM /* 성별구분명 */ , INFO.PAT_BIRTHDT AS PAT_BIRTHDT /* 환자생년월일 */ , INFO.AGE_CNTE AS AGE_CNTE /* 나이내용 */ , INFO.MBPH_NO AS MBPH_NO /* 휴대전화번호 */ , PATN.MDDP_CD AS MDDP_CD /* 진료과코드 */ , NVL(( SELECT TTD_EMPNO FROM V_NRNCMMDAW WHERE PATNO = ATBS.PATNO AND VIST_SN = ATBS.VIST_SN AND MDDP_CD = PATN.MDDP_CD ORDER BY VIST_CONFM_YN DESC, VIST_CONFM_DT DESC, VIST_CONFM_TM DESC FETCH FIRST 1 ROWS ONLY ), PATN.ATNN_EMPNO) AS ATNN_EMPNO , NVL(IRAW.IR_WAIT_STAT_CD, 'N') AS IR_WAIT_STAT_CD /* 주사실대기상태코드 */ , DECODE(IRAW.IR_WAIT_STAT_CD, 'N', '준비' , 'P', '접수' , 'W', '대기' , 'R', '입실' , 'O', '완료' , 'L', '퇴실' , 'T', '통과' , '준비') AS IR_WAIT_STAT_NM /* 주사실대기상태명 */ , IRAW.IR_WAIT_NO AS IR_WAIT_NO /* 주사실대기번호 */ , IRAW.IR_TASK_CD AS IR_TASK_CD /* 주사실업무코드 (C:처치 H:헤파빅 N:단순주사 R:조제주사) */ , IRAW.IR_ZONE_NO AS IR_ZONE_NO /* 주사실구역번호 1:주사실1, 2:주사실2 */ , ATBK.ORDR_DIRECT_DT AS IR_ORDR_DT /* 처방지시일자 */ , ATBK.ORDR_DIRECT_DT AS ORDR_DIRECT_DT , ATBS.RCIV_DT || ATBS.RCIV_TM AS RCIV_DTM , CASE WHEN NVL(PHIN.PHRM_TYP_CD, '*') = 'I' THEN 'R' /*임상약은 무조건 조제주사*/ WHEN /* NVL(PHIN.MANAGE_MEDI_KND_CD, '*') = 'F' AND 수액조건은 막아달라 김영미 20190403*/ (NVL(PHIN.MEDI_VOL_MSR_CD, '*') = 'L' OR (NVL(PHIN.MEDI_VOL_MSR_CD, '*') = 'ml' AND NVL(PHIN.MEDI_VOL_VAL, 0) &gt;= 50)) THEN 'R' /* 수액이면서 50ml 이상은 조제주사 */ WHEN CODE.FRST_ADD_CD_VAL IN ('M', 'H', 'C', 'X') THEN CODE.FRST_ADD_CD_VAL WHEN ATBS.MEDI_MIX_YN = 'Y' OR CODE.FRST_ADD_CD_VAL = 'R' THEN 'R' ELSE 'N' END AS IR_TASK_CD_TEMP , CASE WHEN NVL(PHIN.PHRM_TYP_CD, '*') = 'I' THEN 'R' /*임상약은 무조건 조제주사*/ WHEN /* NVL(PHIN.MANAGE_MEDI_KND_CD, '*') = 'F' AND */ (NVL(PHIN.MEDI_VOL_MSR_CD, '*') = 'L' OR (NVL(PHIN.MEDI_VOL_MSR_CD, '*') = 'ml' AND NVL(PHIN.MEDI_VOL_VAL, 0) &gt;= 50)) THEN 'R' /* 수액이면서 50ml 이상은 조제주사 */ WHEN CODE.FRST_ADD_CD_VAL IN ('M', 'H', 'C') THEN CODE.FRST_ADD_CD_VAL WHEN ATBS.MEDI_MIX_YN = 'Y' OR CODE.FRST_ADD_CD_VAL = 'R' THEN 'R' ELSE 'N' END AS IR_TASK_CD_JUSA , CASE WHEN NVL(PHIN.PHRM_TYP_CD, '*') = 'I' THEN '조제주사' /*임상약은 무조건 조제주사*/ WHEN /* NVL(PHIN.MANAGE_MEDI_KND_CD, '*') = 'F' AND 수액조건은 막아달라 김영미 20190403*/ (NVL(PHIN.MEDI_VOL_MSR_CD, '*') = 'L' OR (NVL(PHIN.MEDI_VOL_MSR_CD, '*') = 'ml' AND NVL(PHIN.MEDI_VOL_VAL, 0) &gt;= 50)) THEN '조제주사' /* 수액이면서 50ml 이상은 조제주사 */ WHEN CODE.FRST_ADD_CD_VAL IN ('M', 'H', 'C', 'X') THEN CODE.SCON_ADD_CD_VAL WHEN ATBS.MEDI_MIX_YN = 'Y' OR CODE.FRST_ADD_CD_VAL = 'R' THEN '조제주사' ELSE '단순주사' END AS IR_TASK_NM , DECODE(NVL(CODE.FRST_ADD_CD_VAL, 'N'), 'H', '2', '1') AS IR_ZONE_NO_TEMP , ( SELECT DECODE(COUNT(*), 0, 'N', 'Y') FROM V_NRDADATIN WHERE ORDR_PFORM_NO = ATBS.ORDR_PFORM_NO AND PFORM_STAT_CD = 'RL' ) AS RL_YN /*불출여부*/ , ( SELECT DECODE(COUNT(*), 0, 'N', 'Y') FROM V_NRDADATIN WHERE ORDR_PFORM_NO = ATBS.ORDR_PFORM_NO AND PFORM_STAT_CD IN ('RF', 'SK', 'ZZ', 'DC') ) AS RF_YN /*수행불능여부*/ FROM NRDAMATBS ATBS , NRDARATBK ATBK , V_NRDADATIN ATIN , V_WJAPMPATN PATN , V_WPPIMINFO INFO , NRNCMIRAW IRAW , NRAMDCODE CODE , V_OOODMMEDI MEDI , V_OOODMEXAM EXAM , V_OOODMBLOD BLOD , V_PHINMMEDI PHIN , V_ZZCKMCLND CLND WHERE ATBK.ORDR_PFORM_NO = ATBS.ORDR_PFORM_NO AND ATBK.VALD_YN = 'Y' AND ATBK.ORDR_CANCEL_CD = 'N' AND PATN.PATNO = ATBS.PATNO AND PATN.VIST_SN = ATBS.VIST_SN AND ATIN.ORDR_PFORM_NO = ATBS.ORDR_PFORM_NO AND INFO.PATNO = ATBS.PATNO AND INFO.VALD_YN = 'Y' AND IRAW.PATNO(+) = ATBS.PATNO AND IRAW.VIST_SN(+) = ATBS.VIST_SN AND IRAW.ORDR_PFORM_LOC_CD(+) = NVL(ATBS.REAL_ORDR_LOC_USE_CD, ATBS.ORDR_PFORM_LOC_CD) AND IRAW.IR_WAIT_NO(+) = ATBS.IR_WAIT_NO AND IRAW.VALD_YN(+) = 'Y' AND MEDI.ORDR_NO(+) = ATBS.ORDR_PFORM_NO AND EXAM.ORDR_NO(+) = ATBS.ORDR_PFORM_NO AND BLOD.ORDR_NO(+) = ATBS.ORDR_PFORM_NO AND NVL(MEDI.PREP_ORDR_CLSF_CD, '0') != 'P' /* PRE처방이 아닌것 */ AND NVL(MEDI.ORDR_TITL_CD, '0') != '16' /* 의사가 입력한 처방 */ AND MEDI.ACTING_ORGL_ORDR_NO IS NULL /* 원처방만 */ /* AND MEDI.MEDI_RAPD_SHAP_CD IS NULL 의약품수불형태코드 2018.10.30 김영미T요청 */ AND NVL(MEDI.MEDI_RAPD_SHAP_CD, '*') = CASE WHEN NVL(MEDI.MEDI_RAPD_SHAP_CD, '*') = 'X' AND ATBK.ORDR_CD = 'PS-SETO' THEN NVL(MEDI.MEDI_RAPD_SHAP_CD, '*') WHEN NVL(MEDI.MEDI_RAPD_SHAP_CD, '*') = 'Z' AND (ATBK.ORDR_CD = 'OA-VEN20RS' OR ATBK.ORDR_CD = 'OA-VEN2.5' OR ATBK.ORDR_CD = 'OA-MUC4ML' OR ATBK.ORDR_CD = 'OA-PULRP') THEN NVL(MEDI.MEDI_RAPD_SHAP_CD, '*') WHEN NVL(MEDI.MEDI_RAPD_SHAP_CD, '*') = 'M' AND NVL(ATBS.REAL_ORDR_LOC_USE_CD, ATBS.ORDR_PFORM_LOC_CD) = 'PIVC' THEN NVL(MEDI.MEDI_RAPD_SHAP_CD, '*') ELSE '*' END /* 의약품수불형태코드 조건 2018.10.30 김영미샘 요청, PS-SETO가 수불X일때는 예외처리 2019.03.28 윤혜영샘 요청 */ AND NVL(MEDI.VALD_YN, 'Y') = 'Y' AND NVL(MEDI.ORDR_CANCEL_CD, 'N') = 'N' AND NVL(MEDI.MDEX_DIV_CD,'O') = 'O' AND NVL(EXAM.ORDR_TITL_CD, '0') != '16' /* 의사가 입력한 처방 */ AND NVL(EXAM.VALD_YN, 'Y') = 'Y' AND NVL(EXAM.ORDR_CANCEL_CD,'N') = 'N' AND NVL(EXAM.MDEX_DIV_CD,'O') IN ('O', 'I') /* 입원처방 Bone Marrow 조회를 위해 I 추가 */ AND NVL(BLOD.ORDR_TITL_CD, '0') != '16' /* 의사가 입력한 처방 */ AND NVL(BLOD.VALD_YN,'Y') = 'Y' AND NVL(BLOD.ORDR_CANCEL_CD,'N') = 'N' AND NVL(BLOD.MDEX_DIV_CD,'O') = 'O' AND CODE.NURS_ATEN_TASK_CD(+) = 'IRTASKCD' AND CODE.NURS_ATEN_CD_VAL (+) = ATBK.ORDR_CD AND ATBS.HOPE_DT BETWEEN CODE.APPLY_ST_DT(+) AND CODE.APPLY_END_DT(+) AND PHIN.PHRM_CD(+) = ATBK.ORDR_CD AND ATBS.VALD_YN = 'Y' AND ATBS.ORDR_DEL_YN = 'N' AND ATBS.HOPE_DT = #{pformDt, jdbcType=VARCHAR} AND ATBS.PATNO NOT IN (SELECT PATNO FROM V_OOOSRVIPT) /* VVIP 제외 */ AND ATBS.HOPE_DT = CLND.CLND_DT ]]&gt; &lt;choose&gt; &lt;when test=&quot;rcivYn != null and rcivYn != '' and rcivYn == 'N'.toString() &quot;&gt; AND ATBS.RCIV_DT IS NULL AND ATBS.RCIV_TM IS NULL &lt;/when&gt; &lt;otherwise&gt; AND ( NVL(MEDI.RCIV_STAT_CD, '0') IN ('1', '9') /* 환불하지 않은 처방 */ OR NVL(EXAM.RCIV_STAT_CD, '0') IN ('1', '9') /* 환불하지 않은 처방 */ OR NVL(BLOD.RCIV_STAT_CD, '0') IN ('1', '9') ) /* 환불하지 않은 처방 */ AND ATBS.RCIV_DT IS NOT NULL AND ATBS.RCIV_TM IS NOT NULL &lt;/otherwise&gt; &lt;/choose&gt; &lt;choose&gt; &lt;when test=&quot;irPformDiv != null and irPformDiv != '' and irPformDiv == 'HNDV'.toString() &quot;&gt; AND ATBS.ORDR_PFORM_LOC_CD IN ('OPIV','OPIV3','PEDIV','PIVC','OUT') AND ATBS.ORDR_PFORM_LOC_CD != CASE WHEN CLND.MDEX_HLDY_CD = '2' THEN 'OUT' ELSE '*' END /* 평일에는 OUT 환자 보이지 않도록 제외 */ AND ATBS.ORDR_PFORM_LOC_CD = DECODE(#{ordrPformLocCd, jdbcType=VARCHAR}, '', ATBS.ORDR_PFORM_LOC_CD, #{ordrPformLocCd, jdbcType=VARCHAR}) AND ATIN.PFORM_STAT_CD = 'TR' /* 수행상태코드 : 인계 */ &lt;/when&gt; &lt;otherwise&gt; AND NVL(ATBS.REAL_ORDR_LOC_USE_CD, ATBS.ORDR_PFORM_LOC_CD) IN ('OPIV','OPIV3','PEDIV','PIVC','OUT') AND NVL(ATBS.REAL_ORDR_LOC_USE_CD, ATBS.ORDR_PFORM_LOC_CD) != CASE WHEN CLND.MDEX_HLDY_CD = '2' THEN 'OUT' ELSE '*' END /* 평일에는 OUT 환자 보이지 않도록 제외 */ AND NVL(ATBS.REAL_ORDR_LOC_USE_CD, ATBS.ORDR_PFORM_LOC_CD) = DECODE(#{ordrPformLocCd, jdbcType=VARCHAR}, '', NVL(ATBS.REAL_ORDR_LOC_USE_CD, ATBS.ORDR_PFORM_LOC_CD), #{ordrPformLocCd, jdbcType=VARCHAR}) &lt;if test=&quot;irPformDiv != null and irPformDiv != '' and irPformDiv == 'BEFOR'.toString()&quot;&gt; AND ATBS.ORDR_PFORM_STAT_CD IN ('N', 'P') /* 처방수행상태코드 */ &lt;/if&gt; AND ATBS.ORDR_PFORM_STAT_CD = DECODE(#{irPformDiv, jdbcType=VARCHAR}, 'FINSH', 'Y', ATBS.ORDR_PFORM_STAT_CD) /* 처방수행상태코드 */ AND ( ATIN.PFORM_STAT_CD = DECODE(#{irPformDiv, jdbcType=VARCHAR}, 'INBL', 'RF', ATIN.PFORM_STAT_CD) OR ATIN.PFORM_STAT_CD = DECODE(#{irPformDiv, jdbcType=VARCHAR}, 'INBL', 'SK', ATIN.PFORM_STAT_CD) OR ATIN.PFORM_STAT_CD = DECODE(#{irPformDiv, jdbcType=VARCHAR}, 'INBL', 'ZZ', ATIN.PFORM_STAT_CD) OR ATIN.PFORM_STAT_CD = DECODE(#{irPformDiv, jdbcType=VARCHAR}, 'INBL', 'DC', ATIN.PFORM_STAT_CD) ) AND ATIN.PFORM_STAT_CD = DECODE(#{irPformDiv, jdbcType=VARCHAR}, 'RELES', 'RL', ATIN.PFORM_STAT_CD) /* 수행상태코드 : 불출 */ &lt;/otherwise&gt; &lt;/choose&gt; &lt;![CDATA[ ) JUSA WHERE 'Y' = CASE WHEN #{irPformDiv, jdbcType=VARCHAR} IN ('FINSH', 'BEFOR') AND (JUSA.RL_YN = 'Y' OR JUSA.RF_YN = 'Y') THEN 'N' ELSE 'Y' END /* 인계, 수행불능, 불출은 수행전과 수행완료에 보이지 않도록 막음 */ ORDER BY RCIV_DTM , PATNO , IR_TASK_CD_SEQ ]]&gt; &lt;/select&gt; &lt;!-- 외래주사실 환자별 수행대상 목록조회 --&gt; &lt;select id=&quot;retrievePformTrgetListByPat&quot; parameterType=&quot;kr.amc.amis.mc.nr.pm.entity.IrPformTrgetListByPatDTO&quot; resultType=&quot;kr.amc.amis.mc.nr.pm.entity.IrPformTrgetListByPatDTO&quot;&gt; &lt;![CDATA[ SELECT /* SQLID=kr.amc.amis.mc.nr.pm.store.mapper.IrPatInfoMapper.retrievePformTrgetListByPat */ * FROM ( SELECT DISTINCT ATBS.PATNO AS PATNO /* 병원등록번호 */ , ATBS.VIST_SN AS VIST_SN /* 내원일련번호 */ , ATBS.PFORM_DT AS PFORM_DT /* 수행일자 */ , ATBS.HOPE_DT AS HOPE_DT /* 희망일자 */ , PATN.MDDP_CD AS MDDP_CD /* 진료과코드 */ , PATN.ATNN_EMPNO AS ATNN_EMPNO /* 진료의사번 */ , FN_ZZ_GET_USER_NM(PATN.ATNN_EMPNO, 'K') AS ATNN_NM /* 진료의성명 */ , INFO.PAT_NM AS PAT_NM /* 환자성명 */ , INFO.SEX_DIV_NM AS SEX_DIV_NM /* 성별구분명 */ , INFO.PAT_BIRTHDT AS PAT_BIRTHDT /* 환자생년월일 */ , INFO.AGE_CNTE AS AGE_CNTE /* 나이 */ , ( SELECT 'Y' FROM V_MRNRRFLIF FLIF /* 낙상사정등록내역 */ WHERE FLIF.PATNO = ATBS.PATNO AND FLIF.DRAWUP_DT = ATBS.HOPE_DT AND FLIF.REC_VALD_CD = 'V' AND FLIF.FLDW_ASSM_CHK_YN = 'Y' AND ROWNUM = 1 ) AS FLDW_REG_YN /* 낙상등록여부 */ , ( SELECT (SELECT INHOSP_DIAG_ENG_NM FROM V_MSMACDGCD /* 원내진단코드 뷰 */ WHERE INHOSP_DIAG_CD = DIAG.INHOSP_DIAG_CD AND USE_YN = 'Y' AND ROWNUM = 1) FROM V_OOOSMDIAG DIAG /* 원내진단코드 뷰 */ WHERE DIAG.PATNO = ATBS.PATNO AND DIAG.VIST_SN = ATBS.VIST_SN AND DIAG.MAINDIAG_YN = 'Y' AND ROWNUM = 1 ) AS INHOSP_DIAG_ENG_NM /* 원내진단영문명 */ , ( SELECT RCIV_DT || RCIV_TM FROM V_WMMCRPROF_MC PROF WHERE PROF.PATNO = ATBS.PATNO AND PROF.VIST_SN = ATBS.VIST_SN AND PROF.ORDR_NO = ATBS.ORDR_PFORM_NO AND ROWNUM = 1 ) AS RCIV_DTM /* 수납일시 */ , ( SELECT 'Y' FROM V_OOODMBLOD BLOD /* 수혈처방기본 */ WHERE BLOD.PATNO = ATBS.PATNO AND BLOD.VIST_SN = ATBS.VIST_SN AND BLOD.ORDR_TITL_CD != '16' /* 의사가 입력한 처방 */ AND BLOD.VALD_YN = 'Y' AND BLOD.ORDR_CANCEL_CD = 'N' AND ROWNUM = 1 ) AS BLDTR_ORDR_YN /* 수혈처방여부 */ , ( SELECT 'Y' FROM V_OOODMEXAM EXAM /* 검사치료처방기본 */ WHERE EXAM.PATNO = ATBS.PATNO AND EXAM.VIST_SN = ATBS.VIST_SN AND EXAM.ORDR_TITL_CD != '16' /* 의사가 입력한 처방 */ AND EXAM.VALD_YN = 'Y' AND EXAM.ORDR_CANCEL_CD = 'N' AND EXAM.ORDR_DELI_SYSM_CD = 'O' AND ROWNUM = 1 ) AS HLIN_ORDR_YN /* 행위처방여부 */ ,'' AS PWSN_YN /* 동명이인여부 */ ,( SELECT 'Y' FROM V_OOODMMEDI MEDI , V_PHINMMEDI PHDI WHERE MEDI.PATNO = ATBS.PATNO AND MEDI.VIST_SN = ATBS.VIST_SN AND NVL(MEDI.PREP_ORDR_CLSF_CD, '0') != 'P' /* PRE처방이 아닌것 */ AND MEDI.ORDR_TITL_CD != '16' /* 의사가 입력한 처방 */ AND MEDI.ACTING_ORGL_ORDR_NO IS NULL /* 원처방만 */ AND MEDI.VALD_YN = 'Y' AND MEDI.ORDR_CANCEL_CD = 'N' AND PHDI.PHRM_CD = MEDI.ORDR_CD AND PHDI.MANAGE_MEDI_KND_CD = 'F' /* 수액여부 */ AND ROWNUM = 1 ) AS IS_ORDR_YN /* 수액처방여부 */ , (SELECT (CASE WHEN COUNT(1) &gt; 0 THEN 'Y' ELSE 'N' END) FROM V_WPDCDFAML FAML WHERE FAML.PATNO = ATBS.PATNO AND ATBS.HOPE_DT BETWEEN FAML.APPLY_ST_DT AND FAML.APPLY_END_DT AND FAML.VALD_YN = 'Y') AS EMP_DSCNT_YN /* 직원, 직원가족할인, 할인여부 */ FROM NRDAMATBS ATBS /* 수행대상처방요약기본 */ , V_WPPIMINFO INFO /* 환자기본_뷰 */ , V_WJAPMPATN PATN /* 통합접수기본_뷰 */ WHERE ATBS.PATNO = INFO.PATNO AND ATBS.PATNO = PATN.PATNO AND ATBS.VIST_SN = PATN.VIST_SN AND ATBS.VALD_YN = 'Y' /* 유효여부 */ ]]&gt; &lt;if test=&quot;inqryStDt != null and inqryStDt != '' and inqryEndDt != null and inqryEndDt != ''&quot;&gt; AND ATBS.HOPE_DT BETWEEN #{inqryStDt} AND #{inqryEndDt} &lt;/if&gt; &lt;if test=&quot;ordrPformLocCd != null and ordrPformLocCd != ''&quot;&gt; AND ATBS.ORDR_PFORM_LOC_CD = #{ordrPformLocCd} &lt;/if&gt; &lt;if test=&quot;patno != null and patno != ''&quot;&gt; AND ATBS.PATNO = #{patno} &lt;/if&gt; &lt;![CDATA[ ) WHERE RCIV_DTM IS NOT NULL ORDER BY RCIV_DTM DESC ]]&gt; &lt;/select&gt; &lt;!-- 동명이인 제거를 위한 조회 --&gt; &lt;select id=&quot;retrievePformTrgetListForPwsn&quot; parameterType=&quot;kr.amc.amis.mc.nr.pm.entity.IrPformTrgetListByPformDtDTO&quot; resultType=&quot;kr.amc.amis.mc.nr.pm.entity.IrPformTrgetListByPformDtDTO&quot;&gt; &lt;![CDATA[ SELECT /* SQLID=kr.amc.amis.mc.nr.pm.store.mapper.IrPatInfoMapper.retrievePformTrgetListForPwsn */ ATBS.PATNO AS PATNO /* 병원등록번호 */ , INFO.PAT_NM AS PAT_NM /* 환자성명 */ FROM NRDAMATBS ATBS , V_WPPIMINFO INFO , V_OOODMMEDI MEDI , V_OOODMEXAM EXAM , V_OOODMBLOD BLOD WHERE ATBS.PATNO = INFO.PATNO AND ATBS.ORDR_PFORM_NO = MEDI.ORDR_NO(+) AND ATBS.ORDR_PFORM_NO = EXAM.ORDR_NO(+) AND ATBS.ORDR_PFORM_NO = BLOD.ORDR_NO(+) AND NVL(MEDI.PREP_ORDR_CLSF_CD, '0') != 'P' /* PRE처방이 아닌것 */ AND NVL(MEDI.ORDR_TITL_CD, '0') != '16' /* 의사가 입력한 처방 */ AND MEDI.ACTING_ORGL_ORDR_NO IS NULL /* 원처방만 */ AND NVL(MEDI.VALD_YN, 'Y') = 'Y' AND NVL(MEDI.ORDR_CANCEL_CD, 'N') = 'N' AND NVL(MEDI.MDEX_DIV_CD,'O') = 'O' AND NVL(MEDI.RCIV_STAT_CD, '1') IN ('1', '9') AND NVL(EXAM.ORDR_TITL_CD, '0') != '16' /* 의사가 입력한 처방 */ AND NVL(EXAM.VALD_YN, 'Y') = 'Y' AND NVL(EXAM.ORDR_CANCEL_CD,'N') = 'N' AND NVL(EXAM.MDEX_DIV_CD,'O') IN ('O', 'I') /* 입원처방 Bone Marrow 조회를 위해 I 추가 */ AND NVL(EXAM.RCIV_STAT_CD, '1') IN ('1', '9') AND NVL(BLOD.ORDR_TITL_CD, '0') != '16' /* 의사가 입력한 처방 */ AND NVL(BLOD.VALD_YN,'Y') = 'Y' AND NVL(BLOD.ORDR_CANCEL_CD,'N') = 'N' AND NVL(BLOD.MDEX_DIV_CD,'O') = 'O' AND NVL(BLOD.RCIV_STAT_CD, '1') IN ('1', '9') AND ATBS.VALD_YN = 'Y' AND ATBS.ORDR_DEL_YN = 'N' AND INFO.VALD_YN = 'Y' AND ATBS.HOPE_DT = #{pformDt, jdbcType=VARCHAR} AND ATBS.RCIV_DT IS NOT NULL AND ATBS.RCIV_TM IS NOT NULL AND NVL(ATBS.REAL_ORDR_LOC_USE_CD, ATBS.ORDR_PFORM_LOC_CD) IN ('OPIV','OPIV3','PEDIV','PIVC') AND NVL(ATBS.REAL_ORDR_LOC_USE_CD, ATBS.ORDR_PFORM_LOC_CD) = DECODE(#{ordrPformLocCd, jdbcType=VARCHAR}, '', NVL(ATBS.REAL_ORDR_LOC_USE_CD, ATBS.ORDR_PFORM_LOC_CD), #{ordrPformLocCd, jdbcType=VARCHAR}) ]]&gt; &lt;/select&gt; &lt;!-- 검사 예약일자 조회 --&gt; &lt;select id=&quot;retrieveExamResvDtForPformHopeDtUpdate&quot; parameterType=&quot;kr.amc.amis.mc.nr.pm.entity.IrPformTrgetListByPformDtDTO&quot; resultType=&quot;kr.amc.amis.mc.nr.pm.entity.IrPformTrgetListByPformDtDTO&quot;&gt; &lt;![CDATA[ SELECT /* SQLID=kr.amc.amis.mc.nr.pm.store.mapper.IrPatInfoMapper.retrieveExamResvDtForPformHopeDtUpdate */ BS.ORDR_PFORM_NO AS ORDR_PFORM_NO , HE.EXAM_RESV_DT AS HOPE_DT FROM NRDAMATBS BS , NRDARATBK BK , V_SEEBMSCHE HE WHERE BK.ORDR_PFORM_NO = BS.ORDR_PFORM_NO AND HE.ORDR_NO = BS.ORDR_PFORM_NO AND BS.HOPE_DT != HE.EXAM_RESV_DT AND BS.HOPE_DT = #{pformDt, jdbcType=VARCHAR} AND BS.VALD_YN = 'Y' AND BS.ORDR_DEL_YN = 'N' AND BK.ORDR_CD IN ('GJ0021', 'GJ0016') AND BS.ORDR_PFORM_LOC_CD IN ('OPIV', 'PIVC', 'CHEMO') ]]&gt; &lt;/select&gt; &lt;/mapper&gt;","link":"/2019/06/15/sourcecode-jusasil-1/"}],"tags":[{"name":"RPA","slug":"RPA","link":"/tags/RPA/"},{"name":"고민거리","slug":"고민거리","link":"/tags/%EA%B3%A0%EB%AF%BC%EA%B1%B0%EB%A6%AC/"},{"name":"FHIR","slug":"FHIR","link":"/tags/FHIR/"},{"name":"JDK","slug":"JDK","link":"/tags/JDK/"},{"name":"Eclipse","slug":"Eclipse","link":"/tags/Eclipse/"},{"name":"Tomcat","slug":"Tomcat","link":"/tags/Tomcat/"},{"name":"MySQL","slug":"MySQL","link":"/tags/MySQL/"},{"name":"HAPI","slug":"HAPI","link":"/tags/HAPI/"},{"name":"jpaserver","slug":"jpaserver","link":"/tags/jpaserver/"},{"name":"착수보고","slug":"착수보고","link":"/tags/%EC%B0%A9%EC%88%98%EB%B3%B4%EA%B3%A0/"},{"name":"모바일 표준","slug":"모바일-표준","link":"/tags/%EB%AA%A8%EB%B0%94%EC%9D%BC-%ED%91%9C%EC%A4%80/"},{"name":"제안","slug":"제안","link":"/tags/%EC%A0%9C%EC%95%88/"},{"name":"레드마인","slug":"레드마인","link":"/tags/%EB%A0%88%EB%93%9C%EB%A7%88%EC%9D%B8/"},{"name":"주간 업무일지","slug":"주간-업무일지","link":"/tags/%EC%A3%BC%EA%B0%84-%EC%97%85%EB%AC%B4%EC%9D%BC%EC%A7%80/"},{"name":"표준","slug":"표준","link":"/tags/%ED%91%9C%EC%A4%80/"},{"name":"소스코드","slug":"소스코드","link":"/tags/%EC%86%8C%EC%8A%A4%EC%BD%94%EB%93%9C/"}],"categories":[{"name":"기획 &gt; RPA","slug":"기획-RPA","link":"/categories/%EA%B8%B0%ED%9A%8D-RPA/"},{"name":"고민거리","slug":"고민거리","link":"/categories/%EA%B3%A0%EB%AF%BC%EA%B1%B0%EB%A6%AC/"},{"name":"오픈소스 &gt; FHIR &gt; 기획","slug":"오픈소스-FHIR-기획","link":"/categories/%EC%98%A4%ED%94%88%EC%86%8C%EC%8A%A4-FHIR-%EA%B8%B0%ED%9A%8D/"},{"name":"오픈소스 &gt; FHIR &gt; HAPI FHIR 설치","slug":"오픈소스-FHIR-HAPI-FHIR-설치","link":"/categories/%EC%98%A4%ED%94%88%EC%86%8C%EC%8A%A4-FHIR-HAPI-FHIR-%EC%84%A4%EC%B9%98/"},{"name":"사업관리 &gt; 착수보고","slug":"사업관리-착수보고","link":"/categories/%EC%82%AC%EC%97%85%EA%B4%80%EB%A6%AC-%EC%B0%A9%EC%88%98%EB%B3%B4%EA%B3%A0/"},{"name":"기획 &gt; 모바일 표준","slug":"기획-모바일-표준","link":"/categories/%EA%B8%B0%ED%9A%8D-%EB%AA%A8%EB%B0%94%EC%9D%BC-%ED%91%9C%EC%A4%80/"},{"name":"제안","slug":"제안","link":"/categories/%EC%A0%9C%EC%95%88/"},{"name":"오픈소스 &gt; 레드마인","slug":"오픈소스-레드마인","link":"/categories/%EC%98%A4%ED%94%88%EC%86%8C%EC%8A%A4-%EB%A0%88%EB%93%9C%EB%A7%88%EC%9D%B8/"},{"name":"주간 업무일지","slug":"주간-업무일지","link":"/categories/%EC%A3%BC%EA%B0%84-%EC%97%85%EB%AC%B4%EC%9D%BC%EC%A7%80/"},{"name":"사업관리 &gt; 표준 산출물","slug":"사업관리-표준-산출물","link":"/categories/%EC%82%AC%EC%97%85%EA%B4%80%EB%A6%AC-%ED%91%9C%EC%A4%80-%EC%82%B0%EC%B6%9C%EB%AC%BC/"},{"name":"소스코드 &gt; 의료","slug":"소스코드-의료","link":"/categories/%EC%86%8C%EC%8A%A4%EC%BD%94%EB%93%9C-%EC%9D%98%EB%A3%8C/"}]}
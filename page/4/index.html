<!doctype html>
<html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta><title>ilovemychange&#039;s IT Blog</title><meta property="og:type" content="blog"><meta property="og:title" content="ilovemychange&#039;s IT Blog"><meta property="og:url" content="https://ilovemychange.github.io/"><meta property="og:site_name" content="ilovemychange&#039;s IT Blog"><meta property="og:locale" content="en_US"><meta property="og:image" content="https://ilovemychange.github.io/img/og_image.png"><meta property="article:author" content="ilovemychange"><meta property="twitter:card" content="summary"><meta property="twitter:image" content="/img/og_image.png"><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https://ilovemychange.github.io"},"headline":"ilovemychange's IT Blog","image":["https://ilovemychange.github.io/img/og_image.png"],"author":{"@type":"Person","name":"ilovemychange"},"description":null}</script><link rel="icon" href="/img/skating4.svg"><link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.12.0/css/all.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@9.12.0/styles/atom-one-dark.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Ubuntu:wght@400;600&amp;family=Source+Code+Pro"><link rel="stylesheet" href="/css/default.css"><style>body>.footer,body>.navbar,body>.section{opacity:0}</style><!--!--><!--!--><!--!--><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lightgallery@1.6.8/dist/css/lightgallery.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/css/justifiedGallery.min.css"><!--!--><!--!--><script src="https://cdn.jsdelivr.net/npm/pace-js@1.0.2/pace.min.js"></script><meta name="generator" content="Hexo 5.1.1"></head><body class="is-2-column"><nav class="navbar navbar-main"><div class="container"><div class="navbar-brand justify-content-center"><a class="navbar-item navbar-logo" href="/">ilovemychange</a></div><div class="navbar-menu"><div class="navbar-start"><a class="navbar-item" href="/">Home</a><a class="navbar-item" href="/categories">Categories</a><a class="navbar-item" href="/tags">Tags</a><a class="navbar-item" href="/archives">Archives</a><a class="navbar-item" href="/about">About</a></div><div class="navbar-end"><a class="navbar-item search" title="Search" href="javascript:;"><i class="fas fa-search"></i></a></div></div></div></nav><section class="section"><div class="container"><div class="columns"><div class="column order-2 column-main is-8-tablet is-8-desktop is-8-widescreen"><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><span class="level-item">Posted&nbsp;<time dateTime="2020-08-01T13:00:00.000Z" title="2020-08-01T13:00:00.000Z">2020-08-01</time></span><span class="level-item">Updated&nbsp;<time dateTime="2020-10-03T02:44:44.339Z" title="2020-10-03T02:44:44.339Z">2020-10-03</time></span><span class="level-item"><a class="link-muted" href="/categories/%EC%82%AC%EC%97%85%EA%B4%80%EB%A6%AC-%EC%B0%A9%EC%88%98%EB%B3%B4%EA%B3%A0/">사업관리 &gt; 착수보고</a></span><span class="level-item">16 minutes read (About 2437 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2020/08/01/kickoff-report/">착수보고 준비 (1/2) - 착수보고서 작성</a></h1><div class="content"><p>SI 프로젝트에서 착수보고란, <strong>프로젝트의 시작을 알리는 행사</strong>다. 보통 프로젝트 투입 후 <strong>첫째 주 또는 둘째 주</strong>에 진행하고, 프로젝트와 직간접적으로 <strong>유관된 부서의 참여자들을 모두 초청</strong>한다. 특히 프로젝트의 각종 스폰서(임원들)가 참여하므로 결코 가볍지 않은 행사라고 볼 수 있다.</p>
<p>이 글을 작성하는 이유는, 착수보고라는 것은 어떤 형태로 진행되고, 어떻게 준비해야 하는지 차후 프로젝트를 진행하더라도 혼란이 없도록 기록을 남겨두기 위함이다. 필자는 착수보고라는 것을 처음으로 맞딱뜨린 입장에서 보고서는 어떻게 작성해야 하는지, 보고회는 어떻게 준비해야 하는지 전혀 경험이나 지식이 없었기 때문에 많은 시행착오를 겪을 수밖에 없었다. 부족함이 많았지만 지금 정리해두는 내용을 토대로 다음 번 프로젝트때는 좀더 전문가답게 업무를 진행할 수 있었으면 하는 바람이다.</p>
<p>필자가 생각하기에 착수보고는 크게 3가지의 굵직한 업무로 나뉜다.</p>
<ol>
<li><strong>착수보고서 작성</strong></li>
<li><strong>착수보고 행사 준비 및 진행</strong></li>
<li><strong>착수보고 발표</strong></li>
</ol>
<p>여기서, 필자는 1번과 2번의 업무를 담당하였고, 3번은 프로젝트 PM께서 직접 진행하였다. 그래서 필자가 소관하였던 1번과 2번에 대해서만 기록을 남기고, 이번 글에서는 그 중에 <strong>1. 착수보고서 작성</strong>에 대해서 적어보려 한다.</p>
<hr>
<h2 id="착수보고서를-작성하기에-앞서"><a href="#착수보고서를-작성하기에-앞서" class="headerlink" title="착수보고서를 작성하기에 앞서"></a>착수보고서를 작성하기에 앞서</h2><p>먼저, 가장 실수하기 쉬운 부분은, 보고서이기 때문에 뭔가 거창해야 할 것 같지만 착수보고는 정말 <strong>심플하고 간단하고 짧아야 한다</strong>. 착수보고는 “우리가 이러한 재미있는 프로젝트를 진행하려고 합니다. 여기 계신 여러분들께서 많은 도움이 필요합니다”라는 메시지만 전달이 되면 끝이다. 대체 얼마나 심플해야 하냐고? 필자는 착수보고를 다음과 같이 구성하였다. </p>
<blockquote>
<ol>
<li><p>무엇을<br> 1.1 사업 개요<br> 1.2 사업 목적<br> 1.3 목표 시스템</p>
</li>
<li><p>어떻게<br> 2.1 추진 방향성<br> 2.2 전체 일정<br> 2.3 조직도</p>
</li>
<li><p>앞으로<br> 3.1 향후 일정<br> 3.2 지원 요청<br> 3.3 우리의 다짐</p>
</li>
</ol>
</blockquote>
<p>장표는 각각 1장 씩 총 9장으로 구성되었다. (표지와 마지막 QnA 페이지를 포함하면 11장) 발표로 했을때는 각 장당 약 1분 30초가 소요되니 <strong>약 13~15분</strong> 정도이다. 사실 작성자의 역량에 따라 더 심플하게 구성할 수 있다면 더 심플하게 가도 된다. (필자가 참고했던 타 샘플 착수보고서는 7장이었다..) 그럼 각각의 장표에는 어떤 내용이 담겨야 하는지에 대해 구체적으로 살펴보자.</p>
<hr>
<h2 id="무엇을"><a href="#무엇을" class="headerlink" title="무엇을"></a>무엇을</h2><p>프로젝트의 각종 유관 부서 참여자들을 전부 초대했지만, 안타깝게도 그들은 이 프로젝트에 대해 아직 잘 모른다. 그들에게 차근차근 이 프로젝트가 무엇인지를 설명해주어야 한다. 중요한 것은 <strong>쉽게 설명해야 한다</strong>는 것이다. 보고서도 물론 아주 쉬워야 한다. 복잡한 내용은 최소화하도록 한다. IT 담당자가 아닌 임원이나 현업 담당자들도 다수 포함되어 있기 때문이다. 먼저 이 사업의 전반적인 개요를 설명하고, 왜 이런 사업이 탄생하였는지 사업의 목적과, 어떤 시스템을 만들 것인지에 대한 밑그림인 목표시스템을 설명한다.</p>
<h3 id="사업-개요"><a href="#사업-개요" class="headerlink" title="사업 개요"></a>사업 개요</h3><p>사업의 개요에는 5가지의 내용이 담기면 된다. “프로젝트명”이 무엇인지, “수행사”가 어느 회사인지, “참여 인원”들은 몇명인지, “사업 기간”은 언제부터 언제까지인지, “프로젝트룸”은 어디에 위치하였는지.</p>
<h3 id="사업-목적"><a href="#사업-목적" class="headerlink" title="사업 목적"></a>사업 목적</h3><p>사업의 목적에는 이 프로젝트를 추진하게된 “배경”(고객이 간지러워하는 부분)을 담고, 어떤 방향으로 이를 개선할 것인지 “목적”을 담아내면 된다.</p>
<h3 id="목표-시스템"><a href="#목표-시스템" class="headerlink" title="목표 시스템"></a>목표 시스템</h3><p>목표 시스템에는 제안서에 담길법한 거창한 인프라 아키텍처를 담는 것은 아니다. 눈높이를 현업 담당자에게 맞춰서, 프로젝트가 끝나면 어떤 시스템들이 구성이 되겠구나 한눈에  들어올 수 있게 그려내면 된다.</p>
<hr>
<h2 id="어떻게"><a href="#어떻게" class="headerlink" title="어떻게"></a>어떻게</h2><p>앞에서 무엇을 하겠다는 것을 제시하였으니, 어떻게 그것을 달성해낼 것인지 이야기를 풀어나가면 자연스러울 것이다. 필자의 경우에는 크게 전략과 일정, 조직으로 콘텐츠를 구성하였다.</p>
<h3 id="추진-전략"><a href="#추진-전략" class="headerlink" title="추진 전략"></a>추진 전략</h3><p>추진 전략 (또는 추진 방향성)에는 프로젝트팀에서 어떤 방향으로 프로젝트를 이끌어나갈 것인지 전략과 실행방안을 간략히 담아내면 된다. 다만 그 전략은 반드시 프로젝트를 성공하기 위한 현실적이면서도 핵심적인 요소여야 한다. 예상컨데 추진전략은 이미 제안서나 제안PT에도 작성을 하였을 것이다. 당부하고 싶은 것은, 제안서와 제안PT를 작성하는 단계에서는 발주처의 상황을 잘 모르고 작성하였기 때문에 뜬구름 잡는 이야기가 많았을 것이다. 그렇기에 착수보고에서는 철저히 발주처의 상황을 고려하여 현실적인 전략이 도출되어야만 한다.</p>
<h3 id="전체-일정"><a href="#전체-일정" class="headerlink" title="전체 일정"></a>전체 일정</h3><p>프로젝트의 시작부터 끝까지 전체적인 일정을 담아내면 된다. 다만 너무 상세한 일정까지 표현하면 눈에 들어오지 않으므로, 주요한 마일스톤만 잘 찍어주면 된다. 보는 사람 입장에서 “아 ~ 5월부터 개발 시작이구나, 8월부터는 테스트 시작이네? 12월에 오픈하는구나” 이 정도 주요 이정표들만 눈에 들어오면 되겠다.</p>
<h3 id="조직도"><a href="#조직도" class="headerlink" title="조직도"></a>조직도</h3><p>조직도는, 트리 구조로 프로젝트의 사업단장부터 각 파트별 전문가들까지 가급적이면 모든 사람들이 직책과 실명 위주로 표현되는 것이 좋다. (다만 플젝 인원이 수백명이라 그러면 다 담지는 힘들겠다.. 그땐 다른 방법을 강구해보길) 필자가 수행한 프로젝트의 경우 전체 유관자가 약 40~50명 정도여서 장표 1장에 전부 표현이 가능했다. 가능하다면 발주처 직원과 수행사 직원을 색깔 등으로 구분하여 누가 내 카운터 파트너인지를 확실히 알 수 있으면 더 좋겠다.</p>
<hr>
<h2 id="앞으로"><a href="#앞으로" class="headerlink" title="앞으로"></a>앞으로</h2><p>무엇을 어떻게 하겠다는 그림을 앞에서 그려주었으니, 이제는 마무리를 할 단계이다. 이제는 수행사 입장에서 조금의 속내를 드러낼 시간이다. 앞으로는 정말 바쁘게 일을 시작해야 하니 발주처 직원들의 많은 참여를 이끌어내야 한다.</p>
<h3 id="향후-일정"><a href="#향후-일정" class="headerlink" title="향후 일정"></a>향후 일정</h3><p>당장 내일부터, 또는 당장 다음주부터는 어떤 일들이 벌어질지 이야기가 진행될 수 있도록 장표를 구성한다. 목적은 발주처 현업들의 적극적인 참여를 요청하고 약간의 긴장감(?)을 조성하기 위함이다. </p>
<h3 id="지원-요청"><a href="#지원-요청" class="headerlink" title="지원 요청"></a>지원 요청</h3><p>비록 첫째 주, 또는 둘째 주밖에 안되었지만, 프로젝트를 막상 시작하려고 하니 많은 어려움이나 제약사항들이 있을 것이다. 프로젝트 스폰서들께 도움을 요청할 것이 있다면 이 시간을 통해 운을 띄워보는 것도 좋은 방법이다. 다만 어디까지나 프로젝트의 시작을 알리는 행사이니 너무 심각한 내용을 담지는 말고, 운을 띄우는 정도로 활용하는 것이 좋다. 혹은 이 프로젝트 성공을 위해 핵심적으로 해결해야 하는 예상 위험요소들을 간략히 담는 것도 좋겠다.</p>
<h3 id="우리의-다짐"><a href="#우리의-다짐" class="headerlink" title="우리의 다짐"></a>우리의 다짐</h3><p>여느 발표와 마찬가지로 마지막으로 하고 싶은 한마디이다. 열심히 하겠다는 내용도 좋고, 프로젝트팀의 모토나 <a target="_blank" rel="noopener" href="https://terms.naver.com/entry.nhn?docId=1149487&cid=40942&categoryId=31766">캐치프레이즈</a>가 있다면 그것을 담아도 괜찮을 것이다. 만약  초반에 발표를 무겁게 시작했다면, 마지막에 분위기를 풀어줄 수 있도록 재치있게 마무리하는 것도 좋겠다. 반대로 초반에 발표를 조금 재치있게 시작했다면 마지막에는 좀더 진중한 멘트로 마무리해도 좋을 것이다. 이 부분은 철저히 보고서 작성자와 PM의 역량에 달려있는 부분이니 설명을 줄이도록 하겠다.</p>
<p>끝.</p>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><span class="level-item">Posted&nbsp;<time dateTime="2019-10-10T11:00:00.000Z" title="2019-10-10T11:00:00.000Z">2019-10-10</time></span><span class="level-item">Updated&nbsp;<time dateTime="2020-10-04T13:21:06.147Z" title="2020-10-04T13:21:06.147Z">2020-10-04</time></span><span class="level-item"><a class="link-muted" href="/categories/%EA%B8%B0%ED%9A%8D-RPA/">기획 &gt; RPA</a></span><span class="level-item">17 minutes read (About 2550 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2019/10/10/block-of-medical-rpa/">의료 RPA 사업기획안 - Block of Medical RPA</a></h1><div class="content"><p>2019년도 여름, 팀에서 새로운 먹거리를 찾기위해 몇몇 팀원분들과 함께 약 2~3개월 동안 신사업 발굴/기획 업무를 담당하였다. 당시 재미있는 신사업 아이템이 여럿 발굴되었고, 그 중에서 필자가 담당하였던 Block of Medical RPA는 운이 좋게도 내부적으로 긍정적인 평가를 받아 고객사(병원)와 사업 협의 중인 단계로 발전하였다. 이에 당시 신사업 아이디어를 어떤 방향으로 기획하였는지 기록으로 남기고자 한다. 다만, 외부 공개가 되면 곤란한 영업비밀이 일부 있어 해당 부분은 제거하였다.</p>
<p><strong>Block of Medical RPA</strong>란, 각종 자동화 업무들을 블록의 형태로 쌓아가는 모습을 형상화한 아이디어의 명칭이며, 핵심은 <strong>RPA 기반의 의료 인력운영 효율화 플랫폼</strong>이다. RPA란, Robotic Process Automation의 약자로, <strong>UI(User Interface) 상에서 사용자가 수행하던 업무/작업을 자동화하는 기술</strong>을 일컫는다. </p>
<p><img src="/image/block-of-medical-rpa/%EC%8A%AC%EB%9D%BC%EC%9D%B4%EB%93%9C01.png" alt=""></p>
<p><img src="/image/block-of-medical-rpa/%EC%8A%AC%EB%9D%BC%EC%9D%B4%EB%93%9C02.png" alt=""></p>
<hr>
<h2 id="추진배경"><a href="#추진배경" class="headerlink" title="추진배경"></a>추진배경</h2><p>사업을 추진하게 된 배경은, 대형병원의 환자수 급증 현상에 있다. 여러 대형병원들이 가진 공통의 고민이자 현재 사회적인 이슈이기도 하다. 병원 입장에서 이를 해결하려면 당장 시급한 것이 바로 <strong>인프라, 제도, 인력운영</strong> 측면에서의 대책이라 생각했다. </p>
<p>환자가 늘어나면 가장 먼저 인프라에 부하가 오기 때문에 이에 대한 해결책이 필요하다. 건물/공간이 모자라고, 시스템이 감당을 못한다. 제도적으로도 해결책이 필요하다. 정부적 차원에서 현재 환자를 분산할 수 있는 지원책, 의료인력을 확충하는 지원책 등을 마련해주어야 한다. 마지막으로 인력운영 측면에서 해결책도 필요하다. 환자가 많아지는 것은 곧 직원들의 일이 늘어나는 것을 의미하기 때문이다. </p>
<p>현재 여러 상급종합병원의 경우 자체적인 인프라 확장을 진행중이고, 제도적으로도 “전문병원 제도”, “입원전담전문의 제도” 등 지원책이 등장하고 있다. 안타까운 점은 인력운영에 대해서는 뚜렷한 해결책이 없다는 것이다. 시간이 흐를수록 상급종합병원 직원들의 업무량은 끝도없이 늘어가고 있는 실정이다.</p>
<p><img src="/image/block-of-medical-rpa/%EC%8A%AC%EB%9D%BC%EC%9D%B4%EB%93%9C03.png" alt=""></p>
<p>물론, 인력을 계속 때려박으면 문제가 해결되지 않을까 싶지만 병원들도 재정상황이 그리 녹록치 못하고, 더군다나 이는 의료계 추세와 맞지 않은 상황이다. 현재 의료계는 직접진료와 정밀의료 서비스 제공을 위해 전문 의료진 위주로 인력을 충원하고, 행정업무는 갈수록 효율화하고 있기 때문이다. </p>
<p>그렇다면 인력운영 효율화를 하기 위해서는 어떤 방법이 있을까? 이는 3가지로 나누어 생각해볼 수 있다. 첫째 업무속도를 향상시켜주는 방법, 둘째 업무 분장을 조정해주는 방법, 셋째 업무량을 줄여주는 방법이다. 조사를 통해 확인해보니 이미 여러 상급종합병원에서 업무속도향상 및 업무분장조정에 대한 대응책을 진행 중이거나 진행완료하였다. 다만, 업무량 자체를 줄여주는 방법에 대해서는 아직까지 도입한 사례는 뚜렷하게 확인하기 어려웠고 이 부분이 아직 개척되지 않은 미지의 영역일 수 있겠다 판단했다.</p>
<p><img src="/image/block-of-medical-rpa/%EC%8A%AC%EB%9D%BC%EC%9D%B4%EB%93%9C04.png" alt=""></p>
<p>그렇다면 IT 기술로 업무량을 줄이는데 도움을 줄 수 있을 만한 업무영역은 어떤 것들이 있고, 어떤 IT기술들이 필요한지를 아래와 같이 조사하였다. 결론적으로는 RPA라는 기술이 다방면으로 활동될 수 있다는 점을 찾아냈다.</p>
<p><img src="/image/block-of-medical-rpa/%EC%8A%AC%EB%9D%BC%EC%9D%B4%EB%93%9C05.png" alt=""></p>
<p>서두에서도 언급했으나 RPA란, 로보틱 처리 자동화 기술로 Email, Excel, XML, Web/App 등 다양한 작업유형들을 자동화할 수 있는 기술이다. HfS리서치, EY한영, 맥킨지, 가트너 등에서 발표한 내용들을 참고해보았을 때 현재 가장 뜨겁게 주목받고 있는 기술이면서, 한국에서도 금융/제조/유통 산업 중심으로 보급되고 있는 추세이다.</p>
<p><img src="/image/block-of-medical-rpa/%EC%8A%AC%EB%9D%BC%EC%9D%B4%EB%93%9C06.png" alt=""></p>
<p>RPA는 Robotic &gt; Cognitive Robotic &gt; Intelligent Robotic의 흐름으로 발전되고 있고, 그에 따라 RPA를 도입하는 병원에서는 이와 Align되는 방향으로 로드맵(추진전략)을 세울 수 있을 것으로 판단하였다. 즉, RPA를 단기적으로는 단순/반복 업무에, 중기적으로는 데이터분석 업무에, 장기적으로는 의학적 업무에 도입하는 것이다. 그리고 장기적인 Goal로는 CDSS를 대체할 수 있는 진단솔루션의 역할을 하는 것이다.</p>
<p><img src="/image/block-of-medical-rpa/%EC%8A%AC%EB%9D%BC%EC%9D%B4%EB%93%9C07.png" alt=""></p>
<hr>
<h2 id="추진과제"><a href="#추진과제" class="headerlink" title="추진과제"></a>추진과제</h2><p>RPA는 좋은 기술이다. 하지만, 기술 그 자체가 상품이 되기는 어렵다고 생각했다. 기술을 고객이 이해할 수 있는 언어로 전달해야 매력적인 상품이 될 수 있겠다 판단했다. 그래서 탄생한 것이 <strong>Block of Medical RPA라는 컨셉</strong>이다. RPA로 자동화한 업무 프로세스들을 레고블럭처럼 차곡차곡 쌓아가는 모습을 형상화하였다. 이것들을 업무단위(y축)로, 그리고 시스템 단위(x축)으로 쌓아나갔을 때 안정적이게 쌓아올려질 수 있을 것이라는 이미지를 삽입하였다.</p>
<p><img src="/image/block-of-medical-rpa/%EC%8A%AC%EB%9D%BC%EC%9D%B4%EB%93%9C08.png" alt=""></p>
<p>RPA를 통해 구축될 전반적인 플랫폼의 구성도이다. (먼저, 우리가 도입한 RPA 솔루션은 UiPath의 제품이라는 것을 밝힌다.) Block of Medical RPA와 UiPath RPA는 하나의 상품으로 제공된다. 그리고 이는 Internal Legacy System(병원 내부 시스템)과 External Website(외부 사이트)들과 연계되어 동작한다.</p>
<p>UiPath RPA는 업무 자동화 기술을 담당하고, Block of Medical RPA는 그 외의 KPI/ROI 모니터링, 타기관 사례 공유, 신규요구사항관리, 유지보수/변경관리 등의 플랫폼으로서의 기능을 담당한다.</p>
<p><img src="/image/block-of-medical-rpa/%EC%8A%AC%EB%9D%BC%EC%9D%B4%EB%93%9C09.png" alt=""></p>
<p>RPA 도입 프로세스는 일반적인 SI와 대동소이하지만, “안정화”라는 단계가 매우 중요하다. RPA는 살아 움직이는 시스템 위에서 동작하는 것이다 보니, 구축 단계에서 파악하지 못한 예외적인 케이스들이 많이 도출된다. </p>
<p><img src="/image/block-of-medical-rpa/%EC%8A%AC%EB%9D%BC%EC%9D%B4%EB%93%9C10.png" alt=""></p>
<p>어찌보면 고객(병원)이 가장 궁금해할만한 부분일 것 같다. 병원의 어떤 업무들에 RPA를 도입할 수 있을까? 이를 도출하기 위해 함께 일하고 있는 병원 IT 전문가들과 수차례 브레인스토밍을 거쳐, 3가지 카테고리의 21개의 과제를 뽑아낼 수 있었다.</p>
<p><img src="/image/block-of-medical-rpa/%EC%8A%AC%EB%9D%BC%EC%9D%B4%EB%93%9C11.png" alt=""></p>
<p>도출된 21개 과제들 중에서, 어떤 과제를 우선적으로 추진할지를 선정하였다. 실현가능성, 기대효과, 활용성이라는 3가지 기준을 가지고 정량평가를 통해 3개의 우선과제를 도출하였다.</p>
<p><img src="/image/block-of-medical-rpa/%EC%8A%AC%EB%9D%BC%EC%9D%B4%EB%93%9C12.png" alt=""></p>
<p>우선과제 3개를 파일럿 형태로 적용하지만, 점진적으로 도입을 확대해나가는 모델은 아래와 같은 Double Diamond 프로세스가 될 것이다.</p>
<p><img src="/image/block-of-medical-rpa/%EC%8A%AC%EB%9D%BC%EC%9D%B4%EB%93%9C13.png" alt=""></p>
<p>우선과제 3개 중에서, [신규직원 등록 및 각종 데이터 생성 작업]을 샘플로 업무 프로세스 구체화를 진행하였다. 세부적으로 쪼개보니 예상보다 많은 상세 작업들이 있음을 알 수 있다. 프로세스를 상세화하는 이유는, 자동화할 수 있는 범위를 예측하기 위함이다. 실제 RPA를 도입하게 되면, 아래와 유사한 형태로 프로세스를 상세화하고 평가하는 과정을 거치게 된다.</p>
<p><img src="/image/block-of-medical-rpa/%EC%8A%AC%EB%9D%BC%EC%9D%B4%EB%93%9C14.png" alt=""></p>
<p>이 업무를 도입했을 때 얼마만큼의 효과가 기대되는지를 서울 A병원을 예시로 시뮬레이션해보았다. 데이터는 국민연금 기반 데이터를 근거로 하였다. </p>
<p><img src="/image/block-of-medical-rpa/%EC%8A%AC%EB%9D%BC%EC%9D%B4%EB%93%9C15.png" alt=""></p>
<p>이 업무를 신규입사 뿐 아니라, 퇴사/휴직/파견/수련 등 직원 데이터가 갱신되는 모든 범위로 확장하였을 때 얼마만큼의 효과가 기대되는지를 서울 A병원을 예시로 시뮬레이션해보았다.  데이터는 국민연금 기반 데이터를 근거로 하되, 확인이 불가한 수치는 일부 추정치를 적용하였다.</p>
<p><img src="/image/block-of-medical-rpa/%EC%8A%AC%EB%9D%BC%EC%9D%B4%EB%93%9C16.png" alt=""></p>
<hr>
<h2 id="추진비용"><a href="#추진비용" class="headerlink" title="추진비용"></a>추진비용</h2><p>서두에서도 언급했듯이, 비용과 관련된 부분은 영업비밀이기 때문에 내용을 제거하였다. </p>
<p><img src="/image/block-of-medical-rpa/%EC%8A%AC%EB%9D%BC%EC%9D%B4%EB%93%9C18.png" alt=""></p>
<p><img src="/image/block-of-medical-rpa/%EC%8A%AC%EB%9D%BC%EC%9D%B4%EB%93%9C17.png" alt=""></p>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><span class="level-item">Posted&nbsp;<time dateTime="2019-06-15T11:00:00.000Z" title="2019-06-15T11:00:00.000Z">2019-06-15</time></span><span class="level-item">Updated&nbsp;<time dateTime="2020-10-19T11:56:37.013Z" title="2020-10-19T11:56:37.013Z">2020-10-19</time></span><span class="level-item"><a class="link-muted" href="/categories/%EC%86%8C%EC%8A%A4%EC%BD%94%EB%93%9C-%EC%9D%98%EB%A3%8C/">소스코드 &gt; 의료</a></span><span class="level-item">2 hours read (About 14761 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2019/06/15/sourcecode-jusasil-1/">주사실환자목록 소스코드</a></h1><div class="content"><h2 id="개요"><a href="#개요" class="headerlink" title="개요"></a>개요</h2><h3 id="화면설명"><a href="#화면설명" class="headerlink" title="화면설명"></a>화면설명</h3><ul>
<li>화면명: 주사실환자목록</li>
<li>설명: 동관/신관/소아/소아항암 주사실의 환자 목록을 조회하는 화면</li>
</ul>
<h3 id="활용기술"><a href="#활용기술" class="headerlink" title="활용기술"></a>활용기술</h3><ul>
<li>Client: C# Visual Studio, DevExpress</li>
<li>Server: Java Spring, SQL</li>
<li>DB: Oracle</li>
</ul>
<h3 id="공수"><a href="#공수" class="headerlink" title="공수"></a>공수</h3><ul>
<li>개발기간: 약 3개월</li>
<li>전체 소스코드 분량: 약 3,500 line</li>
</ul>
<h3 id="이미지"><a href="#이미지" class="headerlink" title="이미지"></a>이미지</h3><p><img src="sourcecode-jusasil-1/%E1%84%8C%E1%85%AE%E1%84%89%E1%85%A1%E1%84%89%E1%85%B5%E1%86%AF%E1%84%92%E1%85%AA%E1%86%AB%E1%84%8C%E1%85%A1%E1%84%86%E1%85%A9%E1%86%A8%E1%84%85%E1%85%A9%E1%86%A8%20%E1%84%8B%E1%85%B5%E1%84%86%E1%85%B5%E1%84%8C%E1%85%B5_%E1%84%80%E1%85%A2%E1%84%8B%E1%85%B5%E1%86%AB%E1%84%8C%E1%85%A5%E1%86%BC%E1%84%87%E1%85%A9%E1%84%80%E1%85%A1%E1%84%85%E1%85%B5%E1%86%B7.png" alt=""></p>
<hr>
<h2 id="Client"><a href="#Client" class="headerlink" title="Client"></a>Client</h2><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br><span class="line">441</span><br><span class="line">442</span><br><span class="line">443</span><br><span class="line">444</span><br><span class="line">445</span><br><span class="line">446</span><br><span class="line">447</span><br><span class="line">448</span><br><span class="line">449</span><br><span class="line">450</span><br><span class="line">451</span><br><span class="line">452</span><br><span class="line">453</span><br><span class="line">454</span><br><span class="line">455</span><br><span class="line">456</span><br><span class="line">457</span><br><span class="line">458</span><br><span class="line">459</span><br><span class="line">460</span><br><span class="line">461</span><br><span class="line">462</span><br><span class="line">463</span><br><span class="line">464</span><br><span class="line">465</span><br><span class="line">466</span><br><span class="line">467</span><br><span class="line">468</span><br><span class="line">469</span><br><span class="line">470</span><br><span class="line">471</span><br><span class="line">472</span><br><span class="line">473</span><br><span class="line">474</span><br><span class="line">475</span><br><span class="line">476</span><br><span class="line">477</span><br><span class="line">478</span><br><span class="line">479</span><br><span class="line">480</span><br><span class="line">481</span><br><span class="line">482</span><br><span class="line">483</span><br><span class="line">484</span><br><span class="line">485</span><br><span class="line">486</span><br><span class="line">487</span><br><span class="line">488</span><br><span class="line">489</span><br><span class="line">490</span><br><span class="line">491</span><br><span class="line">492</span><br><span class="line">493</span><br><span class="line">494</span><br><span class="line">495</span><br><span class="line">496</span><br><span class="line">497</span><br><span class="line">498</span><br><span class="line">499</span><br><span class="line">500</span><br><span class="line">501</span><br><span class="line">502</span><br><span class="line">503</span><br><span class="line">504</span><br><span class="line">505</span><br><span class="line">506</span><br><span class="line">507</span><br><span class="line">508</span><br><span class="line">509</span><br><span class="line">510</span><br><span class="line">511</span><br><span class="line">512</span><br><span class="line">513</span><br><span class="line">514</span><br><span class="line">515</span><br><span class="line">516</span><br><span class="line">517</span><br><span class="line">518</span><br><span class="line">519</span><br><span class="line">520</span><br><span class="line">521</span><br><span class="line">522</span><br><span class="line">523</span><br><span class="line">524</span><br><span class="line">525</span><br><span class="line">526</span><br><span class="line">527</span><br><span class="line">528</span><br><span class="line">529</span><br><span class="line">530</span><br><span class="line">531</span><br><span class="line">532</span><br><span class="line">533</span><br><span class="line">534</span><br><span class="line">535</span><br><span class="line">536</span><br><span class="line">537</span><br><span class="line">538</span><br><span class="line">539</span><br><span class="line">540</span><br><span class="line">541</span><br><span class="line">542</span><br><span class="line">543</span><br><span class="line">544</span><br><span class="line">545</span><br><span class="line">546</span><br><span class="line">547</span><br><span class="line">548</span><br><span class="line">549</span><br><span class="line">550</span><br><span class="line">551</span><br><span class="line">552</span><br><span class="line">553</span><br><span class="line">554</span><br><span class="line">555</span><br><span class="line">556</span><br><span class="line">557</span><br><span class="line">558</span><br><span class="line">559</span><br><span class="line">560</span><br><span class="line">561</span><br><span class="line">562</span><br><span class="line">563</span><br><span class="line">564</span><br><span class="line">565</span><br><span class="line">566</span><br><span class="line">567</span><br><span class="line">568</span><br><span class="line">569</span><br><span class="line">570</span><br><span class="line">571</span><br><span class="line">572</span><br><span class="line">573</span><br><span class="line">574</span><br><span class="line">575</span><br><span class="line">576</span><br><span class="line">577</span><br><span class="line">578</span><br><span class="line">579</span><br><span class="line">580</span><br><span class="line">581</span><br><span class="line">582</span><br><span class="line">583</span><br><span class="line">584</span><br><span class="line">585</span><br><span class="line">586</span><br><span class="line">587</span><br><span class="line">588</span><br><span class="line">589</span><br><span class="line">590</span><br><span class="line">591</span><br><span class="line">592</span><br><span class="line">593</span><br><span class="line">594</span><br><span class="line">595</span><br><span class="line">596</span><br><span class="line">597</span><br><span class="line">598</span><br><span class="line">599</span><br><span class="line">600</span><br><span class="line">601</span><br><span class="line">602</span><br><span class="line">603</span><br><span class="line">604</span><br><span class="line">605</span><br><span class="line">606</span><br><span class="line">607</span><br><span class="line">608</span><br><span class="line">609</span><br><span class="line">610</span><br><span class="line">611</span><br><span class="line">612</span><br><span class="line">613</span><br><span class="line">614</span><br><span class="line">615</span><br><span class="line">616</span><br><span class="line">617</span><br><span class="line">618</span><br><span class="line">619</span><br><span class="line">620</span><br><span class="line">621</span><br><span class="line">622</span><br><span class="line">623</span><br><span class="line">624</span><br><span class="line">625</span><br><span class="line">626</span><br><span class="line">627</span><br><span class="line">628</span><br><span class="line">629</span><br><span class="line">630</span><br><span class="line">631</span><br><span class="line">632</span><br><span class="line">633</span><br><span class="line">634</span><br><span class="line">635</span><br><span class="line">636</span><br><span class="line">637</span><br><span class="line">638</span><br><span class="line">639</span><br><span class="line">640</span><br><span class="line">641</span><br><span class="line">642</span><br><span class="line">643</span><br><span class="line">644</span><br><span class="line">645</span><br><span class="line">646</span><br><span class="line">647</span><br><span class="line">648</span><br><span class="line">649</span><br><span class="line">650</span><br><span class="line">651</span><br><span class="line">652</span><br><span class="line">653</span><br><span class="line">654</span><br><span class="line">655</span><br><span class="line">656</span><br><span class="line">657</span><br><span class="line">658</span><br><span class="line">659</span><br><span class="line">660</span><br><span class="line">661</span><br><span class="line">662</span><br><span class="line">663</span><br><span class="line">664</span><br><span class="line">665</span><br><span class="line">666</span><br><span class="line">667</span><br><span class="line">668</span><br><span class="line">669</span><br><span class="line">670</span><br><span class="line">671</span><br><span class="line">672</span><br><span class="line">673</span><br><span class="line">674</span><br><span class="line">675</span><br><span class="line">676</span><br><span class="line">677</span><br><span class="line">678</span><br><span class="line">679</span><br><span class="line">680</span><br><span class="line">681</span><br><span class="line">682</span><br><span class="line">683</span><br><span class="line">684</span><br><span class="line">685</span><br><span class="line">686</span><br><span class="line">687</span><br><span class="line">688</span><br><span class="line">689</span><br><span class="line">690</span><br><span class="line">691</span><br><span class="line">692</span><br><span class="line">693</span><br><span class="line">694</span><br><span class="line">695</span><br><span class="line">696</span><br><span class="line">697</span><br><span class="line">698</span><br><span class="line">699</span><br><span class="line">700</span><br><span class="line">701</span><br><span class="line">702</span><br><span class="line">703</span><br><span class="line">704</span><br><span class="line">705</span><br><span class="line">706</span><br><span class="line">707</span><br><span class="line">708</span><br><span class="line">709</span><br><span class="line">710</span><br><span class="line">711</span><br><span class="line">712</span><br><span class="line">713</span><br><span class="line">714</span><br><span class="line">715</span><br><span class="line">716</span><br><span class="line">717</span><br><span class="line">718</span><br><span class="line">719</span><br><span class="line">720</span><br><span class="line">721</span><br><span class="line">722</span><br><span class="line">723</span><br><span class="line">724</span><br><span class="line">725</span><br><span class="line">726</span><br><span class="line">727</span><br><span class="line">728</span><br><span class="line">729</span><br><span class="line">730</span><br><span class="line">731</span><br><span class="line">732</span><br><span class="line">733</span><br><span class="line">734</span><br><span class="line">735</span><br><span class="line">736</span><br><span class="line">737</span><br><span class="line">738</span><br><span class="line">739</span><br><span class="line">740</span><br><span class="line">741</span><br><span class="line">742</span><br><span class="line">743</span><br><span class="line">744</span><br><span class="line">745</span><br><span class="line">746</span><br><span class="line">747</span><br><span class="line">748</span><br><span class="line">749</span><br><span class="line">750</span><br><span class="line">751</span><br><span class="line">752</span><br><span class="line">753</span><br><span class="line">754</span><br><span class="line">755</span><br><span class="line">756</span><br><span class="line">757</span><br><span class="line">758</span><br><span class="line">759</span><br><span class="line">760</span><br><span class="line">761</span><br><span class="line">762</span><br><span class="line">763</span><br><span class="line">764</span><br><span class="line">765</span><br><span class="line">766</span><br><span class="line">767</span><br><span class="line">768</span><br><span class="line">769</span><br><span class="line">770</span><br><span class="line">771</span><br><span class="line">772</span><br><span class="line">773</span><br><span class="line">774</span><br><span class="line">775</span><br><span class="line">776</span><br><span class="line">777</span><br><span class="line">778</span><br><span class="line">779</span><br><span class="line">780</span><br><span class="line">781</span><br><span class="line">782</span><br><span class="line">783</span><br><span class="line">784</span><br><span class="line">785</span><br><span class="line">786</span><br><span class="line">787</span><br><span class="line">788</span><br><span class="line">789</span><br><span class="line">790</span><br><span class="line">791</span><br><span class="line">792</span><br><span class="line">793</span><br><span class="line">794</span><br><span class="line">795</span><br><span class="line">796</span><br><span class="line">797</span><br><span class="line">798</span><br><span class="line">799</span><br><span class="line">800</span><br><span class="line">801</span><br><span class="line">802</span><br><span class="line">803</span><br><span class="line">804</span><br><span class="line">805</span><br><span class="line">806</span><br><span class="line">807</span><br><span class="line">808</span><br><span class="line">809</span><br><span class="line">810</span><br><span class="line">811</span><br><span class="line">812</span><br><span class="line">813</span><br><span class="line">814</span><br><span class="line">815</span><br><span class="line">816</span><br><span class="line">817</span><br><span class="line">818</span><br><span class="line">819</span><br><span class="line">820</span><br><span class="line">821</span><br><span class="line">822</span><br><span class="line">823</span><br><span class="line">824</span><br><span class="line">825</span><br><span class="line">826</span><br><span class="line">827</span><br><span class="line">828</span><br><span class="line">829</span><br><span class="line">830</span><br><span class="line">831</span><br><span class="line">832</span><br><span class="line">833</span><br><span class="line">834</span><br><span class="line">835</span><br><span class="line">836</span><br><span class="line">837</span><br><span class="line">838</span><br><span class="line">839</span><br><span class="line">840</span><br><span class="line">841</span><br><span class="line">842</span><br><span class="line">843</span><br><span class="line">844</span><br><span class="line">845</span><br><span class="line">846</span><br><span class="line">847</span><br><span class="line">848</span><br><span class="line">849</span><br><span class="line">850</span><br><span class="line">851</span><br><span class="line">852</span><br><span class="line">853</span><br><span class="line">854</span><br><span class="line">855</span><br><span class="line">856</span><br><span class="line">857</span><br><span class="line">858</span><br><span class="line">859</span><br><span class="line">860</span><br><span class="line">861</span><br><span class="line">862</span><br><span class="line">863</span><br><span class="line">864</span><br><span class="line">865</span><br><span class="line">866</span><br><span class="line">867</span><br><span class="line">868</span><br><span class="line">869</span><br><span class="line">870</span><br><span class="line">871</span><br><span class="line">872</span><br><span class="line">873</span><br><span class="line">874</span><br><span class="line">875</span><br><span class="line">876</span><br><span class="line">877</span><br><span class="line">878</span><br><span class="line">879</span><br><span class="line">880</span><br><span class="line">881</span><br><span class="line">882</span><br><span class="line">883</span><br><span class="line">884</span><br><span class="line">885</span><br><span class="line">886</span><br><span class="line">887</span><br><span class="line">888</span><br><span class="line">889</span><br><span class="line">890</span><br><span class="line">891</span><br><span class="line">892</span><br><span class="line">893</span><br><span class="line">894</span><br><span class="line">895</span><br><span class="line">896</span><br><span class="line">897</span><br><span class="line">898</span><br><span class="line">899</span><br><span class="line">900</span><br><span class="line">901</span><br><span class="line">902</span><br><span class="line">903</span><br><span class="line">904</span><br><span class="line">905</span><br><span class="line">906</span><br><span class="line">907</span><br><span class="line">908</span><br><span class="line">909</span><br><span class="line">910</span><br><span class="line">911</span><br><span class="line">912</span><br><span class="line">913</span><br><span class="line">914</span><br><span class="line">915</span><br><span class="line">916</span><br><span class="line">917</span><br><span class="line">918</span><br><span class="line">919</span><br><span class="line">920</span><br><span class="line">921</span><br><span class="line">922</span><br><span class="line">923</span><br><span class="line">924</span><br><span class="line">925</span><br><span class="line">926</span><br><span class="line">927</span><br><span class="line">928</span><br><span class="line">929</span><br><span class="line">930</span><br><span class="line">931</span><br><span class="line">932</span><br><span class="line">933</span><br><span class="line">934</span><br><span class="line">935</span><br><span class="line">936</span><br><span class="line">937</span><br><span class="line">938</span><br><span class="line">939</span><br><span class="line">940</span><br><span class="line">941</span><br><span class="line">942</span><br><span class="line">943</span><br><span class="line">944</span><br><span class="line">945</span><br><span class="line">946</span><br><span class="line">947</span><br><span class="line">948</span><br><span class="line">949</span><br><span class="line">950</span><br><span class="line">951</span><br><span class="line">952</span><br><span class="line">953</span><br><span class="line">954</span><br><span class="line">955</span><br><span class="line">956</span><br><span class="line">957</span><br><span class="line">958</span><br><span class="line">959</span><br><span class="line">960</span><br><span class="line">961</span><br><span class="line">962</span><br><span class="line">963</span><br><span class="line">964</span><br><span class="line">965</span><br><span class="line">966</span><br><span class="line">967</span><br><span class="line">968</span><br><span class="line">969</span><br><span class="line">970</span><br><span class="line">971</span><br><span class="line">972</span><br><span class="line">973</span><br><span class="line">974</span><br><span class="line">975</span><br><span class="line">976</span><br><span class="line">977</span><br><span class="line">978</span><br><span class="line">979</span><br><span class="line">980</span><br><span class="line">981</span><br><span class="line">982</span><br><span class="line">983</span><br><span class="line">984</span><br><span class="line">985</span><br><span class="line">986</span><br><span class="line">987</span><br><span class="line">988</span><br><span class="line">989</span><br><span class="line">990</span><br><span class="line">991</span><br><span class="line">992</span><br><span class="line">993</span><br><span class="line">994</span><br><span class="line">995</span><br><span class="line">996</span><br><span class="line">997</span><br><span class="line">998</span><br><span class="line">999</span><br><span class="line">1000</span><br><span class="line">1001</span><br><span class="line">1002</span><br><span class="line">1003</span><br><span class="line">1004</span><br><span class="line">1005</span><br><span class="line">1006</span><br><span class="line">1007</span><br><span class="line">1008</span><br><span class="line">1009</span><br><span class="line">1010</span><br><span class="line">1011</span><br><span class="line">1012</span><br><span class="line">1013</span><br><span class="line">1014</span><br><span class="line">1015</span><br><span class="line">1016</span><br><span class="line">1017</span><br><span class="line">1018</span><br><span class="line">1019</span><br><span class="line">1020</span><br><span class="line">1021</span><br><span class="line">1022</span><br><span class="line">1023</span><br><span class="line">1024</span><br><span class="line">1025</span><br><span class="line">1026</span><br><span class="line">1027</span><br><span class="line">1028</span><br><span class="line">1029</span><br><span class="line">1030</span><br><span class="line">1031</span><br><span class="line">1032</span><br><span class="line">1033</span><br><span class="line">1034</span><br><span class="line">1035</span><br><span class="line">1036</span><br><span class="line">1037</span><br><span class="line">1038</span><br><span class="line">1039</span><br><span class="line">1040</span><br><span class="line">1041</span><br><span class="line">1042</span><br><span class="line">1043</span><br><span class="line">1044</span><br><span class="line">1045</span><br><span class="line">1046</span><br><span class="line">1047</span><br><span class="line">1048</span><br><span class="line">1049</span><br><span class="line">1050</span><br><span class="line">1051</span><br><span class="line">1052</span><br><span class="line">1053</span><br><span class="line">1054</span><br><span class="line">1055</span><br><span class="line">1056</span><br><span class="line">1057</span><br><span class="line">1058</span><br><span class="line">1059</span><br><span class="line">1060</span><br><span class="line">1061</span><br><span class="line">1062</span><br><span class="line">1063</span><br><span class="line">1064</span><br><span class="line">1065</span><br><span class="line">1066</span><br><span class="line">1067</span><br><span class="line">1068</span><br><span class="line">1069</span><br><span class="line">1070</span><br><span class="line">1071</span><br><span class="line">1072</span><br><span class="line">1073</span><br><span class="line">1074</span><br><span class="line">1075</span><br><span class="line">1076</span><br><span class="line">1077</span><br><span class="line">1078</span><br><span class="line">1079</span><br><span class="line">1080</span><br><span class="line">1081</span><br><span class="line">1082</span><br><span class="line">1083</span><br><span class="line">1084</span><br><span class="line">1085</span><br><span class="line">1086</span><br><span class="line">1087</span><br><span class="line">1088</span><br><span class="line">1089</span><br><span class="line">1090</span><br><span class="line">1091</span><br><span class="line">1092</span><br><span class="line">1093</span><br><span class="line">1094</span><br><span class="line">1095</span><br><span class="line">1096</span><br><span class="line">1097</span><br><span class="line">1098</span><br><span class="line">1099</span><br><span class="line">1100</span><br><span class="line">1101</span><br><span class="line">1102</span><br><span class="line">1103</span><br><span class="line">1104</span><br><span class="line">1105</span><br><span class="line">1106</span><br><span class="line">1107</span><br><span class="line">1108</span><br><span class="line">1109</span><br><span class="line">1110</span><br><span class="line">1111</span><br><span class="line">1112</span><br><span class="line">1113</span><br><span class="line">1114</span><br><span class="line">1115</span><br><span class="line">1116</span><br><span class="line">1117</span><br><span class="line">1118</span><br><span class="line">1119</span><br><span class="line">1120</span><br><span class="line">1121</span><br><span class="line">1122</span><br><span class="line">1123</span><br><span class="line">1124</span><br><span class="line">1125</span><br><span class="line">1126</span><br><span class="line">1127</span><br><span class="line">1128</span><br><span class="line">1129</span><br><span class="line">1130</span><br><span class="line">1131</span><br><span class="line">1132</span><br><span class="line">1133</span><br><span class="line">1134</span><br><span class="line">1135</span><br><span class="line">1136</span><br><span class="line">1137</span><br><span class="line">1138</span><br><span class="line">1139</span><br><span class="line">1140</span><br><span class="line">1141</span><br><span class="line">1142</span><br><span class="line">1143</span><br><span class="line">1144</span><br><span class="line">1145</span><br><span class="line">1146</span><br><span class="line">1147</span><br><span class="line">1148</span><br><span class="line">1149</span><br><span class="line">1150</span><br><span class="line">1151</span><br><span class="line">1152</span><br><span class="line">1153</span><br><span class="line">1154</span><br><span class="line">1155</span><br><span class="line">1156</span><br><span class="line">1157</span><br><span class="line">1158</span><br><span class="line">1159</span><br><span class="line">1160</span><br><span class="line">1161</span><br><span class="line">1162</span><br><span class="line">1163</span><br><span class="line">1164</span><br><span class="line">1165</span><br><span class="line">1166</span><br><span class="line">1167</span><br><span class="line">1168</span><br><span class="line">1169</span><br><span class="line">1170</span><br><span class="line">1171</span><br><span class="line">1172</span><br><span class="line">1173</span><br><span class="line">1174</span><br><span class="line">1175</span><br><span class="line">1176</span><br><span class="line">1177</span><br><span class="line">1178</span><br><span class="line">1179</span><br><span class="line">1180</span><br><span class="line">1181</span><br><span class="line">1182</span><br><span class="line">1183</span><br><span class="line">1184</span><br><span class="line">1185</span><br><span class="line">1186</span><br><span class="line">1187</span><br><span class="line">1188</span><br><span class="line">1189</span><br><span class="line">1190</span><br><span class="line">1191</span><br><span class="line">1192</span><br><span class="line">1193</span><br><span class="line">1194</span><br><span class="line">1195</span><br><span class="line">1196</span><br><span class="line">1197</span><br><span class="line">1198</span><br><span class="line">1199</span><br><span class="line">1200</span><br><span class="line">1201</span><br><span class="line">1202</span><br><span class="line">1203</span><br><span class="line">1204</span><br><span class="line">1205</span><br><span class="line">1206</span><br><span class="line">1207</span><br><span class="line">1208</span><br><span class="line">1209</span><br><span class="line">1210</span><br><span class="line">1211</span><br><span class="line">1212</span><br><span class="line">1213</span><br><span class="line">1214</span><br><span class="line">1215</span><br><span class="line">1216</span><br><span class="line">1217</span><br><span class="line">1218</span><br><span class="line">1219</span><br><span class="line">1220</span><br><span class="line">1221</span><br><span class="line">1222</span><br><span class="line">1223</span><br><span class="line">1224</span><br><span class="line">1225</span><br><span class="line">1226</span><br><span class="line">1227</span><br><span class="line">1228</span><br><span class="line">1229</span><br><span class="line">1230</span><br><span class="line">1231</span><br><span class="line">1232</span><br><span class="line">1233</span><br><span class="line">1234</span><br><span class="line">1235</span><br><span class="line">1236</span><br><span class="line">1237</span><br><span class="line">1238</span><br><span class="line">1239</span><br><span class="line">1240</span><br><span class="line">1241</span><br><span class="line">1242</span><br><span class="line">1243</span><br><span class="line">1244</span><br><span class="line">1245</span><br><span class="line">1246</span><br><span class="line">1247</span><br><span class="line">1248</span><br><span class="line">1249</span><br><span class="line">1250</span><br><span class="line">1251</span><br><span class="line">1252</span><br><span class="line">1253</span><br><span class="line">1254</span><br><span class="line">1255</span><br><span class="line">1256</span><br><span class="line">1257</span><br><span class="line">1258</span><br><span class="line">1259</span><br><span class="line">1260</span><br><span class="line">1261</span><br><span class="line">1262</span><br><span class="line">1263</span><br><span class="line">1264</span><br><span class="line">1265</span><br><span class="line">1266</span><br><span class="line">1267</span><br><span class="line">1268</span><br><span class="line">1269</span><br><span class="line">1270</span><br><span class="line">1271</span><br><span class="line">1272</span><br><span class="line">1273</span><br><span class="line">1274</span><br><span class="line">1275</span><br><span class="line">1276</span><br><span class="line">1277</span><br><span class="line">1278</span><br><span class="line">1279</span><br><span class="line">1280</span><br><span class="line">1281</span><br><span class="line">1282</span><br><span class="line">1283</span><br><span class="line">1284</span><br><span class="line">1285</span><br><span class="line">1286</span><br><span class="line">1287</span><br><span class="line">1288</span><br><span class="line">1289</span><br><span class="line">1290</span><br><span class="line">1291</span><br><span class="line">1292</span><br><span class="line">1293</span><br><span class="line">1294</span><br><span class="line">1295</span><br><span class="line">1296</span><br><span class="line">1297</span><br><span class="line">1298</span><br><span class="line">1299</span><br><span class="line">1300</span><br><span class="line">1301</span><br><span class="line">1302</span><br><span class="line">1303</span><br><span class="line">1304</span><br><span class="line">1305</span><br><span class="line">1306</span><br><span class="line">1307</span><br><span class="line">1308</span><br><span class="line">1309</span><br><span class="line">1310</span><br><span class="line">1311</span><br><span class="line">1312</span><br><span class="line">1313</span><br><span class="line">1314</span><br><span class="line">1315</span><br><span class="line">1316</span><br><span class="line">1317</span><br><span class="line">1318</span><br><span class="line">1319</span><br><span class="line">1320</span><br><span class="line">1321</span><br><span class="line">1322</span><br><span class="line">1323</span><br><span class="line">1324</span><br><span class="line">1325</span><br><span class="line">1326</span><br><span class="line">1327</span><br><span class="line">1328</span><br><span class="line">1329</span><br><span class="line">1330</span><br><span class="line">1331</span><br><span class="line">1332</span><br><span class="line">1333</span><br><span class="line">1334</span><br><span class="line">1335</span><br><span class="line">1336</span><br><span class="line">1337</span><br><span class="line">1338</span><br><span class="line">1339</span><br><span class="line">1340</span><br><span class="line">1341</span><br><span class="line">1342</span><br><span class="line">1343</span><br><span class="line">1344</span><br><span class="line">1345</span><br><span class="line">1346</span><br><span class="line">1347</span><br><span class="line">1348</span><br><span class="line">1349</span><br><span class="line">1350</span><br><span class="line">1351</span><br><span class="line">1352</span><br><span class="line">1353</span><br><span class="line">1354</span><br><span class="line">1355</span><br><span class="line">1356</span><br><span class="line">1357</span><br><span class="line">1358</span><br><span class="line">1359</span><br><span class="line">1360</span><br><span class="line">1361</span><br><span class="line">1362</span><br><span class="line">1363</span><br><span class="line">1364</span><br><span class="line">1365</span><br><span class="line">1366</span><br><span class="line">1367</span><br><span class="line">1368</span><br><span class="line">1369</span><br><span class="line">1370</span><br><span class="line">1371</span><br><span class="line">1372</span><br><span class="line">1373</span><br><span class="line">1374</span><br><span class="line">1375</span><br><span class="line">1376</span><br><span class="line">1377</span><br><span class="line">1378</span><br><span class="line">1379</span><br><span class="line">1380</span><br><span class="line">1381</span><br><span class="line">1382</span><br><span class="line">1383</span><br><span class="line">1384</span><br><span class="line">1385</span><br><span class="line">1386</span><br><span class="line">1387</span><br><span class="line">1388</span><br><span class="line">1389</span><br><span class="line">1390</span><br><span class="line">1391</span><br><span class="line">1392</span><br><span class="line">1393</span><br><span class="line">1394</span><br><span class="line">1395</span><br><span class="line">1396</span><br><span class="line">1397</span><br><span class="line">1398</span><br><span class="line">1399</span><br><span class="line">1400</span><br><span class="line">1401</span><br><span class="line">1402</span><br><span class="line">1403</span><br><span class="line">1404</span><br><span class="line">1405</span><br><span class="line">1406</span><br><span class="line">1407</span><br><span class="line">1408</span><br><span class="line">1409</span><br><span class="line">1410</span><br><span class="line">1411</span><br><span class="line">1412</span><br><span class="line">1413</span><br><span class="line">1414</span><br><span class="line">1415</span><br><span class="line">1416</span><br><span class="line">1417</span><br><span class="line">1418</span><br><span class="line">1419</span><br><span class="line">1420</span><br><span class="line">1421</span><br><span class="line">1422</span><br><span class="line">1423</span><br><span class="line">1424</span><br><span class="line">1425</span><br><span class="line">1426</span><br><span class="line">1427</span><br><span class="line">1428</span><br><span class="line">1429</span><br><span class="line">1430</span><br><span class="line">1431</span><br><span class="line">1432</span><br><span class="line">1433</span><br><span class="line">1434</span><br><span class="line">1435</span><br><span class="line">1436</span><br><span class="line">1437</span><br><span class="line">1438</span><br><span class="line">1439</span><br><span class="line">1440</span><br><span class="line">1441</span><br><span class="line">1442</span><br><span class="line">1443</span><br><span class="line">1444</span><br><span class="line">1445</span><br><span class="line">1446</span><br><span class="line">1447</span><br><span class="line">1448</span><br><span class="line">1449</span><br><span class="line">1450</span><br><span class="line">1451</span><br><span class="line">1452</span><br><span class="line">1453</span><br><span class="line">1454</span><br><span class="line">1455</span><br><span class="line">1456</span><br><span class="line">1457</span><br><span class="line">1458</span><br><span class="line">1459</span><br><span class="line">1460</span><br><span class="line">1461</span><br><span class="line">1462</span><br><span class="line">1463</span><br><span class="line">1464</span><br><span class="line">1465</span><br><span class="line">1466</span><br><span class="line">1467</span><br><span class="line">1468</span><br><span class="line">1469</span><br><span class="line">1470</span><br><span class="line">1471</span><br><span class="line">1472</span><br><span class="line">1473</span><br><span class="line">1474</span><br><span class="line">1475</span><br><span class="line">1476</span><br><span class="line">1477</span><br><span class="line">1478</span><br><span class="line">1479</span><br><span class="line">1480</span><br><span class="line">1481</span><br><span class="line">1482</span><br><span class="line">1483</span><br><span class="line">1484</span><br><span class="line">1485</span><br><span class="line">1486</span><br><span class="line">1487</span><br><span class="line">1488</span><br><span class="line">1489</span><br><span class="line">1490</span><br><span class="line">1491</span><br><span class="line">1492</span><br><span class="line">1493</span><br><span class="line">1494</span><br><span class="line">1495</span><br><span class="line">1496</span><br><span class="line">1497</span><br><span class="line">1498</span><br><span class="line">1499</span><br><span class="line">1500</span><br><span class="line">1501</span><br><span class="line">1502</span><br><span class="line">1503</span><br><span class="line">1504</span><br><span class="line">1505</span><br><span class="line">1506</span><br><span class="line">1507</span><br><span class="line">1508</span><br><span class="line">1509</span><br><span class="line">1510</span><br><span class="line">1511</span><br><span class="line">1512</span><br><span class="line">1513</span><br><span class="line">1514</span><br><span class="line">1515</span><br><span class="line">1516</span><br><span class="line">1517</span><br><span class="line">1518</span><br><span class="line">1519</span><br><span class="line">1520</span><br><span class="line">1521</span><br><span class="line">1522</span><br><span class="line">1523</span><br><span class="line">1524</span><br><span class="line">1525</span><br><span class="line">1526</span><br><span class="line">1527</span><br><span class="line">1528</span><br><span class="line">1529</span><br><span class="line">1530</span><br><span class="line">1531</span><br><span class="line">1532</span><br><span class="line">1533</span><br><span class="line">1534</span><br><span class="line">1535</span><br><span class="line">1536</span><br><span class="line">1537</span><br><span class="line">1538</span><br><span class="line">1539</span><br><span class="line">1540</span><br><span class="line">1541</span><br><span class="line">1542</span><br><span class="line">1543</span><br><span class="line">1544</span><br><span class="line">1545</span><br><span class="line">1546</span><br><span class="line">1547</span><br><span class="line">1548</span><br><span class="line">1549</span><br><span class="line">1550</span><br><span class="line">1551</span><br><span class="line">1552</span><br><span class="line">1553</span><br><span class="line">1554</span><br><span class="line">1555</span><br><span class="line">1556</span><br><span class="line">1557</span><br><span class="line">1558</span><br><span class="line">1559</span><br><span class="line">1560</span><br><span class="line">1561</span><br><span class="line">1562</span><br><span class="line">1563</span><br><span class="line">1564</span><br><span class="line">1565</span><br><span class="line">1566</span><br><span class="line">1567</span><br><span class="line">1568</span><br><span class="line">1569</span><br><span class="line">1570</span><br><span class="line">1571</span><br><span class="line">1572</span><br><span class="line">1573</span><br><span class="line">1574</span><br><span class="line">1575</span><br><span class="line">1576</span><br><span class="line">1577</span><br><span class="line">1578</span><br><span class="line">1579</span><br><span class="line">1580</span><br><span class="line">1581</span><br><span class="line">1582</span><br><span class="line">1583</span><br><span class="line">1584</span><br><span class="line">1585</span><br><span class="line">1586</span><br><span class="line">1587</span><br><span class="line">1588</span><br><span class="line">1589</span><br><span class="line">1590</span><br><span class="line">1591</span><br><span class="line">1592</span><br><span class="line">1593</span><br><span class="line">1594</span><br><span class="line">1595</span><br><span class="line">1596</span><br><span class="line">1597</span><br><span class="line">1598</span><br><span class="line">1599</span><br><span class="line">1600</span><br><span class="line">1601</span><br><span class="line">1602</span><br><span class="line">1603</span><br><span class="line">1604</span><br><span class="line">1605</span><br><span class="line">1606</span><br><span class="line">1607</span><br><span class="line">1608</span><br><span class="line">1609</span><br><span class="line">1610</span><br><span class="line">1611</span><br><span class="line">1612</span><br><span class="line">1613</span><br><span class="line">1614</span><br><span class="line">1615</span><br><span class="line">1616</span><br><span class="line">1617</span><br><span class="line">1618</span><br><span class="line">1619</span><br><span class="line">1620</span><br><span class="line">1621</span><br><span class="line">1622</span><br><span class="line">1623</span><br><span class="line">1624</span><br><span class="line">1625</span><br><span class="line">1626</span><br><span class="line">1627</span><br><span class="line">1628</span><br><span class="line">1629</span><br><span class="line">1630</span><br><span class="line">1631</span><br><span class="line">1632</span><br><span class="line">1633</span><br><span class="line">1634</span><br><span class="line">1635</span><br><span class="line">1636</span><br><span class="line">1637</span><br><span class="line">1638</span><br><span class="line">1639</span><br><span class="line">1640</span><br><span class="line">1641</span><br><span class="line">1642</span><br><span class="line">1643</span><br><span class="line">1644</span><br><span class="line">1645</span><br><span class="line">1646</span><br><span class="line">1647</span><br><span class="line">1648</span><br><span class="line">1649</span><br><span class="line">1650</span><br><span class="line">1651</span><br><span class="line">1652</span><br><span class="line">1653</span><br><span class="line">1654</span><br><span class="line">1655</span><br><span class="line">1656</span><br><span class="line">1657</span><br><span class="line">1658</span><br><span class="line">1659</span><br><span class="line">1660</span><br><span class="line">1661</span><br><span class="line">1662</span><br><span class="line">1663</span><br><span class="line">1664</span><br><span class="line">1665</span><br><span class="line">1666</span><br><span class="line">1667</span><br><span class="line">1668</span><br><span class="line">1669</span><br><span class="line">1670</span><br><span class="line">1671</span><br><span class="line">1672</span><br><span class="line">1673</span><br><span class="line">1674</span><br><span class="line">1675</span><br><span class="line">1676</span><br><span class="line">1677</span><br><span class="line">1678</span><br><span class="line">1679</span><br><span class="line">1680</span><br><span class="line">1681</span><br><span class="line">1682</span><br><span class="line">1683</span><br><span class="line">1684</span><br><span class="line">1685</span><br><span class="line">1686</span><br><span class="line">1687</span><br><span class="line">1688</span><br><span class="line">1689</span><br><span class="line">1690</span><br><span class="line">1691</span><br><span class="line">1692</span><br><span class="line">1693</span><br><span class="line">1694</span><br><span class="line">1695</span><br><span class="line">1696</span><br><span class="line">1697</span><br><span class="line">1698</span><br><span class="line">1699</span><br><span class="line">1700</span><br><span class="line">1701</span><br><span class="line">1702</span><br><span class="line">1703</span><br><span class="line">1704</span><br><span class="line">1705</span><br><span class="line">1706</span><br><span class="line">1707</span><br><span class="line">1708</span><br><span class="line">1709</span><br><span class="line">1710</span><br><span class="line">1711</span><br><span class="line">1712</span><br><span class="line">1713</span><br><span class="line">1714</span><br><span class="line">1715</span><br><span class="line">1716</span><br><span class="line">1717</span><br><span class="line">1718</span><br><span class="line">1719</span><br><span class="line">1720</span><br><span class="line">1721</span><br><span class="line">1722</span><br><span class="line">1723</span><br><span class="line">1724</span><br><span class="line">1725</span><br><span class="line">1726</span><br><span class="line">1727</span><br><span class="line">1728</span><br><span class="line">1729</span><br><span class="line">1730</span><br><span class="line">1731</span><br><span class="line">1732</span><br><span class="line">1733</span><br><span class="line">1734</span><br><span class="line">1735</span><br><span class="line">1736</span><br><span class="line">1737</span><br><span class="line">1738</span><br><span class="line">1739</span><br><span class="line">1740</span><br><span class="line">1741</span><br><span class="line">1742</span><br><span class="line">1743</span><br><span class="line">1744</span><br><span class="line">1745</span><br><span class="line">1746</span><br><span class="line">1747</span><br><span class="line">1748</span><br><span class="line">1749</span><br><span class="line">1750</span><br><span class="line">1751</span><br><span class="line">1752</span><br><span class="line">1753</span><br><span class="line">1754</span><br><span class="line">1755</span><br><span class="line">1756</span><br><span class="line">1757</span><br><span class="line">1758</span><br><span class="line">1759</span><br><span class="line">1760</span><br><span class="line">1761</span><br><span class="line">1762</span><br><span class="line">1763</span><br><span class="line">1764</span><br><span class="line">1765</span><br><span class="line">1766</span><br><span class="line">1767</span><br><span class="line">1768</span><br><span class="line">1769</span><br><span class="line">1770</span><br><span class="line">1771</span><br><span class="line">1772</span><br><span class="line">1773</span><br><span class="line">1774</span><br><span class="line">1775</span><br><span class="line">1776</span><br><span class="line">1777</span><br><span class="line">1778</span><br><span class="line">1779</span><br><span class="line">1780</span><br><span class="line">1781</span><br><span class="line">1782</span><br><span class="line">1783</span><br><span class="line">1784</span><br><span class="line">1785</span><br><span class="line">1786</span><br><span class="line">1787</span><br><span class="line">1788</span><br><span class="line">1789</span><br><span class="line">1790</span><br><span class="line">1791</span><br><span class="line">1792</span><br><span class="line">1793</span><br><span class="line">1794</span><br><span class="line">1795</span><br><span class="line">1796</span><br><span class="line">1797</span><br><span class="line">1798</span><br><span class="line">1799</span><br><span class="line">1800</span><br><span class="line">1801</span><br><span class="line">1802</span><br><span class="line">1803</span><br><span class="line">1804</span><br><span class="line">1805</span><br><span class="line">1806</span><br><span class="line">1807</span><br><span class="line">1808</span><br><span class="line">1809</span><br><span class="line">1810</span><br><span class="line">1811</span><br><span class="line">1812</span><br><span class="line">1813</span><br><span class="line">1814</span><br><span class="line">1815</span><br><span class="line">1816</span><br><span class="line">1817</span><br><span class="line">1818</span><br><span class="line">1819</span><br><span class="line">1820</span><br><span class="line">1821</span><br><span class="line">1822</span><br><span class="line">1823</span><br><span class="line">1824</span><br><span class="line">1825</span><br><span class="line">1826</span><br><span class="line">1827</span><br><span class="line">1828</span><br><span class="line">1829</span><br><span class="line">1830</span><br><span class="line">1831</span><br><span class="line">1832</span><br><span class="line">1833</span><br><span class="line">1834</span><br><span class="line">1835</span><br><span class="line">1836</span><br><span class="line">1837</span><br><span class="line">1838</span><br><span class="line">1839</span><br><span class="line">1840</span><br><span class="line">1841</span><br><span class="line">1842</span><br><span class="line">1843</span><br><span class="line">1844</span><br><span class="line">1845</span><br><span class="line">1846</span><br><span class="line">1847</span><br><span class="line">1848</span><br><span class="line">1849</span><br><span class="line">1850</span><br><span class="line">1851</span><br><span class="line">1852</span><br><span class="line">1853</span><br><span class="line">1854</span><br><span class="line">1855</span><br><span class="line">1856</span><br><span class="line">1857</span><br><span class="line">1858</span><br><span class="line">1859</span><br><span class="line">1860</span><br><span class="line">1861</span><br><span class="line">1862</span><br><span class="line">1863</span><br><span class="line">1864</span><br><span class="line">1865</span><br><span class="line">1866</span><br><span class="line">1867</span><br><span class="line">1868</span><br><span class="line">1869</span><br><span class="line">1870</span><br><span class="line">1871</span><br><span class="line">1872</span><br><span class="line">1873</span><br><span class="line">1874</span><br><span class="line">1875</span><br><span class="line">1876</span><br><span class="line">1877</span><br><span class="line">1878</span><br><span class="line">1879</span><br><span class="line">1880</span><br><span class="line">1881</span><br><span class="line">1882</span><br><span class="line">1883</span><br><span class="line">1884</span><br><span class="line">1885</span><br><span class="line">1886</span><br><span class="line">1887</span><br><span class="line">1888</span><br><span class="line">1889</span><br><span class="line">1890</span><br><span class="line">1891</span><br><span class="line">1892</span><br><span class="line">1893</span><br><span class="line">1894</span><br><span class="line">1895</span><br><span class="line">1896</span><br><span class="line">1897</span><br><span class="line">1898</span><br><span class="line">1899</span><br><span class="line">1900</span><br><span class="line">1901</span><br><span class="line">1902</span><br><span class="line">1903</span><br><span class="line">1904</span><br><span class="line">1905</span><br><span class="line">1906</span><br><span class="line">1907</span><br><span class="line">1908</span><br><span class="line">1909</span><br><span class="line">1910</span><br><span class="line">1911</span><br><span class="line">1912</span><br><span class="line">1913</span><br><span class="line">1914</span><br><span class="line">1915</span><br><span class="line">1916</span><br><span class="line">1917</span><br><span class="line">1918</span><br><span class="line">1919</span><br><span class="line">1920</span><br><span class="line">1921</span><br><span class="line">1922</span><br><span class="line">1923</span><br><span class="line">1924</span><br><span class="line">1925</span><br><span class="line">1926</span><br><span class="line">1927</span><br><span class="line">1928</span><br><span class="line">1929</span><br><span class="line">1930</span><br><span class="line">1931</span><br><span class="line">1932</span><br><span class="line">1933</span><br><span class="line">1934</span><br><span class="line">1935</span><br><span class="line">1936</span><br><span class="line">1937</span><br><span class="line">1938</span><br><span class="line">1939</span><br><span class="line">1940</span><br><span class="line">1941</span><br><span class="line">1942</span><br><span class="line">1943</span><br><span class="line">1944</span><br><span class="line">1945</span><br><span class="line">1946</span><br><span class="line">1947</span><br><span class="line">1948</span><br><span class="line">1949</span><br><span class="line">1950</span><br><span class="line">1951</span><br><span class="line">1952</span><br><span class="line">1953</span><br><span class="line">1954</span><br><span class="line">1955</span><br><span class="line">1956</span><br><span class="line">1957</span><br><span class="line">1958</span><br><span class="line">1959</span><br><span class="line">1960</span><br><span class="line">1961</span><br><span class="line">1962</span><br><span class="line">1963</span><br><span class="line">1964</span><br><span class="line">1965</span><br><span class="line">1966</span><br><span class="line">1967</span><br><span class="line">1968</span><br><span class="line">1969</span><br><span class="line">1970</span><br><span class="line">1971</span><br><span class="line">1972</span><br><span class="line">1973</span><br><span class="line">1974</span><br><span class="line">1975</span><br><span class="line">1976</span><br><span class="line">1977</span><br><span class="line">1978</span><br><span class="line">1979</span><br><span class="line">1980</span><br><span class="line">1981</span><br><span class="line">1982</span><br><span class="line">1983</span><br><span class="line">1984</span><br><span class="line">1985</span><br><span class="line">1986</span><br><span class="line">1987</span><br><span class="line">1988</span><br><span class="line">1989</span><br><span class="line">1990</span><br><span class="line">1991</span><br><span class="line">1992</span><br><span class="line">1993</span><br><span class="line">1994</span><br><span class="line">1995</span><br><span class="line">1996</span><br><span class="line">1997</span><br><span class="line">1998</span><br><span class="line">1999</span><br><span class="line">2000</span><br><span class="line">2001</span><br><span class="line">2002</span><br><span class="line">2003</span><br><span class="line">2004</span><br><span class="line">2005</span><br><span class="line">2006</span><br><span class="line">2007</span><br><span class="line">2008</span><br><span class="line">2009</span><br><span class="line">2010</span><br><span class="line">2011</span><br><span class="line">2012</span><br><span class="line">2013</span><br><span class="line">2014</span><br><span class="line">2015</span><br><span class="line">2016</span><br><span class="line">2017</span><br><span class="line">2018</span><br><span class="line">2019</span><br><span class="line">2020</span><br><span class="line">2021</span><br><span class="line">2022</span><br><span class="line">2023</span><br><span class="line">2024</span><br><span class="line">2025</span><br><span class="line">2026</span><br><span class="line">2027</span><br><span class="line">2028</span><br><span class="line">2029</span><br><span class="line">2030</span><br><span class="line">2031</span><br><span class="line">2032</span><br><span class="line">2033</span><br><span class="line">2034</span><br><span class="line">2035</span><br><span class="line">2036</span><br><span class="line">2037</span><br><span class="line">2038</span><br><span class="line">2039</span><br><span class="line">2040</span><br><span class="line">2041</span><br><span class="line">2042</span><br><span class="line">2043</span><br><span class="line">2044</span><br><span class="line">2045</span><br><span class="line">2046</span><br><span class="line">2047</span><br><span class="line">2048</span><br><span class="line">2049</span><br><span class="line">2050</span><br><span class="line">2051</span><br><span class="line">2052</span><br><span class="line">2053</span><br><span class="line">2054</span><br><span class="line">2055</span><br><span class="line">2056</span><br><span class="line">2057</span><br><span class="line">2058</span><br><span class="line">2059</span><br><span class="line">2060</span><br><span class="line">2061</span><br><span class="line">2062</span><br><span class="line">2063</span><br><span class="line">2064</span><br><span class="line">2065</span><br><span class="line">2066</span><br><span class="line">2067</span><br><span class="line">2068</span><br><span class="line">2069</span><br><span class="line">2070</span><br><span class="line">2071</span><br><span class="line">2072</span><br><span class="line">2073</span><br><span class="line">2074</span><br><span class="line">2075</span><br><span class="line">2076</span><br><span class="line">2077</span><br><span class="line">2078</span><br><span class="line">2079</span><br><span class="line">2080</span><br><span class="line">2081</span><br><span class="line">2082</span><br><span class="line">2083</span><br><span class="line">2084</span><br><span class="line">2085</span><br><span class="line">2086</span><br><span class="line">2087</span><br><span class="line">2088</span><br><span class="line">2089</span><br><span class="line">2090</span><br><span class="line">2091</span><br><span class="line">2092</span><br><span class="line">2093</span><br><span class="line">2094</span><br><span class="line">2095</span><br><span class="line">2096</span><br><span class="line">2097</span><br><span class="line">2098</span><br><span class="line">2099</span><br><span class="line">2100</span><br><span class="line">2101</span><br><span class="line">2102</span><br><span class="line">2103</span><br><span class="line">2104</span><br><span class="line">2105</span><br><span class="line">2106</span><br><span class="line">2107</span><br><span class="line">2108</span><br><span class="line">2109</span><br><span class="line">2110</span><br><span class="line">2111</span><br><span class="line">2112</span><br><span class="line">2113</span><br><span class="line">2114</span><br><span class="line">2115</span><br><span class="line">2116</span><br><span class="line">2117</span><br><span class="line">2118</span><br><span class="line">2119</span><br><span class="line">2120</span><br><span class="line">2121</span><br><span class="line">2122</span><br><span class="line">2123</span><br><span class="line">2124</span><br><span class="line">2125</span><br><span class="line">2126</span><br><span class="line">2127</span><br><span class="line">2128</span><br><span class="line">2129</span><br><span class="line">2130</span><br><span class="line">2131</span><br><span class="line">2132</span><br><span class="line">2133</span><br><span class="line">2134</span><br><span class="line">2135</span><br><span class="line">2136</span><br><span class="line">2137</span><br><span class="line">2138</span><br><span class="line">2139</span><br><span class="line">2140</span><br><span class="line">2141</span><br><span class="line">2142</span><br><span class="line">2143</span><br><span class="line">2144</span><br><span class="line">2145</span><br><span class="line">2146</span><br><span class="line">2147</span><br><span class="line">2148</span><br><span class="line">2149</span><br><span class="line">2150</span><br><span class="line">2151</span><br><span class="line">2152</span><br><span class="line">2153</span><br><span class="line">2154</span><br><span class="line">2155</span><br><span class="line">2156</span><br><span class="line">2157</span><br><span class="line">2158</span><br><span class="line">2159</span><br><span class="line">2160</span><br><span class="line">2161</span><br><span class="line">2162</span><br><span class="line">2163</span><br><span class="line">2164</span><br><span class="line">2165</span><br><span class="line">2166</span><br><span class="line">2167</span><br><span class="line">2168</span><br><span class="line">2169</span><br><span class="line">2170</span><br><span class="line">2171</span><br><span class="line">2172</span><br><span class="line">2173</span><br><span class="line">2174</span><br><span class="line">2175</span><br><span class="line">2176</span><br><span class="line">2177</span><br><span class="line">2178</span><br><span class="line">2179</span><br><span class="line">2180</span><br><span class="line">2181</span><br><span class="line">2182</span><br><span class="line">2183</span><br><span class="line">2184</span><br><span class="line">2185</span><br><span class="line">2186</span><br><span class="line">2187</span><br><span class="line">2188</span><br><span class="line">2189</span><br><span class="line">2190</span><br><span class="line">2191</span><br><span class="line">2192</span><br><span class="line">2193</span><br><span class="line">2194</span><br><span class="line">2195</span><br><span class="line">2196</span><br><span class="line">2197</span><br><span class="line">2198</span><br><span class="line">2199</span><br><span class="line">2200</span><br><span class="line">2201</span><br><span class="line">2202</span><br><span class="line">2203</span><br><span class="line">2204</span><br><span class="line">2205</span><br><span class="line">2206</span><br><span class="line">2207</span><br><span class="line">2208</span><br><span class="line">2209</span><br><span class="line">2210</span><br><span class="line">2211</span><br><span class="line">2212</span><br><span class="line">2213</span><br><span class="line">2214</span><br><span class="line">2215</span><br><span class="line">2216</span><br><span class="line">2217</span><br><span class="line">2218</span><br><span class="line">2219</span><br><span class="line">2220</span><br><span class="line">2221</span><br><span class="line">2222</span><br><span class="line">2223</span><br><span class="line">2224</span><br><span class="line">2225</span><br><span class="line">2226</span><br><span class="line">2227</span><br><span class="line">2228</span><br><span class="line">2229</span><br><span class="line">2230</span><br><span class="line">2231</span><br><span class="line">2232</span><br><span class="line">2233</span><br><span class="line">2234</span><br><span class="line">2235</span><br><span class="line">2236</span><br><span class="line">2237</span><br><span class="line">2238</span><br><span class="line">2239</span><br><span class="line">2240</span><br><span class="line">2241</span><br><span class="line">2242</span><br><span class="line">2243</span><br><span class="line">2244</span><br><span class="line">2245</span><br><span class="line">2246</span><br><span class="line">2247</span><br><span class="line">2248</span><br><span class="line">2249</span><br><span class="line">2250</span><br><span class="line">2251</span><br><span class="line">2252</span><br><span class="line">2253</span><br><span class="line">2254</span><br><span class="line">2255</span><br><span class="line">2256</span><br><span class="line">2257</span><br><span class="line">2258</span><br><span class="line">2259</span><br><span class="line">2260</span><br><span class="line">2261</span><br><span class="line">2262</span><br><span class="line">2263</span><br><span class="line">2264</span><br><span class="line">2265</span><br><span class="line">2266</span><br><span class="line">2267</span><br><span class="line">2268</span><br><span class="line">2269</span><br><span class="line">2270</span><br><span class="line">2271</span><br><span class="line">2272</span><br><span class="line">2273</span><br><span class="line">2274</span><br><span class="line">2275</span><br><span class="line">2276</span><br><span class="line">2277</span><br><span class="line">2278</span><br><span class="line">2279</span><br><span class="line">2280</span><br><span class="line">2281</span><br><span class="line">2282</span><br><span class="line">2283</span><br><span class="line">2284</span><br><span class="line">2285</span><br><span class="line">2286</span><br><span class="line">2287</span><br><span class="line">2288</span><br><span class="line">2289</span><br><span class="line">2290</span><br><span class="line">2291</span><br><span class="line">2292</span><br><span class="line">2293</span><br><span class="line">2294</span><br><span class="line">2295</span><br><span class="line">2296</span><br><span class="line">2297</span><br><span class="line">2298</span><br><span class="line">2299</span><br><span class="line">2300</span><br><span class="line">2301</span><br><span class="line">2302</span><br><span class="line">2303</span><br><span class="line">2304</span><br><span class="line">2305</span><br><span class="line">2306</span><br><span class="line">2307</span><br><span class="line">2308</span><br><span class="line">2309</span><br><span class="line">2310</span><br><span class="line">2311</span><br><span class="line">2312</span><br><span class="line">2313</span><br><span class="line">2314</span><br><span class="line">2315</span><br><span class="line">2316</span><br><span class="line">2317</span><br><span class="line">2318</span><br><span class="line">2319</span><br><span class="line">2320</span><br><span class="line">2321</span><br><span class="line">2322</span><br><span class="line">2323</span><br><span class="line">2324</span><br><span class="line">2325</span><br><span class="line">2326</span><br><span class="line">2327</span><br><span class="line">2328</span><br><span class="line">2329</span><br><span class="line">2330</span><br><span class="line">2331</span><br><span class="line">2332</span><br><span class="line">2333</span><br><span class="line">2334</span><br><span class="line">2335</span><br><span class="line">2336</span><br><span class="line">2337</span><br><span class="line">2338</span><br><span class="line">2339</span><br><span class="line">2340</span><br><span class="line">2341</span><br><span class="line">2342</span><br><span class="line">2343</span><br><span class="line">2344</span><br><span class="line">2345</span><br><span class="line">2346</span><br><span class="line">2347</span><br><span class="line">2348</span><br><span class="line">2349</span><br><span class="line">2350</span><br><span class="line">2351</span><br><span class="line">2352</span><br><span class="line">2353</span><br><span class="line">2354</span><br><span class="line">2355</span><br><span class="line">2356</span><br><span class="line">2357</span><br><span class="line">2358</span><br><span class="line">2359</span><br><span class="line">2360</span><br><span class="line">2361</span><br><span class="line">2362</span><br><span class="line">2363</span><br><span class="line">2364</span><br><span class="line">2365</span><br><span class="line">2366</span><br><span class="line">2367</span><br><span class="line">2368</span><br><span class="line">2369</span><br><span class="line">2370</span><br><span class="line">2371</span><br><span class="line">2372</span><br><span class="line">2373</span><br><span class="line">2374</span><br><span class="line">2375</span><br><span class="line">2376</span><br><span class="line">2377</span><br><span class="line">2378</span><br><span class="line">2379</span><br><span class="line">2380</span><br><span class="line">2381</span><br><span class="line">2382</span><br><span class="line">2383</span><br><span class="line">2384</span><br><span class="line">2385</span><br><span class="line">2386</span><br><span class="line">2387</span><br><span class="line">2388</span><br><span class="line">2389</span><br><span class="line">2390</span><br><span class="line">2391</span><br><span class="line">2392</span><br><span class="line">2393</span><br><span class="line">2394</span><br><span class="line">2395</span><br><span class="line">2396</span><br><span class="line">2397</span><br><span class="line">2398</span><br><span class="line">2399</span><br><span class="line">2400</span><br><span class="line">2401</span><br><span class="line">2402</span><br><span class="line">2403</span><br><span class="line">2404</span><br><span class="line">2405</span><br><span class="line">2406</span><br><span class="line">2407</span><br><span class="line">2408</span><br><span class="line">2409</span><br><span class="line">2410</span><br><span class="line">2411</span><br><span class="line">2412</span><br><span class="line">2413</span><br><span class="line">2414</span><br><span class="line">2415</span><br><span class="line">2416</span><br><span class="line">2417</span><br><span class="line">2418</span><br><span class="line">2419</span><br><span class="line">2420</span><br><span class="line">2421</span><br><span class="line">2422</span><br><span class="line">2423</span><br><span class="line">2424</span><br><span class="line">2425</span><br><span class="line">2426</span><br><span class="line">2427</span><br><span class="line">2428</span><br><span class="line">2429</span><br><span class="line">2430</span><br><span class="line">2431</span><br><span class="line">2432</span><br><span class="line">2433</span><br><span class="line">2434</span><br><span class="line">2435</span><br><span class="line">2436</span><br><span class="line">2437</span><br><span class="line">2438</span><br><span class="line">2439</span><br><span class="line">2440</span><br><span class="line">2441</span><br><span class="line">2442</span><br><span class="line">2443</span><br><span class="line">2444</span><br><span class="line">2445</span><br><span class="line">2446</span><br><span class="line">2447</span><br><span class="line">2448</span><br><span class="line">2449</span><br><span class="line">2450</span><br><span class="line">2451</span><br><span class="line">2452</span><br><span class="line">2453</span><br><span class="line">2454</span><br><span class="line">2455</span><br><span class="line">2456</span><br><span class="line">2457</span><br><span class="line">2458</span><br><span class="line">2459</span><br><span class="line">2460</span><br><span class="line">2461</span><br><span class="line">2462</span><br><span class="line">2463</span><br><span class="line">2464</span><br><span class="line">2465</span><br><span class="line">2466</span><br><span class="line">2467</span><br><span class="line">2468</span><br><span class="line">2469</span><br><span class="line">2470</span><br><span class="line">2471</span><br><span class="line">2472</span><br><span class="line">2473</span><br><span class="line">2474</span><br><span class="line">2475</span><br><span class="line">2476</span><br><span class="line">2477</span><br><span class="line">2478</span><br><span class="line">2479</span><br><span class="line">2480</span><br><span class="line">2481</span><br><span class="line">2482</span><br><span class="line">2483</span><br><span class="line">2484</span><br><span class="line">2485</span><br><span class="line">2486</span><br><span class="line">2487</span><br><span class="line">2488</span><br><span class="line">2489</span><br><span class="line">2490</span><br><span class="line">2491</span><br><span class="line">2492</span><br><span class="line">2493</span><br><span class="line">2494</span><br><span class="line">2495</span><br><span class="line">2496</span><br><span class="line">2497</span><br><span class="line">2498</span><br><span class="line">2499</span><br><span class="line">2500</span><br><span class="line">2501</span><br><span class="line">2502</span><br><span class="line">2503</span><br><span class="line">2504</span><br><span class="line">2505</span><br><span class="line">2506</span><br><span class="line">2507</span><br><span class="line">2508</span><br><span class="line">2509</span><br><span class="line">2510</span><br><span class="line">2511</span><br><span class="line">2512</span><br><span class="line">2513</span><br><span class="line">2514</span><br><span class="line">2515</span><br><span class="line">2516</span><br><span class="line">2517</span><br><span class="line">2518</span><br><span class="line">2519</span><br><span class="line">2520</span><br><span class="line">2521</span><br><span class="line">2522</span><br><span class="line">2523</span><br><span class="line">2524</span><br><span class="line">2525</span><br><span class="line">2526</span><br><span class="line">2527</span><br><span class="line">2528</span><br><span class="line">2529</span><br><span class="line">2530</span><br><span class="line">2531</span><br><span class="line">2532</span><br><span class="line">2533</span><br><span class="line">2534</span><br><span class="line">2535</span><br><span class="line">2536</span><br><span class="line">2537</span><br><span class="line">2538</span><br><span class="line">2539</span><br><span class="line">2540</span><br><span class="line">2541</span><br><span class="line">2542</span><br><span class="line">2543</span><br><span class="line">2544</span><br><span class="line">2545</span><br><span class="line">2546</span><br><span class="line">2547</span><br><span class="line">2548</span><br><span class="line">2549</span><br><span class="line">2550</span><br><span class="line">2551</span><br><span class="line">2552</span><br><span class="line">2553</span><br><span class="line">2554</span><br><span class="line">2555</span><br><span class="line">2556</span><br><span class="line">2557</span><br><span class="line">2558</span><br><span class="line">2559</span><br><span class="line">2560</span><br><span class="line">2561</span><br><span class="line">2562</span><br><span class="line">2563</span><br><span class="line">2564</span><br><span class="line">2565</span><br><span class="line">2566</span><br><span class="line">2567</span><br><span class="line">2568</span><br><span class="line">2569</span><br><span class="line">2570</span><br><span class="line">2571</span><br><span class="line">2572</span><br><span class="line">2573</span><br><span class="line">2574</span><br><span class="line">2575</span><br><span class="line">2576</span><br><span class="line">2577</span><br><span class="line">2578</span><br><span class="line">2579</span><br><span class="line">2580</span><br><span class="line">2581</span><br><span class="line">2582</span><br><span class="line">2583</span><br><span class="line">2584</span><br><span class="line">2585</span><br><span class="line">2586</span><br><span class="line">2587</span><br><span class="line">2588</span><br><span class="line">2589</span><br><span class="line">2590</span><br><span class="line">2591</span><br><span class="line">2592</span><br><span class="line">2593</span><br><span class="line">2594</span><br><span class="line">2595</span><br><span class="line">2596</span><br><span class="line">2597</span><br><span class="line">2598</span><br><span class="line">2599</span><br><span class="line">2600</span><br><span class="line">2601</span><br><span class="line">2602</span><br><span class="line">2603</span><br><span class="line">2604</span><br><span class="line">2605</span><br><span class="line">2606</span><br><span class="line">2607</span><br><span class="line">2608</span><br><span class="line">2609</span><br><span class="line">2610</span><br><span class="line">2611</span><br><span class="line">2612</span><br><span class="line">2613</span><br><span class="line">2614</span><br><span class="line">2615</span><br><span class="line">2616</span><br><span class="line">2617</span><br><span class="line">2618</span><br><span class="line">2619</span><br><span class="line">2620</span><br><span class="line">2621</span><br><span class="line">2622</span><br><span class="line">2623</span><br><span class="line">2624</span><br><span class="line">2625</span><br><span class="line">2626</span><br><span class="line">2627</span><br><span class="line">2628</span><br><span class="line">2629</span><br><span class="line">2630</span><br><span class="line">2631</span><br><span class="line">2632</span><br><span class="line">2633</span><br><span class="line">2634</span><br><span class="line">2635</span><br><span class="line">2636</span><br><span class="line">2637</span><br><span class="line">2638</span><br><span class="line">2639</span><br><span class="line">2640</span><br><span class="line">2641</span><br><span class="line">2642</span><br><span class="line">2643</span><br><span class="line">2644</span><br><span class="line">2645</span><br><span class="line">2646</span><br><span class="line">2647</span><br><span class="line">2648</span><br><span class="line">2649</span><br><span class="line">2650</span><br><span class="line">2651</span><br><span class="line">2652</span><br><span class="line">2653</span><br><span class="line">2654</span><br><span class="line">2655</span><br><span class="line">2656</span><br><span class="line">2657</span><br><span class="line">2658</span><br><span class="line">2659</span><br><span class="line">2660</span><br><span class="line">2661</span><br><span class="line">2662</span><br><span class="line">2663</span><br><span class="line">2664</span><br><span class="line">2665</span><br><span class="line">2666</span><br><span class="line">2667</span><br><span class="line">2668</span><br><span class="line">2669</span><br><span class="line">2670</span><br><span class="line">2671</span><br><span class="line">2672</span><br><span class="line">2673</span><br><span class="line">2674</span><br><span class="line">2675</span><br><span class="line">2676</span><br><span class="line">2677</span><br><span class="line">2678</span><br><span class="line">2679</span><br><span class="line">2680</span><br><span class="line">2681</span><br><span class="line">2682</span><br><span class="line">2683</span><br><span class="line">2684</span><br><span class="line">2685</span><br><span class="line">2686</span><br><span class="line">2687</span><br><span class="line">2688</span><br><span class="line">2689</span><br><span class="line">2690</span><br><span class="line">2691</span><br><span class="line">2692</span><br><span class="line">2693</span><br><span class="line">2694</span><br><span class="line">2695</span><br><span class="line">2696</span><br><span class="line">2697</span><br><span class="line">2698</span><br><span class="line">2699</span><br><span class="line">2700</span><br><span class="line">2701</span><br><span class="line">2702</span><br><span class="line">2703</span><br><span class="line">2704</span><br><span class="line">2705</span><br><span class="line">2706</span><br><span class="line">2707</span><br><span class="line">2708</span><br><span class="line">2709</span><br><span class="line">2710</span><br><span class="line">2711</span><br><span class="line">2712</span><br><span class="line">2713</span><br><span class="line">2714</span><br><span class="line">2715</span><br><span class="line">2716</span><br><span class="line">2717</span><br><span class="line">2718</span><br><span class="line">2719</span><br><span class="line">2720</span><br><span class="line">2721</span><br><span class="line">2722</span><br><span class="line">2723</span><br><span class="line">2724</span><br><span class="line">2725</span><br><span class="line">2726</span><br><span class="line">2727</span><br><span class="line">2728</span><br><span class="line">2729</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">using</span> AMIS3.UIFramework;</span><br><span class="line"><span class="keyword">using</span> AMIS3.UIFramework.DataModel;</span><br><span class="line"><span class="keyword">using</span> AMIS3.UIFramework.FxExtension;</span><br><span class="line"><span class="keyword">using</span> AMIS3.UIFramework.UI;</span><br><span class="line"><span class="keyword">using</span> System;</span><br><span class="line"><span class="keyword">using</span> System.Collections.Generic;</span><br><span class="line"><span class="keyword">using</span> System.Data;</span><br><span class="line"><span class="keyword">using</span> System.Drawing;</span><br><span class="line"><span class="keyword">using</span> AMIS3.MC.NR.ZZLIB002;</span><br><span class="line"><span class="keyword">using</span> AMIS3.ZZ.ZZ.ZZ.Common.Helpers;</span><br><span class="line"><span class="keyword">using</span> DevExpress.XtraGrid.Views.Grid;</span><br><span class="line"><span class="keyword">using</span> System.Windows.Forms;</span><br><span class="line"><span class="keyword">using</span> AMIS3.ZZ.ZZ.ZZ.Common.Message;</span><br><span class="line"><span class="keyword">using</span> System.Threading.Tasks;</span><br><span class="line"><span class="keyword">using</span> System.Linq;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> <span class="title">AMIS3.MC.NR.PM327</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">partial</span> <span class="keyword">class</span> <span class="title">VMCNRPM327S</span> : <span class="title">ScreenBase</span>, <span class="title">ISmartToolbar</span></span><br><span class="line">    &#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="meta">#<span class="meta-keyword">region</span> ========================= [ 변수 선언 ] ==========================</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 액션버튼 아이템</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="keyword">public</span> List&lt;ActionButtonItem&gt; ActionButtonItems &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 주사실대기상태코드 조회테이블</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="keyword">private</span> DataTable dtIrWaitStatCd = <span class="keyword">new</span> DataTable();</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 외래주사실 수행일자별 수행대상 목록 보관용 DataTable</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="keyword">private</span> DataTable _dtList = <span class="keyword">new</span> DataTable();</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 재원시간 저장용 DataTable</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="keyword">private</span> DataTable dtSaveIrStayTmc = <span class="keyword">new</span> DataTable();</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 환자진료정보</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="keyword">private</span> PatMdexInfo patInfo = <span class="keyword">new</span> PatMdexInfo();</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        DataTable dtPwsn = <span class="keyword">new</span> DataTable();</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="meta">#<span class="meta-keyword">endregion</span> ===============================================================</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="meta">#<span class="meta-keyword">region</span> ========================== [ 초 기 화 ] ==========================</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 컴포넌트 초기화</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="title">VMCNRPM327S</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>        &#123;</span><br><span class="line">            InitializeComponent();</span><br><span class="line">            keyHelper.Add(<span class="keyword">new</span> KeyCommand(Keys.Alt | Keys.D1, (s, ee) =&gt; &#123; OnOpenVMCNRAM017S(); &#125;));   <span class="comment">// 팝업 호출</span></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> OnLoad Event</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;e&quot;&gt;</span><span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">        <span class="function"><span class="keyword">protected</span> <span class="keyword">override</span> <span class="keyword">void</span> <span class="title">OnLoad</span>(<span class="params">EventArgs e</span>)</span></span><br><span class="line"><span class="function"></span>        &#123;</span><br><span class="line">            <span class="keyword">base</span>.OnLoad(e);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">            <span class="keyword">switch</span> (SecurityService.WorkLocCd)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">case</span> <span class="string">&quot;10601&quot;</span>: rdoOrdrPformLocCd.EditValue = <span class="string">&quot;OPIV&quot;</span>; <span class="keyword">break</span>;   <span class="comment">// 동관주사실</span></span><br><span class="line">                <span class="keyword">case</span> <span class="string">&quot;22439&quot;</span>: rdoOrdrPformLocCd.EditValue = <span class="string">&quot;OPIV3&quot;</span>; <span class="keyword">break</span>;  <span class="comment">// 신관주사실</span></span><br><span class="line">                <span class="keyword">case</span> <span class="string">&quot;22372&quot;</span>: rdoOrdrPformLocCd.EditValue = <span class="string">&quot;PEDIV&quot;</span>; <span class="keyword">break</span>;  <span class="comment">// 소아주사실</span></span><br><span class="line">                <span class="keyword">case</span> <span class="string">&quot;22377&quot;</span>: rdoOrdrPformLocCd.EditValue = <span class="string">&quot;PIVC&quot;</span>; <span class="keyword">break</span>;   <span class="comment">// 소아항암주사실</span></span><br><span class="line">            &#125;</span><br><span class="line">            </span><br><span class="line">            dtIrWaitStatCd = CodeHelper.GetCommonCode(<span class="string">&quot;NR0165&quot;</span>);</span><br><span class="line">            </span><br><span class="line">            rdoDiv.EditValue = <span class="string">&quot;DT&quot;</span>; </span><br><span class="line">            flwpnlPformTrgetListByPformDt.Visible = <span class="literal">true</span>;</span><br><span class="line">            flwpnlPformTrgetListByPat.Visible = <span class="literal">false</span>;     </span><br><span class="line">            lblSubTitle.Text = <span class="string">&quot;수행일자별 수행대상 목록&quot;</span>;</span><br><span class="line">            grdList.MainView = gvListByDt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">            dtpPform.EditValue = DateTime.Now.ToString(<span class="string">&quot;yyyy-MM-dd&quot;</span>);</span><br><span class="line">            dtpOrdrDirectDt.FromDateTime = DateTime.Now;</span><br><span class="line">            dtpOrdrDirectDt.ToDateTime = DateTime.Now;</span><br><span class="line">                        </span><br><span class="line">            gvListByDt.SetIndicateNumber(<span class="number">45</span>);</span><br><span class="line">            gvListByPat.SetIndicateNumber(<span class="number">30</span>);</span><br><span class="line">            </span><br><span class="line">            InitializeControls();</span><br><span class="line">            InitializeActionButtons();</span><br><span class="line">            InitializeDtSaveIrStayTmc();  </span><br><span class="line">            InitializeGridColumn(); </span><br><span class="line">            rdoPformDiv.Visible = <span class="literal">true</span>;</span><br><span class="line">            btnSearch_Click(<span class="literal">null</span>, <span class="literal">null</span>); </span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> OnShown Event</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;e&quot;&gt;</span><span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">        <span class="function"><span class="keyword">protected</span> <span class="keyword">override</span> <span class="keyword">void</span> <span class="title">OnShown</span>(<span class="params">EventArgs e</span>)</span></span><br><span class="line"><span class="function"></span>        &#123;</span><br><span class="line">            <span class="keyword">base</span>.OnShown(e);</span><br><span class="line">            <span class="keyword">if</span> (<span class="keyword">base</span>.MainPatient != <span class="literal">null</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                patInfo.SelectedPatInfo[(<span class="keyword">int</span>)SelectedPatInfo.PATNO] = <span class="keyword">base</span>.MainPatient.patno;</span><br><span class="line">                patInfo.SelectedPatInfo[(<span class="keyword">int</span>)SelectedPatInfo.VIST_SN] = <span class="keyword">base</span>.MainPatient.vistSn.ToStringDefault(<span class="string">&quot;&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 콘트롤 초기화</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">InitializeControls</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>        &#123;</span><br><span class="line">            <span class="keyword">if</span> (grdList.DataSource != <span class="literal">null</span>)</span><br><span class="line">                (grdList.DataSource <span class="keyword">as</span> DataTable).Rows.Clear();</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (patInfo == <span class="literal">null</span>)</span><br><span class="line">                patInfo = <span class="keyword">new</span> PatMdexInfo();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 액션버튼 초기화</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">InitializeActionButtons</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>        &#123;</span><br><span class="line">            <span class="keyword">int</span> idx = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (rdoDiv.EditValue.ToStringDefault(<span class="string">&quot;&quot;</span>) == <span class="string">&quot;DT&quot;</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                ActionButtonItems = <span class="keyword">new</span> List&lt;ActionButtonItem&gt;();</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">                <span class="keyword">if</span> (rdoOrdrPformLocCd.EditValue.ToStringDefault(<span class="string">&quot;&quot;</span>) == <span class="string">&quot;PIVC&quot;</span>)</span><br><span class="line">                &#123;</span><br><span class="line">                    ActionButtonItems.Add(<span class="keyword">new</span> ActionButtonItem()</span><br><span class="line">                    &#123;</span><br><span class="line">                        Text = <span class="string">&quot;저장&quot;</span>,</span><br><span class="line">                        Idx = idx++,</span><br><span class="line">                        IsImportant = <span class="literal">true</span>,</span><br><span class="line">                        ClickAction = OnSave,</span><br><span class="line">                        Name = <span class="string">&quot;OnSave&quot;</span>,</span><br><span class="line">                        Permissions = <span class="string">&quot;R&quot;</span></span><br><span class="line">                    &#125;);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">                    ActionButtonItems.Add(<span class="keyword">new</span> ActionButtonItem()</span><br><span class="line">                    &#123;</span><br><span class="line">                        Text = <span class="string">&quot;통합검사결과조회&quot;</span>,</span><br><span class="line">                        Idx = idx++,</span><br><span class="line">                        IsImportant = <span class="literal">false</span>,</span><br><span class="line">                        ClickAction = OnOpenVSPSZZZ010S,</span><br><span class="line">                        Name = <span class="string">&quot;OnOpenVMCOOOD022S&quot;</span>,</span><br><span class="line">                        Permissions = <span class="string">&quot;R&quot;</span></span><br><span class="line">                    &#125;);</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">                ActionButtonItems.Add(<span class="keyword">new</span> ActionButtonItem()</span><br><span class="line">                &#123;</span><br><span class="line">                    Text = <span class="string">&quot;간호투약\r\n수행기록&quot;</span>,</span><br><span class="line">                    Idx = idx++,</span><br><span class="line">                    IsImportant = <span class="literal">false</span>,</span><br><span class="line">                    ClickAction = OnOpenVMCNRDA003S,</span><br><span class="line">                    Name = <span class="string">&quot;actOpenVMCNRDA003S&quot;</span>,</span><br><span class="line">                    Permissions = <span class="string">&quot;R&quot;</span></span><br><span class="line">                &#125;);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">                ActionButtonItems.Add(<span class="keyword">new</span> ActionButtonItem()</span><br><span class="line">                &#123;</span><br><span class="line">                    Text = <span class="string">&quot;오더\r\n전체보기&quot;</span>,</span><br><span class="line">                    Idx = idx++,</span><br><span class="line">                    IsImportant = <span class="literal">false</span>,</span><br><span class="line">                    ClickAction = OnOpenVMCOOOD058S,</span><br><span class="line">                    Name = <span class="string">&quot;actOpenVMCOOOD058S&quot;</span>,</span><br><span class="line">                    Permissions = <span class="string">&quot;R&quot;</span></span><br><span class="line">                &#125;);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">                ActionButtonItems.Add(<span class="keyword">new</span> ActionButtonItem()</span><br><span class="line">                &#123;</span><br><span class="line">                    Text = <span class="string">&quot;외래\r\n간호기록&quot;</span>,</span><br><span class="line">                    Idx = idx++,</span><br><span class="line">                    IsImportant = <span class="literal">false</span>,</span><br><span class="line">                    ClickAction = OnOpenVMCMRNR035S,</span><br><span class="line">                    Name = <span class="string">&quot;actOpenVMCMRNR035S&quot;</span>,</span><br><span class="line">                    Permissions = <span class="string">&quot;R&quot;</span></span><br><span class="line">                &#125;);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">                ActionButtonItems.Add(<span class="keyword">new</span> ActionButtonItem()</span><br><span class="line">                &#123;</span><br><span class="line">                    Text = <span class="string">&quot;기록조회&quot;</span>,</span><br><span class="line">                    Idx = idx++,</span><br><span class="line">                    IsImportant = <span class="literal">false</span>,</span><br><span class="line">                    ClickAction = OnOpenVMCMRDR004S,</span><br><span class="line">                    Name = <span class="string">&quot;actOpenVMCOOOD058S&quot;</span>,</span><br><span class="line">                    Permissions = <span class="string">&quot;R&quot;</span></span><br><span class="line">                &#125;);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">                <span class="keyword">if</span> (rdoOrdrPformLocCd.EditValue.ToStringDefault(<span class="string">&quot;&quot;</span>) == <span class="string">&quot;PIVC&quot;</span>)</span><br><span class="line">                &#123;</span><br><span class="line">                    ActionButtonItems.Add(<span class="keyword">new</span> ActionButtonItem()</span><br><span class="line">                    &#123;</span><br><span class="line">                        Text = <span class="string">&quot;암병원주사실 입퇴실기록&quot;</span>,</span><br><span class="line">                        Idx = idx++,</span><br><span class="line">                        IsImportant = <span class="literal">false</span>,</span><br><span class="line">                        ClickAction = OnOpenVMCMRNR126S,</span><br><span class="line">                        Name = <span class="string">&quot;actOpenVMCMRNR126S&quot;</span>,</span><br><span class="line">                        Permissions = <span class="string">&quot;R&quot;</span></span><br><span class="line">                    &#125;);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">                    ActionButtonItems.Add(<span class="keyword">new</span> ActionButtonItem()</span><br><span class="line">                    &#123;</span><br><span class="line">                        Text = <span class="string">&quot;간호처방등록&quot;</span>,</span><br><span class="line">                        Idx = idx++,</span><br><span class="line">                        IsImportant = <span class="literal">false</span>,</span><br><span class="line">                        ClickAction = OnOpenVMCOOOD022S,</span><br><span class="line">                        Name = <span class="string">&quot;OnOpenVMCOOOD022S&quot;</span>,</span><br><span class="line">                        Permissions = <span class="string">&quot;R&quot;</span></span><br><span class="line">                    &#125;);</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">                ActionButtonItems.Add(<span class="keyword">new</span> ActionButtonItem()</span><br><span class="line">                &#123;</span><br><span class="line">                    Text = <span class="string">&quot;수혈수행\r\n관리&quot;</span>,</span><br><span class="line">                    Idx = idx++,</span><br><span class="line">                    IsImportant = <span class="literal">false</span>,</span><br><span class="line">                    ClickAction = OnOpenVMCNRDA004S,</span><br><span class="line">                    Name = <span class="string">&quot;actOpenVMCNRDA004S&quot;</span>,</span><br><span class="line">                    Permissions = <span class="string">&quot;R&quot;</span></span><br><span class="line">                &#125;);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">                ActionButtonItems.Add(<span class="keyword">new</span> ActionButtonItem()</span><br><span class="line">                &#123;</span><br><span class="line">                    Text = <span class="string">&quot;낙상입력&quot;</span>,</span><br><span class="line">                    Idx = idx++,</span><br><span class="line">                    IsImportant = <span class="literal">false</span>,</span><br><span class="line">                    ClickAction = OnOpenVMCMRNR116S,</span><br><span class="line">                    Name = <span class="string">&quot;actOpenVMCMRNR116S&quot;</span>,</span><br><span class="line">                    Permissions = <span class="string">&quot;R&quot;</span></span><br><span class="line">                &#125;);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">                ActionButtonItems.Add(<span class="keyword">new</span> ActionButtonItem()</span><br><span class="line">                &#123;</span><br><span class="line">                    Text = <span class="string">&quot;신체계측&quot;</span>,</span><br><span class="line">                    Idx = idx++,</span><br><span class="line">                    IsImportant = <span class="literal">false</span>,</span><br><span class="line">                    ClickAction = OnOpenVMCNRPM257S,</span><br><span class="line">                    Name = <span class="string">&quot;actOpenVMCNRPM257S&quot;</span>,</span><br><span class="line">                    Permissions = <span class="string">&quot;R&quot;</span></span><br><span class="line">                &#125;);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">                ActionButtonItems.Add(<span class="keyword">new</span> ActionButtonItem()</span><br><span class="line">                &#123;</span><br><span class="line">                    Text = <span class="string">&quot;환자팔찌 및 환자바코드 출력&quot;</span>,</span><br><span class="line">                    Idx = idx++,</span><br><span class="line">                    IsImportant = <span class="literal">false</span>,</span><br><span class="line">                    ClickAction = OnOpenVMCNRWS765S,</span><br><span class="line">                    Name = <span class="string">&quot;OnCallBandPatBarcode&quot;</span>,</span><br><span class="line">                    Permissions = <span class="string">&quot;W&quot;</span></span><br><span class="line">                &#125;);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">                ActionButtonItems.Add(<span class="keyword">new</span> ActionButtonItem()</span><br><span class="line">                &#123;</span><br><span class="line">                    Text = <span class="string">&quot;투약카드&quot;</span>,</span><br><span class="line">                    Idx = idx++,</span><br><span class="line">                    IsImportant = <span class="literal">false</span>,</span><br><span class="line">                    ClickAction = OnOpenVMCNRDA006S,</span><br><span class="line">                    Name = <span class="string">&quot;OnOpenVMCNRDA006S&quot;</span>,</span><br><span class="line">                    Permissions = <span class="string">&quot;W&quot;</span></span><br><span class="line">                &#125;);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">                <span class="keyword">if</span> (rdoOrdrPformLocCd.EditValue.ToStringDefault(<span class="string">&quot;&quot;</span>) == <span class="string">&quot;OPIV&quot;</span>)</span><br><span class="line">                &#123;</span><br><span class="line">                    ActionButtonItems.Add(<span class="keyword">new</span> ActionButtonItem()</span><br><span class="line">                    &#123;</span><br><span class="line">                        Text = <span class="string">&quot;전광판 접수&quot;</span>,</span><br><span class="line">                        Idx = idx++,</span><br><span class="line">                        IsImportant = <span class="literal">false</span>,</span><br><span class="line">                        ClickAction = OnNewRcep,</span><br><span class="line">                        Name = <span class="string">&quot;actRcep&quot;</span>,</span><br><span class="line">                        Permissions = <span class="string">&quot;W&quot;</span></span><br><span class="line">                    &#125;);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">                    ActionButtonItems.Add(<span class="keyword">new</span> ActionButtonItem()</span><br><span class="line">                    &#123;</span><br><span class="line">                        Text = <span class="string">&quot;외래주사실 조제관리&quot;</span>,</span><br><span class="line">                        Idx = idx++,</span><br><span class="line">                        IsImportant = <span class="literal">false</span>,</span><br><span class="line">                        ClickAction = OnOpenVMCPHDS060S,</span><br><span class="line">                        Name = <span class="string">&quot;OnOpenVMCPHDS060S&quot;</span>,</span><br><span class="line">                        Permissions = <span class="string">&quot;R&quot;</span></span><br><span class="line">                    &#125;);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">                ActionButtonItems.Add(<span class="keyword">new</span> ActionButtonItem()</span><br><span class="line">                &#123;</span><br><span class="line">                    Text = <span class="string">&quot;SMS문자전송(단일)-환자용&quot;</span>,</span><br><span class="line">                    Idx = idx++,</span><br><span class="line">                    IsImportant = <span class="literal">false</span>,</span><br><span class="line">                    ClickAction = OnOpenVETSYMS005S_Patient,</span><br><span class="line">                    Name = <span class="string">&quot;OnOpenVETSYMS005S&quot;</span>,</span><br><span class="line">                    Permissions = <span class="string">&quot;R&quot;</span></span><br><span class="line">                &#125;);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">                ActionButtonItems.Add(<span class="keyword">new</span> ActionButtonItem()</span><br><span class="line">                &#123;</span><br><span class="line">                    Text = <span class="string">&quot;SMS문자전송(단일)-직원용&quot;</span>,</span><br><span class="line">                    Idx = idx++,</span><br><span class="line">                    IsImportant = <span class="literal">false</span>,</span><br><span class="line">                    ClickAction = OnOpenVETSYMS005S_Employee,</span><br><span class="line">                    Name = <span class="string">&quot;OnOpenVETSYMS005S&quot;</span>,</span><br><span class="line">                    Permissions = <span class="string">&quot;R&quot;</span></span><br><span class="line">                &#125;);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">                <span class="keyword">if</span> (rdoOrdrPformLocCd.EditValue.ToStringDefault(<span class="string">&quot;&quot;</span>) == <span class="string">&quot;PIVC&quot;</span>)</span><br><span class="line">                &#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">                    ActionButtonItems.Add(<span class="keyword">new</span> ActionButtonItem()</span><br><span class="line">                    &#123;</span><br><span class="line">                        Text = <span class="string">&quot;시술Time\r\nOut기록지&quot;</span>,</span><br><span class="line">                        Idx = idx++,</span><br><span class="line">                        IsImportant = <span class="literal">false</span>,</span><br><span class="line">                        ClickAction = OnOpenVSPSEEJ050S,</span><br><span class="line">                        Name = <span class="string">&quot;OnOpenVSPSEEJ050S&quot;</span>,</span><br><span class="line">                        Permissions = <span class="string">&quot;R&quot;</span></span><br><span class="line">                    &#125;);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">                    ActionButtonItems.Add(<span class="keyword">new</span> ActionButtonItem()</span><br><span class="line">                    &#123;</span><br><span class="line">                        Text = <span class="string">&quot;검체채혈\r\n-업무구분별&quot;</span>,</span><br><span class="line">                        Idx = idx++,</span><br><span class="line">                        IsImportant = <span class="literal">false</span>,</span><br><span class="line">                        ClickAction = OnOpenVSPSSSP030S,</span><br><span class="line">                        Name = <span class="string">&quot;OnOpenVSPSSSP030S&quot;</span>,</span><br><span class="line">                        Permissions = <span class="string">&quot;R&quot;</span></span><br><span class="line">                    &#125;);</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">                ActionButtonItems.Add(<span class="keyword">new</span> ActionButtonItem()</span><br><span class="line">                &#123;</span><br><span class="line">                    Text = <span class="string">&quot;이송신청\r\n(환자별)&quot;</span>,</span><br><span class="line">                    Idx = idx++,</span><br><span class="line">                    IsImportant = <span class="literal">false</span>,</span><br><span class="line">                    ClickAction = OnOpenVWAWPTF022S,</span><br><span class="line">                    Name = <span class="string">&quot;OnCallBandPatBarcode&quot;</span>,</span><br><span class="line">                    Permissions = <span class="string">&quot;W&quot;</span></span><br><span class="line">                &#125;);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">                ActionButtonItems.Add(<span class="keyword">new</span> ActionButtonItem()</span><br><span class="line">                &#123;</span><br><span class="line">                    Text = <span class="string">&quot;주사실 처방코드 분류관리&quot;</span>,</span><br><span class="line">                    Idx = idx++,</span><br><span class="line">                    IsImportant = <span class="literal">false</span>,</span><br><span class="line">                    ClickAction = OnManageCode,</span><br><span class="line">                    Name = <span class="string">&quot;OnManageCode&quot;</span>,</span><br><span class="line">                    Permissions = <span class="string">&quot;W&quot;</span></span><br><span class="line">                &#125;);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">                ActionButtonItems.Add(<span class="keyword">new</span> ActionButtonItem()</span><br><span class="line">                &#123;</span><br><span class="line">                    Text = <span class="string">&quot;검사예약일자 가져오기&quot;</span>,</span><br><span class="line">                    Idx = idx++,</span><br><span class="line">                    IsImportant = <span class="literal">false</span>,</span><br><span class="line">                    ClickAction = OnUpdateHopeDt,</span><br><span class="line">                    Name = <span class="string">&quot;OnCallBandPatBarcode&quot;</span>,</span><br><span class="line">                    Permissions = <span class="string">&quot;W&quot;</span></span><br><span class="line">                &#125;);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">                <span class="keyword">this</span>.btnAction.Items = ActionButtonItems; </span><br><span class="line">                btnAction.Visible = <span class="literal">true</span>;</span><br><span class="line">                btnAction.FallDownMenuWidth = <span class="number">162</span>;</span><br><span class="line">                DocumentService.ChangeActionButtons(<span class="keyword">this</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">            &#123;</span><br><span class="line">                grdList.ContextMenuStrip = <span class="literal">null</span>;</span><br><span class="line">                btnAction.Visible = <span class="literal">false</span>;</span><br><span class="line">                DocumentService.ChangeActionButtons(<span class="keyword">this</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 스마트위젯 셋팅</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;sender&quot;&gt;</span><span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;e&quot;&gt;</span><span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">        <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">gvList_RowClick</span>(<span class="params"><span class="keyword">object</span> sender, DevExpress.XtraGrid.Views.Grid.RowClickEventArgs e</span>)</span></span><br><span class="line"><span class="function"></span>        &#123;</span><br><span class="line">            <span class="keyword">if</span> (e.Button == MouseButtons.Right)</span><br><span class="line">            &#123;</span><br><span class="line">                ASmartWidget stwPopup = <span class="keyword">new</span> ASmartWidget(<span class="keyword">this</span>);</span><br><span class="line">                <span class="keyword">if</span> (rdoDiv.EditValue.ToStringDefault(<span class="string">&quot;&quot;</span>) == <span class="string">&quot;DT&quot;</span>)</span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="keyword">if</span> (rdoOrdrPformLocCd.EditValue.ToStringDefault(<span class="string">&quot;&quot;</span>) == <span class="string">&quot;OPIV&quot;</span>)</span><br><span class="line">                    &#123;</span><br><span class="line">                        stwPopup.AddItem(ASmartWidget.ItemKind.Work, <span class="string">&quot;전광판 접수&quot;</span>, <span class="literal">null</span>, <span class="literal">null</span>, () =&gt; OnNewRcep());</span><br><span class="line">                        stwPopup.AddItem(ASmartWidget.ItemKind.Work, <span class="string">&quot;환자팔찌 및 환자바코드 출력&quot;</span>, <span class="literal">null</span>, <span class="literal">null</span>, () =&gt; OnOpenVMCNRWS765S());</span><br><span class="line">                        stwPopup.AddItem(ASmartWidget.ItemKind.Work, <span class="string">&quot;투약카드 출력&quot;</span>, <span class="literal">null</span>, <span class="literal">null</span>, () =&gt; OnMdctCardPrint());</span><br><span class="line">                        stwPopup.AddItem(ASmartWidget.ItemKind.Work, <span class="string">&quot;외래주사실 조제관리&quot;</span>, <span class="literal">null</span>, <span class="literal">null</span>, () =&gt; OnOpenVMCPHDS060S());</span><br><span class="line">                        stwPopup.AddItem(ASmartWidget.ItemKind.Work, <span class="string">&quot;오더전체보기&quot;</span>, <span class="literal">null</span>, <span class="literal">null</span>, () =&gt; OnOpenVMCOOOD058S());</span><br><span class="line">                        stwPopup.AddItem(ASmartWidget.ItemKind.Work, <span class="string">&quot;간호투약수행기록&quot;</span>, <span class="literal">null</span>, <span class="literal">null</span>, () =&gt; OnOpenVMCNRDA003S());</span><br><span class="line">                        stwPopup.AddItem(ASmartWidget.ItemKind.Work, <span class="string">&quot;외래간호기록&quot;</span>, <span class="literal">null</span>, <span class="literal">null</span>, () =&gt; OnOpenVMCMRNR035S());</span><br><span class="line">                        stwPopup.AddItem(ASmartWidget.ItemKind.Work, <span class="string">&quot;기록조회&quot;</span>, <span class="literal">null</span>, <span class="literal">null</span>, () =&gt; OnOpenVMCMRDR004S());</span><br><span class="line">                        stwPopup.AddItem(ASmartWidget.ItemKind.Work, <span class="string">&quot;수혈수행관리&quot;</span>, <span class="literal">null</span>, <span class="literal">null</span>, () =&gt; OnOpenVMCNRDA004S());</span><br><span class="line">                        stwPopup.AddItem(ASmartWidget.ItemKind.Work, <span class="string">&quot;낙상입력&quot;</span>, <span class="literal">null</span>, <span class="literal">null</span>, () =&gt; OnOpenVMCMRNR116S());</span><br><span class="line">                        stwPopup.AddItem(ASmartWidget.ItemKind.Work, <span class="string">&quot;신체계측&quot;</span>, <span class="literal">null</span>, <span class="literal">null</span>, () =&gt; OnOpenVMCNRPM257S());</span><br><span class="line">                        stwPopup.AddItem(ASmartWidget.ItemKind.Work, <span class="string">&quot;SMS문자전송(단일)-환자용&quot;</span>, <span class="literal">null</span>, <span class="literal">null</span>, () =&gt; OnOpenVETSYMS005S_Patient());</span><br><span class="line">                        stwPopup.AddItem(ASmartWidget.ItemKind.Work, <span class="string">&quot;SMS문자전송(단일)-직원용&quot;</span>, <span class="literal">null</span>, <span class="literal">null</span>, () =&gt; OnOpenVETSYMS005S_Employee());</span><br><span class="line">                        stwPopup.AddItem(ASmartWidget.ItemKind.Work, <span class="string">&quot;이송신청(환자별)&quot;</span>, <span class="literal">null</span>, <span class="literal">null</span>, () =&gt; OnOpenVWAWPTF022S());</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">else</span></span><br><span class="line">                    &#123;</span><br><span class="line">                        <span class="keyword">if</span> (rdoOrdrPformLocCd.EditValue.ToStringDefault(<span class="string">&quot;&quot;</span>) == <span class="string">&quot;PIVC&quot;</span>)</span><br><span class="line">                        &#123;</span><br><span class="line">                            stwPopup.AddItem(ASmartWidget.ItemKind.Work, <span class="string">&quot;저장&quot;</span>, <span class="literal">null</span>, <span class="literal">null</span>, () =&gt; OnSave());</span><br><span class="line">                            stwPopup.AddItem(ASmartWidget.ItemKind.Work, <span class="string">&quot;통합검사결과조회&quot;</span>, <span class="literal">null</span>, <span class="literal">null</span>, () =&gt; OnOpenVSPSZZZ010S());</span><br><span class="line">                        &#125;</span><br><span class="line">                        stwPopup.AddItem(ASmartWidget.ItemKind.Work, <span class="string">&quot;간호투약수행기록&quot;</span>, <span class="literal">null</span>, <span class="literal">null</span>, () =&gt; OnOpenVMCNRDA003S());</span><br><span class="line">                        stwPopup.AddItem(ASmartWidget.ItemKind.Work, <span class="string">&quot;오더전체보기&quot;</span>, <span class="literal">null</span>, <span class="literal">null</span>, () =&gt; OnOpenVMCOOOD058S());</span><br><span class="line">                        stwPopup.AddItem(ASmartWidget.ItemKind.Work, <span class="string">&quot;외래간호기록&quot;</span>, <span class="literal">null</span>, <span class="literal">null</span>, () =&gt; OnOpenVMCMRNR035S());</span><br><span class="line">                        stwPopup.AddItem(ASmartWidget.ItemKind.Work, <span class="string">&quot;기록조회&quot;</span>, <span class="literal">null</span>, <span class="literal">null</span>, () =&gt; OnOpenVMCMRDR004S());</span><br><span class="line">                        <span class="keyword">if</span> (rdoOrdrPformLocCd.EditValue.ToStringDefault(<span class="string">&quot;&quot;</span>) == <span class="string">&quot;PIVC&quot;</span>)</span><br><span class="line">                        &#123;</span><br><span class="line">                            stwPopup.AddItem(ASmartWidget.ItemKind.Work, <span class="string">&quot;암병원주사실 입퇴실기록&quot;</span>, <span class="literal">null</span>, <span class="literal">null</span>, () =&gt; OnOpenVMCMRNR126S());</span><br><span class="line">                            stwPopup.AddItem(ASmartWidget.ItemKind.Work, <span class="string">&quot;간호처방등록&quot;</span>, <span class="literal">null</span>, <span class="literal">null</span>, () =&gt; OnOpenVMCOOOD022S());</span><br><span class="line">                        &#125;</span><br><span class="line">                        stwPopup.AddItem(ASmartWidget.ItemKind.Work, <span class="string">&quot;수혈수행관리&quot;</span>, <span class="literal">null</span>, <span class="literal">null</span>, () =&gt; OnOpenVMCNRDA004S());</span><br><span class="line">                        stwPopup.AddItem(ASmartWidget.ItemKind.Work, <span class="string">&quot;낙상입력&quot;</span>, <span class="literal">null</span>, <span class="literal">null</span>, () =&gt; OnOpenVMCMRNR116S());</span><br><span class="line">                        stwPopup.AddItem(ASmartWidget.ItemKind.Work, <span class="string">&quot;신체계측&quot;</span>, <span class="literal">null</span>, <span class="literal">null</span>, () =&gt; OnOpenVMCNRPM257S());</span><br><span class="line">                        stwPopup.AddItem(ASmartWidget.ItemKind.Work, <span class="string">&quot;환자팔찌 및 환자바코드 출력&quot;</span>, <span class="literal">null</span>, <span class="literal">null</span>, () =&gt; OnOpenVMCNRWS765S());</span><br><span class="line">                        stwPopup.AddItem(ASmartWidget.ItemKind.Work, <span class="string">&quot;투약카드 출력&quot;</span>, <span class="literal">null</span>, <span class="literal">null</span>, () =&gt; OnMdctCardPrint());</span><br><span class="line">                        stwPopup.AddItem(ASmartWidget.ItemKind.Work, <span class="string">&quot;SMS문자전송(단일)-환자용&quot;</span>, <span class="literal">null</span>, <span class="literal">null</span>, () =&gt; OnOpenVETSYMS005S_Patient());</span><br><span class="line">                        stwPopup.AddItem(ASmartWidget.ItemKind.Work, <span class="string">&quot;SMS문자전송(단일)-직원용&quot;</span>, <span class="literal">null</span>, <span class="literal">null</span>, () =&gt; OnOpenVETSYMS005S_Employee());</span><br><span class="line">                        <span class="keyword">if</span> (rdoOrdrPformLocCd.EditValue.ToStringDefault(<span class="string">&quot;&quot;</span>) == <span class="string">&quot;PIVC&quot;</span>)</span><br><span class="line">                        &#123;</span><br><span class="line">                            stwPopup.AddItem(ASmartWidget.ItemKind.Work, <span class="string">&quot;시술TimeOut기록지&quot;</span>, <span class="literal">null</span>, <span class="literal">null</span>, () =&gt; OnOpenVSPSEEJ050S());</span><br><span class="line">                            stwPopup.AddItem(ASmartWidget.ItemKind.Work, <span class="string">&quot;검체채혈-업무구분별&quot;</span>, <span class="literal">null</span>, <span class="literal">null</span>, () =&gt; OnOpenVSPSSSP030S());</span><br><span class="line">                        &#125;</span><br><span class="line">                        stwPopup.AddItem(ASmartWidget.ItemKind.Work, <span class="string">&quot;이송신청(환자별)&quot;</span>, <span class="literal">null</span>, <span class="literal">null</span>, () =&gt; OnOpenVWAWPTF022S());</span><br><span class="line">                    &#125;</span><br><span class="line">                    stwPopup.Show(<span class="keyword">this</span>);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 그리드컬럼 초기화</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">InitializeGridColumn</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>        &#123;</span><br><span class="line">            <span class="keyword">if</span> (rdoOrdrPformLocCd.EditValue.ToStringDefault(<span class="string">&quot;&quot;</span>) == <span class="string">&quot;OPIV&quot;</span>)  <span class="comment">// 동관</span></span><br><span class="line">            &#123;</span><br><span class="line">                colpatno.VisibleIndex = <span class="number">0</span>;             <span class="comment">// 병원등록번호 </span></span><br><span class="line">                colpatNm.VisibleIndex = <span class="number">1</span>;             <span class="comment">// 환자성명     </span></span><br><span class="line">                colOrdrRefndExscYn.VisibleIndex = <span class="number">2</span>;   <span class="comment">// 환불</span></span><br><span class="line">                colirTaskNm.VisibleIndex = <span class="number">3</span>;          <span class="comment">// 환자구분     </span></span><br><span class="line">                colirWaitStatNm.VisibleIndex = <span class="number">4</span>;      <span class="comment">// 대기상태     </span></span><br><span class="line">                colfldwRegYn.VisibleIndex = <span class="number">5</span>;         <span class="comment">// 낙상         </span></span><br><span class="line">                colageCnte.VisibleIndex = <span class="number">6</span>;           <span class="comment">// 나이         </span></span><br><span class="line">                colsexDivNm.VisibleIndex = <span class="number">7</span>;          <span class="comment">// 성별         </span></span><br><span class="line">                colmddpCd.VisibleIndex = <span class="number">8</span>;            <span class="comment">// 진료과       </span></span><br><span class="line">                colAtnnNm.VisibleIndex = <span class="number">9</span>;            <span class="comment">// 진료의성명   </span></span><br><span class="line">                colrcivDtm.VisibleIndex = <span class="number">10</span>;          <span class="comment">// 수납일시     </span></span><br><span class="line">                colIrOrdrDt.VisibleIndex = <span class="number">11</span>;         <span class="comment">// 처방일자</span></span><br><span class="line">                colPatBirthdt.VisibleIndex = <span class="number">12</span>;       <span class="comment">// 생년월일     </span></span><br><span class="line">                colInhospDiagEngNm.VisibleIndex = <span class="number">13</span>;  <span class="comment">// 진단명</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">                colpatno.Visible = <span class="literal">true</span>;               <span class="comment">// 병원등록번호 </span></span><br><span class="line">                colpatNm.Visible = <span class="literal">true</span>;               <span class="comment">// 환자성명     </span></span><br><span class="line">                colirTaskNm.Visible = <span class="literal">true</span>;            <span class="comment">// 환자구분     </span></span><br><span class="line">                colirWaitStatNm.Visible = <span class="literal">true</span>;        <span class="comment">// 대기상태     </span></span><br><span class="line">                colfldwRegYn.Visible = <span class="literal">true</span>;           <span class="comment">// 낙상         </span></span><br><span class="line">                colageCnte.Visible = <span class="literal">true</span>;             <span class="comment">// 나이         </span></span><br><span class="line">                colsexDivNm.Visible = <span class="literal">true</span>;            <span class="comment">// 성별         </span></span><br><span class="line">                colmddpCd.Visible = <span class="literal">true</span>;              <span class="comment">// 진료과       </span></span><br><span class="line">                colAtnnNm.Visible = <span class="literal">true</span>;              <span class="comment">// 진료의성명   </span></span><br><span class="line">                colrcivDtm.Visible = <span class="literal">true</span>;             <span class="comment">// 수납일시     </span></span><br><span class="line">                colIrOrdrDt.Visible = <span class="literal">true</span>;            <span class="comment">// 처방일자</span></span><br><span class="line">                colPatBirthdt.Visible = <span class="literal">true</span>;          <span class="comment">// 생년월일     </span></span><br><span class="line">                colInhospDiagEngNm.Visible = <span class="literal">true</span>;     <span class="comment">// 진단명</span></span><br><span class="line">                colOrdrRefndExscYn.Visible = <span class="literal">true</span>;     <span class="comment">// 환불</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">                colaboRhBlty.Visible = <span class="literal">false</span>;          <span class="comment">// 혈액형</span></span><br><span class="line">                colChildAntnIrStayTmc.Visible = <span class="literal">false</span>; <span class="comment">// 재원시간</span></span><br><span class="line">                colchildAntnIrEroomTm.Visible = <span class="literal">false</span>; <span class="comment">// 입실시간</span></span><br><span class="line">                colchildAntnIrLrTm.Visible = <span class="literal">false</span>;    <span class="comment">// 퇴실시간</span></span><br><span class="line">                colBldtrOrdrYn.Visible = <span class="literal">false</span>;        <span class="comment">// 수혈처방여부            </span></span><br><span class="line">                colHlinOrdrYn.Visible = <span class="literal">false</span>;         <span class="comment">// 행위처방여부 </span></span><br><span class="line">                colIsAndrYn.Visible = <span class="literal">false</span>;           <span class="comment">// 항암제처방여부</span></span><br><span class="line">                colFtrOrdrYn.Visible = <span class="literal">false</span>;          <span class="comment">// 미래처방 여부</span></span><br><span class="line">                colpwsnYn.Visible = <span class="literal">false</span>;             <span class="comment">// 동명</span></span><br><span class="line">                colDnrYnMark.Visible = <span class="literal">false</span>;          <span class="comment">// DNR여부 </span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">                colpatNm.Width = <span class="number">55</span>;</span><br><span class="line">                colInhospDiagEngNm.Width = <span class="number">218</span>;        <span class="comment">// 진단명</span></span><br><span class="line">                colInhospDiagEngNm.MinWidth = <span class="number">218</span>;     <span class="comment">// 진단명</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span> (rdoOrdrPformLocCd.EditValue.ToStringDefault(<span class="string">&quot;&quot;</span>) == <span class="string">&quot;PIVC&quot;</span>)  <span class="comment">// 소아항암</span></span><br><span class="line">            &#123;</span><br><span class="line">                colpatno.VisibleIndex = <span class="number">0</span>;               <span class="comment">// 병원등록번호          </span></span><br><span class="line">                colfldwRegYn.VisibleIndex = <span class="number">1</span>;           <span class="comment">// 낙상               </span></span><br><span class="line">                colpatNm.VisibleIndex = <span class="number">2</span>;               <span class="comment">// 환자성명 </span></span><br><span class="line">                colOrdrRefndExscYn.VisibleIndex = <span class="number">3</span>;     <span class="comment">// 환불</span></span><br><span class="line">                colAtnnNm.VisibleIndex = <span class="number">4</span>;              <span class="comment">// 진료의성명   (원래 뒤쪽에 있었는데 앞쪽으로 옮겨달라고 요청받음 by 윤혜영샘 2019.04.04)</span></span><br><span class="line">                colPatBirthdt.VisibleIndex = <span class="number">5</span>;          <span class="comment">// 생년월일   </span></span><br><span class="line">                colageCnte.VisibleIndex = <span class="number">6</span>;             <span class="comment">// 나이                   </span></span><br><span class="line">                colsexDivNm.VisibleIndex = <span class="number">7</span>;            <span class="comment">// 성별                   </span></span><br><span class="line">                colaboRhBlty.VisibleIndex = <span class="number">8</span>;           <span class="comment">// 혈액형  </span></span><br><span class="line">                colFtrOrdrYn.VisibleIndex = <span class="number">9</span>;</span><br><span class="line">                colIsAndrYn.VisibleIndex = <span class="number">10</span>;           <span class="comment">// 항암제 처방여부               </span></span><br><span class="line">                colChildAntnIrStayTmc.VisibleIndex = <span class="number">11</span>; <span class="comment">// 재원시간                </span></span><br><span class="line">                colchildAntnIrEroomTm.VisibleIndex = <span class="number">12</span>; <span class="comment">// 입실시간                </span></span><br><span class="line">                colchildAntnIrLrTm.VisibleIndex = <span class="number">13</span>;    <span class="comment">// 퇴실시간  </span></span><br><span class="line">                colInhospDiagEngNm.VisibleIndex = <span class="number">14</span>;    <span class="comment">// 진단명                  </span></span><br><span class="line">                colmddpCd.VisibleIndex = <span class="number">15</span>;             <span class="comment">// 진료과             </span></span><br><span class="line">                colrcivDtm.VisibleIndex = <span class="number">16</span>;            <span class="comment">// 수납일시               </span></span><br><span class="line">                colIrOrdrDt.VisibleIndex = <span class="number">17</span>;           <span class="comment">// 처방일자</span></span><br><span class="line">                colDnrYnMark.VisibleIndex = <span class="number">18</span>;          <span class="comment">// DNR여부</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">                colpatno.Visible = <span class="literal">true</span>;              <span class="comment">// 병원등록번호          </span></span><br><span class="line">                colfldwRegYn.Visible = <span class="literal">true</span>;          <span class="comment">// 낙상               </span></span><br><span class="line">                colpatNm.Visible = <span class="literal">true</span>;              <span class="comment">// 환자성명           </span></span><br><span class="line">                colageCnte.Visible = <span class="literal">true</span>;            <span class="comment">// 나이                   </span></span><br><span class="line">                colsexDivNm.Visible = <span class="literal">true</span>;           <span class="comment">// 성별                   </span></span><br><span class="line">                colaboRhBlty.Visible = <span class="literal">true</span>;          <span class="comment">// 혈액형                 </span></span><br><span class="line">                colmddpCd.Visible = <span class="literal">true</span>;             <span class="comment">// 진료과             </span></span><br><span class="line">                colAtnnNm.Visible = <span class="literal">true</span>;             <span class="comment">// 진료의성명         </span></span><br><span class="line">                colrcivDtm.Visible = <span class="literal">true</span>;            <span class="comment">// 수납일시               </span></span><br><span class="line">                colIrOrdrDt.Visible = <span class="literal">true</span>;           <span class="comment">// 처방일자</span></span><br><span class="line">                colPatBirthdt.Visible = <span class="literal">true</span>;         <span class="comment">// 생년월일               </span></span><br><span class="line">                colInhospDiagEngNm.Visible = <span class="literal">true</span>;    <span class="comment">// 진단명                  </span></span><br><span class="line">                colIsAndrYn.Visible = <span class="literal">true</span>;           <span class="comment">// 항암제처방여부</span></span><br><span class="line">                colChildAntnIrStayTmc.Visible = <span class="literal">true</span>; <span class="comment">// 재원시간                </span></span><br><span class="line">                colchildAntnIrEroomTm.Visible = <span class="literal">true</span>; <span class="comment">// 입실시간                </span></span><br><span class="line">                colchildAntnIrLrTm.Visible = <span class="literal">true</span>;    <span class="comment">// 퇴실시간  </span></span><br><span class="line">                colFtrOrdrYn.Visible = <span class="literal">true</span>;          <span class="comment">// 미래처방 여부</span></span><br><span class="line">                colDnrYnMark.Visible = <span class="literal">true</span>;          <span class="comment">// DNR여부 </span></span><br><span class="line">                colOrdrRefndExscYn.Visible = <span class="literal">true</span>;    <span class="comment">// 환불</span></span><br><span class="line">                colChildAntnIrStayTmc.ColumnEdit = repCmbStayTmc;</span><br><span class="line">                colirTaskNm.Visible = <span class="literal">false</span>;          <span class="comment">// 환자구분 </span></span><br><span class="line">                colirWaitStatNm.Visible = <span class="literal">false</span>;      <span class="comment">// 대기상태</span></span><br><span class="line">                colpwsnYn.Visible = <span class="literal">false</span>;            <span class="comment">// 동명         </span></span><br><span class="line">                colBldtrOrdrYn.Visible = <span class="literal">false</span>;       <span class="comment">// 수혈처방여부            </span></span><br><span class="line">                colHlinOrdrYn.Visible = <span class="literal">false</span>;        <span class="comment">// 행위처방여부 </span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">                colpatNm.Width = <span class="number">55</span>;</span><br><span class="line">                colInhospDiagEngNm.Width = <span class="number">218</span>;      <span class="comment">// 진단명</span></span><br><span class="line">                colInhospDiagEngNm.MinWidth = <span class="number">218</span>;   <span class="comment">// 진단명</span></span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span>(rdoOrdrPformLocCd.EditValue.ToStringDefault(<span class="string">&quot;&quot;</span>) == <span class="string">&quot;OPIV3&quot;</span>) <span class="comment">// 신관</span></span><br><span class="line">            &#123;</span><br><span class="line">                colpatno.VisibleIndex = <span class="number">0</span>;            <span class="comment">// 병원등록번호 </span></span><br><span class="line">                colpatNm.VisibleIndex = <span class="number">1</span>;            <span class="comment">// 환자성명      </span></span><br><span class="line">                colOrdrRefndExscYn.VisibleIndex = <span class="number">2</span>;  <span class="comment">// 환불        </span></span><br><span class="line">                colfldwRegYn.VisibleIndex = <span class="number">3</span>;        <span class="comment">// 낙상         </span></span><br><span class="line">                colageCnte.VisibleIndex = <span class="number">4</span>;          <span class="comment">// 나이         </span></span><br><span class="line">                colsexDivNm.VisibleIndex = <span class="number">5</span>;         <span class="comment">// 성별         </span></span><br><span class="line">                colmddpCd.VisibleIndex = <span class="number">6</span>;           <span class="comment">// 진료과       </span></span><br><span class="line">                colAtnnNm.VisibleIndex = <span class="number">7</span>;           <span class="comment">// 진료의성명   </span></span><br><span class="line">                colrcivDtm.VisibleIndex = <span class="number">8</span>;          <span class="comment">// 수납일시     </span></span><br><span class="line">                colIrOrdrDt.VisibleIndex = <span class="number">9</span>;         <span class="comment">// 처방일자</span></span><br><span class="line">                colPatBirthdt.VisibleIndex = <span class="number">10</span>;      <span class="comment">// 생년월일     </span></span><br><span class="line">                colInhospDiagEngNm.VisibleIndex = <span class="number">11</span>; <span class="comment">// 진단명  </span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">                colpatno.Visible = <span class="literal">true</span>;               <span class="comment">// 병원등록번호 </span></span><br><span class="line">                colpatNm.Visible = <span class="literal">true</span>;               <span class="comment">// 환자성명      </span></span><br><span class="line">                colfldwRegYn.Visible = <span class="literal">true</span>;           <span class="comment">// 낙상         </span></span><br><span class="line">                colageCnte.Visible = <span class="literal">true</span>;             <span class="comment">// 나이         </span></span><br><span class="line">                colsexDivNm.Visible = <span class="literal">true</span>;            <span class="comment">// 성별         </span></span><br><span class="line">                colmddpCd.Visible = <span class="literal">true</span>;              <span class="comment">// 진료과       </span></span><br><span class="line">                colAtnnNm.Visible = <span class="literal">true</span>;              <span class="comment">// 진료의성명   </span></span><br><span class="line">                colrcivDtm.Visible = <span class="literal">true</span>;             <span class="comment">// 수납일시     </span></span><br><span class="line">                colIrOrdrDt.Visible = <span class="literal">true</span>;            <span class="comment">// 처방일자</span></span><br><span class="line">                colPatBirthdt.Visible = <span class="literal">true</span>;          <span class="comment">// 생년월일     </span></span><br><span class="line">                colInhospDiagEngNm.Visible = <span class="literal">true</span>;     <span class="comment">// 진단명  </span></span><br><span class="line">                colOrdrRefndExscYn.Visible = <span class="literal">true</span>;     <span class="comment">// 환불</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">                colirTaskNm.Visible = <span class="literal">false</span>;           <span class="comment">// 환자구분 </span></span><br><span class="line">                colirWaitStatNm.Visible = <span class="literal">false</span>;       <span class="comment">// 대기상태</span></span><br><span class="line">                colaboRhBlty.Visible = <span class="literal">false</span>;          <span class="comment">// 혈액형</span></span><br><span class="line">                colChildAntnIrStayTmc.Visible = <span class="literal">false</span>; <span class="comment">// 재원시간</span></span><br><span class="line">                colchildAntnIrEroomTm.Visible = <span class="literal">false</span>; <span class="comment">// 입실시간</span></span><br><span class="line">                colchildAntnIrLrTm.Visible = <span class="literal">false</span>;    <span class="comment">// 퇴실시간</span></span><br><span class="line">                colBldtrOrdrYn.Visible = <span class="literal">false</span>;        <span class="comment">// 수혈처방여부            </span></span><br><span class="line">                colHlinOrdrYn.Visible = <span class="literal">false</span>;         <span class="comment">// 행위처방여부    </span></span><br><span class="line">                colIsAndrYn.Visible = <span class="literal">false</span>;           <span class="comment">// 항암제처방여부</span></span><br><span class="line">                colFtrOrdrYn.Visible = <span class="literal">false</span>;          <span class="comment">// 미래처방 여부</span></span><br><span class="line">                colpwsnYn.Visible = <span class="literal">false</span>;             <span class="comment">// 동명    </span></span><br><span class="line">                colDnrYnMark.Visible = <span class="literal">false</span>;          <span class="comment">// DNR여부 </span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">                colpatNm.Width = <span class="number">55</span>;</span><br><span class="line">                colInhospDiagEngNm.Width = <span class="number">300</span>;        <span class="comment">// 진단명</span></span><br><span class="line">                colInhospDiagEngNm.MinWidth = <span class="number">300</span>;     <span class="comment">// 진단명</span></span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span>(rdoOrdrPformLocCd.EditValue.ToStringDefault(<span class="string">&quot;&quot;</span>) == <span class="string">&quot;PEDIV&quot;</span>) <span class="comment">// 소아</span></span><br><span class="line">            &#123;</span><br><span class="line">                colpatno.VisibleIndex = <span class="number">0</span>;            <span class="comment">// 병원등록번호 </span></span><br><span class="line">                colpatNm.VisibleIndex = <span class="number">1</span>;            <span class="comment">// 환자성명      </span></span><br><span class="line">                colOrdrRefndExscYn.VisibleIndex = <span class="number">2</span>;  <span class="comment">// 환불</span></span><br><span class="line">                colfldwRegYn.VisibleIndex = <span class="number">3</span>;        <span class="comment">// 낙상         </span></span><br><span class="line">                colageCnte.VisibleIndex = <span class="number">4</span>;          <span class="comment">// 나이         </span></span><br><span class="line">                colsexDivNm.VisibleIndex = <span class="number">5</span>;         <span class="comment">// 성별         </span></span><br><span class="line">                colmddpCd.VisibleIndex = <span class="number">6</span>;           <span class="comment">// 진료과       </span></span><br><span class="line">                colAtnnNm.VisibleIndex = <span class="number">7</span>;           <span class="comment">// 진료의성명   </span></span><br><span class="line">                colrcivDtm.VisibleIndex = <span class="number">8</span>;          <span class="comment">// 수납일시     </span></span><br><span class="line">                colIrOrdrDt.VisibleIndex = <span class="number">9</span>;         <span class="comment">// 처방일자</span></span><br><span class="line">                colPatBirthdt.VisibleIndex = <span class="number">10</span>;      <span class="comment">// 생년월일     </span></span><br><span class="line">                colInhospDiagEngNm.VisibleIndex = <span class="number">11</span>; <span class="comment">// 진단명  </span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">                colpatno.Visible = <span class="literal">true</span>;               <span class="comment">// 병원등록번호 </span></span><br><span class="line">                colpatNm.Visible = <span class="literal">true</span>;               <span class="comment">// 환자성명      </span></span><br><span class="line">                colfldwRegYn.Visible = <span class="literal">true</span>;           <span class="comment">// 낙상         </span></span><br><span class="line">                colageCnte.Visible = <span class="literal">true</span>;             <span class="comment">// 나이         </span></span><br><span class="line">                colsexDivNm.Visible = <span class="literal">true</span>;            <span class="comment">// 성별         </span></span><br><span class="line">                colmddpCd.Visible = <span class="literal">true</span>;              <span class="comment">// 진료과       </span></span><br><span class="line">                colAtnnNm.Visible = <span class="literal">true</span>;              <span class="comment">// 진료의성명   </span></span><br><span class="line">                colrcivDtm.Visible = <span class="literal">true</span>;             <span class="comment">// 수납일시     </span></span><br><span class="line">                colIrOrdrDt.Visible = <span class="literal">true</span>;            <span class="comment">// 처방일자</span></span><br><span class="line">                colPatBirthdt.Visible = <span class="literal">true</span>;          <span class="comment">// 생년월일     </span></span><br><span class="line">                colInhospDiagEngNm.Visible = <span class="literal">true</span>;     <span class="comment">// 진단명  </span></span><br><span class="line">                colOrdrRefndExscYn.Visible = <span class="literal">true</span>;     <span class="comment">// 환불</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">                colirTaskNm.Visible = <span class="literal">false</span>;           <span class="comment">// 환자구분 </span></span><br><span class="line">                colirWaitStatNm.Visible = <span class="literal">false</span>;       <span class="comment">// 대기상태</span></span><br><span class="line">                colaboRhBlty.Visible = <span class="literal">false</span>;          <span class="comment">// 혈액형</span></span><br><span class="line">                colChildAntnIrStayTmc.Visible = <span class="literal">false</span>; <span class="comment">// 재원시간</span></span><br><span class="line">                colchildAntnIrEroomTm.Visible = <span class="literal">false</span>; <span class="comment">// 입실시간</span></span><br><span class="line">                colchildAntnIrLrTm.Visible = <span class="literal">false</span>;    <span class="comment">// 퇴실시간</span></span><br><span class="line">                colBldtrOrdrYn.Visible = <span class="literal">false</span>;        <span class="comment">// 수혈처방여부            </span></span><br><span class="line">                colHlinOrdrYn.Visible = <span class="literal">false</span>;         <span class="comment">// 행위처방여부    </span></span><br><span class="line">                colIsAndrYn.Visible = <span class="literal">false</span>;           <span class="comment">// 항암제처방여부</span></span><br><span class="line">                colFtrOrdrYn.Visible = <span class="literal">false</span>;          <span class="comment">// 미래처방 여부</span></span><br><span class="line">                colpwsnYn.Visible = <span class="literal">false</span>;             <span class="comment">// 동명     </span></span><br><span class="line">                colDnrYnMark.Visible = <span class="literal">false</span>;          <span class="comment">// DNR여부 </span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">                colpatNm.Width = <span class="number">75</span>;                   <span class="comment">// 소아주사실</span></span><br><span class="line">                colInhospDiagEngNm.Width = <span class="number">300</span>;        <span class="comment">// 진단명</span></span><br><span class="line">                colInhospDiagEngNm.MinWidth = <span class="number">300</span>;     <span class="comment">// 진단명</span></span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span>     <span class="comment">//  전체</span></span><br><span class="line">            &#123;</span><br><span class="line">                colirTaskNm.VisibleIndex = <span class="number">0</span>;         <span class="comment">// 환자구분     </span></span><br><span class="line">                colirWaitStatNm.VisibleIndex = <span class="number">2</span>;     <span class="comment">// 대기상태     </span></span><br><span class="line">                colfldwRegYn.VisibleIndex = <span class="number">3</span>;        <span class="comment">// 낙상         </span></span><br><span class="line">                colpatno.VisibleIndex = <span class="number">4</span>;            <span class="comment">// 병원등록번호 </span></span><br><span class="line">                colpatNm.VisibleIndex = <span class="number">5</span>;            <span class="comment">// 환자성명     </span></span><br><span class="line">                colOrdrRefndExscYn.VisibleIndex = <span class="number">6</span>;  <span class="comment">// 환불</span></span><br><span class="line">                colageCnte.VisibleIndex = <span class="number">6</span>;          <span class="comment">// 나이         </span></span><br><span class="line">                colsexDivNm.VisibleIndex = <span class="number">7</span>;         <span class="comment">// 성별         </span></span><br><span class="line">                colmddpCd.VisibleIndex = <span class="number">8</span>;           <span class="comment">// 진료과       </span></span><br><span class="line">                colAtnnNm.VisibleIndex = <span class="number">9</span>;           <span class="comment">// 진료의성명   </span></span><br><span class="line">                colrcivDtm.VisibleIndex = <span class="number">10</span>;         <span class="comment">// 수납일시     </span></span><br><span class="line">                colIrOrdrDt.VisibleIndex = <span class="number">11</span>;        <span class="comment">// 처방일자</span></span><br><span class="line">                colPatBirthdt.VisibleIndex = <span class="number">12</span>;      <span class="comment">// 생년월일     </span></span><br><span class="line">                colInhospDiagEngNm.VisibleIndex = <span class="number">13</span>; <span class="comment">// 진단명</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">                colirTaskNm.Visible = <span class="literal">true</span>;            <span class="comment">// 환자구분     </span></span><br><span class="line">                colirWaitStatNm.Visible = <span class="literal">true</span>;        <span class="comment">// 대기상태     </span></span><br><span class="line">                colfldwRegYn.Visible = <span class="literal">true</span>;           <span class="comment">// 낙상         </span></span><br><span class="line">                colpatno.Visible = <span class="literal">true</span>;               <span class="comment">// 병원등록번호 </span></span><br><span class="line">                colpatNm.Visible = <span class="literal">true</span>;               <span class="comment">// 환자성명     </span></span><br><span class="line">                colageCnte.Visible = <span class="literal">true</span>;             <span class="comment">// 나이         </span></span><br><span class="line">                colsexDivNm.Visible = <span class="literal">true</span>;            <span class="comment">// 성별         </span></span><br><span class="line">                colmddpCd.Visible = <span class="literal">true</span>;              <span class="comment">// 진료과       </span></span><br><span class="line">                colAtnnNm.Visible = <span class="literal">true</span>;              <span class="comment">// 진료의성명   </span></span><br><span class="line">                colrcivDtm.Visible = <span class="literal">true</span>;             <span class="comment">// 수납일시     </span></span><br><span class="line">                colIrOrdrDt.Visible = <span class="literal">true</span>;            <span class="comment">// 처방일자</span></span><br><span class="line">                colPatBirthdt.Visible = <span class="literal">true</span>;          <span class="comment">// 생년월일     </span></span><br><span class="line">                colInhospDiagEngNm.Visible = <span class="literal">true</span>;     <span class="comment">// 진단명</span></span><br><span class="line">                colOrdrRefndExscYn.Visible = <span class="literal">true</span>;     <span class="comment">// 환불</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">                colaboRhBlty.Visible = <span class="literal">false</span>;          <span class="comment">// 혈액형</span></span><br><span class="line">                colChildAntnIrStayTmc.Visible = <span class="literal">false</span>; <span class="comment">// 재원시간</span></span><br><span class="line">                colchildAntnIrEroomTm.Visible = <span class="literal">false</span>; <span class="comment">// 입실시간</span></span><br><span class="line">                colchildAntnIrLrTm.Visible = <span class="literal">false</span>;    <span class="comment">// 퇴실시간</span></span><br><span class="line">                colBldtrOrdrYn.Visible = <span class="literal">false</span>;        <span class="comment">// 수혈처방여부            </span></span><br><span class="line">                colHlinOrdrYn.Visible = <span class="literal">false</span>;         <span class="comment">// 행위처방여부  </span></span><br><span class="line">                colIsAndrYn.Visible = <span class="literal">false</span>;           <span class="comment">// 항암제처방여부</span></span><br><span class="line">                colFtrOrdrYn.Visible = <span class="literal">false</span>;          <span class="comment">// 미래처방 여부</span></span><br><span class="line">                colDnrYnMark.Visible = <span class="literal">false</span>;</span><br><span class="line">                colpwsnYn.Visible = <span class="literal">false</span>;             <span class="comment">// 동명    </span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">                colpatNm.Width = <span class="number">55</span>;</span><br><span class="line">                colInhospDiagEngNm.Width = <span class="number">218</span>;        <span class="comment">// 진단명</span></span><br><span class="line">                colInhospDiagEngNm.MinWidth = <span class="number">218</span>;     <span class="comment">// 진단명</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 재원환자 데이터테이블 초기화</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">InitializeDtSaveIrStayTmc</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>        &#123;</span><br><span class="line">            dtSaveIrStayTmc.Columns.Add(<span class="string">&quot;ordrNo&quot;</span>, <span class="keyword">typeof</span>(<span class="keyword">string</span>));</span><br><span class="line">            dtSaveIrStayTmc.Columns.Add(<span class="string">&quot;patno&quot;</span>, <span class="keyword">typeof</span>(<span class="keyword">string</span>));</span><br><span class="line">            dtSaveIrStayTmc.Columns.Add(<span class="string">&quot;vistSn&quot;</span>, <span class="keyword">typeof</span>(<span class="keyword">string</span>));</span><br><span class="line">            dtSaveIrStayTmc.Columns.Add(<span class="string">&quot;ordrDirectDt&quot;</span>, <span class="keyword">typeof</span>(<span class="keyword">string</span>));</span><br><span class="line">            dtSaveIrStayTmc.Columns.Add(<span class="string">&quot;childAntnIrResvDt&quot;</span>, <span class="keyword">typeof</span>(<span class="keyword">string</span>));</span><br><span class="line">            dtSaveIrStayTmc.Columns.Add(<span class="string">&quot;childAntnIrStayTmc&quot;</span>, <span class="keyword">typeof</span>(<span class="keyword">string</span>));</span><br><span class="line">            dtSaveIrStayTmc.Columns.Add(<span class="string">&quot;childAntnIrResvTm&quot;</span>, <span class="keyword">typeof</span>(<span class="keyword">string</span>));</span><br><span class="line">            dtSaveIrStayTmc.Columns.Add(<span class="string">&quot;bedCd&quot;</span>, <span class="keyword">typeof</span>(<span class="keyword">string</span>));</span><br><span class="line">            dtSaveIrStayTmc.Columns.Add(<span class="string">&quot;mdctLocCd&quot;</span>, <span class="keyword">typeof</span>(<span class="keyword">string</span>));</span><br><span class="line">            dtSaveIrStayTmc.Columns.Add(<span class="string">&quot;ordrTblDstgCd&quot;</span>, <span class="keyword">typeof</span>(<span class="keyword">string</span>));</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="meta">#<span class="meta-keyword">endregion</span> ===============================================================</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="meta">#<span class="meta-keyword">region</span> ======================== [ 조회 / 저장 ] =========================</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 조회 실행</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="function"><span class="keyword">private</span> <span class="keyword">async</span> <span class="keyword">void</span> <span class="title">OnSearchAction</span>(<span class="params">Boolean bShowMsg</span>)</span></span><br><span class="line"><span class="function"></span>        &#123;</span><br><span class="line">            InitializeControls();</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (rdoDiv.EditValue.ToStringDefault(<span class="string">&quot;&quot;</span>) == <span class="string">&quot;DT&quot;</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                updateHopeDt(<span class="literal">false</span>);</span><br><span class="line">                Task irPatInfoForCheckPwsn = retrieveIrPatInfoForCheckPwsn(); <span class="comment">// 1. 선택된 주사실의 당일 전체 환자를 조회한다. (동명이인 체크용)</span></span><br><span class="line">                Task irPatInfoByDt = retrieveIrPatInfoByDt();                 <span class="comment">// 2. 선택된 주사실의 현재 조건에 걸린 환자를 조회한다. (동명이인 체크용)</span></span><br><span class="line">                <span class="keyword">await</span> Task.WhenAll(irPatInfoForCheckPwsn, irPatInfoByDt);     <span class="comment">// 3.  1번+2번이 모두 완료될 때까지 기다린다.</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">                DataTable dt = _dtList.Clone();</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">                <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; _dtList.Rows.Count; i++)</span><br><span class="line">                &#123;</span><br><span class="line">                    DataRow drList = _dtList.Rows[i];</span><br><span class="line">                    DataRow dr = <span class="literal">null</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">                    <span class="keyword">if</span> (drList[<span class="string">&quot;irTaskCdSeq&quot;</span>].ToLong() == <span class="number">1</span>)   <span class="comment">// 환자의 수납일시별 등록된 처방이 여러건인경우 우선순위에 따라 처음1건만 표시</span></span><br><span class="line">                    &#123;</span><br><span class="line">                        dr = dt.NewRow();</span><br><span class="line">                        dr[<span class="string">&quot;hopeDt&quot;</span>] = drList[<span class="string">&quot;hopeDt&quot;</span>].ToString();                          <span class="comment">// 희망일자</span></span><br><span class="line">                        dr[<span class="string">&quot;pformDt&quot;</span>] = drList[<span class="string">&quot;pformDt&quot;</span>].ToString();                        <span class="comment">// 수행일자</span></span><br><span class="line">                        dr[<span class="string">&quot;patno&quot;</span>] = drList[<span class="string">&quot;patno&quot;</span>].ToString();                            <span class="comment">// 등록번호</span></span><br><span class="line">                        dr[<span class="string">&quot;vistSn&quot;</span>] = drList[<span class="string">&quot;vistSn&quot;</span>].ToLong();                            <span class="comment">// 방문일련번호</span></span><br><span class="line">                        dr[<span class="string">&quot;rcivDtm&quot;</span>] = drList[<span class="string">&quot;rcivDtm&quot;</span>].ToString();                        <span class="comment">// 수납일시</span></span><br><span class="line">                        dr[<span class="string">&quot;irOrdrDt&quot;</span>] = drList[<span class="string">&quot;irOrdrDt&quot;</span>].ToString();                      <span class="comment">// 처방일자</span></span><br><span class="line">                        dr[<span class="string">&quot;patNm&quot;</span>] = drList[<span class="string">&quot;patNm&quot;</span>].ToString();                            <span class="comment">// 환자명</span></span><br><span class="line">                        dr[<span class="string">&quot;patBirthdt&quot;</span>] = drList[<span class="string">&quot;patBirthdt&quot;</span>].ToString();                  <span class="comment">// 생년월일</span></span><br><span class="line">                        dr[<span class="string">&quot;ageCnte&quot;</span>] = drList[<span class="string">&quot;ageCnte&quot;</span>].ToString();                        <span class="comment">// 나이</span></span><br><span class="line">                        dr[<span class="string">&quot;sexDivNm&quot;</span>] = drList[<span class="string">&quot;sexDivNm&quot;</span>].ToString();                      <span class="comment">// 성별</span></span><br><span class="line">                        dr[<span class="string">&quot;aboRhBlty&quot;</span>] = drList[<span class="string">&quot;aboRhBlty&quot;</span>].ToString();                    <span class="comment">// 혈액형</span></span><br><span class="line">                        dr[<span class="string">&quot;mbphNo&quot;</span>] = drList[<span class="string">&quot;mbphNo&quot;</span>].ToString();                          <span class="comment">// 전화번호  </span></span><br><span class="line">                        dr[<span class="string">&quot;ordrPformLocCd&quot;</span>] = drList[<span class="string">&quot;ordrPformLocCd&quot;</span>].ToString();          <span class="comment">// 처방수행장소</span></span><br><span class="line">                        dr[<span class="string">&quot;fldwRegYn&quot;</span>] = drList[<span class="string">&quot;fldwRegYn&quot;</span>].ToString();                    <span class="comment">// 낙상등록여부</span></span><br><span class="line">                        dr[<span class="string">&quot;inhospDiagEngNm&quot;</span>] = drList[<span class="string">&quot;inhospDiagEngNm&quot;</span>].ToString();        <span class="comment">// 원내진단영문명</span></span><br><span class="line">                        dr[<span class="string">&quot;mddpCd&quot;</span>] = drList[<span class="string">&quot;mddpCd&quot;</span>].ToString();                          <span class="comment">// 진료과코드</span></span><br><span class="line">                        dr[<span class="string">&quot;atnnEmpno&quot;</span>] = drList[<span class="string">&quot;atnnEmpno&quot;</span>].ToString();                    <span class="comment">// 진료의사번</span></span><br><span class="line">                        dr[<span class="string">&quot;atnnNm&quot;</span>] = drList[<span class="string">&quot;atnnNm&quot;</span>].ToString();                          <span class="comment">// 진료의성명</span></span><br><span class="line">                        dr[<span class="string">&quot;bldtrOrdrYn&quot;</span>] = drList[<span class="string">&quot;bldtrOrdrYn&quot;</span>].ToString();                <span class="comment">// 수혈처방여부</span></span><br><span class="line">                        dr[<span class="string">&quot;hlinOrdrYn&quot;</span>] = drList[<span class="string">&quot;hlinOrdrYn&quot;</span>].ToString();                  <span class="comment">// 행위처방여부    </span></span><br><span class="line">                        dr[<span class="string">&quot;rcivBySn&quot;</span>] = drList[<span class="string">&quot;rcivBySn&quot;</span>].ToLong();                        <span class="comment">// 수납별일련번호</span></span><br><span class="line">                        dr[<span class="string">&quot;sendLOrdrDelYn&quot;</span>] = drList[<span class="string">&quot;sendLOrdrDelYn&quot;</span>].ToString();          <span class="comment">// 전송후처방삭제여부</span></span><br><span class="line">                        dr[<span class="string">&quot;irWaitStatCd&quot;</span>] = drList[<span class="string">&quot;irWaitStatCd&quot;</span>].ToString();              <span class="comment">// 주사실대기상태코드</span></span><br><span class="line">                        dr[<span class="string">&quot;irWaitStatNm&quot;</span>] = drList[<span class="string">&quot;irWaitStatNm&quot;</span>].ToString();              <span class="comment">// 주사실대기상태명</span></span><br><span class="line">                        dr[<span class="string">&quot;pwsnYn&quot;</span>] = drList[<span class="string">&quot;pwsnYn&quot;</span>].ToString();                          <span class="comment">// 동명이인여부</span></span><br><span class="line">                        dr[<span class="string">&quot;empDscntYn&quot;</span>] = drList[<span class="string">&quot;empDscntYn&quot;</span>].ToString();                  <span class="comment">// 직원할인여부 </span></span><br><span class="line">                        dr[<span class="string">&quot;childAntnIrEroomTm&quot;</span>] = drList[<span class="string">&quot;childAntnIrEroomTm&quot;</span>].ToString();  <span class="comment">// 입실시각 </span></span><br><span class="line">                        dr[<span class="string">&quot;childAntnIrLrTm&quot;</span>] = drList[<span class="string">&quot;childAntnIrLrTm&quot;</span>].ToString();        <span class="comment">// 퇴실시각 </span></span><br><span class="line">                        dr[<span class="string">&quot;childAntnIrStayTmc&quot;</span>] = drList[<span class="string">&quot;childAntnIrStayTmc&quot;</span>].ToString();  <span class="comment">// 재실시각</span></span><br><span class="line">                        dr[<span class="string">&quot;isAndrYn&quot;</span>] = drList[<span class="string">&quot;isAndrYn&quot;</span>].ToString();                      <span class="comment">// 항암제처방여부</span></span><br><span class="line">                        dr[<span class="string">&quot;ftrOrdrYn&quot;</span>] = drList[<span class="string">&quot;ftrOrdrYn&quot;</span>].ToString();                    <span class="comment">// 미래처방여부</span></span><br><span class="line">                        dr[<span class="string">&quot;irTaskNm&quot;</span>] = drList[<span class="string">&quot;irTaskNm&quot;</span>].ToString();                      <span class="comment">// 주사실업무명   </span></span><br><span class="line">                        dr[<span class="string">&quot;dnrYnMark&quot;</span>] = drList[<span class="string">&quot;dnrYnMark&quot;</span>].ToString();                    <span class="comment">// DNR여부</span></span><br><span class="line">                        dr[<span class="string">&quot;ordrPformNo&quot;</span>] = drList[<span class="string">&quot;ordrPformNo&quot;</span>].ToString();                <span class="comment">// 처방코드</span></span><br><span class="line">                        dr[<span class="string">&quot;ordrRefndExscYn&quot;</span>] = drList[<span class="string">&quot;ordrRefndExscYn&quot;</span>].ToString();        <span class="comment">// 처방환불존재여부</span></span><br><span class="line">                        dr[<span class="string">&quot;irTaskCd&quot;</span>] = drList[<span class="string">&quot;irTaskCdTemp&quot;</span>].ToString();                  <span class="comment">// 주사실업무코드임시</span></span><br><span class="line">                        dr[<span class="string">&quot;irTaskCdJusa&quot;</span>] = drList[<span class="string">&quot;irTaskCdJusa&quot;</span>].ToString();              <span class="comment">// 주사실업무코드_주사실접수용(2019.04.03)</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">                        <span class="comment">// 동명이인처리 클라이언트로 옮김 - 속도개선 (2018.08.24)</span></span><br><span class="line">                        <span class="keyword">string</span> QueryForPwsn = <span class="string">&quot;patno &lt;&gt; &#x27;&quot;</span> + drList[<span class="string">&quot;patno&quot;</span>].ToString() + <span class="string">&quot;&#x27; &quot;</span></span><br><span class="line">                                            + <span class="string">&quot;and patNm = &#x27;&quot;</span> + drList[<span class="string">&quot;patNm&quot;</span>].ToString() + <span class="string">&quot;&#x27; &quot;</span>;</span><br><span class="line">                        <span class="keyword">if</span>(dtPwsn != <span class="literal">null</span> &amp;&amp; dtPwsn.Rows.Count &gt; <span class="number">0</span>)</span><br><span class="line">                        &#123;</span><br><span class="line">                            DataRow[] drsPwns = dtPwsn.Select(QueryForPwsn);</span><br><span class="line">                            <span class="keyword">if</span> (drsPwns != <span class="literal">null</span> &amp;&amp; drsPwns.Length &gt; <span class="number">0</span>) <span class="comment">// 동명이인 존재</span></span><br><span class="line">                            &#123;</span><br><span class="line">                                drList[<span class="string">&quot;pwsnYn&quot;</span>] = <span class="string">&quot;Y&quot;</span>;</span><br><span class="line">                                dr[<span class="string">&quot;pwsnYn&quot;</span>] = <span class="string">&quot;Y&quot;</span>;</span><br><span class="line">                            &#125;</span><br><span class="line">                        &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">                        <span class="keyword">if</span> (<span class="keyword">string</span>.IsNullOrEmpty(drList[<span class="string">&quot;irWaitNo&quot;</span>].ToString()))</span><br><span class="line">                        &#123;</span><br><span class="line">                            dr[<span class="string">&quot;irZoneNo&quot;</span>] = drList[<span class="string">&quot;irZoneNoTemp&quot;</span>].ToString();  <span class="comment">// 주사실구역번호임시</span></span><br><span class="line">                        &#125;</span><br><span class="line">                        <span class="keyword">else</span></span><br><span class="line">                        &#123;</span><br><span class="line">                            dr[<span class="string">&quot;irWaitNo&quot;</span>] = drList[<span class="string">&quot;irWaitNo&quot;</span>].ToString();      <span class="comment">// 주사실대기번호</span></span><br><span class="line">                            dr[<span class="string">&quot;irZoneNo&quot;</span>] = drList[<span class="string">&quot;irZoneNo&quot;</span>].ToString();      <span class="comment">// 주사실구역번호</span></span><br><span class="line">                        &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">                        <span class="comment">// 동일환자인데 수납일시만 다른 처방이 있으면 바로 다음 Row로 인덱스 변경</span></span><br><span class="line">                        <span class="keyword">string</span> QueryDifferentRciv = <span class="string">&quot;patno = &#x27;&quot;</span> + drList[<span class="string">&quot;patno&quot;</span>].ToString() + <span class="string">&quot;&#x27; &quot;</span></span><br><span class="line">                                                  + <span class="string">&quot;and vistSn = &#x27;&quot;</span> + drList[<span class="string">&quot;vistSn&quot;</span>].ToString() + <span class="string">&quot;&#x27; &quot;</span></span><br><span class="line">                                                  + <span class="string">&quot;and hopeDt = &#x27;&quot;</span> + drList[<span class="string">&quot;hopeDt&quot;</span>].ToString() + <span class="string">&quot;&#x27; &quot;</span></span><br><span class="line">                                                  + <span class="string">&quot;and rcivDtm &lt; &#x27;&quot;</span> + drList[<span class="string">&quot;rcivDtm&quot;</span>].ToString() + <span class="string">&quot;&#x27; &quot;</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">                        DataRow[] drsDifferentRciv = dt.Select(QueryDifferentRciv, <span class="string">&quot;rcivDtm ASC&quot;</span>);</span><br><span class="line">                        <span class="keyword">if</span> (drsDifferentRciv != <span class="literal">null</span> &amp;&amp; drsDifferentRciv.Length &gt; <span class="number">0</span>)</span><br><span class="line">                        &#123;</span><br><span class="line">                            <span class="keyword">int</span> index = dt.Rows.IndexOf(drsDifferentRciv[drsDifferentRciv.Length - <span class="number">1</span>]);</span><br><span class="line">                            dt.Rows.InsertAt(dr, index + <span class="number">1</span>);</span><br><span class="line">                        &#125;</span><br><span class="line">                        <span class="keyword">else</span></span><br><span class="line">                        &#123;</span><br><span class="line">                            dt.Rows.Add(dr);</span><br><span class="line">                        &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">                        dt.AcceptChanges();</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">                grdList.DataSource = dt;</span><br><span class="line">                AMessageBox.ShowInstant(<span class="keyword">this</span>, dt.Rows.Count.ToStringDefault(<span class="string">&quot;0&quot;</span>) + <span class="string">&quot;건이 조회되었습니다.&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">            &#123;</span><br><span class="line">                retrieveIrPatInfoByPat();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 동명이인 체크를 위한 당일 전체 환자명단 조회</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span><span class="doctag">&lt;/returns&gt;</span></span></span><br><span class="line">        <span class="function"><span class="keyword">private</span> <span class="keyword">async</span> Task <span class="title">retrieveIrPatInfoForCheckPwsn</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>        &#123;</span><br><span class="line">            PreData searchParamPwsn = <span class="keyword">new</span> PreData();</span><br><span class="line">            searchParamPwsn[<span class="string">&quot;pformDt&quot;</span>] = dtpPform.DateTime.ToString(<span class="string">&quot;yyyyMMdd&quot;</span>);</span><br><span class="line">            searchParamPwsn[<span class="string">&quot;irPformDiv&quot;</span>] = <span class="string">&quot;&quot;</span>;</span><br><span class="line">            searchParamPwsn[<span class="string">&quot;ordrPformLocCd&quot;</span>] = rdoOrdrPformLocCd.EditValue.ToStringDefault(<span class="string">&quot;&quot;</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">            AmcData responseDataPwsn = <span class="keyword">await</span> CommService.CallServiceAsync(<span class="string">&quot;SMCNR4317R&quot;</span>, <span class="keyword">new</span> AmcData &#123; preDatas = <span class="keyword">new</span> PreDatas &#123; &#123; <span class="string">&quot;IPD_Request&quot;</span>, searchParamPwsn &#125; &#125; &#125;, <span class="keyword">this</span>, LoadingType.BlockSearch);</span><br><span class="line">            dtPwsn = responseDataPwsn.recordSets[<span class="string">&quot;ORS_IrPat&quot;</span>].ToDataTable();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 선택된 조건의 주사실환자리스트 조회</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span><span class="doctag">&lt;/returns&gt;</span></span></span><br><span class="line">        <span class="function"><span class="keyword">private</span> <span class="keyword">async</span> Task <span class="title">retrieveIrPatInfoByDt</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>        &#123;</span><br><span class="line">            _dtList = <span class="literal">null</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">            PreData searchParam = <span class="keyword">new</span> PreData();</span><br><span class="line">            searchParam[<span class="string">&quot;pformDt&quot;</span>] = dtpPform.DateTime.ToString(<span class="string">&quot;yyyyMMdd&quot;</span>);                  <span class="comment">// 수행일자</span></span><br><span class="line">            searchParam[<span class="string">&quot;hopeDt&quot;</span>] = dtpPform.DateTime.ToString(<span class="string">&quot;yyyyMMdd&quot;</span>);                   <span class="comment">// 희망일자</span></span><br><span class="line">            searchParam[<span class="string">&quot;irPformDiv&quot;</span>] = rdoPformDiv.EditValue.ToStringDefault(<span class="string">&quot;&quot;</span>);            <span class="comment">// 수행구분  </span></span><br><span class="line">            searchParam[<span class="string">&quot;ordrPformLocCd&quot;</span>] = rdoOrdrPformLocCd.EditValue.ToStringDefault(<span class="string">&quot;&quot;</span>);  <span class="comment">// 주사실구분</span></span><br><span class="line">            searchParam[<span class="string">&quot;rcivYn&quot;</span>] = rdoRcivYn.EditValue.ToStringDefault(<span class="string">&quot;Y&quot;</span>);                 <span class="comment">// 수납여부</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">            AmcData responseData = <span class="keyword">await</span> CommService.CallServiceAsync(<span class="string">&quot;SMCNR4313R&quot;</span>, <span class="keyword">new</span> AmcData &#123; preDatas = <span class="keyword">new</span> PreDatas &#123; &#123; <span class="string">&quot;IPD_Request&quot;</span>, searchParam &#125; &#125; &#125;, <span class="keyword">this</span>, LoadingType.BlockSearch);</span><br><span class="line">            _dtList = responseData.recordSets[<span class="string">&quot;ORS_IrPat&quot;</span>].ToDataTable();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 환자별 조회</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">retrieveIrPatInfoByPat</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>        &#123;</span><br><span class="line">            PreData searchParam = <span class="keyword">new</span> PreData();</span><br><span class="line">            searchParam[<span class="string">&quot;patno&quot;</span>] = txtCondPatno.Text.Trim();                                  <span class="comment">// 병원등록번호</span></span><br><span class="line">            searchParam[<span class="string">&quot;inqryStDt&quot;</span>] = dtpOrdrDirectDt.FromDateTime.ToString(<span class="string">&quot;yyyyMMdd&quot;</span>);     <span class="comment">// 처방일자 From</span></span><br><span class="line">            searchParam[<span class="string">&quot;inqryEndDt&quot;</span>] = dtpOrdrDirectDt.ToDateTime.ToString(<span class="string">&quot;yyyyMMdd&quot;</span>);      <span class="comment">// 처방일자 To</span></span><br><span class="line">            searchParam[<span class="string">&quot;ordrPformLocCd&quot;</span>] = rdoOrdrPformLocCd.EditValue.ToStringDefault(<span class="string">&quot;&quot;</span>);  <span class="comment">// 주사실구분</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">            AmcData responseData = CommService.CallService(<span class="string">&quot;SMCNR4314R&quot;</span>, <span class="keyword">new</span> AmcData &#123; preDatas = <span class="keyword">new</span> PreDatas &#123; &#123; <span class="string">&quot;IPD_Request&quot;</span>, searchParam &#125; &#125; &#125;);</span><br><span class="line">            grdList.DataSource = responseData.recordSets[<span class="string">&quot;ORS_IrPat&quot;</span>].ToDataTable();</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">            AMessageBox.ShowInstant(<span class="keyword">this</span>, responseData.header.message);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 저장 실행</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="function"><span class="keyword">private</span> <span class="keyword">async</span> <span class="keyword">void</span> <span class="title">OnSave</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>        &#123;</span><br><span class="line">            <span class="keyword">if</span> (dtSaveIrStayTmc == <span class="literal">null</span> || dtSaveIrStayTmc.Rows.Count &lt; <span class="number">1</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                AMessageBox.ShowInstant(<span class="string">&quot;변경된 내용이 없습니다.&quot;</span>);</span><br><span class="line">                <span class="keyword">return</span>;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">            AmcData requestData = <span class="keyword">new</span> AmcData</span><br><span class="line">            &#123;</span><br><span class="line">                preDatas = <span class="keyword">new</span> PreDatas &#123; &#123; <span class="string">&quot;IPD_Request&quot;</span>, <span class="literal">null</span> &#125; &#125;,</span><br><span class="line">                recordSets = <span class="keyword">new</span> RecordSets &#123; &#123; <span class="string">&quot;IRS_DtByChildAntnIrResvPat&quot;</span>, dtSaveIrStayTmc.ToRecordSet(<span class="literal">true</span>) &#125; &#125;</span><br><span class="line">            &#125;;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">            AmcData responseData = <span class="keyword">await</span> CommService.CallServiceAsync(<span class="string">&quot;SMCNR0680T&quot;</span>, requestData);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (responseData.IsSuccess == <span class="literal">true</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                AMessageBox.ShowInstant(<span class="keyword">this</span>, <span class="string">&quot;저장하였습니다.&quot;</span>);</span><br><span class="line">                dtSaveIrStayTmc.Clear();</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">            &#123;</span><br><span class="line">                AMessageBox.ShowInstant(<span class="keyword">this</span>, responseData.header.message);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 희망일자 업데이트 실행</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">OnUpdateHopeDt</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>        &#123;</span><br><span class="line">            updateHopeDt(<span class="literal">true</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 검사예약일자 가져와 주사실희망일자 변경</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">updateHopeDt</span>(<span class="params"><span class="keyword">bool</span> ShowMessage = <span class="literal">true</span></span>)</span></span><br><span class="line"><span class="function"></span>        &#123;</span><br><span class="line">            PreData searchParam = <span class="keyword">new</span> PreData();</span><br><span class="line">            searchParam[<span class="string">&quot;pformDt&quot;</span>] = DateTime.Now.ToString(<span class="string">&quot;yyyyMMdd&quot;</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">            AmcData amcDataSearchParam = <span class="keyword">new</span> AmcData</span><br><span class="line">            &#123;</span><br><span class="line">                preDatas = <span class="keyword">new</span> PreDatas &#123;</span><br><span class="line">                     &#123;<span class="string">&quot;IPD_Request&quot;</span>,  searchParam &#125;</span><br><span class="line">                 &#125;</span><br><span class="line">            &#125;;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">            AmcData responseData = CommService.CallService(<span class="string">&quot;SMCNR4318U&quot;</span>, amcDataSearchParam);</span><br><span class="line">            <span class="keyword">if</span> (responseData.IsSuccess &amp;&amp; ShowMessage)</span><br><span class="line">            &#123;</span><br><span class="line">                AMessageBox.ShowInstant(responseData.header.message);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span> (responseData.IsFail)</span><br><span class="line">            &#123;</span><br><span class="line">                AMessageBox.Show(<span class="string">&quot;&quot;</span>, responseData.header.message);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="meta">#<span class="meta-keyword">endregion</span> ===============================================================</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="meta">#<span class="meta-keyword">region</span> =========================== [ 호  출 ] ===========================</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 간호관심코드</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">OnManageCode</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>        &#123;</span><br><span class="line">            Dictionary&lt;<span class="keyword">string</span>, <span class="keyword">string</span>&gt; paramDic = <span class="keyword">new</span> Dictionary&lt;<span class="keyword">string</span>, <span class="keyword">string</span>&gt;();</span><br><span class="line">            paramDic.Add(<span class="string">&quot;nursAtenTaskNm&quot;</span>, <span class="string">&quot;주사실 처방코드 분류관리&quot;</span>);</span><br><span class="line">            paramDic.Add(<span class="string">&quot;nursAtenTaskCd&quot;</span>, <span class="string">&quot;IRTASKCD&quot;</span>);</span><br><span class="line">            paramDic.Add(<span class="string">&quot;nursAtenClsfCd&quot;</span>, <span class="string">&quot;O&quot;</span>);</span><br><span class="line">            paramDic.Add(<span class="string">&quot;cdDiv&quot;</span>, <span class="string">&quot;L&quot;</span>);</span><br><span class="line">            paramDic.Add(<span class="string">&quot;guMinCd&quot;</span>, <span class="string">&quot;00000&quot;</span>);</span><br><span class="line">            paramDic.Add(<span class="string">&quot;handle&quot;</span>, <span class="string">&quot;N&quot;</span>);</span><br><span class="line">            paramDic.Add(<span class="string">&quot;ordrByCd&quot;</span>, <span class="string">&quot;F&quot;</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">            DocumentService.ShowDialogPopup(<span class="string">&quot;AMIS3.MC.NR.AM017.dll&quot;</span>, <span class="string">&quot;VMCNRAM017S&quot;</span>, Point.Empty, paramDic.ToJson(), (dlg) =&gt; &#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 공통화면호출 함수</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">OnCommonFormOpen</span>(<span class="params">Dictionary&lt;<span class="keyword">string</span>, <span class="keyword">string</span>&gt; dic, <span class="keyword">string</span> pSenderID, <span class="keyword">string</span> pTargetID, <span class="keyword">string</span> pMessageID, Boolean pIsGuid, <span class="keyword">string</span> pDLL</span>)</span></span><br><span class="line"><span class="function"></span>        &#123;</span><br><span class="line">            AmisMessageData&lt;<span class="keyword">string</span>&gt; messageData = <span class="keyword">new</span> AmisMessageData&lt;<span class="keyword">string</span>&gt;();  <span class="comment">//전달할 Data형식을 string으로 정의</span></span><br><span class="line">            messageData.SenderID = pSenderID;          <span class="comment">// 보내는 사용자ID(Local인 경우 &#x27;SYSTEM&#x27;)</span></span><br><span class="line">            messageData.SenderScreenID = <span class="keyword">this</span>.Name;    <span class="comment">// 보낸쪽 ID는 현재 스크린의 NAME으로 설정</span></span><br><span class="line">            messageData.TargetID = pTargetID;          <span class="comment">// 받는쪽 ID를 설정</span></span><br><span class="line">            messageData.MessageID = pMessageID;        <span class="comment">// 메세지 ID 보내고 받는 쪽에서 상호간 정의한다.(업무코드2자리 + 일련번호3자리)</span></span><br><span class="line">            messageData.IsGuid = pIsGuid;              <span class="comment">// 받는 TargetID가 GUID인지 여부</span></span><br><span class="line">            messageData.Data = dic.ToJson();           <span class="comment">// 전달할 Data</span></span><br><span class="line">            <span class="keyword">this</span>.SendDataToScreen(messageData, pDLL);  <span class="comment">//실제로 데이터를 보낸다.</span></span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 신체계측 화면 호출</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">OnOpenVMCNRPM257S</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>        &#123;</span><br><span class="line">            Dictionary&lt;<span class="keyword">string</span>, <span class="keyword">string</span>&gt; dic = <span class="keyword">new</span> Dictionary&lt;<span class="keyword">string</span>, <span class="keyword">string</span>&gt;();</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (rdoDiv.EditValue.ToStringDefault(<span class="string">&quot;&quot;</span>) == <span class="string">&quot;DT&quot;</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">if</span> (gvListByDt != <span class="literal">null</span> &amp;&amp; gvListByDt.FocusedRowHandle &gt;= <span class="number">0</span>)</span><br><span class="line">                &#123;</span><br><span class="line">                    dic[<span class="string">&quot;patno&quot;</span>] = gvListByDt.GetFocusedRowCellValue(<span class="string">&quot;patno&quot;</span>).ToString();</span><br><span class="line">                    OnCommonFormOpen(dic, <span class="string">&quot;SYSTEM&quot;</span>, <span class="string">&quot;VMCNRPM257S&quot;</span>, <span class="string">&quot;PM327&quot;</span>, <span class="literal">false</span>, <span class="string">&quot;AMIS3.MC.NR.PM257.dll&quot;</span>);</span><br><span class="line">                    sendDataToPatDto();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">            &#123;</span><br><span class="line">                dic[<span class="string">&quot;patno&quot;</span>] = txtCondPatno.Text.ToStringDefault(<span class="string">&quot;&quot;</span>);</span><br><span class="line">                OnCommonFormOpen(dic, <span class="string">&quot;SYSTEM&quot;</span>, <span class="string">&quot;VMCNRPM257S&quot;</span>, <span class="string">&quot;PM327&quot;</span>, <span class="literal">false</span>, <span class="string">&quot;AMIS3.MC.NR.PM257.dll&quot;</span>);</span><br><span class="line">                sendDataToPatDto();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 오더전체조회 화면 호출</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">OnOpenVMCOOOD058S</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>        &#123;</span><br><span class="line">            Dictionary&lt;<span class="keyword">string</span>, <span class="keyword">string</span>&gt; dic = <span class="keyword">new</span> Dictionary&lt;<span class="keyword">string</span>, <span class="keyword">string</span>&gt;();</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (rdoDiv.EditValue.ToStringDefault(<span class="string">&quot;&quot;</span>) == <span class="string">&quot;DT&quot;</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">if</span> (gvListByDt != <span class="literal">null</span> &amp;&amp; gvListByDt.FocusedRowHandle &gt;= <span class="number">0</span>)</span><br><span class="line">                &#123;</span><br><span class="line">                    dic[<span class="string">&quot;patno&quot;</span>] = gvListByDt.GetFocusedRowCellValue(<span class="string">&quot;patno&quot;</span>).ToString();</span><br><span class="line">                    dic[<span class="string">&quot;vistSn&quot;</span>] = gvListByDt.GetFocusedRowCellValue(<span class="string">&quot;vistSn&quot;</span>).ToString();</span><br><span class="line">                    dic[<span class="string">&quot;ordrDirectDt&quot;</span>] = dtpPform.DateTime.ToString(<span class="string">&quot;yyyyMMdd&quot;</span>);              <span class="comment">// 수행일자</span></span><br><span class="line">                    OnCommonFormOpen(dic, <span class="string">&quot;SYSTEM&quot;</span>, <span class="string">&quot;VMCOOOD058S&quot;</span>, <span class="string">&quot;PM327&quot;</span>, <span class="literal">false</span>, <span class="string">&quot;AMIS3.MC.OO.OD058.dll&quot;</span>);</span><br><span class="line">                    sendDataToPatDto();</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">if</span> (gvListByPat != <span class="literal">null</span> &amp;&amp; gvListByPat.FocusedRowHandle &gt;= <span class="number">0</span>)</span><br><span class="line">                &#123;</span><br><span class="line">                    dic[<span class="string">&quot;patno&quot;</span>] = gvListByPat.GetFocusedRowCellValue(<span class="string">&quot;patno&quot;</span>).ToString();</span><br><span class="line">                    dic[<span class="string">&quot;vistSn&quot;</span>] = gvListByPat.GetFocusedRowCellValue(<span class="string">&quot;vistSn&quot;</span>).ToString();</span><br><span class="line">                    dic[<span class="string">&quot;ordrDirectDt&quot;</span>] = dtpPform.DateTime.ToString(<span class="string">&quot;yyyyMMdd&quot;</span>);              <span class="comment">// 수행일자</span></span><br><span class="line">                    OnCommonFormOpen(dic, <span class="string">&quot;SYSTEM&quot;</span>, <span class="string">&quot;VMCOOOD058S&quot;</span>, <span class="string">&quot;PM327&quot;</span>, <span class="literal">false</span>, <span class="string">&quot;AMIS3.MC.OO.OD058.dll&quot;</span>);</span><br><span class="line">                    sendDataToPatDto();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 낙상 화면 호출</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">OnOpenVMCMRNR116S</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>        &#123;</span><br><span class="line">            <span class="keyword">string</span> sPatno = String.Empty;</span><br><span class="line">            <span class="keyword">long</span> vistSn = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (rdoDiv.EditValue.ToStringDefault(<span class="string">&quot;&quot;</span>) == <span class="string">&quot;DT&quot;</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">if</span> (gvListByDt != <span class="literal">null</span> &amp;&amp; gvListByDt.FocusedRowHandle &gt;= <span class="number">0</span>)</span><br><span class="line">                &#123;</span><br><span class="line">                    sPatno = gvListByDt.GetFocusedRowCellValue(<span class="string">&quot;patno&quot;</span>).ToString();</span><br><span class="line">                    vistSn = <span class="keyword">long</span>.Parse(gvListByDt.GetFocusedRowCellValue(<span class="string">&quot;vistSn&quot;</span>).ToString());</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">else</span> <span class="keyword">return</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">if</span> (gvListByPat != <span class="literal">null</span> &amp;&amp; gvListByPat.FocusedRowHandle &gt;= <span class="number">0</span>)</span><br><span class="line">                &#123;</span><br><span class="line">                    sPatno = gvListByPat.GetFocusedRowCellValue(<span class="string">&quot;patno&quot;</span>).ToString();</span><br><span class="line">                    vistSn = <span class="keyword">long</span>.Parse(gvListByPat.GetFocusedRowCellValue(<span class="string">&quot;vistSn&quot;</span>).ToString());</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">else</span> <span class="keyword">return</span>;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">            <span class="keyword">string</span> sWorkLocCd = SecurityService.WorkLocCd;</span><br><span class="line">            <span class="keyword">string</span> sMessageData = sPatno + <span class="string">&quot;,&quot;</span> + sWorkLocCd;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">            AmisMessageData&lt;<span class="keyword">string</span>&gt; msgDetailScreen = <span class="keyword">new</span> AmisMessageData&lt;<span class="keyword">string</span>&gt;();  <span class="comment">//전달할 Data형식을 string으로 정의</span></span><br><span class="line">            msgDetailScreen.SenderID = <span class="string">&quot;SYSTEM&quot;</span>;                                      <span class="comment">//보내는 사용자ID(Local인 경우 &#x27;SYSTEM&#x27;)</span></span><br><span class="line">            msgDetailScreen.SenderScreenID = <span class="keyword">this</span>.Name;                               <span class="comment">//보낸쪽 ID는 현재 스크린의 NAME으로 설정</span></span><br><span class="line">            msgDetailScreen.TargetID = <span class="string">&quot;VMCMRNR116S&quot;</span>;                                 <span class="comment">//받는쪽 ID를 설정</span></span><br><span class="line">            msgDetailScreen.MessageID = <span class="string">&quot;MC001&quot;</span>;                                      <span class="comment">//메세지 ID 보내고 받는 쪽에서 상호간 정의한다.(업무코드2자리 + 일련번호3자리)</span></span><br><span class="line">            msgDetailScreen.IsGuid = <span class="literal">false</span>;                                           <span class="comment">//받는 TargetID가 GUID인지 여부</span></span><br><span class="line">            msgDetailScreen.Patno = sPatno;                                           <span class="comment">//추가: 환자등록번호</span></span><br><span class="line">            msgDetailScreen.VistSn = vistSn;                                          <span class="comment">//추가: 내원일련번호</span></span><br><span class="line">            msgDetailScreen.Data = sMessageData;                                      <span class="comment">//전달할 Data</span></span><br><span class="line">            msgDetailScreen.IsFillPatientVO = <span class="literal">true</span>;</span><br><span class="line">            <span class="keyword">this</span>.SendDataToScreen(msgDetailScreen, <span class="string">&quot;AMIS3.MC.MR.NR116.dll&quot;</span>);  <span class="comment">//실제로 데이터를 보낸다. </span></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 간호투약수행관리 화면 호출 </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">OnOpenVMCNRDA003S</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>        &#123;</span><br><span class="line">            Dictionary&lt;<span class="keyword">string</span>, <span class="keyword">string</span>&gt; dic = <span class="keyword">new</span> Dictionary&lt;<span class="keyword">string</span>, <span class="keyword">string</span>&gt;();</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (rdoDiv.EditValue.ToStringDefault(<span class="string">&quot;&quot;</span>) == <span class="string">&quot;DT&quot;</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">if</span> (gvListByDt != <span class="literal">null</span> &amp;&amp; gvListByDt.FocusedRowHandle &gt;= <span class="number">0</span>)</span><br><span class="line">                &#123;</span><br><span class="line">                    dic[<span class="string">&quot;patno&quot;</span>] = gvListByDt.GetFocusedRowCellValue(<span class="string">&quot;patno&quot;</span>).ToString();</span><br><span class="line">                    OnCommonFormOpen(dic, <span class="string">&quot;SYSTEM&quot;</span>, <span class="string">&quot;VMCNRDA003S&quot;</span>, <span class="string">&quot;PM327&quot;</span>, <span class="literal">false</span>, <span class="string">&quot;AMIS3.MC.MR.DA003.dll&quot;</span>);</span><br><span class="line">                    sendDataToPatDto();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">if</span>(gvListByPat != <span class="literal">null</span> &amp;&amp; gvListByPat.FocusedRowHandle &gt;= <span class="number">0</span>)</span><br><span class="line">                &#123;</span><br><span class="line">                    dic[<span class="string">&quot;patno&quot;</span>] = txtCondPatno.Text.ToStringDefault(<span class="string">&quot;&quot;</span>);</span><br><span class="line">                    OnCommonFormOpen(dic, <span class="string">&quot;SYSTEM&quot;</span>, <span class="string">&quot;VMCNRDA003S&quot;</span>, <span class="string">&quot;PM327&quot;</span>, <span class="literal">false</span>, <span class="string">&quot;AMIS3.MC.MR.DA003.dll&quot;</span>);</span><br><span class="line">                    sendDataToPatDto();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 외래간호기록 화면 호출</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">OnOpenVMCMRNR035S</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>        &#123;</span><br><span class="line">            Dictionary&lt;<span class="keyword">string</span>, <span class="keyword">string</span>&gt; dic = <span class="keyword">new</span> Dictionary&lt;<span class="keyword">string</span>, <span class="keyword">string</span>&gt;();</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (rdoDiv.EditValue.ToStringDefault(<span class="string">&quot;&quot;</span>) == <span class="string">&quot;DT&quot;</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">if</span> (gvListByDt != <span class="literal">null</span> &amp;&amp; gvListByDt.FocusedRowHandle &gt;= <span class="number">0</span>)</span><br><span class="line">                &#123;</span><br><span class="line">                    dic[<span class="string">&quot;patno&quot;</span>] = gvListByDt.GetFocusedRowCellValue(<span class="string">&quot;patno&quot;</span>).ToString();</span><br><span class="line">                    dic[<span class="string">&quot;vistSn&quot;</span>] = gvListByDt.GetFocusedRowCellValue(<span class="string">&quot;vistSn&quot;</span>).ToString();</span><br><span class="line">                    dic[<span class="string">&quot;vistDt&quot;</span>] = dtpPform.DateTime.ToString(<span class="string">&quot;yyyyMMdd&quot;</span>);</span><br><span class="line">                    OnCommonFormOpen(dic, <span class="string">&quot;SYSTEM&quot;</span>, <span class="string">&quot;VMCMRNR035S&quot;</span>, <span class="string">&quot;PM327&quot;</span>, <span class="literal">false</span>, <span class="string">&quot;AMIS3.MC.MR.NR035.dll&quot;</span>);</span><br><span class="line">                    sendDataToPatDto();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">if</span>(gvListByPat != <span class="literal">null</span> &amp;&amp; gvListByPat.FocusedRowHandle &gt;= <span class="number">0</span>)</span><br><span class="line">                &#123;</span><br><span class="line">                    dic[<span class="string">&quot;patno&quot;</span>] = gvListByPat.GetFocusedRowCellValue(<span class="string">&quot;patno&quot;</span>).ToString();</span><br><span class="line">                    dic[<span class="string">&quot;vistSn&quot;</span>] = gvListByPat.GetFocusedRowCellValue(<span class="string">&quot;vistSn&quot;</span>).ToString();</span><br><span class="line">                    dic[<span class="string">&quot;vistDt&quot;</span>] = dtpPform.DateTime.ToString(<span class="string">&quot;yyyyMMdd&quot;</span>);</span><br><span class="line">                    OnCommonFormOpen(dic, <span class="string">&quot;SYSTEM&quot;</span>, <span class="string">&quot;VMCMRNR035S&quot;</span>, <span class="string">&quot;PM327&quot;</span>, <span class="literal">false</span>, <span class="string">&quot;AMIS3.MC.MR.NR035.dll&quot;</span>);</span><br><span class="line">                    sendDataToPatDto();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 수혈기록 화면 호출</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">OnOpenVMCNRDA004S</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>        &#123;</span><br><span class="line">            Dictionary&lt;<span class="keyword">string</span>, <span class="keyword">string</span>&gt; dic = <span class="keyword">new</span> Dictionary&lt;<span class="keyword">string</span>, <span class="keyword">string</span>&gt;();</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (rdoDiv.EditValue.ToStringDefault(<span class="string">&quot;&quot;</span>) == <span class="string">&quot;DT&quot;</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">if</span> (gvListByDt != <span class="literal">null</span> &amp;&amp; gvListByDt.FocusedRowHandle &gt;= <span class="number">0</span>)</span><br><span class="line">                &#123;</span><br><span class="line">                    dic[<span class="string">&quot;patno&quot;</span>] = gvListByDt.GetFocusedRowCellValue(<span class="string">&quot;patno&quot;</span>).ToString();</span><br><span class="line">                    OnCommonFormOpen(dic, <span class="string">&quot;SYSTEM&quot;</span>, <span class="string">&quot;VMCNRDA004S&quot;</span>, <span class="string">&quot;PM327&quot;</span>, <span class="literal">false</span>, <span class="string">&quot;AMIS3.MC.NR.DA004.dll&quot;</span>);</span><br><span class="line">                    sendDataToPatDto();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">if</span> (gvListByPat != <span class="literal">null</span> &amp;&amp; gvListByPat.FocusedRowHandle &gt;= <span class="number">0</span>)</span><br><span class="line">                &#123;</span><br><span class="line">                    dic[<span class="string">&quot;patno&quot;</span>] = txtCondPatno.Text.ToStringDefault(<span class="string">&quot;&quot;</span>);</span><br><span class="line">                    OnCommonFormOpen(dic, <span class="string">&quot;SYSTEM&quot;</span>, <span class="string">&quot;VMCNRDA004S&quot;</span>, <span class="string">&quot;PM327&quot;</span>, <span class="literal">false</span>, <span class="string">&quot;AMIS3.MC.NR.DA004.dll&quot;</span>);</span><br><span class="line">                    sendDataToPatDto();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 기록조회 화면호출</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">OnOpenVMCMRDR004S</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>        &#123;</span><br><span class="line">            Dictionary&lt;<span class="keyword">string</span>, <span class="keyword">string</span>&gt; dic = <span class="keyword">new</span> Dictionary&lt;<span class="keyword">string</span>, <span class="keyword">string</span>&gt;();</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (rdoDiv.EditValue.ToStringDefault(<span class="string">&quot;&quot;</span>) == <span class="string">&quot;DT&quot;</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">if</span> (gvListByDt != <span class="literal">null</span> &amp;&amp; gvListByDt.FocusedRowHandle &gt;= <span class="number">0</span>)</span><br><span class="line">                &#123;</span><br><span class="line">                    dic[<span class="string">&quot;patno&quot;</span>] = gvListByDt.GetFocusedRowCellValue(<span class="string">&quot;patno&quot;</span>).ToString();</span><br><span class="line">                    OnCommonFormOpen(dic, <span class="string">&quot;SYSTEM&quot;</span>, <span class="string">&quot;VMCMRDR004S&quot;</span>, <span class="string">&quot;PM327&quot;</span>, <span class="literal">false</span>, <span class="string">&quot;AMIS3.MC.MR.DA004.dll&quot;</span>);</span><br><span class="line">                    sendDataToPatDto();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">if</span> (gvListByPat != <span class="literal">null</span> &amp;&amp; gvListByPat.FocusedRowHandle &gt;= <span class="number">0</span>)</span><br><span class="line">                &#123;</span><br><span class="line">                    dic[<span class="string">&quot;patno&quot;</span>] = gvListByPat.GetFocusedRowCellValue(<span class="string">&quot;patno&quot;</span>).ToString();</span><br><span class="line">                    OnCommonFormOpen(dic, <span class="string">&quot;SYSTEM&quot;</span>, <span class="string">&quot;VMCMRDR004S&quot;</span>, <span class="string">&quot;PM327&quot;</span>, <span class="literal">false</span>, <span class="string">&quot;AMIS3.MC.MR.DA004.dll&quot;</span>);</span><br><span class="line">                    sendDataToPatDto();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 외래주사실 조제관리 화면호출</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">OnOpenVMCPHDS060S</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>        &#123;</span><br><span class="line">            OnCommonFormOpen(<span class="literal">null</span>, <span class="string">&quot;SYSTEM&quot;</span>, <span class="string">&quot;VMCPHDS060S&quot;</span>, <span class="string">&quot;PM327&quot;</span>, <span class="literal">false</span>, <span class="string">&quot;AMIS3.MC.PH.DS060.dll&quot;</span>);</span><br><span class="line">            sendDataToPatDto();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 암병원주사실입퇴실기록 화면 호출</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">OnOpenVMCMRNR126S</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>        &#123;</span><br><span class="line">            <span class="keyword">string</span> sPatno = String.Empty;</span><br><span class="line">            <span class="keyword">var</span> dicSendData = <span class="keyword">new</span> Dictionary&lt;<span class="keyword">string</span>, <span class="keyword">string</span>&gt;();</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (rdoDiv.EditValue.ToStringDefault(<span class="string">&quot;&quot;</span>) == <span class="string">&quot;DT&quot;</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">if</span> (gvListByDt != <span class="literal">null</span> &amp;&amp; gvListByDt.FocusedRowHandle &gt;= <span class="number">0</span>)</span><br><span class="line">                &#123;</span><br><span class="line">                    dicSendData.Add(<span class="string">&quot;patno&quot;</span>, gvListByDt.GetFocusedRowCellValue(<span class="string">&quot;patno&quot;</span>).ToString());</span><br><span class="line">                    dicSendData.Add(<span class="string">&quot;vistSn&quot;</span>, gvListByDt.GetFocusedRowCellValue(<span class="string">&quot;vistSn&quot;</span>).ToString());</span><br><span class="line">                    dicSendData.Add(<span class="string">&quot;vistDt&quot;</span>, gvListByDt.GetFocusedRowCellValue(<span class="string">&quot;hopeDt&quot;</span>).ToString());</span><br><span class="line">                    dicSendData.Add(<span class="string">&quot;vistTm&quot;</span>, DateTime.Now.ToString(<span class="string">&quot;HHmm&quot;</span>));</span><br><span class="line">                    dicSendData.Add(<span class="string">&quot;mddpCd&quot;</span>, gvListByDt.GetFocusedRowCellValue(<span class="string">&quot;mddpCd&quot;</span>).ToString());</span><br><span class="line">                    dicSendData.Add(<span class="string">&quot;locCd&quot;</span>, <span class="string">&quot;&quot;</span>);</span><br><span class="line">                    dicSendData.Add(<span class="string">&quot;dchrgDt&quot;</span>, <span class="string">&quot;&quot;</span>);</span><br><span class="line">                    dicSendData.Add(<span class="string">&quot;inqryTypCd&quot;</span>, <span class="string">&quot;&quot;</span>);</span><br><span class="line">                    dicSendData.Add(<span class="string">&quot;mdexDivCd&quot;</span>, <span class="string">&quot;&quot;</span>);</span><br><span class="line">                    dicSendData.Add(<span class="string">&quot;from&quot;</span>, <span class="string">&quot;&quot;</span>);</span><br><span class="line">                    dicSendData.Add(<span class="string">&quot;to&quot;</span>, <span class="string">&quot;&quot;</span>);</span><br><span class="line">                    dicSendData.Add(<span class="string">&quot;lvl&quot;</span>, <span class="string">&quot;&quot;</span>);</span><br><span class="line">                    dicSendData.Add(<span class="string">&quot;formDrawupNo&quot;</span>, <span class="string">&quot;&quot;</span>);</span><br><span class="line">                    dicSendData.Add(<span class="string">&quot;formCd&quot;</span>, <span class="string">&quot;&quot;</span>);</span><br><span class="line">                    dicSendData.Add(<span class="string">&quot;cancelVistYn&quot;</span>, <span class="string">&quot;&quot;</span>);</span><br><span class="line">                    OnCommonFormOpen(dicSendData, <span class="string">&quot;SYSTEM&quot;</span>, <span class="string">&quot;VMCMRNR126S&quot;</span>, <span class="string">&quot;PM327&quot;</span>, <span class="literal">false</span>, <span class="string">&quot;AMIS3.MC.MR.NR126.dll&quot;</span>);</span><br><span class="line">                    sendDataToPatDto();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">if</span> (gvListByPat != <span class="literal">null</span> &amp;&amp; gvListByPat.FocusedRowHandle &gt;= <span class="number">0</span>)</span><br><span class="line">                &#123;</span><br><span class="line">                    dicSendData.Add(<span class="string">&quot;patno&quot;</span>, gvListByPat.GetFocusedRowCellValue(<span class="string">&quot;patno&quot;</span>).ToString());</span><br><span class="line">                    dicSendData.Add(<span class="string">&quot;vistSn&quot;</span>, gvListByPat.GetFocusedRowCellValue(<span class="string">&quot;vistSn&quot;</span>).ToString());</span><br><span class="line">                    dicSendData.Add(<span class="string">&quot;vistDt&quot;</span>, gvListByPat.GetFocusedRowCellValue(<span class="string">&quot;hopeDt&quot;</span>).ToString());</span><br><span class="line">                    dicSendData.Add(<span class="string">&quot;vistTm&quot;</span>, DateTime.Now.ToString(<span class="string">&quot;HHmm&quot;</span>));</span><br><span class="line">                    dicSendData.Add(<span class="string">&quot;mddpCd&quot;</span>, gvListByPat.GetFocusedRowCellValue(<span class="string">&quot;mddpCd&quot;</span>).ToString());</span><br><span class="line">                    dicSendData.Add(<span class="string">&quot;locCd&quot;</span>, <span class="string">&quot;&quot;</span>);</span><br><span class="line">                    dicSendData.Add(<span class="string">&quot;dchrgDt&quot;</span>, <span class="string">&quot;&quot;</span>);</span><br><span class="line">                    dicSendData.Add(<span class="string">&quot;inqryTypCd&quot;</span>, <span class="string">&quot;&quot;</span>);</span><br><span class="line">                    dicSendData.Add(<span class="string">&quot;mdexDivCd&quot;</span>, <span class="string">&quot;&quot;</span>);</span><br><span class="line">                    dicSendData.Add(<span class="string">&quot;from&quot;</span>, <span class="string">&quot;&quot;</span>);</span><br><span class="line">                    dicSendData.Add(<span class="string">&quot;to&quot;</span>, <span class="string">&quot;&quot;</span>);</span><br><span class="line">                    dicSendData.Add(<span class="string">&quot;lvl&quot;</span>, <span class="string">&quot;&quot;</span>);</span><br><span class="line">                    dicSendData.Add(<span class="string">&quot;formDrawupNo&quot;</span>, <span class="string">&quot;&quot;</span>);</span><br><span class="line">                    dicSendData.Add(<span class="string">&quot;formCd&quot;</span>, <span class="string">&quot;&quot;</span>);</span><br><span class="line">                    dicSendData.Add(<span class="string">&quot;cancelVistYn&quot;</span>, <span class="string">&quot;&quot;</span>);</span><br><span class="line">                    OnCommonFormOpen(dicSendData, <span class="string">&quot;SYSTEM&quot;</span>, <span class="string">&quot;VMCMRNR126S&quot;</span>, <span class="string">&quot;PM327&quot;</span>, <span class="literal">false</span>, <span class="string">&quot;AMIS3.MC.MR.NR126.dll&quot;</span>);</span><br><span class="line">                    sendDataToPatDto();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 시술TimeOut기록지 화면 호출</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">OnOpenVSPSEEJ050S</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>        &#123;</span><br><span class="line">            <span class="keyword">var</span> dicSendData = <span class="keyword">new</span> Dictionary&lt;<span class="keyword">string</span>, <span class="keyword">string</span>&gt;();</span><br><span class="line">            <span class="keyword">if</span> (rdoDiv.EditValue.ToStringDefault(<span class="string">&quot;&quot;</span>) == <span class="string">&quot;DT&quot;</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">if</span> (gvListByDt != <span class="literal">null</span> &amp;&amp; gvListByDt.FocusedRowHandle &gt;= <span class="number">0</span>)</span><br><span class="line">                &#123;</span><br><span class="line">                    dicSendData.Add(<span class="string">&quot;patno&quot;</span>, gvListByDt.GetFocusedRowCellValue(<span class="string">&quot;patno&quot;</span>).ToString());</span><br><span class="line">                    dicSendData.Add(<span class="string">&quot;vistSn&quot;</span>, gvListByDt.GetFocusedRowCellValue(<span class="string">&quot;vistSn&quot;</span>).ToString());</span><br><span class="line">                    dicSendData.Add(<span class="string">&quot;examActDeptCd&quot;</span>, <span class="string">&quot;&quot;</span>);</span><br><span class="line">                    dicSendData.Add(<span class="string">&quot;examNursRecDrawupNo&quot;</span>, <span class="string">&quot;&quot;</span>);</span><br><span class="line">                    dicSendData.Add(<span class="string">&quot;drawupSn&quot;</span>, <span class="string">&quot;&quot;</span>);</span><br><span class="line">                    dicSendData.Add(<span class="string">&quot;formClsfCd&quot;</span>, <span class="string">&quot;&quot;</span>);</span><br><span class="line">                    dicSendData.Add(<span class="string">&quot;startDt&quot;</span>, <span class="string">&quot;&quot;</span>);</span><br><span class="line">                    dicSendData.Add(<span class="string">&quot;endDt&quot;</span>, <span class="string">&quot;&quot;</span>);</span><br><span class="line">                    dicSendData.Add(<span class="string">&quot;mdexDivCd&quot;</span>, <span class="string">&quot;&quot;</span>);</span><br><span class="line">                    dicSendData.Add(<span class="string">&quot;lookType&quot;</span>, <span class="string">&quot;&quot;</span>);</span><br><span class="line">                    sendDataToPatDto();</span><br><span class="line">                    OnCommonFormOpen(dicSendData, <span class="string">&quot;SYSTEM&quot;</span>, <span class="string">&quot;VSPSEEJ050S&quot;</span>, <span class="string">&quot;PM327&quot;</span>, <span class="literal">false</span>, <span class="string">&quot;AMIS3.SP.SE.EJ050.dll&quot;</span>);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">if</span> (gvListByPat != <span class="literal">null</span> &amp;&amp; gvListByPat.FocusedRowHandle &gt;= <span class="number">0</span>)</span><br><span class="line">                &#123;</span><br><span class="line">                    dicSendData.Add(<span class="string">&quot;patno&quot;</span>, gvListByPat.GetFocusedRowCellValue(<span class="string">&quot;patno&quot;</span>).ToString());</span><br><span class="line">                    dicSendData.Add(<span class="string">&quot;vistSn&quot;</span>, gvListByPat.GetFocusedRowCellValue(<span class="string">&quot;vistSn&quot;</span>).ToString());</span><br><span class="line">                    dicSendData.Add(<span class="string">&quot;examActDeptCd&quot;</span>, <span class="string">&quot;&quot;</span>);</span><br><span class="line">                    dicSendData.Add(<span class="string">&quot;examNursRecDrawupNo&quot;</span>, <span class="string">&quot;&quot;</span>);</span><br><span class="line">                    dicSendData.Add(<span class="string">&quot;drawupSn&quot;</span>, <span class="string">&quot;&quot;</span>);</span><br><span class="line">                    dicSendData.Add(<span class="string">&quot;formClsfCd&quot;</span>, <span class="string">&quot;&quot;</span>);</span><br><span class="line">                    dicSendData.Add(<span class="string">&quot;startDt&quot;</span>, <span class="string">&quot;&quot;</span>);</span><br><span class="line">                    dicSendData.Add(<span class="string">&quot;endDt&quot;</span>, <span class="string">&quot;&quot;</span>);</span><br><span class="line">                    dicSendData.Add(<span class="string">&quot;mdexDivCd&quot;</span>, <span class="string">&quot;&quot;</span>);</span><br><span class="line">                    dicSendData.Add(<span class="string">&quot;lookType&quot;</span>, <span class="string">&quot;&quot;</span>);</span><br><span class="line">                    sendDataToPatDto();</span><br><span class="line">                    OnCommonFormOpen(dicSendData, <span class="string">&quot;SYSTEM&quot;</span>, <span class="string">&quot;VSPSEEJ050S&quot;</span>, <span class="string">&quot;PM327&quot;</span>, <span class="literal">false</span>, <span class="string">&quot;AMIS3.SP.SE.EJ050.dll&quot;</span>);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 환자팔찌 및 환자바코드 출력</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">OnOpenVMCNRWS765S</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>        &#123;</span><br><span class="line">            Dictionary&lt;<span class="keyword">string</span>, <span class="keyword">string</span>&gt; dic = <span class="keyword">new</span> Dictionary&lt;<span class="keyword">string</span>, <span class="keyword">string</span>&gt;();</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (patInfo.SelectedPatInfo[(<span class="keyword">int</span>)SelectedPatInfo.PATNO].Equals(<span class="keyword">string</span>.Empty) ||</span><br><span class="line">                patInfo.SelectedPatInfo[(<span class="keyword">int</span>)SelectedPatInfo.VIST_SN].Equals(<span class="keyword">string</span>.Empty))</span><br><span class="line">                <span class="keyword">return</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">            dic.Add(<span class="string">&quot;patno&quot;</span>, patInfo.SelectedPatInfo[(<span class="keyword">int</span>)SelectedPatInfo.PATNO]);</span><br><span class="line">            <span class="keyword">if</span> (patInfo.SelectedPatInfo[(<span class="keyword">int</span>)SelectedPatInfo.VIST_SN] != <span class="literal">null</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                dic.Add(<span class="string">&quot;vistSn&quot;</span>, patInfo.SelectedPatInfo[(<span class="keyword">int</span>)SelectedPatInfo.VIST_SN]);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">return</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            dic.Add(<span class="string">&quot;prtTyp&quot;</span>, <span class="string">&quot;1&quot;</span>);</span><br><span class="line">            dic.Add(<span class="string">&quot;userLocGrpcd&quot;</span>, <span class="string">&quot;O&quot;</span>); <span class="comment">// 병동환자면 W, 응급환자면 E, 외래환자면 O</span></span><br><span class="line">            <span class="comment">//dic.Add(&quot;vistDt&quot;, gvListByDt.GetFocusedRowCellValue(&quot;pformDt&quot;).ToString());</span></span><br><span class="line">            dic.Add(<span class="string">&quot;mddpCd&quot;</span>, gvListByDt.GetFocusedRowCellValue(<span class="string">&quot;mddpCd&quot;</span>).ToString());</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">            List&lt;Dictionary&lt;<span class="keyword">string</span>, <span class="keyword">string</span>&gt;&gt; dicList = <span class="keyword">new</span> List&lt;Dictionary&lt;<span class="keyword">string</span>, <span class="keyword">string</span>&gt;&gt;();</span><br><span class="line">            dicList.Add(dic);</span><br><span class="line">            <span class="keyword">string</span> parameter = dicList.ToJson();</span><br><span class="line">            DocumentService.ShowDialogPopup(<span class="keyword">this</span>, <span class="string">&quot;AMIS3.MC.NR.WS765.dll&quot;</span>, <span class="string">&quot;VMCNRWS765S&quot;</span>, Point.Empty, parameter, (dlg) =&gt; &#123; &#125;);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 투약카드출력 화면 호출</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 수행장소가 전체일 경우에는 현재 로그인된 사용자의 장소를 따른다.</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">OnOpenVMCNRDA006S</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>        &#123;</span><br><span class="line">            KeyValueData keyValueDataInfo = <span class="keyword">new</span> KeyValueData();</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">            <span class="keyword">string</span> patno = gvListByDt.GetFocusedDataRow().Field&lt;<span class="keyword">string</span>&gt;(<span class="string">&quot;patno&quot;</span>);</span><br><span class="line">            <span class="keyword">string</span> patNm = gvListByDt.GetFocusedDataRow().Field&lt;<span class="keyword">string</span>&gt;(<span class="string">&quot;patNm&quot;</span>);</span><br><span class="line">            <span class="keyword">long</span> vistSn = gvListByDt.GetFocusedDataRow().Field&lt;<span class="keyword">long</span>&gt;(<span class="string">&quot;vistSn&quot;</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (String.IsNullOrEmpty(patno))</span><br><span class="line">            &#123;</span><br><span class="line">                AMessageBox.ShowInstant(<span class="keyword">this</span>, <span class="string">&quot;선택된 환자가 없습니다.&quot;</span>);</span><br><span class="line">                <span class="keyword">return</span>;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">            keyValueDataInfo.Add(<span class="string">&quot;patno&quot;</span>, patno);</span><br><span class="line">            keyValueDataInfo.Add(<span class="string">&quot;patNm&quot;</span>, patNm);</span><br><span class="line">            keyValueDataInfo.Add(<span class="string">&quot;vistSn&quot;</span>, vistSn.ToString());</span><br><span class="line">            keyValueDataInfo.Add(<span class="string">&quot;ordrDirectDt&quot;</span>, dtpPform.EditValue.ToDate().ToString(<span class="string">&quot;yyyyMMdd&quot;</span>));</span><br><span class="line">            keyValueDataInfo.Add(<span class="string">&quot;pformPosblTmYn&quot;</span>, <span class="string">&quot;Y&quot;</span>);  <span class="comment">// 재출력여부</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">            Form frm = Application.OpenForms.Cast&lt;Form&gt;().ToList().Find(x =&gt; x.Name == <span class="string">&quot;VMCNRDA006S&quot;</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (frm == <span class="literal">null</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                AmisMessageData&lt;<span class="keyword">string</span>&gt; amisMsgData = <span class="keyword">new</span> AmisMessageData&lt;<span class="keyword">string</span>&gt;();</span><br><span class="line">                amisMsgData.SenderID = SecurityWrapper.Instance.SecurityService.UserID;</span><br><span class="line">                amisMsgData.IsTargetActive = <span class="literal">true</span>;</span><br><span class="line">                amisMsgData.SenderScreenID = <span class="keyword">this</span>.Name;</span><br><span class="line">                amisMsgData.MessageID = <span class="string">&quot;MDCTCARD&quot;</span>;</span><br><span class="line">                amisMsgData.TargetID = <span class="string">&quot;VMCNRDA006S&quot;</span>;</span><br><span class="line">                amisMsgData.Data = keyValueDataInfo.ToJson();</span><br><span class="line">                SendDataToScreen(amisMsgData, <span class="string">&quot;AMIS3.MC.NR.DA006.dll&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">            &#123;</span><br><span class="line">                AmisMessageData&lt;Dictionary&lt;<span class="keyword">string</span>, <span class="keyword">string</span>&gt;&gt; amisMsgData = <span class="keyword">new</span> AmisMessageData&lt;Dictionary&lt;<span class="keyword">string</span>, <span class="keyword">string</span>&gt;&gt;();</span><br><span class="line">                amisMsgData.SenderID = SecurityWrapper.Instance.SecurityService.UserID;</span><br><span class="line">                amisMsgData.IsTargetActive = <span class="literal">true</span>;</span><br><span class="line">                amisMsgData.SenderScreenID = <span class="keyword">this</span>.Name;</span><br><span class="line">                amisMsgData.MessageID = <span class="string">&quot;MDCTCARD&quot;</span>;</span><br><span class="line">                amisMsgData.TargetID = <span class="string">&quot;VMCNRDA006S&quot;</span>;</span><br><span class="line">                amisMsgData.Data = keyValueDataInfo;</span><br><span class="line">                frm.Activate();</span><br><span class="line">                (frm <span class="keyword">as</span> IScreenBase).OnDataReceived(amisMsgData);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 투약카드 직접출력 호출</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">OnMdctCardPrint</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>        &#123;</span><br><span class="line">            IScreenBase mdtcCardCtrl = <span class="literal">null</span>;</span><br><span class="line">            <span class="keyword">if</span> (flwpnlActionButton.FindControl(<span class="string">&quot;VMCNRDA006P1&quot;</span>) == <span class="literal">null</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                mdtcCardCtrl = DocumentService.SetScreenControlReturnInstance(flwpnlActionButton, <span class="string">&quot;AMIS3.MC.NR.DA006.dll&quot;</span>, <span class="string">&quot;VMCNRDA006P1&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">            &#123;</span><br><span class="line">                mdtcCardCtrl = flwpnlActionButton.Controls.Find(<span class="string">&quot;VMCNRDA006P1&quot;</span>, <span class="literal">false</span>)[<span class="number">0</span>] <span class="keyword">as</span> IScreenBase;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (mdtcCardCtrl == <span class="literal">null</span>) <span class="keyword">return</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">            <span class="keyword">string</span> patno = String.Empty, patNm = String.Empty, pformLocCd = String.Empty, vistSn = String.Empty;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (rdoDiv.EditValue.ToStringDefault(<span class="string">&quot;&quot;</span>) == <span class="string">&quot;DT&quot;</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                patno = gvListByDt.GetFocusedRowCellValue(<span class="string">&quot;patno&quot;</span>).ToStringDefault();</span><br><span class="line">                patNm = gvListByDt.GetFocusedRowCellValue(<span class="string">&quot;patNm&quot;</span>).ToStringDefault();</span><br><span class="line">                vistSn = gvListByDt.GetFocusedRowCellValue(<span class="string">&quot;vistSn&quot;</span>).ToStringDefault();</span><br><span class="line">                pformLocCd = gvListByDt.GetFocusedRowCellValue(<span class="string">&quot;ordrPformLocCd&quot;</span>).ToStringDefault();</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">            &#123;</span><br><span class="line">                patno = gvListByPat.GetFocusedRowCellValue(<span class="string">&quot;patno&quot;</span>).ToStringDefault();</span><br><span class="line">                patNm = gvListByPat.GetFocusedRowCellValue(<span class="string">&quot;patNm&quot;</span>).ToStringDefault();</span><br><span class="line">                vistSn = gvListByPat.GetFocusedRowCellValue(<span class="string">&quot;vistSn&quot;</span>).ToStringDefault();</span><br><span class="line">                pformLocCd = gvListByPat.GetFocusedRowCellValue(<span class="string">&quot;ordrPformLocCd&quot;</span>).ToStringDefault();</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">            Dictionary&lt;<span class="keyword">string</span>, <span class="keyword">object</span>&gt; keyValueDataInfo = <span class="keyword">new</span> Dictionary&lt;<span class="keyword">string</span>, <span class="keyword">object</span>&gt;();</span><br><span class="line">            </span><br><span class="line">            keyValueDataInfo.Add(<span class="string">&quot;patno&quot;</span>, patno);</span><br><span class="line">            keyValueDataInfo.Add(<span class="string">&quot;patNm&quot;</span>, patNm);</span><br><span class="line">            keyValueDataInfo.Add(<span class="string">&quot;vistSn&quot;</span>, vistSn);</span><br><span class="line">            keyValueDataInfo.Add(<span class="string">&quot;ordrSrchTyp&quot;</span>, <span class="string">&quot;M&quot;</span>);</span><br><span class="line">            keyValueDataInfo.Add(<span class="string">&quot;pformLocCd&quot;</span>, pformLocCd);</span><br><span class="line">            keyValueDataInfo.Add(<span class="string">&quot;usrLocGrpCd&quot;</span>, pformLocCd);</span><br><span class="line">            keyValueDataInfo.Add(<span class="string">&quot;ordrDirectDt&quot;</span>, dtpPform.EditValue.ToDateString(ADateForamt.YYYYMMDD));</span><br><span class="line">            keyValueDataInfo.Add(<span class="string">&quot;skipProcessMsg&quot;</span>, <span class="string">&quot;N&quot;</span>);</span><br><span class="line">            keyValueDataInfo.Add(<span class="string">&quot;pformPosblTmYn&quot;</span>, <span class="string">&quot;Y&quot;</span>);  <span class="comment">// 재출력여부, 2019-04-26 </span></span><br><span class="line">            mdtcCardCtrl.OnDataReceived(keyValueDataInfo);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 동관주사실 전광판제어 새로고침</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">OnRefreshVMCNRPM420S</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>        &#123;</span><br><span class="line">            Dictionary&lt;<span class="keyword">string</span>, <span class="keyword">object</span>&gt; sendDic = <span class="keyword">new</span> Dictionary&lt;<span class="keyword">string</span>, <span class="keyword">object</span>&gt;();</span><br><span class="line">            SendObjectDicToScreen(<span class="string">&quot;VMCNRPM420S&quot;</span>, <span class="string">&quot;PM420&quot;</span>, <span class="literal">null</span>, <span class="string">&quot;AMIS3.MC.NR.PM420.dll&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 타화면 데이터 수신</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;typeparam name=&quot;T&quot;&gt;</span><span class="doctag">&lt;/typeparam&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;data&quot;&gt;</span><span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">override</span> <span class="keyword">void</span> <span class="title">OnDataReceived</span>&lt;<span class="title">T</span>&gt;(<span class="params">AmisMessageData&lt;T&gt; data</span>)</span></span><br><span class="line"><span class="function"></span>        &#123;</span><br><span class="line">            AmisMessageData&lt;<span class="keyword">string</span>&gt; amisData = data <span class="keyword">as</span> AmisMessageData&lt;<span class="keyword">string</span>&gt;;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (amisData.MessageID == <span class="string">&quot;PM327&quot;</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                OnSearchAction(<span class="literal">true</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> SMS 문자전송(단일) 화면 호출</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">OnOpenVETSYMS005S_Patient</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>        &#123;</span><br><span class="line">            <span class="keyword">if</span> (gvListByDt.GetFocusedRowCellValue(<span class="string">&quot;patno&quot;</span>) == <span class="literal">null</span> || gvListByDt.GetFocusedRowCellValue(<span class="string">&quot;patno&quot;</span>).ToString() == <span class="string">&quot;&quot;</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                AMessageBox.ShowInstant(<span class="string">&quot;환자가 선택되지 않았습니다.&quot;</span>); <span class="keyword">return</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (gvListByDt.GetFocusedRowCellValue(<span class="string">&quot;mbphNo&quot;</span>) == <span class="literal">null</span> || gvListByDt.GetFocusedRowCellValue(<span class="string">&quot;mbphNo&quot;</span>).ToString() == <span class="string">&quot;&quot;</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                AMessageBox.ShowInstant(<span class="string">&quot;환자의 전화번호가 확인되지 않습니다.&quot;</span>); <span class="keyword">return</span>;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">            <span class="keyword">string</span> mbphNo = gvListByDt.GetFocusedRowCellValue(<span class="string">&quot;mbphNo&quot;</span>).ToString();</span><br><span class="line">            <span class="keyword">string</span> patno = gvListByDt.GetFocusedRowCellValue(<span class="string">&quot;patno&quot;</span>).ToString();</span><br><span class="line">            <span class="keyword">string</span> patNm = gvListByDt.GetFocusedRowCellValue(<span class="string">&quot;patNm&quot;</span>).ToString();</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">            SMSMessage smsMsgTO = <span class="keyword">new</span> SMSMessage();</span><br><span class="line">            smsMsgTO.msgRevrClsf = <span class="string">&quot;P&quot;</span>;                            <span class="comment">//수신자분류 : P(환자)-default, E(직원)</span></span><br><span class="line">            smsMsgTO.revrTelno = mbphNo;                           <span class="comment">//수신자전화번호</span></span><br><span class="line">            smsMsgTO.msgSendReqDtm = DateTime.Now;                 <span class="comment">//메시지전송요청일시</span></span><br><span class="line">            smsMsgTO.msgRevrId = patno;                            <span class="comment">//메시지수신자ID</span></span><br><span class="line">            smsMsgTO.msgRevrNm = patNm;                            <span class="comment">//메시지수신자명</span></span><br><span class="line">            smsMsgTO.etcCnteDic.Add(<span class="string">&quot;PAT_NM&quot;</span>, patNm);              <span class="comment">//표준문구 대체 파라미터(Dictionary)</span></span><br><span class="line">            smsMsgTO.etcCnteDic.Add(<span class="string">&quot;DEPT_NM&quot;</span>, <span class="string">&quot;&quot;</span>);                <span class="comment">//표준문구 대체 파라미터(Dictionary)</span></span><br><span class="line">            smsMsgTO.smsSendPuposCnte = <span class="string">&quot;소아항암주사실SMS&quot;</span>;       <span class="comment">//SMS발송목적내용(필수)</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">            Dictionary&lt;<span class="keyword">string</span>, <span class="keyword">object</span>&gt; SendDic = <span class="keyword">new</span> Dictionary&lt;<span class="keyword">string</span>, <span class="keyword">object</span>&gt;();</span><br><span class="line">            SendDic.Add(<span class="string">&quot;smsMsg&quot;</span>, smsMsgTO);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">            <span class="keyword">this</span>.SendObjectDicToScreen(<span class="string">&quot;VETSYMS005S&quot;</span>, <span class="string">&quot;Msg01&quot;</span>, SendDic, <span class="string">&quot;AMIS3.ET.SY.MS005.dll&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> SMS 문자전송(직원) 화면 호출</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">OnOpenVETSYMS005S_Employee</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>        &#123;</span><br><span class="line">            <span class="comment">/**</span></span><br><span class="line"><span class="comment">             * 동관주사실을 선택했을 때만 수신자/메시지내용을 셋팅하고</span></span><br><span class="line"><span class="comment">             * 나머지 주사실은 메시지내용 셋팅하지 않고 빈화면을 호출합니다.</span></span><br><span class="line"><span class="comment">             */</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">            <span class="keyword">string</span> patno = <span class="keyword">string</span>.Empty;</span><br><span class="line">            <span class="keyword">string</span> patNm = <span class="keyword">string</span>.Empty;</span><br><span class="line">            <span class="keyword">string</span> msgCnte = <span class="keyword">string</span>.Empty;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (gvListByDt.GetFocusedRowCellValue(<span class="string">&quot;patno&quot;</span>) != <span class="literal">null</span> &amp;&amp; gvListByDt.GetFocusedRowCellValue(<span class="string">&quot;patno&quot;</span>).ToString() != <span class="string">&quot;&quot;</span>)</span><br><span class="line">                patno = gvListByDt.GetFocusedRowCellValue(<span class="string">&quot;patno&quot;</span>).ToString();</span><br><span class="line">            <span class="keyword">if</span> (gvListByDt.GetFocusedRowCellValue(<span class="string">&quot;patNm&quot;</span>) != <span class="literal">null</span> &amp;&amp; gvListByDt.GetFocusedRowCellValue(<span class="string">&quot;patNm&quot;</span>).ToString() != <span class="string">&quot;&quot;</span>)</span><br><span class="line">                patNm = gvListByDt.GetFocusedRowCellValue(<span class="string">&quot;patNm&quot;</span>).ToString();</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">            Dictionary&lt;<span class="keyword">string</span>, <span class="keyword">object</span>&gt; SendDic = <span class="keyword">new</span> Dictionary&lt;<span class="keyword">string</span>, <span class="keyword">object</span>&gt;();</span><br><span class="line">            <span class="keyword">switch</span> (rdoOrdrPformLocCd.EditValue.ToStringDefault(<span class="string">&quot;&quot;</span>))</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">case</span> <span class="string">&quot;OPIV&quot;</span>: <span class="comment">// 동관주사실 메시지 세팅</span></span><br><span class="line">                    <span class="comment">//-------------------------------------------------------------</span></span><br><span class="line">                    <span class="comment">// DataTable에 수신자번호(mbphNo), 수신자정보(desc) 세팅</span></span><br><span class="line">                    DataTable dtMbph = <span class="keyword">new</span> DataTable();</span><br><span class="line">                    dtMbph.Columns.Add(<span class="string">&quot;mbphNo&quot;</span>, <span class="keyword">typeof</span>(<span class="keyword">string</span>));</span><br><span class="line">                    dtMbph.Columns.Add(<span class="string">&quot;desc&quot;</span>, <span class="keyword">typeof</span>(<span class="keyword">string</span>));</span><br><span class="line">                    DataRow drMbph = dtMbph.NewRow();</span><br><span class="line">                    drMbph[<span class="string">&quot;mbphNo&quot;</span>] = <span class="string">&quot;889949&quot;</span>;</span><br><span class="line">                    drMbph[<span class="string">&quot;desc&quot;</span>] = <span class="string">&quot;동관주사실 김진미(H930223)&quot;</span>;</span><br><span class="line">                    dtMbph.Rows.Add(drMbph);</span><br><span class="line">                    <span class="comment">//-------------------------------------------------------------</span></span><br><span class="line">                    <span class="comment">// 동관주사실 메시지 내용 : Ex) 홍길동 55443322 마약 타다주세요</span></span><br><span class="line">                    <span class="keyword">if</span> (gvListByDt.GetFocusedRowCellValue(<span class="string">&quot;patno&quot;</span>) != <span class="literal">null</span> &amp;&amp; gvListByDt.GetFocusedRowCellValue(<span class="string">&quot;patno&quot;</span>).ToString() != <span class="string">&quot;&quot;</span>)</span><br><span class="line">                        msgCnte = patNm + <span class="string">&quot; &quot;</span> + patno + <span class="string">&quot; 마약 타다주세요&quot;</span>;</span><br><span class="line">                    <span class="keyword">else</span></span><br><span class="line">                        AMessageBox.ShowInstant(<span class="string">&quot;환자 선택후 [SMS문자전송(단일)-직원용] 오픈하면\r\n메시지내용을 자동완성합니다. \r\n\r\nEx) 홍길동 12345678 마약 타다주세요&quot;</span>);</span><br><span class="line">                    <span class="comment">//-------------------------------------------------------------</span></span><br><span class="line">                    SendDic.Add(<span class="string">&quot;cardex&quot;</span>, <span class="string">&quot;true&quot;</span>);                                      <span class="comment">// cardex를 &quot;true&quot;로 보내야 SMS직원용 탭이 열린다.</span></span><br><span class="line">                    SendDic.Add(<span class="string">&quot;smsSendPuposCnte&quot;</span>, <span class="string">&quot;동관주사실-직원SMS&quot;</span>);              <span class="comment">// SMS전송목적</span></span><br><span class="line">                    SendDic.Add(<span class="string">&quot;patno&quot;</span>, patno);                                        <span class="comment">// 병원등록번호</span></span><br><span class="line">                    SendDic.Add(<span class="string">&quot;msgRevrId&quot;</span>, <span class="string">&quot;H930223&quot;</span>);                                <span class="comment">// 수신자사번</span></span><br><span class="line">                    SendDic.Add(<span class="string">&quot;msgRevrNm&quot;</span>, <span class="string">&quot;김진미&quot;</span>);                                 <span class="comment">// 수신자명</span></span><br><span class="line">                    SendDic.Add(<span class="string">&quot;msgCnte&quot;</span>, msgCnte);                                    <span class="comment">// 메시지내용</span></span><br><span class="line">                    SendDic.Add(<span class="string">&quot;mbphList&quot;</span>, dtMbph);                                    <span class="comment">// 수신번호</span></span><br><span class="line">                    <span class="keyword">break</span>;       </span><br><span class="line"></span><br><span class="line"></span><br><span class="line">                <span class="keyword">case</span> <span class="string">&quot;OPIV3&quot;</span>: <span class="comment">// 신관주사실 메시지 세팅</span></span><br><span class="line">                    SendDic.Add(<span class="string">&quot;cardex&quot;</span>, <span class="string">&quot;true&quot;</span>);                                      <span class="comment">// cardex를 &quot;true&quot;로 보내야 SMS직원용 탭이 열린다.</span></span><br><span class="line">                    SendDic.Add(<span class="string">&quot;smsSendPuposCnte&quot;</span>, <span class="string">&quot;신관주사실-직원SMS&quot;</span>);</span><br><span class="line">                    SendDic.Add(<span class="string">&quot;patno&quot;</span>, patno);                                        <span class="comment">// 병원등록번호</span></span><br><span class="line">                    <span class="keyword">break</span>;       </span><br><span class="line"></span><br><span class="line"></span><br><span class="line">                <span class="keyword">case</span> <span class="string">&quot;PEDIV&quot;</span>: <span class="comment">// 소아주사실 메시지 세팅</span></span><br><span class="line">                    SendDic.Add(<span class="string">&quot;cardex&quot;</span>, <span class="string">&quot;true&quot;</span>);                                      <span class="comment">// cardex를 &quot;true&quot;로 보내야 SMS직원용 탭이 열린다.</span></span><br><span class="line">                    SendDic.Add(<span class="string">&quot;smsSendPuposCnte&quot;</span>, <span class="string">&quot;소아주사실-직원SMS&quot;</span>);</span><br><span class="line">                    SendDic.Add(<span class="string">&quot;patno&quot;</span>, patno);                                        <span class="comment">// 병원등록번호</span></span><br><span class="line">                    <span class="keyword">break</span>;       </span><br><span class="line"></span><br><span class="line"></span><br><span class="line">                <span class="keyword">case</span> <span class="string">&quot;PIVC&quot;</span>:  <span class="comment">// 소아항암주사실 메시지 세팅</span></span><br><span class="line">                    SendDic.Add(<span class="string">&quot;cardex&quot;</span>, <span class="string">&quot;true&quot;</span>);                                      <span class="comment">// cardex를 &quot;true&quot;로 보내야 SMS직원용 탭이 열린다.</span></span><br><span class="line">                    SendDic.Add(<span class="string">&quot;smsSendPuposCnte&quot;</span>, <span class="string">&quot;소아항암주사실-직원SMS&quot;</span>);</span><br><span class="line">                    SendDic.Add(<span class="string">&quot;patno&quot;</span>, patno);                                        <span class="comment">// 병원등록번호</span></span><br><span class="line">                    <span class="keyword">break</span>;   </span><br><span class="line">                <span class="keyword">default</span>:      <span class="comment">// 디폴트 메시지 세팅</span></span><br><span class="line">                    SendDic.Add(<span class="string">&quot;cardex&quot;</span>, <span class="string">&quot;true&quot;</span>);                                      <span class="comment">// cardex를 &quot;true&quot;로 보내야 SMS직원용 탭이 열린다.</span></span><br><span class="line">                    SendDic.Add(<span class="string">&quot;smsSendPuposCnte&quot;</span>, <span class="string">&quot;주사실-직원SMS&quot;</span>);</span><br><span class="line">                    SendDic.Add(<span class="string">&quot;patno&quot;</span>, patno);                                        <span class="comment">// 병원등록번호</span></span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">this</span>.SendObjectDicToScreen(<span class="string">&quot;VETSYMS005S&quot;</span>, <span class="string">&quot;Msg01&quot;</span>, SendDic, <span class="string">&quot;AMIS3.ET.SY.MS005.dll&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 간호처방등록 화면 호출</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">OnOpenVMCOOOD022S</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>        &#123;</span><br><span class="line">            Dictionary&lt;<span class="keyword">string</span>, <span class="keyword">object</span>&gt; SendDic = <span class="keyword">new</span> Dictionary&lt;<span class="keyword">string</span>, <span class="keyword">object</span>&gt;();</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (rdoDiv.EditValue.ToStringDefault(<span class="string">&quot;&quot;</span>) == <span class="string">&quot;DT&quot;</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">if</span> (gvListByDt != <span class="literal">null</span> &amp;&amp; gvListByDt.FocusedRowHandle &gt;= <span class="number">0</span>)</span><br><span class="line">                &#123;</span><br><span class="line">                    SendDic.Add(<span class="string">&quot;patno&quot;</span>, gvListByDt.GetFocusedRowCellValue(<span class="string">&quot;patno&quot;</span>).ToString());</span><br><span class="line">                    SendDic.Add(<span class="string">&quot;vistSn&quot;</span>, gvListByDt.GetFocusedRowCellValue(<span class="string">&quot;vistSn&quot;</span>).ToString());</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">else</span></span><br><span class="line">                &#123;</span><br><span class="line">                    AMessageBox.ShowInstant(<span class="string">&quot;환자를 선택해주세요.&quot;</span>);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">if</span> (gvListByPat != <span class="literal">null</span> &amp;&amp; gvListByPat.FocusedRowHandle &gt;= <span class="number">0</span>)</span><br><span class="line">                &#123;</span><br><span class="line">                    SendDic.Add(<span class="string">&quot;patno&quot;</span>, gvListByPat.GetFocusedRowCellValue(<span class="string">&quot;patno&quot;</span>).ToString());</span><br><span class="line">                    SendDic.Add(<span class="string">&quot;vistSn&quot;</span>, gvListByPat.GetFocusedRowCellValue(<span class="string">&quot;vistSn&quot;</span>).ToString());</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">else</span></span><br><span class="line">                &#123;</span><br><span class="line">                    AMessageBox.ShowInstant(<span class="string">&quot;환자를 선택해주세요.&quot;</span>);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">            sendDataToPatDto();</span><br><span class="line">            SendObjectDicToScreen(<span class="string">&quot;VMCOOOD022S&quot;</span>, <span class="string">&quot;PM420&quot;</span>, SendDic, <span class="string">&quot;AMIS3.MC.OO.OD022.dll&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 통합검사결과조회 화면 호출</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">OnOpenVSPSZZZ010S</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>        &#123;</span><br><span class="line">            Dictionary&lt;<span class="keyword">string</span>, <span class="keyword">object</span>&gt; SendDic = <span class="keyword">new</span> Dictionary&lt;<span class="keyword">string</span>, <span class="keyword">object</span>&gt;();</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (rdoDiv.EditValue.ToStringDefault(<span class="string">&quot;&quot;</span>) == <span class="string">&quot;DT&quot;</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">if</span> (gvListByDt != <span class="literal">null</span> &amp;&amp; gvListByDt.FocusedRowHandle &gt;= <span class="number">0</span>)</span><br><span class="line">                &#123;</span><br><span class="line">                    SendDic.Add(<span class="string">&quot;patno&quot;</span>, gvListByDt.GetFocusedRowCellValue(<span class="string">&quot;patno&quot;</span>).ToString());</span><br><span class="line">                    <span class="comment">//SendDic.Add(&quot;vistSn&quot;, gvListByDt.GetFocusedRowCellValue(&quot;vistSn&quot;).ToString());</span></span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">else</span></span><br><span class="line">                &#123;</span><br><span class="line">                    AMessageBox.ShowInstant(<span class="string">&quot;환자를 선택해주세요.&quot;</span>);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">if</span> (gvListByPat != <span class="literal">null</span> &amp;&amp; gvListByPat.FocusedRowHandle &gt;= <span class="number">0</span>)</span><br><span class="line">                &#123;</span><br><span class="line">                    SendDic.Add(<span class="string">&quot;patno&quot;</span>, gvListByPat.GetFocusedRowCellValue(<span class="string">&quot;patno&quot;</span>).ToString());</span><br><span class="line">                    <span class="comment">//SendDic.Add(&quot;vistSn&quot;, gvListByPat.GetFocusedRowCellValue(&quot;vistSn&quot;).ToString());</span></span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">else</span></span><br><span class="line">                &#123;</span><br><span class="line">                    AMessageBox.ShowInstant(<span class="string">&quot;환자를 선택해주세요.&quot;</span>);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">            sendDataToPatDto();</span><br><span class="line">            SendObjectDicToScreen(<span class="string">&quot;VSPSZZZ010S&quot;</span>, <span class="string">&quot;Msg01&quot;</span>, SendDic, <span class="string">&quot;AMIS3.SP.SZ.ZZ010.dll&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 검체채혈 화면 호출</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">OnOpenVSPSSSP030S</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>        &#123;</span><br><span class="line">            Dictionary&lt;<span class="keyword">string</span>, <span class="keyword">object</span>&gt; SendDic = <span class="keyword">new</span> Dictionary&lt;<span class="keyword">string</span>, <span class="keyword">object</span>&gt;();</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (rdoDiv.EditValue.ToStringDefault(<span class="string">&quot;&quot;</span>) == <span class="string">&quot;DT&quot;</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">if</span> (gvListByDt != <span class="literal">null</span> &amp;&amp; gvListByDt.FocusedRowHandle &gt;= <span class="number">0</span>)</span><br><span class="line">                &#123;</span><br><span class="line">                    SendDic.Add(<span class="string">&quot;patno&quot;</span>, gvListByDt.GetFocusedRowCellValue(<span class="string">&quot;patno&quot;</span>).ToString());</span><br><span class="line">                    SendDic.Add(<span class="string">&quot;vistSn&quot;</span>, gvListByDt.GetFocusedRowCellValue(<span class="string">&quot;vistSn&quot;</span>).ToString());</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">else</span></span><br><span class="line">                &#123;</span><br><span class="line">                    AMessageBox.ShowInstant(<span class="string">&quot;환자를 선택해주세요.&quot;</span>);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">if</span> (gvListByPat != <span class="literal">null</span> &amp;&amp; gvListByPat.FocusedRowHandle &gt;= <span class="number">0</span>)</span><br><span class="line">                &#123;</span><br><span class="line">                    SendDic.Add(<span class="string">&quot;patno&quot;</span>, gvListByPat.GetFocusedRowCellValue(<span class="string">&quot;patno&quot;</span>).ToString());</span><br><span class="line">                    SendDic.Add(<span class="string">&quot;vistSn&quot;</span>, gvListByPat.GetFocusedRowCellValue(<span class="string">&quot;vistSn&quot;</span>).ToString());</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">else</span></span><br><span class="line">                &#123;</span><br><span class="line">                    AMessageBox.ShowInstant(<span class="string">&quot;환자를 선택해주세요.&quot;</span>);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">            sendDataToPatDto();</span><br><span class="line">            SendObjectDicToScreen(<span class="string">&quot;VSPSSSP030S&quot;</span>, <span class="string">&quot;PM420&quot;</span>, SendDic, <span class="string">&quot;AMIS3.SP.SS.SP030.dll&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 이송신청(환자별) 화면 호출</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">OnOpenVWAWPTF022S</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>        &#123;</span><br><span class="line">            Dictionary&lt;<span class="keyword">string</span>, <span class="keyword">object</span>&gt; SendDic = <span class="keyword">new</span> Dictionary&lt;<span class="keyword">string</span>, <span class="keyword">object</span>&gt;();</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (rdoDiv.EditValue.ToStringDefault(<span class="string">&quot;&quot;</span>) == <span class="string">&quot;DT&quot;</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">if</span> (gvListByDt != <span class="literal">null</span> &amp;&amp; gvListByDt.FocusedRowHandle &gt;= <span class="number">0</span>)</span><br><span class="line">                &#123;</span><br><span class="line">                    SendDic.Add(<span class="string">&quot;patno&quot;</span>, gvListByDt.GetFocusedRowCellValue(<span class="string">&quot;patno&quot;</span>).ToString());</span><br><span class="line">                    SendDic.Add(<span class="string">&quot;vistSn&quot;</span>, gvListByDt.GetFocusedRowCellValue(<span class="string">&quot;vistSn&quot;</span>).ToString());</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">else</span></span><br><span class="line">                &#123;</span><br><span class="line">                    AMessageBox.ShowInstant(<span class="string">&quot;환자를 선택해주세요.&quot;</span>);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">if</span> (gvListByPat != <span class="literal">null</span> &amp;&amp; gvListByPat.FocusedRowHandle &gt;= <span class="number">0</span>)</span><br><span class="line">                &#123;</span><br><span class="line">                    SendDic.Add(<span class="string">&quot;patno&quot;</span>, gvListByPat.GetFocusedRowCellValue(<span class="string">&quot;patno&quot;</span>).ToString());</span><br><span class="line">                    SendDic.Add(<span class="string">&quot;vistSn&quot;</span>, gvListByPat.GetFocusedRowCellValue(<span class="string">&quot;vistSn&quot;</span>).ToString());</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">else</span></span><br><span class="line">                &#123;</span><br><span class="line">                    AMessageBox.ShowInstant(<span class="string">&quot;환자를 선택해주세요.&quot;</span>);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">            SendObjectDicToScreen(<span class="string">&quot;VWAWPTF022S&quot;</span>, <span class="string">&quot;PM420&quot;</span>, SendDic, <span class="string">&quot;AMIS3.WA.WP.TF022.dll&quot;</span>);</span><br><span class="line">            sendDataToPatDto();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="meta">#<span class="meta-keyword">endregion</span> ===============================================================</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="meta">#<span class="meta-keyword">region</span> =========================== [ 기  능 ] ===========================</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 접수 처리 (동관)</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">OnNewRcep</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>        &#123;</span><br><span class="line">            OnChangeIrStatByDtAction(<span class="string">&quot;SMCNR5279I&quot;</span>, <span class="string">&quot;P&quot;</span>);</span><br><span class="line">            OnRefreshVMCNRPM420S();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 주사실 대기상태 변경</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span>   - 주사대기상태코드 N:준비  P:접수  W:대기  R:입실  O:완료  T:통과</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;actionDiv&quot;&gt;</span>준비/접수/대기/입실/완료/통과 중 어떤 액션인지<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;IrWaitStatCd&quot;&gt;</span>현재 주사실대기상태코드<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">        <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">OnChangeIrStatByDtAction</span>(<span class="params"><span class="keyword">string</span> pServiceId, <span class="keyword">string</span> pIrWaitStatCd</span>)</span></span><br><span class="line"><span class="function"></span>        &#123;</span><br><span class="line">            PreData searchParam = <span class="keyword">new</span> PreData();</span><br><span class="line">            searchParam[<span class="string">&quot;ordrPformLocCd&quot;</span>] = gvListByDt.GetFocusedRowCellValue(<span class="string">&quot;ordrPformLocCd&quot;</span>).ToString();               <span class="comment">// 처방수행장소코드</span></span><br><span class="line">            searchParam[<span class="string">&quot;irWaitNo&quot;</span>] = gvListByDt.GetFocusedRowCellValue(<span class="string">&quot;irWaitNo&quot;</span>).ToString();                           <span class="comment">// 주사실대기번호</span></span><br><span class="line">            searchParam[<span class="string">&quot;boardMarkDt&quot;</span>] = gvListByDt.GetFocusedRowCellValue(<span class="string">&quot;hopeDt&quot;</span>).ToString();                          <span class="comment">// 전광판표시일자</span></span><br><span class="line">            searchParam[<span class="string">&quot;patno&quot;</span>] = gvListByDt.GetFocusedRowCellValue(<span class="string">&quot;patno&quot;</span>).ToString();                                 <span class="comment">// 병원등록번호</span></span><br><span class="line">            searchParam[<span class="string">&quot;patNm&quot;</span>] = gvListByDt.GetFocusedRowCellValue(<span class="string">&quot;patNm&quot;</span>).ToString();                                 <span class="comment">// 환자성명</span></span><br><span class="line">            searchParam[<span class="string">&quot;vistSn&quot;</span>, ADataType.L] = gvListByDt.GetFocusedRowCellValue(<span class="string">&quot;vistSn&quot;</span>).ToLong();                    <span class="comment">// 내원일련번호</span></span><br><span class="line">            searchParam[<span class="string">&quot;irTaskCd&quot;</span>] = gvListByDt.GetFocusedRowCellValue(<span class="string">&quot;irTaskCdJusa&quot;</span>).ToString();                       <span class="comment">// 주사실업무코드</span></span><br><span class="line">            searchParam[<span class="string">&quot;irWaitStatCd&quot;</span>] = pIrWaitStatCd;                                                                  <span class="comment">// 주사실대기상태코드</span></span><br><span class="line">            searchParam[<span class="string">&quot;irPrevWaitStatCd&quot;</span>] = gvListByDt.GetFocusedRowCellValue(<span class="string">&quot;irWaitStatCd&quot;</span>).ToString();               <span class="comment">// 주사실이전대기상태코드</span></span><br><span class="line">            searchParam[<span class="string">&quot;arivlTm&quot;</span>] = gvListByDt.GetFocusedRowCellValue(<span class="string">&quot;rcivDtm&quot;</span>).ToString().Substring(<span class="number">8</span>, <span class="number">4</span>);             <span class="comment">// 도착시각 = 수납시각</span></span><br><span class="line">            searchParam[<span class="string">&quot;rcivDt&quot;</span>] = gvListByDt.GetFocusedRowCellValue(<span class="string">&quot;rcivDtm&quot;</span>).ToString().Substring(<span class="number">0</span>, <span class="number">8</span>);              <span class="comment">// 수납일자</span></span><br><span class="line">            searchParam[<span class="string">&quot;rcivTm&quot;</span>] = gvListByDt.GetFocusedRowCellValue(<span class="string">&quot;rcivDtm&quot;</span>).ToString().Substring(<span class="number">8</span>, <span class="number">4</span>);              <span class="comment">// 수납시각</span></span><br><span class="line">            searchParam[<span class="string">&quot;irPatTypCd&quot;</span>] = (gvListByDt.GetFocusedRowCellValue(<span class="string">&quot;bldtrOrdrYn&quot;</span>).ToString() == <span class="string">&quot;Y&quot;</span>) ? <span class="string">&quot;B&quot;</span> : <span class="string">&quot;&quot;</span>;  <span class="comment">// 수혈처방 (B: BLOOD)</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">            <span class="comment">// 접수상태</span></span><br><span class="line">            <span class="keyword">if</span> (pIrWaitStatCd == <span class="string">&quot;P&quot;</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                searchParam[<span class="string">&quot;rcepTm&quot;</span>] = DateTime.Now.ToString(<span class="string">&quot;HHmmss&quot;</span>);   <span class="comment">// 접수시각</span></span><br><span class="line">                searchParam[<span class="string">&quot;waitStTm&quot;</span>] = <span class="string">&quot; &quot;</span>;                             <span class="comment">// 대기시작시각</span></span><br><span class="line">                searchParam[<span class="string">&quot;eroomTm&quot;</span>] = <span class="string">&quot; &quot;</span>;                              <span class="comment">// 입실시각</span></span><br><span class="line">                searchParam[<span class="string">&quot;pformFinshTm&quot;</span>] = <span class="string">&quot; &quot;</span>;                         <span class="comment">// 완료시각</span></span><br><span class="line">                searchParam[<span class="string">&quot;lrTm&quot;</span>] = <span class="string">&quot; &quot;</span>;                                 <span class="comment">// 퇴실시각</span></span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">            <span class="comment">// 퇴실상태</span></span><br><span class="line">            <span class="comment">//else if (pIrWaitStatCd == &quot;L&quot;)</span></span><br><span class="line">            <span class="comment">//    searchParam[&quot;lrTm&quot;] = DateTime.Now.ToString(&quot;HHmmss&quot;);     // 퇴실시각</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">            <span class="comment">// 수납별일련번호 - 동일환자의 동일수납일시인 경우는 번호가 동일함. (환자번호, 수납별일련번호로 처방을 판단함)</span></span><br><span class="line">            DataView dv = <span class="keyword">new</span> DataView(_dtList);</span><br><span class="line">            dv.RowFilter = <span class="string">&quot;patno = &#x27;&quot;</span> + gvListByDt.GetFocusedRowCellValue(<span class="string">&quot;patno&quot;</span>).ToString() + <span class="string">&quot;&#x27; and rcivBySn = &#x27;&quot;</span> + gvListByDt.GetFocusedRowCellValue(<span class="string">&quot;rcivBySn&quot;</span>).ToString() + <span class="string">&quot;&#x27;&quot;</span>;</span><br><span class="line">            dv.ToTable();</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">            AmcData requestData = <span class="keyword">new</span> AmcData &#123;</span><br><span class="line">                header = <span class="keyword">new</span> HeaderData &#123; debug = <span class="number">0</span> &#125;,</span><br><span class="line">                preDatas = <span class="keyword">new</span> PreDatas &#123; &#123; <span class="string">&quot;IPD_Request&quot;</span>, searchParam &#125; &#125;,</span><br><span class="line">                recordSets = <span class="keyword">new</span> RecordSets &#123; &#123; <span class="string">&quot;IRS_Request&quot;</span>, dv.ToTable() == <span class="literal">null</span> ? <span class="literal">null</span> : dv.ToTable().ToRecordSet() &#125; &#125;</span><br><span class="line">            &#125;;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">            <span class="keyword">try</span></span><br><span class="line">            &#123;</span><br><span class="line">                AmcData responseData = CommService.CallService(pServiceId, requestData);</span><br><span class="line">                AMessageBox.ShowInstant(<span class="keyword">this</span>, responseData.header.message);</span><br><span class="line">                <span class="keyword">if</span> (responseData != <span class="literal">null</span> &amp;&amp; responseData.IsSuccess)</span><br><span class="line">                    OnSearchAction(<span class="literal">false</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">catch</span> (Exception ex)</span><br><span class="line">            &#123;</span><br><span class="line">                AMessageBox.Show(<span class="string">&quot;&quot;</span>, ex.Message);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="meta">#<span class="meta-keyword">endregion</span> ===============================================================</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="meta">#<span class="meta-keyword">region</span> ========================== [ 이 벤 트 ] ==========================</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 조회버튼 클릭 이벤트</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span><span class="doctag">&lt;/returns&gt;</span> </span></span><br><span class="line">        <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">btnSearch_Click</span>(<span class="params"><span class="keyword">object</span> sender, EventArgs e</span>)</span></span><br><span class="line"><span class="function"></span>        &#123;</span><br><span class="line">            <span class="keyword">string</span> sMessage = <span class="keyword">string</span>.Empty;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (rdoDiv.EditValue.ToStringDefault(<span class="string">&quot;&quot;</span>) == <span class="string">&quot;PATNO&quot;</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">if</span> (<span class="keyword">string</span>.IsNullOrEmpty(txtCondPatno.Text.Trim()))</span><br><span class="line">                &#123;</span><br><span class="line">                    sMessage = <span class="keyword">string</span>.Format(MessageInfo.INPUT_RERUIRED, <span class="keyword">new</span> <span class="keyword">string</span>[] &#123; <span class="string">&quot;등록번호&quot;</span> &#125;);</span><br><span class="line">                    AMessageBox.ShowInstant(<span class="keyword">this</span>, sMessage);</span><br><span class="line">                    <span class="keyword">return</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            OnSearchAction(<span class="literal">true</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 더블클릭 이벤트</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;sender&quot;&gt;</span><span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;e&quot;&gt;</span><span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">        <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">gvListByDt_DoubleClick</span>(<span class="params"><span class="keyword">object</span> sender, EventArgs e</span>)</span></span><br><span class="line"><span class="function"></span>        &#123;</span><br><span class="line">            sendDataToPatDto();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 수행상태 라디오버튼 변경 이벤트</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;sender&quot;&gt;</span><span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;e&quot;&gt;</span><span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">        <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">rdoPformDiv_SelectedIndexChanged</span>(<span class="params"><span class="keyword">object</span> sender, EventArgs e</span>)</span></span><br><span class="line"><span class="function"></span>        &#123;</span><br><span class="line">            OnSearchAction(<span class="literal">true</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 수납구분 라디오버튼 변경 이벤트 </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;sender&quot;&gt;</span><span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;e&quot;&gt;</span><span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">        <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">rdoRcivYn_SelectedIndexChanged</span>(<span class="params"><span class="keyword">object</span> sender, EventArgs e</span>)</span></span><br><span class="line"><span class="function"></span>        &#123;</span><br><span class="line">            OnSearchAction(<span class="literal">true</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 수행장소 라디오버튼 변경 이벤트</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;sender&quot;&gt;</span><span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;e&quot;&gt;</span><span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">        <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">rdoOrdrPformLocCd_SelectedIndexChanged</span>(<span class="params"><span class="keyword">object</span> sender, EventArgs e</span>)</span></span><br><span class="line"><span class="function"></span>        &#123;</span><br><span class="line">            InitializeControls();</span><br><span class="line">            InitializeGridColumn();</span><br><span class="line">            rdoPformDiv.Visible = <span class="literal">true</span>;</span><br><span class="line">            OnSearchAction(<span class="literal">true</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 조회조건 변경 이벤트</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;sender&quot;&gt;</span><span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;e&quot;&gt;</span><span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">        <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">rdoDiv_SelectedIndexChanged</span>(<span class="params"><span class="keyword">object</span> sender, EventArgs e</span>)</span></span><br><span class="line"><span class="function"></span>        &#123;</span><br><span class="line">            <span class="keyword">if</span> (rdoDiv.EditValue.ToStringDefault(<span class="string">&quot;&quot;</span>) == <span class="string">&quot;DT&quot;</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                flwpnlPformTrgetListByPformDt.Visible = <span class="literal">true</span>;</span><br><span class="line">                flwpnlPformTrgetListByPat.Visible = <span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">                lblSubTitle.Text = <span class="string">&quot;수행일자별 수행대상 목록&quot;</span>;</span><br><span class="line">                grdList.MainView = gvListByDt;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">            &#123;</span><br><span class="line">                flwpnlPformTrgetListByPformDt.Visible = <span class="literal">false</span>;</span><br><span class="line">                flwpnlPformTrgetListByPat.Visible = <span class="literal">true</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">                lblSubTitle.Text = <span class="string">&quot;환자별 수행대상 목록&quot;</span>;</span><br><span class="line">                grdList.MainView = gvListByPat;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">            InitializeControls();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> Row 변경 시 주사실 구분에 따라 액션버튼 변경</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;sender&quot;&gt;</span><span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;e&quot;&gt;</span><span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">        <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">gvListByDt_FocusedRowChanged</span>(<span class="params"><span class="keyword">object</span> sender, DevExpress.XtraGrid.Views.Base.FocusedRowChangedEventArgs e</span>)</span></span><br><span class="line"><span class="function"></span>        &#123;</span><br><span class="line">            <span class="keyword">if</span> (_dtList != <span class="literal">null</span> &amp;&amp; gvListByDt.FocusedRowHandle &gt;= <span class="number">0</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                InitializeActionButtons();</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (_dtList != <span class="literal">null</span> &amp;&amp; _dtList.Rows.Count &gt; <span class="number">0</span> &amp;&amp; gvListByDt.FocusedRowHandle &gt;= <span class="number">0</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                patInfo.SelectedPatInfo[(<span class="keyword">int</span>)SelectedPatInfo.PATNO] = gvListByDt.GetFocusedRowCellValue(<span class="string">&quot;patno&quot;</span>).ToString();</span><br><span class="line">                patInfo.SelectedPatInfo[(<span class="keyword">int</span>)SelectedPatInfo.VIST_SN] = gvListByDt.GetFocusedRowCellValue(<span class="string">&quot;vistSn&quot;</span>).ToStringDefault(<span class="string">&quot;&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 상태별 row 배경색 변경 이벤트</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;sender&quot;&gt;</span><span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;e&quot;&gt;</span><span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">        <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">gvListByDt_RowCellStyle</span>(<span class="params"><span class="keyword">object</span> sender, DevExpress.XtraGrid.Views.Grid.RowCellStyleEventArgs e</span>)</span></span><br><span class="line"><span class="function"></span>        &#123;</span><br><span class="line">            DevExpress.XtraGrid.Views.Grid.GridView view = sender <span class="keyword">as</span> DevExpress.XtraGrid.Views.Grid.GridView;</span><br><span class="line">            <span class="keyword">string</span> strValue = view.GetRowCellValue(e.RowHandle, <span class="string">&quot;irWaitStatCd&quot;</span>).ToStringDefault(<span class="string">&quot;&quot;</span>); <span class="comment">// 주사실대기상태코드 N:준비  P:접수  W:대기  R:입실  O:완료  T:통과</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">            <span class="comment">// 직원/직원가족할인여부 </span></span><br><span class="line">            <span class="keyword">if</span> (gvListByDt.GetRowCellValue(e.RowHandle, <span class="string">&quot;empDscntYn&quot;</span>).ToStringDefault(<span class="string">&quot;&quot;</span>).Equals(<span class="string">&quot;Y&quot;</span>))</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">if</span> (e.Column.FieldName == <span class="string">&quot;patNm&quot;</span>)</span><br><span class="line">                &#123;</span><br><span class="line">                    e.Appearance.FontStyleDelta = FontStyle.Italic;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 병원등록번호 입력값 변경</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;sender&quot;&gt;</span><span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;e&quot;&gt;</span><span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">        <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">txtCondPatno_EditValueChanged</span>(<span class="params"><span class="keyword">object</span> sender, EventArgs e</span>)</span></span><br><span class="line"><span class="function"></span>        &#123;</span><br><span class="line">            <span class="keyword">if</span> (!String.IsNullOrEmpty(lblCondPatNm.Text))</span><br><span class="line">            &#123;</span><br><span class="line">                lblCondPatNm.Text = String.Empty;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (txtCondPatno.EditValue.ToString().Length == txtCondPatno.Properties.MaxLength)</span><br><span class="line">            &#123;</span><br><span class="line">                SearchPatInfo();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> Edit 되는 Colum Filtering</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;sender&quot;&gt;</span><span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;e&quot;&gt;</span><span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">        <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">gvListByDt_ShowingEditor</span>(<span class="params"><span class="keyword">object</span> sender, System.ComponentModel.CancelEventArgs e</span>)</span></span><br><span class="line"><span class="function"></span>        &#123;</span><br><span class="line">            GridView view = sender <span class="keyword">as</span> GridView;</span><br><span class="line">            <span class="keyword">if</span> (view.FocusedColumn.FieldName != <span class="string">&quot;childAntnIrStayTmc&quot;</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                e.Cancel = <span class="literal">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 셀값 변경 이벤트</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;sender&quot;&gt;</span><span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;e&quot;&gt;</span><span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">        <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">gvListByDt_CellValueChanged</span>(<span class="params"><span class="keyword">object</span> sender, DevExpress.XtraGrid.Views.Base.CellValueChangedEventArgs e</span>)</span></span><br><span class="line"><span class="function"></span>        &#123;</span><br><span class="line">            GridView view = sender <span class="keyword">as</span> GridView;</span><br><span class="line">            DataRow dr = view.GetFocusedDataRow();</span><br><span class="line">            dtSaveIrStayTmc.Clear();</span><br><span class="line">            <span class="keyword">if</span> (e.Column.FieldName == <span class="string">&quot;childAntnIrStayTmc&quot;</span>)</span><br><span class="line">            &#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">                DataRow drSaveIrStayTmc = dtSaveIrStayTmc.NewRow();</span><br><span class="line">                drSaveIrStayTmc[<span class="string">&quot;ordrNo&quot;</span>] = gvListByDt.GetFocusedRowCellValue(<span class="string">&quot;ordrPformNo&quot;</span>).ToString();</span><br><span class="line">                drSaveIrStayTmc[<span class="string">&quot;patno&quot;</span>] = gvListByDt.GetFocusedRowCellValue(<span class="string">&quot;patno&quot;</span>).ToString();</span><br><span class="line">                drSaveIrStayTmc[<span class="string">&quot;vistSn&quot;</span>] = gvListByDt.GetFocusedRowCellValue(<span class="string">&quot;vistSn&quot;</span>).ToString();</span><br><span class="line">                drSaveIrStayTmc[<span class="string">&quot;ordrDirectDt&quot;</span>] = gvListByDt.GetFocusedRowCellValue(<span class="string">&quot;irOrdrDt&quot;</span>).ToString();</span><br><span class="line">                drSaveIrStayTmc[<span class="string">&quot;childAntnIrResvDt&quot;</span>] = gvListByDt.GetFocusedRowCellValue(<span class="string">&quot;hopeDt&quot;</span>).ToString();</span><br><span class="line">                drSaveIrStayTmc[<span class="string">&quot;childAntnIrResvTm&quot;</span>] = <span class="string">&quot;&quot;</span>;</span><br><span class="line">                drSaveIrStayTmc[<span class="string">&quot;bedCd&quot;</span>] = <span class="string">&quot;&quot;</span>;</span><br><span class="line">                drSaveIrStayTmc[<span class="string">&quot;mdctLocCd&quot;</span>] = <span class="string">&quot;&quot;</span>;</span><br><span class="line">                drSaveIrStayTmc[<span class="string">&quot;childAntnIrStayTmc&quot;</span>] = gvListByDt.GetFocusedRowCellValue(<span class="string">&quot;childAntnIrStayTmc&quot;</span>).ToString();</span><br><span class="line">                drSaveIrStayTmc[<span class="string">&quot;ordrTblDstgCd&quot;</span>] = <span class="string">&quot;JUSA&quot;</span>;</span><br><span class="line">                dtSaveIrStayTmc.Rows.Add(drSaveIrStayTmc);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="meta">#<span class="meta-keyword">endregion</span> ===============================================================</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="meta">#<span class="meta-keyword">region</span> ======================== [ 스타일 이벤트 ] =======================</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 수행일자별 그리드 텍스트 변경</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;sender&quot;&gt;</span><span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;e&quot;&gt;</span><span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">        <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">gvListByDt_CustomColumnDisplayText</span>(<span class="params"><span class="keyword">object</span> sender, DevExpress.XtraGrid.Views.Base.CustomColumnDisplayTextEventArgs e</span>)</span></span><br><span class="line"><span class="function"></span>        &#123;</span><br><span class="line">            <span class="keyword">if</span> ((e.Column.FieldName == <span class="string">&quot;patBirthdt&quot;</span>) || (e.Column.FieldName == <span class="string">&quot;irOrdrDt&quot;</span>))</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">if</span> (e.Value != <span class="literal">null</span> &amp;&amp; !<span class="keyword">string</span>.IsNullOrEmpty(e.Value.ToString()))</span><br><span class="line">                &#123;</span><br><span class="line">                    e.DisplayText = <span class="keyword">string</span>.Format(<span class="string">&quot;&#123;0:yyyy-MM-dd&#125;&quot;</span>, e.Value.ToDate());</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span> (e.Column.FieldName == <span class="string">&quot;rcivDtm&quot;</span>)  <span class="comment">// 수납일자 </span></span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">if</span> (e.Value != <span class="literal">null</span> &amp;&amp; !<span class="keyword">string</span>.IsNullOrEmpty(e.Value.ToString()))</span><br><span class="line">                &#123;</span><br><span class="line">                    e.DisplayText = <span class="keyword">string</span>.Format(<span class="string">&quot;&#123;0:yyyy-MM-dd HH:mm&#125;&quot;</span>, e.Value.ToDate());</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span> (e.Column.FieldName == <span class="string">&quot;childAntnIrEroomTm&quot;</span> || e.Column.FieldName == <span class="string">&quot;childAntnIrLrTm&quot;</span> || e.Column.FieldName == <span class="string">&quot;childAntnIrStayTmc&quot;</span>)         <span class="comment">// 입실시간/ 퇴실시간</span></span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">if</span> (!<span class="keyword">string</span>.IsNullOrEmpty(e.Value.ToString()))</span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="keyword">if</span> (e.Value.ToString().Trim().Length == <span class="number">4</span>)</span><br><span class="line">                    &#123;</span><br><span class="line">                        e.DisplayText = e.Value.ToString().Insert(<span class="number">2</span>, <span class="string">&quot;:&quot;</span>);</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">else</span> <span class="keyword">if</span> (e.Value.ToString().Trim().Length == <span class="number">6</span>)</span><br><span class="line">                    &#123;</span><br><span class="line">                        e.DisplayText = e.Value.ToString().Insert(<span class="number">2</span>, <span class="string">&quot;:&quot;</span>).Insert(<span class="number">5</span>, <span class="string">&quot;:&quot;</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 환자별 그리드 텍스트 변경</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;sender&quot;&gt;</span><span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;e&quot;&gt;</span><span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">        <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">gvListByPat_CustomColumnDisplayText</span>(<span class="params"><span class="keyword">object</span> sender, DevExpress.XtraGrid.Views.Base.CustomColumnDisplayTextEventArgs e</span>)</span></span><br><span class="line"><span class="function"></span>        &#123;</span><br><span class="line">            <span class="keyword">if</span> (e.Column.FieldName == <span class="string">&quot;patBirthdt&quot;</span>)  <span class="comment">// 생년월일 </span></span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">if</span> (e.Value != <span class="literal">null</span> &amp;&amp; !<span class="keyword">string</span>.IsNullOrEmpty(e.Value.ToString()))</span><br><span class="line">                &#123;</span><br><span class="line">                    e.DisplayText = <span class="keyword">string</span>.Format(<span class="string">&quot;&#123;0:yyyy-MM-dd&#125;&quot;</span>, e.Value.ToDate());</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span> (e.Column.FieldName == <span class="string">&quot;rcivDtm&quot;</span>)  <span class="comment">// 수납일자 </span></span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">if</span> (e.Value != <span class="literal">null</span> &amp;&amp; !<span class="keyword">string</span>.IsNullOrEmpty(e.Value.ToString()))</span><br><span class="line">                &#123;</span><br><span class="line">                    e.DisplayText = <span class="keyword">string</span>.Format(<span class="string">&quot;&#123;0:yyyy-MM-dd HH:mm:ss&#125;&quot;</span>, e.Value.ToDate());</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span> (e.Column.FieldName == <span class="string">&quot;pformDt&quot;</span> || e.Column.FieldName == <span class="string">&quot;hopeDt&quot;</span>)  <span class="comment">// 수행일자 </span></span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">if</span> (e.Value != <span class="literal">null</span> &amp;&amp; !<span class="keyword">string</span>.IsNullOrEmpty(e.Value.ToString()))</span><br><span class="line">                &#123;</span><br><span class="line">                    e.DisplayText = <span class="keyword">string</span>.Format(<span class="string">&quot;&#123;0:yyyy-MM-dd&#125;&quot;</span>, e.Value.ToDate());</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 환자별 그리드 스타일 지정</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;sender&quot;&gt;</span><span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;e&quot;&gt;</span><span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">        <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">gvListByPat_RowStyle</span>(<span class="params"><span class="keyword">object</span> sender, DevExpress.XtraGrid.Views.Grid.RowStyleEventArgs e</span>)</span></span><br><span class="line"><span class="function"></span>        &#123;</span><br><span class="line">            <span class="keyword">if</span> (gvListByPat.GetRowCellValue(e.RowHandle, <span class="string">&quot;hlinOrdrYn&quot;</span>).ToStringDefault(<span class="string">&quot;&quot;</span>).Equals(<span class="string">&quot;Y&quot;</span>)) </span><br><span class="line">            &#123;</span><br><span class="line">                e.HighPriority = <span class="literal">true</span>;</span><br><span class="line">                e.Appearance.BackColor = GridColor.F9F5C5;  <span class="comment">// 행위처방여부 : 연노랑</span></span><br><span class="line">            &#125;</span><br><span class="line">            </span><br><span class="line">            <span class="keyword">if</span> (rdoOrdrPformLocCd.EditValue.ToStringDefault(<span class="string">&quot;&quot;</span>) == <span class="string">&quot;PEDIV&quot;</span>) </span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">if</span> (gvListByPat.GetRowCellValue(e.RowHandle, <span class="string">&quot;isOrdrYn&quot;</span>).ToStringDefault(<span class="string">&quot;&quot;</span>).Equals(<span class="string">&quot;Y&quot;</span>))</span><br><span class="line">                &#123;</span><br><span class="line">                    e.HighPriority = <span class="literal">true</span>;</span><br><span class="line">                    e.Appearance.BackColor = Color.Yellow; <span class="comment">// 소아-수액처방여부 : 노랑</span></span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            </span><br><span class="line">            <span class="keyword">if</span> (gvListByPat.GetRowCellValue(e.RowHandle, <span class="string">&quot;bldtrOrdrYn&quot;</span>).ToStringDefault(<span class="string">&quot;&quot;</span>).Equals(<span class="string">&quot;Y&quot;</span>))</span><br><span class="line">            &#123;</span><br><span class="line">                e.HighPriority = <span class="literal">true</span>;</span><br><span class="line">                e.Appearance.BackColor = Color.LightPink;  <span class="comment">// 수혈처방여부 : 연핑크</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 수행일자별 그리드 색상지정</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;sender&quot;&gt;</span><span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;e&quot;&gt;</span><span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">        <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">gvListByDt_RowStyle</span>(<span class="params"><span class="keyword">object</span> sender, DevExpress.XtraGrid.Views.Grid.RowStyleEventArgs e</span>)</span></span><br><span class="line"><span class="function"></span>        &#123;</span><br><span class="line">            </span><br><span class="line">            <span class="keyword">if</span>(rdoOrdrPformLocCd.EditValue.ToStringDefault(<span class="string">&quot;&quot;</span>) == <span class="string">&quot;OPIV&quot;</span>) <span class="comment">// 동관주사실은 처치가 있어야 노랑색으로 표시</span></span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">if</span>(gvListByDt.GetRowCellValue(e.RowHandle, <span class="string">&quot;irTaskCd&quot;</span>).ToStringDefault(<span class="string">&quot;&quot;</span>).Equals(<span class="string">&quot;C&quot;</span>))</span><br><span class="line">                &#123;</span><br><span class="line">                    e.HighPriority = <span class="literal">true</span>;</span><br><span class="line">                    e.Appearance.BackColor = GridColor.F9F5C5; <span class="comment">// 처치 : 연노랑</span></span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">if</span> (gvListByDt.GetRowCellValue(e.RowHandle, <span class="string">&quot;hlinOrdrYn&quot;</span>).ToStringDefault(<span class="string">&quot;&quot;</span>).Equals(<span class="string">&quot;Y&quot;</span>) || gvListByDt.GetRowCellValue(e.RowHandle, <span class="string">&quot;irTaskCd&quot;</span>).ToStringDefault(<span class="string">&quot;&quot;</span>).Equals(<span class="string">&quot;C&quot;</span>))</span><br><span class="line">                &#123;</span><br><span class="line">                    e.HighPriority = <span class="literal">true</span>;</span><br><span class="line">                    e.Appearance.BackColor = GridColor.F9F5C5; <span class="comment">// 행위처방 or 처치 : 연노랑</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">                    <span class="keyword">string</span> sPatno = gvListByDt.GetRowCellValue(e.RowHandle, <span class="string">&quot;patno&quot;</span>).ToStringDefault(<span class="string">&quot;&quot;</span>);</span><br><span class="line">                    <span class="keyword">string</span> sVistSn = gvListByDt.GetRowCellValue(e.RowHandle, <span class="string">&quot;vistSn&quot;</span>).ToStringDefault(<span class="string">&quot;&quot;</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">                    <span class="comment">// 소아항암 주사실의 예외</span></span><br><span class="line">                    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; _dtList.Rows.Count; i++)</span><br><span class="line">                    &#123;</span><br><span class="line">                        <span class="keyword">if</span> (_dtList.Rows[i][<span class="string">&quot;ordrPformLocCd&quot;</span>].ToString() == <span class="string">&quot;PIVC&quot;</span>)</span><br><span class="line">                        &#123;</span><br><span class="line">                            <span class="keyword">if</span> (_dtList.Rows[i][<span class="string">&quot;patno&quot;</span>].ToString() == sPatno &amp;&amp; _dtList.Rows[i][<span class="string">&quot;vistSn&quot;</span>].ToString() == sVistSn)</span><br><span class="line">                            &#123;</span><br><span class="line">                                <span class="keyword">if</span> (_dtList.Rows[i][<span class="string">&quot;irTaskCd&quot;</span>].ToString() != <span class="string">&quot;C&quot;</span>)</span><br><span class="line">                                &#123;</span><br><span class="line">                                    <span class="keyword">if</span> (_dtList.Rows[i][<span class="string">&quot;irTaskCdTemp&quot;</span>].ToString() != <span class="string">&quot;C&quot;</span>)</span><br><span class="line">                                    &#123;</span><br><span class="line">                                        e.HighPriority = <span class="literal">true</span>;</span><br><span class="line">                                        e.Appearance.BackColor = GridColor.FFFFFF;  <span class="comment">// 행위처방+주사가 함께 있으면 색상표시하지 않음.</span></span><br><span class="line">                                    &#125;</span><br><span class="line">                                &#125;</span><br><span class="line">                            &#125;</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">            <span class="comment">// 소아주사실-수액처방여부</span></span><br><span class="line">            <span class="keyword">if</span> (rdoOrdrPformLocCd.EditValue.ToStringDefault(<span class="string">&quot;&quot;</span>) == <span class="string">&quot;PEDIV&quot;</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">if</span> (gvListByDt.GetRowCellValue(e.RowHandle, <span class="string">&quot;isOrdrYn&quot;</span>).ToStringDefault(<span class="string">&quot;&quot;</span>).Equals(<span class="string">&quot;Y&quot;</span>))</span><br><span class="line">                &#123;</span><br><span class="line">                    e.HighPriority = <span class="literal">true</span>;</span><br><span class="line">                    e.Appearance.BackColor = Color.Yellow;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">            <span class="comment">// 수혈처방여부</span></span><br><span class="line">            <span class="keyword">if</span> (gvListByDt.GetRowCellValue(e.RowHandle, <span class="string">&quot;bldtrOrdrYn&quot;</span>).ToStringDefault(<span class="string">&quot;&quot;</span>).Equals(<span class="string">&quot;Y&quot;</span>))</span><br><span class="line">            &#123;</span><br><span class="line">                e.HighPriority = <span class="literal">true</span>;</span><br><span class="line">                e.Appearance.BackColor = Color.LightPink;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">            <span class="comment">// 소아항암주사실-입실시각/퇴실시각 작성여부</span></span><br><span class="line">            <span class="keyword">if</span> (rdoOrdrPformLocCd.EditValue.ToStringDefault(<span class="string">&quot;&quot;</span>) == <span class="string">&quot;PIVC&quot;</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">if</span> (gvListByDt.GetRowCellValue(e.RowHandle, <span class="string">&quot;childAntnIrEroomTm&quot;</span>) != <span class="literal">null</span> &amp;&amp; gvListByDt.GetRowCellValue(e.RowHandle, <span class="string">&quot;childAntnIrEroomTm&quot;</span>).ToString().Trim() != <span class="string">&quot;&quot;</span></span><br><span class="line">                &amp;&amp; gvListByDt.GetRowCellValue(e.RowHandle, <span class="string">&quot;childAntnIrLrTm&quot;</span>) != <span class="literal">null</span> &amp;&amp; gvListByDt.GetRowCellValue(e.RowHandle, <span class="string">&quot;childAntnIrLrTm&quot;</span>).ToString().Trim() != <span class="string">&quot;&quot;</span>) <span class="comment">//CHILD_ANTN_IR_EROOM_TM, CHILD_ANTN_IR_LR_TM</span></span><br><span class="line">                &#123;</span><br><span class="line">                    e.HighPriority = <span class="literal">true</span>;</span><br><span class="line">                    e.Appearance.BackColor = GridColor.C7E7F4; <span class="comment">// 연파랑</span></span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 환자별 그리드 스타일 지정</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;sender&quot;&gt;</span><span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;e&quot;&gt;</span><span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">        <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">gvListByPat_RowCellStyle</span>(<span class="params"><span class="keyword">object</span> sender, DevExpress.XtraGrid.Views.Grid.RowCellStyleEventArgs e</span>)</span></span><br><span class="line"><span class="function"></span>        &#123;</span><br><span class="line">            DevExpress.XtraGrid.Views.Grid.GridView view = sender <span class="keyword">as</span> DevExpress.XtraGrid.Views.Grid.GridView;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">            <span class="comment">// 직원/직원가족할인여부 </span></span><br><span class="line">            <span class="keyword">if</span> (gvListByPat.GetRowCellValue(e.RowHandle, <span class="string">&quot;empDscntYn&quot;</span>).ToStringDefault(<span class="string">&quot;&quot;</span>).Equals(<span class="string">&quot;Y&quot;</span>))</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">if</span> (e.Column.FieldName == <span class="string">&quot;patNm&quot;</span>)</span><br><span class="line">                &#123;</span><br><span class="line">                    e.Appearance.FontStyleDelta = FontStyle.Italic;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 수행일자별 그리드 이미지 지정</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;sender&quot;&gt;</span><span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;e&quot;&gt;</span><span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">        <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">gvListByDt_CustomDrawCell</span>(<span class="params"><span class="keyword">object</span> sender, DevExpress.XtraGrid.Views.Base.RowCellCustomDrawEventArgs e</span>)</span></span><br><span class="line"><span class="function"></span>        &#123;</span><br><span class="line">            <span class="keyword">if</span> (e.Column.FieldName == <span class="string">&quot;fldwRegYn&quot;</span>)  <span class="comment">// 낙상</span></span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">if</span> (gvListByDt.GetRowCellValue(e.RowHandle, <span class="string">&quot;fldwRegYn&quot;</span>).ToString() == <span class="string">&quot;Y&quot;</span>)</span><br><span class="line">                &#123;</span><br><span class="line">                    e.Graphics.DrawImage(Properties.Resources.낙상, <span class="keyword">new</span> Rectangle(e.Bounds.X, e.Bounds.Y, <span class="number">17</span>, <span class="number">16</span>));</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (e.Column.FieldName == <span class="string">&quot;patNm&quot;</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">if</span> (gvListByDt.GetRowCellValue(e.RowHandle, <span class="string">&quot;pwsnYn&quot;</span>).ToString() == <span class="string">&quot;Y&quot;</span>) <span class="comment">// 동명이인 Y</span></span><br><span class="line">                &#123;</span><br><span class="line">                    e.Appearance.BackColor = Color.HotPink;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 환자별 그리드 이미지 지정</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;sender&quot;&gt;</span><span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;e&quot;&gt;</span><span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">        <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">gvListByPat_CustomDrawCell</span>(<span class="params"><span class="keyword">object</span> sender, DevExpress.XtraGrid.Views.Base.RowCellCustomDrawEventArgs e</span>)</span></span><br><span class="line"><span class="function"></span>        &#123;</span><br><span class="line">            <span class="keyword">if</span> (e.Column.FieldName == <span class="string">&quot;fldwRegYn&quot;</span>)  <span class="comment">// 낙상</span></span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">if</span> (gvListByPat.GetRowCellValue(e.RowHandle, <span class="string">&quot;fldwRegYn&quot;</span>).ToString() == <span class="string">&quot;Y&quot;</span>)</span><br><span class="line">                &#123;</span><br><span class="line">                    e.Graphics.DrawImage(Properties.Resources.낙상, <span class="keyword">new</span> Rectangle(e.Bounds.X, e.Bounds.Y, <span class="number">17</span>, <span class="number">16</span>));</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="meta">#<span class="meta-keyword">endregion</span> ===============================================================</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="meta">#<span class="meta-keyword">region</span> =========================== [ 기  타 ] ===========================</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 환자정보조회</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">SearchPatInfo</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>        &#123;</span><br><span class="line">            lblCondPatNm.Text = String.Empty;</span><br><span class="line">            InitializeControls();</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">            PreData searchParam = <span class="keyword">new</span> PreData();</span><br><span class="line">            searchParam[<span class="string">&quot;patno&quot;</span>] = txtCondPatno.Text.Trim();</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">            AmcData requestData = <span class="keyword">new</span> AmcData</span><br><span class="line">            &#123;</span><br><span class="line">                header = <span class="keyword">new</span> HeaderData &#123; debug = <span class="number">0</span> &#125;,</span><br><span class="line">                preDatas = <span class="keyword">new</span> PreDatas &#123; &#123; <span class="string">&quot;IPD_Request&quot;</span>, searchParam &#125; &#125;</span><br><span class="line">            &#125;;</span><br><span class="line">            AmcData responseData = CommService.CallService(<span class="string">&quot;SMCNR9013R&quot;</span>, requestData);</span><br><span class="line">            DataTable dt = responseData.recordSets[<span class="string">&quot;ORS_PatInfoList&quot;</span>].ToDataTable();</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (dt.Rows.Count &gt; <span class="number">0</span> &amp;&amp; responseData.IsSuccess)</span><br><span class="line">            &#123;</span><br><span class="line">                lblCondPatNm.Text = dt.Rows[<span class="number">0</span>][<span class="string">&quot;patNm&quot;</span>].ToString();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 환자상세 연동</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">sendDataToPatDto</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>        &#123;</span><br><span class="line">            DataRow row = <span class="keyword">this</span>.gvListByDt.GetFocusedDataRow();</span><br><span class="line">            <span class="keyword">if</span> (row == <span class="literal">null</span>) <span class="keyword">return</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">            AMIS3.UIFramework.DataModel.PatientVO patientVO = <span class="keyword">new</span> AMIS3.UIFramework.DataModel.PatientVO();</span><br><span class="line">            patientVO.patno = row[<span class="string">&quot;patNo&quot;</span>].ToString();   <span class="comment">// 필수</span></span><br><span class="line">            patientVO.vistSn = <span class="keyword">long</span>.Parse(row[<span class="string">&quot;vistSn&quot;</span>].ToString());</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">            <span class="keyword">base</span>.RequestChangePatientInfo(row[<span class="string">&quot;patNo&quot;</span>].ToString(), <span class="keyword">long</span>.Parse(row[<span class="string">&quot;vistSn&quot;</span>].ToString()), patientVO);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 동관주사실 코드관리</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">OnOpenVMCNRAM017S</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>        &#123;</span><br><span class="line">            Dictionary&lt;<span class="keyword">string</span>, <span class="keyword">string</span>&gt; paramDic = <span class="keyword">new</span> Dictionary&lt;<span class="keyword">string</span>, <span class="keyword">string</span>&gt;();</span><br><span class="line">            paramDic.Add(<span class="string">&quot;nursAtenTaskNm&quot;</span>, <span class="string">&quot;주사실 처방코드&quot;</span>);</span><br><span class="line">            paramDic.Add(<span class="string">&quot;nursAtenTaskCd&quot;</span>, <span class="string">&quot;IRTASKCD&quot;</span>);</span><br><span class="line">            paramDic.Add(<span class="string">&quot;nursAtenClsfCd&quot;</span>, <span class="string">&quot;O&quot;</span>);</span><br><span class="line">            paramDic.Add(<span class="string">&quot;cdDiv&quot;</span>, <span class="string">&quot;L&quot;</span>);</span><br><span class="line">            paramDic.Add(<span class="string">&quot;guMinCd&quot;</span>, <span class="string">&quot;10601&quot;</span>);</span><br><span class="line">            paramDic.Add(<span class="string">&quot;handle&quot;</span>, <span class="string">&quot;N&quot;</span>);</span><br><span class="line">            DocumentService.ShowDialogPopup(<span class="string">&quot;AMIS3.MC.NR.AM017.dll&quot;</span>, <span class="string">&quot;VMCNRAM017S&quot;</span>, Point.Empty, paramDic.ToJson());</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="meta">#<span class="meta-keyword">endregion</span> ===============================================================</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="meta">#<span class="meta-keyword">region</span> ========================== [ 단 축 키 ] ==========================</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 조회 Ctrl+R</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="function"><span class="keyword">protected</span> <span class="keyword">override</span> <span class="keyword">void</span> <span class="title">RefreshMethod</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>        &#123;</span><br><span class="line">            btnSearch_Click(<span class="literal">null</span>, <span class="literal">null</span>);</span><br><span class="line">            <span class="keyword">base</span>.RefreshMethod();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="meta">#<span class="meta-keyword">endregion</span> ===============================================================</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="meta">#<span class="meta-keyword">region</span> ========================== [ 미 사 용 ] ==========================</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 미사용 함수</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;aPatno&quot;&gt;</span><span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;aVisitSn&quot;&gt;</span><span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;patientVO&quot;&gt;</span><span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">override</span> <span class="keyword">void</span> <span class="title">OnChangePatientInfo</span>(<span class="params"><span class="keyword">string</span> aPatno, <span class="keyword">long</span> aVisitSn, PatientVO patientVO</span>)</span></span><br><span class="line"><span class="function"></span>        &#123;</span><br><span class="line">            patInfo.SelectedPatInfo[(<span class="keyword">int</span>)SelectedPatInfo.PATNO] = aPatno;                               <span class="comment">//병원등록번호</span></span><br><span class="line">            patInfo.SelectedPatInfo[(<span class="keyword">int</span>)SelectedPatInfo.VIST_SN] = Convert.ToString(aVisitSn);         <span class="comment">//내원일련번호</span></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="meta">#<span class="meta-keyword">endregion</span></span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<hr>
<h2 id="Server"><a href="#Server" class="headerlink" title="Server"></a>Server</h2><h3 id="Controller"><a href="#Controller" class="headerlink" title="Controller"></a>Controller</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">package</span> kr.amc.amis.mc.nr.pm.rest;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Controller;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RequestBody;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RequestMapping;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.ResponseBody;</span><br><span class="line"><span class="keyword">import</span> kr.amc.amil.amcmessage.AMCData;</span><br><span class="line"><span class="keyword">import</span> kr.amc.amil.amcmessage.AMCDataFactory;</span><br><span class="line"><span class="keyword">import</span> kr.amc.amil.amcmessage.annotation.PreDataParam;</span><br><span class="line"><span class="keyword">import</span> kr.amc.amil.amcmessage.annotation.RecordSetParam;</span><br><span class="line"><span class="keyword">import</span> kr.amc.amis.mc.nr.pm.entity.FtrOrdrResvInfoInqryDTO;</span><br><span class="line"><span class="keyword">import</span> kr.amc.amis.mc.nr.pm.entity.FtrOrdrResvInfoTO;</span><br><span class="line"><span class="keyword">import</span> kr.amc.amis.mc.nr.pm.entity.IrACIPformTrgetListByPatDTO;</span><br><span class="line"><span class="keyword">import</span> kr.amc.amis.mc.nr.pm.entity.IrACIPformTrgetListByPformDtDTO;</span><br><span class="line"><span class="keyword">import</span> kr.amc.amis.mc.nr.pm.entity.IrPformTrgetListByPatDTO;</span><br><span class="line"><span class="keyword">import</span> kr.amc.amis.mc.nr.pm.entity.IrPformTrgetListByPformDtDTO;</span><br><span class="line"><span class="keyword">import</span> kr.amc.amis.mc.nr.pm.entity.ResvDtlInfoDTO;</span><br><span class="line"><span class="keyword">import</span> kr.amc.amis.mc.nr.pm.entity.ToDlineInfoDTO;</span><br><span class="line"><span class="keyword">import</span> kr.amc.amis.mc.nr.pm.service.IrPtmnProcService;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@Controller</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">IrPtmnController</span> </span>&#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    IrPtmnProcService irPtmnProcService;</span><br><span class="line">   </span><br><span class="line">    <span class="meta">@RequestMapping(&quot;SMCNR4313R&quot;)</span></span><br><span class="line">    <span class="meta">@ResponseBody</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> AMCData <span class="title">retrievePformTrgetListByPformDt</span><span class="params">(<span class="meta">@RequestBody</span> AMCData amcData, <span class="meta">@PreDataParam(&quot;IPD_Request&quot;)</span> IrPformTrgetListByPformDtDTO irPformTrgetListByPformDtDTO)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        <span class="comment">// 외래주사실 수행일자별 수행대상 목록</span></span><br><span class="line">        List&lt;IrPformTrgetListByPformDtDTO&gt; lstResult = irPtmnProcService.retrievePformTrgetListByPformDt(irPformTrgetListByPformDtDTO);</span><br><span class="line">        AMCData resData = AMCDataFactory.createForResponse();</span><br><span class="line">        resData.putRecordSet(<span class="string">&quot;ORS_IrPat&quot;</span>, lstResult);</span><br><span class="line">        <span class="keyword">return</span> resData;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="meta">@RequestMapping(&quot;SMCNR4314R&quot;)</span></span><br><span class="line">    <span class="meta">@ResponseBody</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> AMCData <span class="title">retrievePformTrgetListByPat</span><span class="params">(<span class="meta">@RequestBody</span> AMCData amcData, <span class="meta">@PreDataParam(&quot;IPD_Request&quot;)</span> IrPformTrgetListByPatDTO irPformTrgetListByPatDTO)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        <span class="comment">// 외래주사실 환자별 수행대상 목록</span></span><br><span class="line">        List&lt;IrPformTrgetListByPatDTO&gt; lstResult = irPtmnProcService.retrievePformTrgetListByPat(irPformTrgetListByPatDTO);</span><br><span class="line">        AMCData resData = AMCDataFactory.createForResponse();</span><br><span class="line">        resData.putRecordSet(<span class="string">&quot;ORS_IrPat&quot;</span>, lstResult);</span><br><span class="line">        <span class="keyword">return</span> resData;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@RequestMapping(&quot;SMCNR4317R&quot;)</span></span><br><span class="line">    <span class="meta">@ResponseBody</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> AMCData <span class="title">retrievePformTrgetListForPwsn</span><span class="params">(<span class="meta">@RequestBody</span> AMCData amcData, <span class="meta">@PreDataParam(&quot;IPD_Request&quot;)</span> IrPformTrgetListByPformDtDTO irPformTrgetListByPformDtDTO)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        <span class="comment">// 외래주사실 수행일자별 수행대상 목록</span></span><br><span class="line">        List&lt;IrPformTrgetListByPformDtDTO&gt; lstResult = irPtmnProcService.retrievePformTrgetListForPwsn(irPformTrgetListByPformDtDTO);</span><br><span class="line">        AMCData resData = AMCDataFactory.createForResponse();</span><br><span class="line">        resData.putRecordSet(<span class="string">&quot;ORS_IrPat&quot;</span>, lstResult);</span><br><span class="line">        <span class="keyword">return</span> resData;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="meta">@RequestMapping(&quot;SMCNR4318U&quot;)</span></span><br><span class="line">    <span class="meta">@ResponseBody</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> AMCData <span class="title">saveDoctCall</span><span class="params">(<span class="meta">@RequestBody</span> AMCData amcData, <span class="meta">@PreDataParam(&quot;IPD_Request&quot;)</span> IrPformTrgetListByPformDtDTO param)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        <span class="comment">// 검사예약일자 조회하여 주사실희망일자 변경</span></span><br><span class="line">        irPtmnProcService.updateHopeDtFromExamResvDt(param);</span><br><span class="line">        <span class="comment">// 주사실처방전 출력 정보 Insert</span></span><br><span class="line">        irPtmnProcService.registerInjOrdrRptInfo(param);</span><br><span class="line">        AMCData resData = AMCDataFactory.createForResponse();</span><br><span class="line">        <span class="keyword">return</span> resData;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


<h3 id="Service"><a href="#Service" class="headerlink" title="Service"></a>Service</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@desc</span> 주사실환자관리PC 클래스에 대한 기능과 용도를 기술한다.</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> 남상원</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@version</span> 1.0, 2016/07/12</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@see</span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">package</span> kr.amc.amis.mc.nr.pm.service;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.lang.StringUtils;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Service;</span><br><span class="line"><span class="keyword">import</span> org.springframework.transaction.annotation.Transactional;</span><br><span class="line"><span class="keyword">import</span> kr.amc.amil.context.ContextUtil;</span><br><span class="line"><span class="keyword">import</span> kr.amc.amil.context.MessageUtil;</span><br><span class="line"><span class="keyword">import</span> kr.amc.amil.exception.AMISBizException;</span><br><span class="line"><span class="keyword">import</span> kr.amc.amil.utils.data.DTOUtil;</span><br><span class="line"><span class="keyword">import</span> kr.amc.amis.mc.nr.da.entity.PformTrgetOrdrSmryBasicDTO;</span><br><span class="line"><span class="keyword">import</span> kr.amc.amis.mc.nr.pm.entity.FtrOrdrResvInfoInqryDTO;</span><br><span class="line"><span class="keyword">import</span> kr.amc.amis.mc.nr.pm.entity.FtrOrdrResvInfoTO;</span><br><span class="line"><span class="keyword">import</span> kr.amc.amis.mc.nr.pm.entity.IrACIPformTrgetListByPatDTO;</span><br><span class="line"><span class="keyword">import</span> kr.amc.amis.mc.nr.pm.entity.IrACIPformTrgetListByPformDtDTO;</span><br><span class="line"><span class="keyword">import</span> kr.amc.amis.mc.nr.pm.entity.IrPformTrgetListByPatDTO;</span><br><span class="line"><span class="keyword">import</span> kr.amc.amis.mc.nr.pm.entity.IrPformTrgetListByPformDtDTO;</span><br><span class="line"><span class="keyword">import</span> kr.amc.amis.mc.nr.pm.entity.ResvDtlInfoDTO;</span><br><span class="line"><span class="keyword">import</span> kr.amc.amis.mc.nr.pm.entity.ToDlineInfoDTO;</span><br><span class="line"><span class="keyword">import</span> kr.amc.amis.mc.nr.pm.store.mapper.FtrOrdrPrtcolInfoEMapper;</span><br><span class="line"><span class="keyword">import</span> kr.amc.amis.mc.nr.pm.store.mapper.IrPatInfoMapper;</span><br><span class="line"><span class="keyword">import</span> kr.amc.amis.mc.nr.pm.store.mapper.McNrPmCirPtmnBasicMapper;</span><br><span class="line"><span class="keyword">import</span> kr.amc.amis.mc.nr.da.store.mapper.PformTrgetOrdrSmryBasicMapper;</span><br><span class="line"><span class="keyword">import</span> kr.amc.amis.wa.wm.ext.proxy.WmProxy;</span><br><span class="line"><span class="keyword">import</span> kr.amc.amis.wa.wm.ext.spec.WaWmOrExtService;</span><br><span class="line"><span class="keyword">import</span> kr.amc.amis.wa.wm.ext.spec.sdo.zz.WaWmExtOutTO;</span><br><span class="line"><span class="keyword">import</span> kr.amc.amis.wa.wm.share.entity.zz.WaWmExtInTO;</span><br><span class="line"><span class="keyword">import</span> kr.amc.amis.mc.nr.pm.service.CirPtmnProcService;</span><br><span class="line"><span class="keyword">import</span> kr.amc.amis.mc.nr.pm.entity.CirPtnmDTO;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">IrPtmnProcService</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    IrPatInfoMapper irPatInfoMapper;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="meta">@Transactional(rollbackFor = Exception.class)</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> List&lt;IrPformTrgetListByPformDtDTO&gt; <span class="title">retrievePformTrgetListByPformDt</span><span class="params">(</span></span></span><br><span class="line"><span class="function"><span class="params">            IrPformTrgetListByPformDtDTO irPformTrgetListByPformDtDTO)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="comment">// 외래주사실 수행일자별 수행대상 목록 조회</span></span><br><span class="line">        List&lt;IrPformTrgetListByPformDtDTO&gt; lstResult = irPatInfoMapper</span><br><span class="line">                .retrievePformTrgetListByPformDt(irPformTrgetListByPformDtDTO);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        MessageUtil.success(<span class="string">&quot;MC_NR_PM.success.retrievePformTrgetListByPformDt&quot;</span>,</span><br><span class="line">                <span class="keyword">new</span> String[] &#123; String.valueOf(lstResult.size()) &#125;);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> lstResult;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="meta">@Transactional(rollbackFor = Exception.class)</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> List&lt;IrPformTrgetListByPatDTO&gt; <span class="title">retrievePformTrgetListByPat</span><span class="params">(IrPformTrgetListByPatDTO irPformTrgetListByPatDTO)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="comment">// 외래주사실 환자별 수행대상 목록 조회</span></span><br><span class="line">        List&lt;IrPformTrgetListByPatDTO&gt; lstResult = irPatInfoMapper.retrievePformTrgetListByPat(irPformTrgetListByPatDTO);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        MessageUtil.success(<span class="string">&quot;MC_NR_PM.success.retrievePformTrgetListByPformDt&quot;</span>,</span><br><span class="line">                <span class="keyword">new</span> String[] &#123; String.valueOf(lstResult.size()) &#125;);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> lstResult;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="meta">@Transactional(rollbackFor = Exception.class)</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> List&lt;IrPformTrgetListByPformDtDTO&gt; <span class="title">retrievePformTrgetListForPwsn</span><span class="params">(</span></span></span><br><span class="line"><span class="function"><span class="params">            IrPformTrgetListByPformDtDTO irPformTrgetListByPformDtDTO)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="comment">// 외래주사실 수행일자별 수행대상 목록 조회</span></span><br><span class="line">        List&lt;IrPformTrgetListByPformDtDTO&gt; lstResult = irPatInfoMapper</span><br><span class="line">                .retrievePformTrgetListForPwsn(irPformTrgetListByPformDtDTO);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        MessageUtil.success(<span class="string">&quot;MC_NR_PM.success.retrievePformTrgetListByLeaveARoom&quot;</span>,</span><br><span class="line">                <span class="keyword">new</span> String[] &#123; String.valueOf(lstResult.size()) &#125;);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> lstResult;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 검사예약일자 조회하여 주사실희망일자 업데이트 </span></span><br><span class="line"><span class="comment">     **/</span></span><br><span class="line">    <span class="meta">@Transactional(rollbackFor = Exception.class)</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">updateHopeDtFromExamResvDt</span><span class="params">(IrPformTrgetListByPformDtDTO param)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="keyword">int</span> succeeded = <span class="number">0</span>;        </span><br><span class="line">        List&lt;IrPformTrgetListByPformDtDTO&gt; params = irPatInfoMapper.retrieveExamResvDtForPformHopeDtUpdate(param);</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span>(params != <span class="keyword">null</span> &amp;&amp; params.size() &gt; <span class="number">0</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">for</span>(IrPformTrgetListByPformDtDTO DTO : params) </span><br><span class="line">            &#123;</span><br><span class="line">                PformTrgetOrdrSmryBasicDTO pformTrgetOrdrSmryBasicDTO = <span class="keyword">new</span> PformTrgetOrdrSmryBasicDTO();</span><br><span class="line">                pformTrgetOrdrSmryBasicDTO.setOrdrPformNo(DTO.getOrdrPformNo());</span><br><span class="line">                pformTrgetOrdrSmryBasicDTO.setHopeDt(DTO.getHopeDt());</span><br><span class="line">                pformTrgetOrdrSmryBasicDTO.setFinlUpidEmpno(ContextUtil.getUserId());</span><br><span class="line">                succeeded += pformTrgetOrdrSmryBasicMapper.updatePformTrgetOrdrHopeDt(pformTrgetOrdrSmryBasicDTO);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        MessageUtil.success(<span class="string">&quot;MC_NR_PM.success.updateHopeDtFromExamResvDt&quot;</span>, <span class="keyword">new</span> String[] &#123; String.valueOf(succeeded) &#125;);        </span><br><span class="line">        <span class="keyword">return</span> succeeded;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


<h3 id="Mapper"><a href="#Mapper" class="headerlink" title="Mapper"></a>Mapper</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">package</span> kr.amc.amis.mc.nr.pm.store.mapper;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.annotations.Mapper;</span><br><span class="line"><span class="keyword">import</span> kr.amc.amis.mc.nr.pm.entity.IrACIPformTrgetListByPatDTO;</span><br><span class="line"><span class="keyword">import</span> kr.amc.amis.mc.nr.pm.entity.IrACIPformTrgetListByPformDtDTO;</span><br><span class="line"><span class="keyword">import</span> kr.amc.amis.mc.nr.pm.entity.IrPformTrgetListByPatDTO;</span><br><span class="line"><span class="keyword">import</span> kr.amc.amis.mc.nr.pm.entity.IrPformTrgetListByPformDtDTO;</span><br><span class="line"><span class="keyword">import</span> kr.amc.amis.mc.nr.pm.entity.RemicDtlResvInfoDTO;</span><br><span class="line"><span class="keyword">import</span> kr.amc.amis.mc.nr.pm.entity.RemicDtlResvInqryDTO;</span><br><span class="line"><span class="keyword">import</span> kr.amc.amis.mc.nr.pm.entity.RemicInjtPformTmDTO;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@Mapper</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">IrPatInfoMapper</span> </span>&#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">// 외래주사실 수행일자별 수행대상 목록 조회</span></span><br><span class="line">    <span class="function">List&lt;IrPformTrgetListByPformDtDTO&gt; <span class="title">retrievePformTrgetListByPformDt</span><span class="params">(IrPformTrgetListByPformDtDTO remicDtlResvInqryDTO)</span></span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">// 외래주사실 환자별 수행대상 목록조회</span></span><br><span class="line">    <span class="function">List&lt;IrPformTrgetListByPatDTO&gt; <span class="title">retrievePformTrgetListByPat</span><span class="params">(IrPformTrgetListByPatDTO irPformTrgetListByPatDTO)</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 동명이인 조회</span></span><br><span class="line">    <span class="function">List&lt;IrPformTrgetListByPformDtDTO&gt; <span class="title">retrievePformTrgetListForPwsn</span><span class="params">(IrPformTrgetListByPformDtDTO irPformTrgetListByPformDtDTO)</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="function">List&lt;IrPformTrgetListByPformDtDTO&gt; <span class="title">retrieveExamResvDtForPformHopeDtUpdate</span><span class="params">(IrPformTrgetListByPformDtDTO param)</span></span>;</span><br><span class="line">    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


<h3 id="Mapper-xml-SQL"><a href="#Mapper-xml-SQL" class="headerlink" title="Mapper.xml (SQL)"></a>Mapper.xml (SQL)</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br><span class="line">441</span><br><span class="line">442</span><br><span class="line">443</span><br><span class="line">444</span><br><span class="line">445</span><br><span class="line">446</span><br><span class="line">447</span><br><span class="line">448</span><br><span class="line">449</span><br><span class="line">450</span><br><span class="line">451</span><br><span class="line">452</span><br><span class="line">453</span><br><span class="line">454</span><br><span class="line">455</span><br><span class="line">456</span><br><span class="line">457</span><br><span class="line">458</span><br><span class="line">459</span><br><span class="line">460</span><br><span class="line">461</span><br><span class="line">462</span><br><span class="line">463</span><br><span class="line">464</span><br><span class="line">465</span><br><span class="line">466</span><br><span class="line">467</span><br><span class="line">468</span><br><span class="line">469</span><br><span class="line">470</span><br><span class="line">471</span><br><span class="line">472</span><br><span class="line">473</span><br><span class="line">474</span><br><span class="line">475</span><br><span class="line">476</span><br><span class="line">477</span><br><span class="line">478</span><br><span class="line">479</span><br><span class="line">480</span><br><span class="line">481</span><br><span class="line">482</span><br><span class="line">483</span><br><span class="line">484</span><br><span class="line">485</span><br><span class="line">486</span><br><span class="line">487</span><br><span class="line">488</span><br><span class="line">489</span><br><span class="line">490</span><br><span class="line">491</span><br><span class="line">492</span><br><span class="line">493</span><br><span class="line">494</span><br><span class="line">495</span><br><span class="line">496</span><br><span class="line">497</span><br><span class="line">498</span><br><span class="line">499</span><br><span class="line">500</span><br><span class="line">501</span><br><span class="line">502</span><br><span class="line">503</span><br><span class="line">504</span><br><span class="line">505</span><br><span class="line">506</span><br><span class="line">507</span><br><span class="line">508</span><br><span class="line">509</span><br><span class="line">510</span><br><span class="line">511</span><br><span class="line">512</span><br><span class="line">513</span><br><span class="line">514</span><br><span class="line">515</span><br><span class="line">516</span><br><span class="line">517</span><br><span class="line">518</span><br><span class="line">519</span><br><span class="line">520</span><br><span class="line">521</span><br><span class="line">522</span><br><span class="line">523</span><br><span class="line">524</span><br><span class="line">525</span><br><span class="line">526</span><br><span class="line">527</span><br><span class="line">528</span><br><span class="line">529</span><br><span class="line">530</span><br><span class="line">531</span><br><span class="line">532</span><br><span class="line">533</span><br><span class="line">534</span><br><span class="line">535</span><br><span class="line">536</span><br><span class="line">537</span><br><span class="line">538</span><br><span class="line">539</span><br><span class="line">540</span><br><span class="line">541</span><br><span class="line">542</span><br><span class="line">543</span><br><span class="line">544</span><br><span class="line">545</span><br><span class="line">546</span><br><span class="line">547</span><br><span class="line">548</span><br><span class="line">549</span><br><span class="line">550</span><br><span class="line">551</span><br><span class="line">552</span><br><span class="line">553</span><br><span class="line">554</span><br><span class="line">555</span><br><span class="line">556</span><br><span class="line">557</span><br><span class="line">558</span><br><span class="line">559</span><br><span class="line">560</span><br><span class="line">561</span><br><span class="line">562</span><br><span class="line">563</span><br><span class="line">564</span><br><span class="line">565</span><br><span class="line">566</span><br><span class="line">567</span><br><span class="line">568</span><br><span class="line">569</span><br><span class="line">570</span><br><span class="line">571</span><br><span class="line">572</span><br><span class="line">573</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span><br><span class="line">&lt;!DOCTYPE mapper PUBLIC &quot;-//mybatis.org//DTD Mapper 3.0//EN&quot; &quot;http://mybatis.org/dtd/mybatis-3-mapper.dtd&quot;&gt;</span><br><span class="line">&lt;mapper namespace=&quot;kr.amc.amis.mc.nr.pm.store.mapper.IrPatInfoMapper&quot;&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    &lt;!-- 외래주사실 수행일자별 수행대상 목록 조회 --&gt;</span><br><span class="line">    &lt;select id=&quot;retrievePformTrgetListByPformDt&quot; parameterType=&quot;kr.amc.amis.mc.nr.pm.entity.IrPformTrgetListByPformDtDTO&quot; resultType=&quot;kr.amc.amis.mc.nr.pm.entity.IrPformTrgetListByPformDtDTO&quot;&gt;</span><br><span class="line">        &lt;![CDATA[</span><br><span class="line">          <span class="keyword">SELECT</span> <span class="comment">/* SQLID=kr.amc.amis.mc.nr.pm.store.mapper.IrPatInfoMapper.retrievePformTrgetListByPformDt */</span></span><br><span class="line">                 JUSA.*</span><br><span class="line">               , (</span><br><span class="line">                 <span class="keyword">SELECT</span> <span class="string">&#x27;Y&#x27;</span></span><br><span class="line">                   <span class="keyword">FROM</span> V_MRNRRFLIF  FLIF <span class="comment">/* 낙상사정등록내역 */</span></span><br><span class="line">                  <span class="keyword">WHERE</span> FLIF.PATNO       = JUSA.PATNO</span><br><span class="line">                    <span class="keyword">AND</span> FLIF.DRAWUP_DT   = JUSA.HOPE_DT</span><br><span class="line">                    <span class="keyword">AND</span> FLIF.REC_VALD_CD = <span class="string">&#x27;V&#x27;</span></span><br><span class="line">                    <span class="keyword">AND</span> FLIF.FLDW_ASSM_CHK_YN = <span class="string">&#x27;Y&#x27;</span></span><br><span class="line">                    <span class="keyword">AND</span> <span class="keyword">ROWNUM</span> = <span class="number">1</span></span><br><span class="line">                 )                            <span class="keyword">AS</span>  FLDW_REG_YN         <span class="comment">/* 낙상등록여부 */</span></span><br><span class="line">               , (</span><br><span class="line">                 <span class="keyword">SELECT</span> (</span><br><span class="line">                        <span class="keyword">SELECT</span> INHOSP_DIAG_ENG_NM</span><br><span class="line">                          <span class="keyword">FROM</span> V_MSMACDGCD  <span class="comment">/* 원내진단코드 뷰 */</span></span><br><span class="line">                         <span class="keyword">WHERE</span> INHOSP_DIAG_CD = DIAG.INHOSP_DIAG_CD</span><br><span class="line">                           <span class="keyword">AND</span> USE_YN         = <span class="string">&#x27;Y&#x27;</span></span><br><span class="line">                           <span class="keyword">AND</span> <span class="keyword">ROWNUM</span>         = <span class="number">1</span></span><br><span class="line">                        )</span><br><span class="line">                   <span class="keyword">FROM</span> V_OOOSMDIAG  DIAG <span class="comment">/* 원내진단코드 뷰 */</span></span><br><span class="line">                  <span class="keyword">WHERE</span> DIAG.PATNO        = JUSA.PATNO</span><br><span class="line">                    <span class="keyword">AND</span> DIAG.VIST_SN      = JUSA.VIST_SN</span><br><span class="line">                    <span class="keyword">AND</span> DIAG.MAINDIAG_YN  = <span class="string">&#x27;Y&#x27;</span></span><br><span class="line">                    <span class="keyword">AND</span> <span class="keyword">ROWNUM</span> = <span class="number">1</span></span><br><span class="line">                 )                            <span class="keyword">AS</span> INHOSP_DIAG_ENG_NM  <span class="comment">/* 원내진단영문명 */</span></span><br><span class="line">               , (</span><br><span class="line">                 <span class="keyword">SELECT</span> <span class="string">&#x27;Y&#x27;</span></span><br><span class="line">                   <span class="keyword">FROM</span> V_OOODMBLOD  BLOD  <span class="comment">/* 수혈처방기본 */</span></span><br><span class="line">                      , NRDAMATBS    ATBL</span><br><span class="line">                  <span class="keyword">WHERE</span> ATBL.PATNO               = JUSA.PATNO</span><br><span class="line">                    <span class="keyword">AND</span> ATBL.VIST_SN             = JUSA.VIST_SN</span><br><span class="line">                    <span class="keyword">AND</span> ATBL.ORDR_PFORM_LOC_CD   = JUSA.ORDR_PFORM_LOC_CD</span><br><span class="line">                    <span class="keyword">AND</span> ATBL.HOPE_DT             = JUSA.HOPE_DT</span><br><span class="line">                    <span class="keyword">AND</span> BLOD.ORDR_NO             = ATBL.ORDR_PFORM_NO  </span><br><span class="line">                    <span class="keyword">AND</span> BLOD.ORDR_TITL_CD       != <span class="string">&#x27;16&#x27;</span>              <span class="comment">/* 의사가 입력한 처방  */</span></span><br><span class="line">                    <span class="keyword">AND</span> BLOD.VALD_YN             = <span class="string">&#x27;Y&#x27;</span></span><br><span class="line">                    <span class="keyword">AND</span> BLOD.ORDR_CANCEL_CD      = <span class="string">&#x27;N&#x27;</span></span><br><span class="line">                    <span class="keyword">AND</span> BLOD.MDEX_DIV_CD         = <span class="string">&#x27;O&#x27;</span></span><br><span class="line">                    <span class="keyword">AND</span> BLOD.RCIV_STAT_CD       <span class="keyword">IN</span> (<span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;9&#x27;</span>)</span><br><span class="line">                    <span class="keyword">AND</span> <span class="keyword">ROWNUM</span>                   = <span class="number">1</span></span><br><span class="line">                 )                            <span class="keyword">AS</span> BLDTR_ORDR_YN       <span class="comment">/* 수혈처방여부 */</span></span><br><span class="line">               , (</span><br><span class="line">                 <span class="keyword">SELECT</span> <span class="string">&#x27;Y&#x27;</span></span><br><span class="line">                   <span class="keyword">FROM</span> V_OOODMEXAM  EXAM  <span class="comment">/* 검사치료처방기본 */</span></span><br><span class="line">                      , NRDAMATBS    ATBL</span><br><span class="line">                  <span class="keyword">WHERE</span> ATBL.PATNO               = JUSA.PATNO</span><br><span class="line">                    <span class="keyword">AND</span> ATBL.VIST_SN             = JUSA.VIST_SN</span><br><span class="line">                    <span class="keyword">AND</span> ATBL.ORDR_PFORM_LOC_CD   = JUSA.ORDR_PFORM_LOC_CD</span><br><span class="line">                    <span class="keyword">AND</span> ATBL.HOPE_DT             = JUSA.HOPE_DT</span><br><span class="line">                    <span class="keyword">AND</span> EXAM.ORDR_NO             = ATBL.ORDR_PFORM_NO  </span><br><span class="line">                    <span class="keyword">AND</span> EXAM.ORDR_TITL_CD       != <span class="string">&#x27;16&#x27;</span>              <span class="comment">/* 의사가 입력한 처방  */</span></span><br><span class="line">                    <span class="keyword">AND</span> EXAM.VALD_YN             = <span class="string">&#x27;Y&#x27;</span></span><br><span class="line">                    <span class="keyword">AND</span> EXAM.ORDR_CANCEL_CD      = <span class="string">&#x27;N&#x27;</span></span><br><span class="line">                    <span class="keyword">AND</span> EXAM.ORDR_DELI_SYSM_CD   = <span class="string">&#x27;O&#x27;</span></span><br><span class="line">                    <span class="keyword">AND</span> EXAM.MDEX_DIV_CD         = <span class="string">&#x27;O&#x27;</span></span><br><span class="line">                    <span class="keyword">AND</span> EXAM.RCIV_STAT_CD       <span class="keyword">IN</span> (<span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;9&#x27;</span>)</span><br><span class="line">                    <span class="keyword">AND</span> <span class="keyword">ROWNUM</span>                   = <span class="number">1</span></span><br><span class="line">                 )                            <span class="keyword">AS</span> HLIN_ORDR_YN        <span class="comment">/* 행위처방여부 */</span></span><br><span class="line">               , (</span><br><span class="line">                 <span class="keyword">SELECT</span> <span class="string">&#x27;Y&#x27;</span></span><br><span class="line">                   <span class="keyword">FROM</span>  V_OOODMMEDI MEDI</span><br><span class="line">                       , V_PHINMMEDI PHDI</span><br><span class="line">                       , NRDAMATBS   ATBL</span><br><span class="line">                  <span class="keyword">WHERE</span> ATBL.PATNO               = JUSA.PATNO</span><br><span class="line">                    <span class="keyword">AND</span> ATBL.VIST_SN             = JUSA.VIST_SN</span><br><span class="line">                    <span class="keyword">AND</span> ATBL.ORDR_PFORM_LOC_CD   = JUSA.ORDR_PFORM_LOC_CD</span><br><span class="line">                    <span class="keyword">AND</span> ATBL.HOPE_DT             = JUSA.HOPE_DT</span><br><span class="line">                    <span class="keyword">AND</span> MEDI.ORDR_NO             = ATBL.ORDR_PFORM_NO  </span><br><span class="line">                    <span class="keyword">AND</span> NVL(MEDI.PREP_ORDR_CLSF_CD, <span class="string">&#x27;0&#x27;</span>) != <span class="string">&#x27;P&#x27;</span>      <span class="comment">/* PRE처방이 아닌것 */</span></span><br><span class="line">                    <span class="keyword">AND</span> MEDI.ORDR_TITL_CD       != <span class="string">&#x27;16&#x27;</span>              <span class="comment">/* 의사가 입력한 처방  */</span></span><br><span class="line">                    <span class="keyword">AND</span> MEDI.ACTING_ORGL_ORDR_NO <span class="keyword">IS</span> <span class="literal">NULL</span>             <span class="comment">/* 원처방만 */</span></span><br><span class="line">                    <span class="keyword">AND</span> MEDI.VALD_YN             = <span class="string">&#x27;Y&#x27;</span></span><br><span class="line">                    <span class="keyword">AND</span> MEDI.ORDR_CANCEL_CD      = <span class="string">&#x27;N&#x27;</span></span><br><span class="line">                    <span class="keyword">AND</span> PHDI.PHRM_CD             = MEDI.ORDR_CD</span><br><span class="line">                    <span class="keyword">AND</span> PHDI.MANAGE_MEDI_KND_CD  = <span class="string">&#x27;F&#x27;</span>               <span class="comment">/* 수액 */</span></span><br><span class="line">                    <span class="keyword">AND</span> MEDI.RCIV_STAT_CD       <span class="keyword">IN</span> (<span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;9&#x27;</span>)</span><br><span class="line">                    <span class="keyword">AND</span> <span class="keyword">ROWNUM</span>                   = <span class="number">1</span></span><br><span class="line">                 )                           <span class="keyword">AS</span> IS_ORDR_YN           <span class="comment">/* 수액처방여부 */</span></span><br><span class="line">               , (</span><br><span class="line">                 <span class="keyword">SELECT</span> <span class="string">&#x27;Y&#x27;</span></span><br><span class="line">                   <span class="keyword">FROM</span> V_OOODMMEDI MEDI</span><br><span class="line">                      , V_PHINMMEDI PHDI</span><br><span class="line">                      , NRDAMATBS   ATBL </span><br><span class="line">                  <span class="keyword">WHERE</span> ATBL.PATNO               = JUSA.PATNO</span><br><span class="line">                    <span class="keyword">AND</span> ATBL.VIST_SN             = JUSA.VIST_SN</span><br><span class="line">                    <span class="keyword">AND</span> ATBL.ORDR_PFORM_LOC_CD   = JUSA.ORDR_PFORM_LOC_CD</span><br><span class="line">                    <span class="keyword">AND</span> ATBL.HOPE_DT             = JUSA.HOPE_DT</span><br><span class="line">                    <span class="keyword">AND</span> MEDI.ORDR_NO             = ATBL.ORDR_PFORM_NO  </span><br><span class="line">                    <span class="keyword">AND</span> MEDI.VALD_YN             = <span class="string">&#x27;Y&#x27;</span></span><br><span class="line">                    <span class="keyword">AND</span> MEDI.ORDR_CANCEL_CD      = <span class="string">&#x27;N&#x27;</span></span><br><span class="line">                    <span class="keyword">AND</span> PHDI.PHRM_CD             = MEDI.ORDR_CD</span><br><span class="line">                    <span class="keyword">AND</span> PHDI.RMRS_LCLAS_CD       = <span class="string">&#x27;010&#x27;</span>             <span class="comment">/* 항암제여부 */</span></span><br><span class="line">                    <span class="keyword">AND</span> MEDI.RCIV_STAT_CD       <span class="keyword">IN</span> (<span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;9&#x27;</span>)</span><br><span class="line">                    <span class="keyword">AND</span> <span class="keyword">ROWNUM</span>                   = <span class="number">1</span></span><br><span class="line">                 )                           <span class="keyword">AS</span> IS_ANDR_YN           <span class="comment">/* 항암제 처방여부 */</span></span><br><span class="line">               , (</span><br><span class="line">                 <span class="keyword">SELECT</span> ABOX.ABO_BLTY || ABOX.RH_BLTY</span><br><span class="line">                   <span class="keyword">FROM</span> V_SSBIRABOX ABOX</span><br><span class="line">                  <span class="keyword">WHERE</span> ABOX.PATNO = JUSA.PATNO</span><br><span class="line">                    <span class="keyword">AND</span> <span class="keyword">ROWNUM</span>     = <span class="number">1</span></span><br><span class="line">                 )                           <span class="keyword">AS</span> ABO_RH_BLTY          <span class="comment">/* 혈액형 */</span></span><br><span class="line">               , (</span><br><span class="line">                 <span class="keyword">SELECT</span> CHLA.CHILD_ANTN_IR_EROOM_TM</span><br><span class="line">                   <span class="keyword">FROM</span> NRPMMCHLO CHLA</span><br><span class="line">                  <span class="keyword">WHERE</span> CHLA.PATNO                  = JUSA.PATNO</span><br><span class="line">                    <span class="keyword">AND</span> CHLA.VIST_SN                = JUSA.VIST_SN</span><br><span class="line">                    <span class="keyword">AND</span> CHLA.CHILD_ANTN_IR_RESV_DT  = JUSA.HOPE_DT</span><br><span class="line">                    <span class="keyword">AND</span> CHLA.VALD_YN                = <span class="string">&#x27;Y&#x27;</span></span><br><span class="line">                  <span class="keyword">ORDER</span> <span class="keyword">BY</span> CHILD_ANTN_IR_EROOM_TM <span class="keyword">DESC</span></span><br><span class="line">                  <span class="keyword">FETCH</span> <span class="keyword">FIRST</span> <span class="number">1</span> <span class="keyword">ROWS</span> <span class="keyword">ONLY</span></span><br><span class="line">                 )                           <span class="keyword">AS</span> CHILD_ANTN_IR_EROOM_TM <span class="comment">/* 소아항암 입실시각 */</span></span><br><span class="line">               , (</span><br><span class="line">                 <span class="keyword">SELECT</span> CHLB.CHILD_ANTN_IR_LR_TM</span><br><span class="line">                   <span class="keyword">FROM</span> NRPMMCHLO CHLB</span><br><span class="line">                  <span class="keyword">WHERE</span> CHLB.PATNO                  = JUSA.PATNO</span><br><span class="line">                    <span class="keyword">AND</span> CHLB.VIST_SN                = JUSA.VIST_SN</span><br><span class="line">                    <span class="keyword">AND</span> CHLB.CHILD_ANTN_IR_RESV_DT  = JUSA.HOPE_DT</span><br><span class="line">                    <span class="keyword">AND</span> CHLB.VALD_YN                = <span class="string">&#x27;Y&#x27;</span></span><br><span class="line">                  <span class="keyword">ORDER</span> <span class="keyword">BY</span> CHILD_ANTN_IR_LR_TM <span class="keyword">DESC</span></span><br><span class="line">                  <span class="keyword">FETCH</span> <span class="keyword">FIRST</span> <span class="number">1</span> <span class="keyword">ROWS</span> <span class="keyword">ONLY</span></span><br><span class="line">                 )                           <span class="keyword">AS</span> CHILD_ANTN_IR_LR_TM <span class="comment">/* 소아항암 퇴실시각  */</span></span><br><span class="line">               , <span class="keyword">CASE</span> <span class="keyword">WHEN</span> NVL((</span><br><span class="line">                               <span class="keyword">SELECT</span> CHLC.CHILD_ANTN_IR_STAY_TMC</span><br><span class="line">                                 <span class="keyword">FROM</span> NRPMMCHLO CHLC</span><br><span class="line">                                <span class="keyword">WHERE</span> CHLC.PATNO                  = JUSA.PATNO</span><br><span class="line">                                  <span class="keyword">AND</span> CHLC.VIST_SN                = JUSA.VIST_SN</span><br><span class="line">                                  <span class="keyword">AND</span> CHLC.CHILD_ANTN_IR_RESV_DT  = JUSA.HOPE_DT</span><br><span class="line">                                  <span class="keyword">AND</span> CHLC.VALD_YN                = <span class="string">&#x27;Y&#x27;</span></span><br><span class="line">                                <span class="keyword">ORDER</span> <span class="keyword">BY</span> CHILD_ANTN_IR_STAY_TMC <span class="keyword">DESC</span></span><br><span class="line">                                <span class="keyword">FETCH</span> <span class="keyword">FIRST</span> <span class="number">1</span> <span class="keyword">ROWS</span> <span class="keyword">ONLY</span></span><br><span class="line">                               ), <span class="string">&#x27;&#x27;</span>) &gt; <span class="number">0</span></span><br><span class="line">                      <span class="keyword">THEN</span> NVL(TO_CHAR((</span><br><span class="line">                                       <span class="keyword">SELECT</span> CHLD.CHILD_ANTN_IR_STAY_TMC</span><br><span class="line">                                         <span class="keyword">FROM</span> NRPMMCHLO CHLD</span><br><span class="line">                                        <span class="keyword">WHERE</span> CHLD.PATNO                  = JUSA.PATNO</span><br><span class="line">                                          <span class="keyword">AND</span> CHLD.VIST_SN                = JUSA.VIST_SN</span><br><span class="line">                                          <span class="keyword">AND</span> CHLD.CHILD_ANTN_IR_RESV_DT  = JUSA.HOPE_DT</span><br><span class="line">                                          <span class="keyword">AND</span> CHLD.VALD_YN                = <span class="string">&#x27;Y&#x27;</span></span><br><span class="line">                                        <span class="keyword">ORDER</span> <span class="keyword">BY</span> CHILD_ANTN_IR_STAY_TMC <span class="keyword">DESC</span></span><br><span class="line">                                        <span class="keyword">FETCH</span> <span class="keyword">FIRST</span> <span class="number">1</span> <span class="keyword">ROWS</span> <span class="keyword">ONLY</span></span><br><span class="line">                                      )), <span class="string">&#x27;&#x27;</span>)</span><br><span class="line">                      <span class="keyword">ELSE</span> <span class="string">&#x27;&#x27;</span> <span class="keyword">END</span>            <span class="keyword">AS</span> CHILD_ANTN_IR_STAY_TMC <span class="comment">/* 재실시간 */</span></span><br><span class="line">               , (</span><br><span class="line">                 <span class="keyword">SELECT</span> (<span class="keyword">CASE</span> <span class="keyword">WHEN</span> <span class="keyword">COUNT</span>(<span class="number">1</span>) &gt; <span class="number">0</span> <span class="keyword">THEN</span> <span class="string">&#x27;Y&#x27;</span> <span class="keyword">ELSE</span> <span class="string">&#x27;N&#x27;</span> <span class="keyword">END</span>)</span><br><span class="line">                   <span class="keyword">FROM</span> V_WPDCDFAML FAML</span><br><span class="line">                  <span class="keyword">WHERE</span> FAML.PATNO          = JUSA.PATNO</span><br><span class="line">                    <span class="keyword">AND</span> JUSA.HOPE_DT  <span class="keyword">BETWEEN</span> FAML.APPLY_ST_DT </span><br><span class="line">                                          <span class="keyword">AND</span> FAML.APPLY_END_DT</span><br><span class="line">                    <span class="keyword">AND</span> FAML.VALD_YN = <span class="string">&#x27;Y&#x27;</span></span><br><span class="line">                 )                           <span class="keyword">AS</span> EMP_DSCNT_YN         <span class="comment">/* 직원, 직원가족할인, 할인여부 */</span></span><br><span class="line">               , (</span><br><span class="line">                 <span class="keyword">SELECT</span> <span class="keyword">CASE</span> <span class="keyword">WHEN</span> MDAW.FTR_ORDR_YN = <span class="string">&#x27;Y&#x27;</span> <span class="keyword">THEN</span> <span class="string">&#x27;Y&#x27;</span> <span class="keyword">END</span></span><br><span class="line">                   <span class="keyword">FROM</span> NRNCMMDAW MDAW</span><br><span class="line">                  <span class="keyword">WHERE</span> MDAW.PATNO    = JUSA.PATNO</span><br><span class="line">                    <span class="keyword">AND</span> MDAW.VIST_SN  = JUSA.VIST_SN</span><br><span class="line">                           <span class="keyword">AND</span> MDAW.MDEX_DT  = JUSA.HOPE_DT</span><br><span class="line">                           <span class="keyword">AND</span> <span class="keyword">ROWNUM</span>        = <span class="number">1</span></span><br><span class="line">                 )                     <span class="keyword">AS</span> FTR_ORDR_YN                </span><br><span class="line">               , (</span><br><span class="line">                 <span class="keyword">SELECT</span> <span class="keyword">DECODE</span> (<span class="keyword">COUNT</span> (CONS.PATNO), <span class="number">0</span>, <span class="string">&#x27;N&#x27;</span>, <span class="string">&#x27;Y&#x27;</span>) </span><br><span class="line">                   <span class="keyword">FROM</span> OOOSRCONS CONS</span><br><span class="line">                  <span class="keyword">WHERE</span> CONS.PATNO           = JUSA.PATNO</span><br><span class="line">                    <span class="keyword">AND</span> CONS.VIST_SN         = JUSA.VIST_SN</span><br><span class="line">                    <span class="keyword">AND</span> CONS.INCONS_CLSF_CD  = <span class="string">&#x27;DNR&#x27;</span></span><br><span class="line">                    <span class="keyword">AND</span> CONS.VALD_YN         = <span class="string">&#x27;Y&#x27;</span></span><br><span class="line">                    <span class="keyword">AND</span> CONS.REG_CANCEL_YN   = <span class="string">&#x27;Y&#x27;</span></span><br><span class="line">                 )                           <span class="keyword">AS</span> DNR_YN_MARK                                         </span><br><span class="line">               , (</span><br><span class="line">                 <span class="keyword">SELECT</span> <span class="string">&#x27;Y&#x27;</span>    <span class="keyword">AS</span> ORDR_REFND_EXSC_YN</span><br><span class="line">                   <span class="keyword">FROM</span> V_OOODMMEDI MEDI</span><br><span class="line">                      , NRDAMATBS   ATBS</span><br><span class="line">                  <span class="keyword">WHERE</span> MEDI.RCIV_STAT_CD     <span class="keyword">IN</span> (<span class="string">&#x27;2&#x27;</span>, <span class="string">&#x27;6&#x27;</span>, <span class="string">&#x27;8&#x27;</span>)     <span class="comment">/* RCIV_STAT_CD - 2&amp;6 : 환불입력, 8: 환불완료 */</span></span><br><span class="line">                    <span class="keyword">AND</span> MEDI.ORDR_NO           = ATBS.ORDR_PFORM_NO</span><br><span class="line">                    <span class="keyword">AND</span> ATBS.PATNO             = JUSA.PATNO</span><br><span class="line">                    <span class="keyword">AND</span> ATBS.VIST_SN           = JUSA.VIST_SN</span><br><span class="line">                    <span class="keyword">AND</span> ATBS.ORDR_PFORM_LOC_CD = JUSA.ORDR_PFORM_LOC_CD</span><br><span class="line">                    <span class="keyword">AND</span> MEDI.VALD_YN           = <span class="string">&#x27;Y&#x27;</span></span><br><span class="line">                    <span class="keyword">AND</span> <span class="keyword">ROWNUM</span> = <span class="number">1</span></span><br><span class="line">                  <span class="keyword">UNION</span></span><br><span class="line">                 <span class="keyword">SELECT</span> <span class="string">&#x27;Y&#x27;</span>    <span class="keyword">AS</span> ORDR_REFND_EXSC_YN</span><br><span class="line">                   <span class="keyword">FROM</span> V_OOODMEXAM EXAM</span><br><span class="line">                      , NRDAMATBS   ATBS</span><br><span class="line">                  <span class="keyword">WHERE</span> EXAM.RCIV_STAT_CD     <span class="keyword">IN</span> (<span class="string">&#x27;2&#x27;</span>, <span class="string">&#x27;6&#x27;</span>, <span class="string">&#x27;8&#x27;</span>)     <span class="comment">/* RCIV_STAT_CD - 2&amp;6 : 환불입력, 8: 환불완료 */</span></span><br><span class="line">                    <span class="keyword">AND</span> EXAM.ORDR_NO           = ATBS.ORDR_PFORM_NO</span><br><span class="line">                    <span class="keyword">AND</span> ATBS.PATNO             = JUSA.PATNO</span><br><span class="line">                    <span class="keyword">AND</span> ATBS.VIST_SN           = JUSA.VIST_SN</span><br><span class="line">                    <span class="keyword">AND</span> ATBS.ORDR_PFORM_LOC_CD = JUSA.ORDR_PFORM_LOC_CD</span><br><span class="line">                    <span class="keyword">AND</span> EXAM.VALD_YN           = <span class="string">&#x27;Y&#x27;</span></span><br><span class="line">                    <span class="keyword">AND</span> <span class="keyword">ROWNUM</span> = <span class="number">1</span></span><br><span class="line">                  <span class="keyword">UNION</span></span><br><span class="line">                 <span class="keyword">SELECT</span> <span class="string">&#x27;Y&#x27;</span>    <span class="keyword">AS</span> ORDR_REFND_EXSC_YN</span><br><span class="line">                   <span class="keyword">FROM</span> V_OOODMBLOD BLOD</span><br><span class="line">                      , NRDAMATBS   ATBS</span><br><span class="line">                  <span class="keyword">WHERE</span> BLOD.RCIV_STAT_CD     <span class="keyword">IN</span> (<span class="string">&#x27;2&#x27;</span>, <span class="string">&#x27;6&#x27;</span>, <span class="string">&#x27;8&#x27;</span>)     <span class="comment">/* RCIV_STAT_CD - 2&amp;6 : 환불입력, 8: 환불완료 */</span></span><br><span class="line">                    <span class="keyword">AND</span> BLOD.ORDR_NO           = ATBS.ORDR_PFORM_NO</span><br><span class="line">                    <span class="keyword">AND</span> ATBS.PATNO             = JUSA.PATNO</span><br><span class="line">                    <span class="keyword">AND</span> ATBS.VIST_SN           = JUSA.VIST_SN</span><br><span class="line">                    <span class="keyword">AND</span> ATBS.ORDR_PFORM_LOC_CD = JUSA.ORDR_PFORM_LOC_CD</span><br><span class="line">                    <span class="keyword">AND</span> BLOD.VALD_YN           = <span class="string">&#x27;Y&#x27;</span></span><br><span class="line">                    <span class="keyword">AND</span> <span class="keyword">ROWNUM</span> = <span class="number">1</span></span><br><span class="line">                 )                           <span class="keyword">AS</span> ORDR_REFND_EXSC_YN   <span class="comment">/* 처방환불존재여부 - 처방 중 1건이라도 환불이 존재하는지 확인 */</span></span><br><span class="line">               , FN_ZZ_GET_USER_NM(JUSA.ATNN_EMPNO, <span class="string">&#x27;K&#x27;</span>) <span class="keyword">AS</span> ATNN_NM  <span class="comment">/* 진료의성명 */</span>  </span><br><span class="line">               , <span class="keyword">RANK</span>() <span class="keyword">OVER</span> (<span class="keyword">PARTITION</span> <span class="keyword">BY</span> JUSA.PATNO <span class="keyword">ORDER</span> <span class="keyword">BY</span> JUSA.ORDR_PFORM_LOC_CD, JUSA.RCIV_DTM ,JUSA.ORDR_DIRECT_DT) <span class="keyword">AS</span> RCIV_BY_SN     <span class="comment">/* 내원별, 수납별일련번호 */</span> </span><br><span class="line">               , ROW_NUMBER() <span class="keyword">OVER</span> (<span class="keyword">PARTITION</span> <span class="keyword">BY</span> JUSA.PATNO, JUSA.VIST_SN, JUSA.ORDR_PFORM_LOC_CD, JUSA.RCIV_DTM ,JUSA.ORDR_DIRECT_DT</span><br><span class="line">                                        <span class="keyword">ORDER</span> <span class="keyword">BY</span> <span class="keyword">DECODE</span>(IR_TASK_CD_TEMP, <span class="string">&#x27;C&#x27;</span>, <span class="number">1</span>, <span class="string">&#x27;H&#x27;</span>, <span class="number">2</span>, <span class="string">&#x27;M&#x27;</span>, <span class="number">3</span>, <span class="string">&#x27;R&#x27;</span>, <span class="number">4</span>, <span class="string">&#x27;N&#x27;</span>, <span class="number">5</span>, <span class="string">&#x27;X&#x27;</span>, <span class="number">6</span>)) <span class="keyword">AS</span> IR_TASK_CD_SEQ  <span class="comment">/* 주사실업무코드순서 - (처치, 헤파빅, 레미케이드, 조제주사, 단순주사, 행위 순) 동관주사실 김영미 선생님 요청사항임 */</span></span><br><span class="line">            <span class="keyword">FROM</span> (</span><br><span class="line">                 <span class="keyword">SELECT</span> ATBS.ORDR_PFORM_NO                          <span class="keyword">AS</span> ORDR_PFORM_NO       <span class="comment">/* 처방수행번호 */</span></span><br><span class="line">                      , ATBS.PFORM_DT                               <span class="keyword">AS</span> PFORM_DT            <span class="comment">/* 수행일자 */</span></span><br><span class="line">                      , ATBS.HOPE_DT                                <span class="keyword">AS</span> HOPE_DT             <span class="comment">/* 희망일자 */</span></span><br><span class="line">                      , ATBS.PATNO                                  <span class="keyword">AS</span> PATNO               <span class="comment">/* 병원등록번호 */</span></span><br><span class="line">                      , ATBS.VIST_SN                                <span class="keyword">AS</span> VIST_SN             <span class="comment">/* 내원일련번호 */</span></span><br><span class="line">                      , ATIN.PFORM_STAT_CD                          <span class="keyword">AS</span> PFORM_STAT_CD       <span class="comment">/* 수행상세-수행상태코드*/</span></span><br><span class="line">                      , NVL(ATBS.REAL_ORDR_LOC_USE_CD</span><br><span class="line">                          , ATBS.ORDR_PFORM_LOC_CD)                 <span class="keyword">AS</span> ORDR_PFORM_LOC_CD   <span class="comment">/* 처방수행장소코드 */</span></span><br><span class="line">                      , ATBK.ORDR_CD                                <span class="keyword">AS</span> ORDR_CD             <span class="comment">/* 처방코드 */</span></span><br><span class="line">                      , INFO.PAT_NM                                 <span class="keyword">AS</span> PAT_NM              <span class="comment">/* 환자성명 */</span></span><br><span class="line">                      , INFO.SEX_DIV_NM                             <span class="keyword">AS</span> SEX_DIV_NM          <span class="comment">/* 성별구분명 */</span></span><br><span class="line">                      , INFO.PAT_BIRTHDT                            <span class="keyword">AS</span> PAT_BIRTHDT         <span class="comment">/* 환자생년월일 */</span></span><br><span class="line">                      , INFO.AGE_CNTE                               <span class="keyword">AS</span> AGE_CNTE            <span class="comment">/* 나이내용 */</span></span><br><span class="line">                      , INFO.MBPH_NO                                <span class="keyword">AS</span> MBPH_NO             <span class="comment">/* 휴대전화번호 */</span></span><br><span class="line">                      , PATN.MDDP_CD                                <span class="keyword">AS</span> MDDP_CD             <span class="comment">/* 진료과코드 */</span></span><br><span class="line">                      , NVL((</span><br><span class="line">                            <span class="keyword">SELECT</span> TTD_EMPNO</span><br><span class="line">                              <span class="keyword">FROM</span> V_NRNCMMDAW</span><br><span class="line">                             <span class="keyword">WHERE</span> PATNO      = ATBS.PATNO</span><br><span class="line">                               <span class="keyword">AND</span> VIST_SN    = ATBS.VIST_SN</span><br><span class="line">                               <span class="keyword">AND</span> MDDP_CD    = PATN.MDDP_CD</span><br><span class="line">                             <span class="keyword">ORDER</span> <span class="keyword">BY</span> VIST_CONFM_YN <span class="keyword">DESC</span>, VIST_CONFM_DT <span class="keyword">DESC</span>, VIST_CONFM_TM <span class="keyword">DESC</span></span><br><span class="line">                             <span class="keyword">FETCH</span> <span class="keyword">FIRST</span> <span class="number">1</span> <span class="keyword">ROWS</span> <span class="keyword">ONLY</span></span><br><span class="line">                            ), PATN.ATNN_EMPNO)                     <span class="keyword">AS</span> ATNN_EMPNO</span><br><span class="line">                      , NVL(IRAW.IR_WAIT_STAT_CD, <span class="string">&#x27;N&#x27;</span>)              <span class="keyword">AS</span> IR_WAIT_STAT_CD     <span class="comment">/* 주사실대기상태코드 */</span></span><br><span class="line">                      , <span class="keyword">DECODE</span>(IRAW.IR_WAIT_STAT_CD, <span class="string">&#x27;N&#x27;</span>, <span class="string">&#x27;준비&#x27;</span></span><br><span class="line">                                                   , <span class="string">&#x27;P&#x27;</span>, <span class="string">&#x27;접수&#x27;</span></span><br><span class="line">                                                   , <span class="string">&#x27;W&#x27;</span>, <span class="string">&#x27;대기&#x27;</span></span><br><span class="line">                                                   , <span class="string">&#x27;R&#x27;</span>, <span class="string">&#x27;입실&#x27;</span></span><br><span class="line">                                                   , <span class="string">&#x27;O&#x27;</span>, <span class="string">&#x27;완료&#x27;</span></span><br><span class="line">                                                   , <span class="string">&#x27;L&#x27;</span>, <span class="string">&#x27;퇴실&#x27;</span></span><br><span class="line">                                                   , <span class="string">&#x27;T&#x27;</span>, <span class="string">&#x27;통과&#x27;</span></span><br><span class="line">                                                   , <span class="string">&#x27;준비&#x27;</span>)        <span class="keyword">AS</span> IR_WAIT_STAT_NM     <span class="comment">/* 주사실대기상태명 */</span></span><br><span class="line">                      , IRAW.IR_WAIT_NO                             <span class="keyword">AS</span> IR_WAIT_NO          <span class="comment">/* 주사실대기번호 */</span></span><br><span class="line">                      , IRAW.IR_TASK_CD                             <span class="keyword">AS</span> IR_TASK_CD          <span class="comment">/* 주사실업무코드 (C:처치  H:헤파빅  N:단순주사  R:조제주사) */</span></span><br><span class="line">                      , IRAW.IR_ZONE_NO                             <span class="keyword">AS</span> IR_ZONE_NO          <span class="comment">/* 주사실구역번호  1:주사실1, 2:주사실2 */</span></span><br><span class="line">                      , ATBK.ORDR_DIRECT_DT                         <span class="keyword">AS</span> IR_ORDR_DT          <span class="comment">/* 처방지시일자 */</span></span><br><span class="line">                      , ATBK.ORDR_DIRECT_DT                         <span class="keyword">AS</span> ORDR_DIRECT_DT</span><br><span class="line">                      , ATBS.RCIV_DT || ATBS.RCIV_TM                <span class="keyword">AS</span> RCIV_DTM</span><br><span class="line">                      , <span class="keyword">CASE</span> <span class="keyword">WHEN</span> NVL(PHIN.PHRM_TYP_CD, <span class="string">&#x27;*&#x27;</span>) = <span class="string">&#x27;I&#x27;</span> <span class="keyword">THEN</span> <span class="string">&#x27;R&#x27;</span>                <span class="comment">/*임상약은 무조건 조제주사*/</span></span><br><span class="line">                             <span class="keyword">WHEN</span> <span class="comment">/* NVL(PHIN.MANAGE_MEDI_KND_CD, &#x27;*&#x27;) = &#x27;F&#x27; AND 수액조건은 막아달라 김영미 20190403*/</span> </span><br><span class="line">                                  (NVL(PHIN.MEDI_VOL_MSR_CD, <span class="string">&#x27;*&#x27;</span>) = <span class="string">&#x27;L&#x27;</span> <span class="keyword">OR</span> (NVL(PHIN.MEDI_VOL_MSR_CD, <span class="string">&#x27;*&#x27;</span>) = <span class="string">&#x27;ml&#x27;</span> <span class="keyword">AND</span> NVL(PHIN.MEDI_VOL_VAL, <span class="number">0</span>) &gt;= <span class="number">50</span>))  <span class="keyword">THEN</span> <span class="string">&#x27;R&#x27;</span> <span class="comment">/* 수액이면서 50ml 이상은 조제주사 */</span></span><br><span class="line">                             <span class="keyword">WHEN</span> CODE.FRST_ADD_CD_VAL <span class="keyword">IN</span> (<span class="string">&#x27;M&#x27;</span>, <span class="string">&#x27;H&#x27;</span>, <span class="string">&#x27;C&#x27;</span>, <span class="string">&#x27;X&#x27;</span>) <span class="keyword">THEN</span> CODE.FRST_ADD_CD_VAL</span><br><span class="line">                             <span class="keyword">WHEN</span> ATBS.MEDI_MIX_YN = <span class="string">&#x27;Y&#x27;</span> <span class="keyword">OR</span> CODE.FRST_ADD_CD_VAL = <span class="string">&#x27;R&#x27;</span> <span class="keyword">THEN</span> <span class="string">&#x27;R&#x27;</span></span><br><span class="line">                             <span class="keyword">ELSE</span> <span class="string">&#x27;N&#x27;</span> <span class="keyword">END</span>                           <span class="keyword">AS</span> IR_TASK_CD_TEMP</span><br><span class="line">                      , <span class="keyword">CASE</span> <span class="keyword">WHEN</span> NVL(PHIN.PHRM_TYP_CD, <span class="string">&#x27;*&#x27;</span>) = <span class="string">&#x27;I&#x27;</span> <span class="keyword">THEN</span> <span class="string">&#x27;R&#x27;</span>                <span class="comment">/*임상약은 무조건 조제주사*/</span></span><br><span class="line">                             <span class="keyword">WHEN</span> <span class="comment">/* NVL(PHIN.MANAGE_MEDI_KND_CD, &#x27;*&#x27;) = &#x27;F&#x27; AND */</span></span><br><span class="line">                                   (NVL(PHIN.MEDI_VOL_MSR_CD, <span class="string">&#x27;*&#x27;</span>) = <span class="string">&#x27;L&#x27;</span> <span class="keyword">OR</span> (NVL(PHIN.MEDI_VOL_MSR_CD, <span class="string">&#x27;*&#x27;</span>) = <span class="string">&#x27;ml&#x27;</span> <span class="keyword">AND</span> NVL(PHIN.MEDI_VOL_VAL, <span class="number">0</span>) &gt;= <span class="number">50</span>))  <span class="keyword">THEN</span> <span class="string">&#x27;R&#x27;</span> <span class="comment">/* 수액이면서 50ml 이상은 조제주사 */</span></span><br><span class="line">                             <span class="keyword">WHEN</span> CODE.FRST_ADD_CD_VAL <span class="keyword">IN</span> (<span class="string">&#x27;M&#x27;</span>, <span class="string">&#x27;H&#x27;</span>, <span class="string">&#x27;C&#x27;</span>) <span class="keyword">THEN</span> CODE.FRST_ADD_CD_VAL</span><br><span class="line">                             <span class="keyword">WHEN</span> ATBS.MEDI_MIX_YN = <span class="string">&#x27;Y&#x27;</span> <span class="keyword">OR</span> CODE.FRST_ADD_CD_VAL = <span class="string">&#x27;R&#x27;</span> <span class="keyword">THEN</span> <span class="string">&#x27;R&#x27;</span></span><br><span class="line">                             <span class="keyword">ELSE</span> <span class="string">&#x27;N&#x27;</span> <span class="keyword">END</span>                           <span class="keyword">AS</span> IR_TASK_CD_JUSA</span><br><span class="line">                      , <span class="keyword">CASE</span> <span class="keyword">WHEN</span> NVL(PHIN.PHRM_TYP_CD, <span class="string">&#x27;*&#x27;</span>) = <span class="string">&#x27;I&#x27;</span> <span class="keyword">THEN</span> <span class="string">&#x27;조제주사&#x27;</span>         <span class="comment">/*임상약은 무조건 조제주사*/</span></span><br><span class="line">                             <span class="keyword">WHEN</span> <span class="comment">/* NVL(PHIN.MANAGE_MEDI_KND_CD, &#x27;*&#x27;) = &#x27;F&#x27; AND 수액조건은 막아달라 김영미 20190403*/</span> </span><br><span class="line">                                 (NVL(PHIN.MEDI_VOL_MSR_CD, <span class="string">&#x27;*&#x27;</span>) = <span class="string">&#x27;L&#x27;</span> <span class="keyword">OR</span> (NVL(PHIN.MEDI_VOL_MSR_CD, <span class="string">&#x27;*&#x27;</span>) = <span class="string">&#x27;ml&#x27;</span> <span class="keyword">AND</span> NVL(PHIN.MEDI_VOL_VAL, <span class="number">0</span>) &gt;= <span class="number">50</span>))  <span class="keyword">THEN</span> <span class="string">&#x27;조제주사&#x27;</span> <span class="comment">/* 수액이면서 50ml 이상은 조제주사 */</span></span><br><span class="line">                             <span class="keyword">WHEN</span> CODE.FRST_ADD_CD_VAL <span class="keyword">IN</span> (<span class="string">&#x27;M&#x27;</span>, <span class="string">&#x27;H&#x27;</span>, <span class="string">&#x27;C&#x27;</span>, <span class="string">&#x27;X&#x27;</span>) <span class="keyword">THEN</span> CODE.SCON_ADD_CD_VAL</span><br><span class="line">                             <span class="keyword">WHEN</span> ATBS.MEDI_MIX_YN = <span class="string">&#x27;Y&#x27;</span> <span class="keyword">OR</span> CODE.FRST_ADD_CD_VAL = <span class="string">&#x27;R&#x27;</span> <span class="keyword">THEN</span> <span class="string">&#x27;조제주사&#x27;</span></span><br><span class="line">                             <span class="keyword">ELSE</span> <span class="string">&#x27;단순주사&#x27;</span> <span class="keyword">END</span>                    <span class="keyword">AS</span> IR_TASK_NM  </span><br><span class="line">                      , <span class="keyword">DECODE</span>(NVL(CODE.FRST_ADD_CD_VAL, <span class="string">&#x27;N&#x27;</span>), <span class="string">&#x27;H&#x27;</span>, <span class="string">&#x27;2&#x27;</span>, <span class="string">&#x27;1&#x27;</span>)  <span class="keyword">AS</span> IR_ZONE_NO_TEMP</span><br><span class="line">                      , (</span><br><span class="line">                        <span class="keyword">SELECT</span> <span class="keyword">DECODE</span>(<span class="keyword">COUNT</span>(*), <span class="number">0</span>, <span class="string">&#x27;N&#x27;</span>, <span class="string">&#x27;Y&#x27;</span>)</span><br><span class="line">                          <span class="keyword">FROM</span> V_NRDADATIN</span><br><span class="line">                         <span class="keyword">WHERE</span> ORDR_PFORM_NO = ATBS.ORDR_PFORM_NO</span><br><span class="line">                           <span class="keyword">AND</span> PFORM_STAT_CD = <span class="string">&#x27;RL&#x27;</span> </span><br><span class="line">                        )                                                      <span class="keyword">AS</span> RL_YN <span class="comment">/*불출여부*/</span></span><br><span class="line">                      , (</span><br><span class="line">                        <span class="keyword">SELECT</span> <span class="keyword">DECODE</span>(<span class="keyword">COUNT</span>(*), <span class="number">0</span>, <span class="string">&#x27;N&#x27;</span>, <span class="string">&#x27;Y&#x27;</span>)</span><br><span class="line">                          <span class="keyword">FROM</span> V_NRDADATIN</span><br><span class="line">                         <span class="keyword">WHERE</span> ORDR_PFORM_NO = ATBS.ORDR_PFORM_NO</span><br><span class="line">                           <span class="keyword">AND</span> PFORM_STAT_CD <span class="keyword">IN</span> (<span class="string">&#x27;RF&#x27;</span>, <span class="string">&#x27;SK&#x27;</span>, <span class="string">&#x27;ZZ&#x27;</span>, <span class="string">&#x27;DC&#x27;</span>)</span><br><span class="line">                        )                                                      <span class="keyword">AS</span> RF_YN <span class="comment">/*수행불능여부*/</span></span><br><span class="line">                   <span class="keyword">FROM</span> NRDAMATBS    ATBS</span><br><span class="line">                      , NRDARATBK    ATBK</span><br><span class="line">                      , V_NRDADATIN  ATIN</span><br><span class="line">                      , V_WJAPMPATN  PATN</span><br><span class="line">                      , V_WPPIMINFO  INFO</span><br><span class="line">                      , NRNCMIRAW    IRAW</span><br><span class="line">                      , NRAMDCODE    CODE</span><br><span class="line">                      , V_OOODMMEDI  MEDI</span><br><span class="line">                      , V_OOODMEXAM  EXAM</span><br><span class="line">                      , V_OOODMBLOD  BLOD</span><br><span class="line">                      , V_PHINMMEDI  PHIN</span><br><span class="line">                      , V_ZZCKMCLND  CLND</span><br><span class="line">                  <span class="keyword">WHERE</span> ATBK.ORDR_PFORM_NO                 = ATBS.ORDR_PFORM_NO</span><br><span class="line">                    <span class="keyword">AND</span> ATBK.VALD_YN                       = <span class="string">&#x27;Y&#x27;</span></span><br><span class="line">                    <span class="keyword">AND</span> ATBK.ORDR_CANCEL_CD                = <span class="string">&#x27;N&#x27;</span></span><br><span class="line">                    <span class="keyword">AND</span> PATN.PATNO                         = ATBS.PATNO</span><br><span class="line">                    <span class="keyword">AND</span> PATN.VIST_SN                       = ATBS.VIST_SN</span><br><span class="line">                    <span class="keyword">AND</span> ATIN.ORDR_PFORM_NO                 = ATBS.ORDR_PFORM_NO</span><br><span class="line">                    <span class="keyword">AND</span> INFO.PATNO                         = ATBS.PATNO</span><br><span class="line">                    <span class="keyword">AND</span> INFO.VALD_YN                       = <span class="string">&#x27;Y&#x27;</span></span><br><span class="line">                    <span class="keyword">AND</span> IRAW.PATNO(+)                      = ATBS.PATNO</span><br><span class="line">                    <span class="keyword">AND</span> IRAW.VIST_SN(+)                    = ATBS.VIST_SN</span><br><span class="line">                    <span class="keyword">AND</span> IRAW.ORDR_PFORM_LOC_CD(+)          = NVL(ATBS.REAL_ORDR_LOC_USE_CD, ATBS.ORDR_PFORM_LOC_CD)</span><br><span class="line">                    <span class="keyword">AND</span> IRAW.IR_WAIT_NO(+)                 = ATBS.IR_WAIT_NO</span><br><span class="line">                    <span class="keyword">AND</span> IRAW.VALD_YN(+)                    = <span class="string">&#x27;Y&#x27;</span></span><br><span class="line">                    <span class="keyword">AND</span> MEDI.ORDR_NO(+)                    = ATBS.ORDR_PFORM_NO</span><br><span class="line">                    <span class="keyword">AND</span> EXAM.ORDR_NO(+)                    = ATBS.ORDR_PFORM_NO</span><br><span class="line">                    <span class="keyword">AND</span> BLOD.ORDR_NO(+)                    = ATBS.ORDR_PFORM_NO</span><br><span class="line">                    <span class="keyword">AND</span> NVL(MEDI.PREP_ORDR_CLSF_CD, <span class="string">&#x27;0&#x27;</span>)  != <span class="string">&#x27;P&#x27;</span>         <span class="comment">/* PRE처방이 아닌것 */</span></span><br><span class="line">                    <span class="keyword">AND</span> NVL(MEDI.ORDR_TITL_CD, <span class="string">&#x27;0&#x27;</span>)       != <span class="string">&#x27;16&#x27;</span>        <span class="comment">/* 의사가 입력한 처방  */</span></span><br><span class="line">                    <span class="keyword">AND</span> MEDI.ACTING_ORGL_ORDR_NO          <span class="keyword">IS</span> <span class="literal">NULL</span>        <span class="comment">/* 원처방만 */</span></span><br><span class="line">                 <span class="comment">/*    AND MEDI.MEDI_RAPD_SHAP_CD            IS NULL        의약품수불형태코드 2018.10.30 김영미T요청 */</span></span><br><span class="line">                    <span class="keyword">AND</span> NVL(MEDI.MEDI_RAPD_SHAP_CD, <span class="string">&#x27;*&#x27;</span>)   = <span class="keyword">CASE</span> <span class="keyword">WHEN</span> NVL(MEDI.MEDI_RAPD_SHAP_CD, <span class="string">&#x27;*&#x27;</span>) = <span class="string">&#x27;X&#x27;</span> <span class="keyword">AND</span> ATBK.ORDR_CD = <span class="string">&#x27;PS-SETO&#x27;</span> <span class="keyword">THEN</span> NVL(MEDI.MEDI_RAPD_SHAP_CD, <span class="string">&#x27;*&#x27;</span>)</span><br><span class="line">                                                                  <span class="keyword">WHEN</span> NVL(MEDI.MEDI_RAPD_SHAP_CD, <span class="string">&#x27;*&#x27;</span>) = <span class="string">&#x27;Z&#x27;</span> <span class="keyword">AND</span> (ATBK.ORDR_CD = <span class="string">&#x27;OA-VEN20RS&#x27;</span> <span class="keyword">OR</span> ATBK.ORDR_CD = <span class="string">&#x27;OA-VEN2.5&#x27;</span> <span class="keyword">OR</span> ATBK.ORDR_CD = <span class="string">&#x27;OA-MUC4ML&#x27;</span> <span class="keyword">OR</span> ATBK.ORDR_CD = <span class="string">&#x27;OA-PULRP&#x27;</span>) <span class="keyword">THEN</span> NVL(MEDI.MEDI_RAPD_SHAP_CD, <span class="string">&#x27;*&#x27;</span>)</span><br><span class="line">                                                                  <span class="keyword">WHEN</span> NVL(MEDI.MEDI_RAPD_SHAP_CD, <span class="string">&#x27;*&#x27;</span>) = <span class="string">&#x27;M&#x27;</span> <span class="keyword">AND</span> NVL(ATBS.REAL_ORDR_LOC_USE_CD, ATBS.ORDR_PFORM_LOC_CD) = <span class="string">&#x27;PIVC&#x27;</span> <span class="keyword">THEN</span> NVL(MEDI.MEDI_RAPD_SHAP_CD, <span class="string">&#x27;*&#x27;</span>) </span><br><span class="line">                                                                  <span class="keyword">ELSE</span> <span class="string">&#x27;*&#x27;</span> <span class="keyword">END</span>  <span class="comment">/* 의약품수불형태코드 조건 2018.10.30 김영미샘 요청, PS-SETO가 수불X일때는 예외처리 2019.03.28 윤혜영샘 요청 */</span> </span><br><span class="line">                    <span class="keyword">AND</span> NVL(MEDI.VALD_YN, <span class="string">&#x27;Y&#x27;</span>)             = <span class="string">&#x27;Y&#x27;</span></span><br><span class="line">                    <span class="keyword">AND</span> NVL(MEDI.ORDR_CANCEL_CD, <span class="string">&#x27;N&#x27;</span>)      = <span class="string">&#x27;N&#x27;</span></span><br><span class="line">                    <span class="keyword">AND</span> NVL(MEDI.MDEX_DIV_CD,<span class="string">&#x27;O&#x27;</span>)          = <span class="string">&#x27;O&#x27;</span></span><br><span class="line">                    <span class="keyword">AND</span> NVL(EXAM.ORDR_TITL_CD, <span class="string">&#x27;0&#x27;</span>)       != <span class="string">&#x27;16&#x27;</span>        <span class="comment">/* 의사가 입력한 처방 */</span></span><br><span class="line">                    <span class="keyword">AND</span> NVL(EXAM.VALD_YN, <span class="string">&#x27;Y&#x27;</span>)             = <span class="string">&#x27;Y&#x27;</span></span><br><span class="line">                    <span class="keyword">AND</span> NVL(EXAM.ORDR_CANCEL_CD,<span class="string">&#x27;N&#x27;</span>)       = <span class="string">&#x27;N&#x27;</span></span><br><span class="line">                    <span class="keyword">AND</span> NVL(EXAM.MDEX_DIV_CD,<span class="string">&#x27;O&#x27;</span>)         <span class="keyword">IN</span> (<span class="string">&#x27;O&#x27;</span>, <span class="string">&#x27;I&#x27;</span>)  <span class="comment">/* 입원처방 Bone Marrow 조회를 위해 I 추가 */</span></span><br><span class="line">                    <span class="keyword">AND</span> NVL(BLOD.ORDR_TITL_CD, <span class="string">&#x27;0&#x27;</span>)       != <span class="string">&#x27;16&#x27;</span>        <span class="comment">/* 의사가 입력한 처방  */</span></span><br><span class="line">                    <span class="keyword">AND</span> NVL(BLOD.VALD_YN,<span class="string">&#x27;Y&#x27;</span>)              = <span class="string">&#x27;Y&#x27;</span></span><br><span class="line">                    <span class="keyword">AND</span> NVL(BLOD.ORDR_CANCEL_CD,<span class="string">&#x27;N&#x27;</span>)       = <span class="string">&#x27;N&#x27;</span></span><br><span class="line">                    <span class="keyword">AND</span> NVL(BLOD.MDEX_DIV_CD,<span class="string">&#x27;O&#x27;</span>)          = <span class="string">&#x27;O&#x27;</span></span><br><span class="line">                    <span class="keyword">AND</span> CODE.NURS_ATEN_TASK_CD(+)          = <span class="string">&#x27;IRTASKCD&#x27;</span></span><br><span class="line">                    <span class="keyword">AND</span> CODE.NURS_ATEN_CD_VAL (+)          = ATBK.ORDR_CD</span><br><span class="line">                    <span class="keyword">AND</span> ATBS.HOPE_DT                 <span class="keyword">BETWEEN</span> CODE.APPLY_ST_DT(+) <span class="keyword">AND</span> CODE.APPLY_END_DT(+)</span><br><span class="line">                    <span class="keyword">AND</span> PHIN.PHRM_CD(+)                    = ATBK.ORDR_CD</span><br><span class="line">                    <span class="keyword">AND</span> ATBS.VALD_YN                       = <span class="string">&#x27;Y&#x27;</span></span><br><span class="line">                    <span class="keyword">AND</span> ATBS.ORDR_DEL_YN                   = <span class="string">&#x27;N&#x27;</span></span><br><span class="line">                    <span class="keyword">AND</span> ATBS.HOPE_DT                       = <span class="comment">#&#123;pformDt, jdbcType=VARCHAR&#125;</span></span><br><span class="line">                    <span class="keyword">AND</span> ATBS.PATNO                    <span class="keyword">NOT</span> <span class="keyword">IN</span> (<span class="keyword">SELECT</span> PATNO <span class="keyword">FROM</span> V_OOOSRVIPT) <span class="comment">/* VVIP 제외 */</span></span><br><span class="line">                    <span class="keyword">AND</span> ATBS.HOPE_DT                       = CLND.CLND_DT</span><br><span class="line">        ]]&gt;</span><br><span class="line">        &lt;<span class="keyword">choose</span>&gt;</span><br><span class="line">            &lt;<span class="keyword">when</span> <span class="keyword">test</span>=<span class="string">&quot;rcivYn != null and rcivYn != &#x27;&#x27; and rcivYn == &#x27;N&#x27;.toString() &quot;</span>&gt;</span><br><span class="line">                    <span class="keyword">AND</span> ATBS.RCIV_DT                      <span class="keyword">IS</span> <span class="literal">NULL</span></span><br><span class="line">                    <span class="keyword">AND</span> ATBS.RCIV_TM                      <span class="keyword">IS</span> <span class="literal">NULL</span></span><br><span class="line">            &lt;/<span class="keyword">when</span>&gt;</span><br><span class="line">            &lt;otherwise&gt;</span><br><span class="line">                    <span class="keyword">AND</span> (</span><br><span class="line">                           NVL(MEDI.RCIV_STAT_CD, <span class="string">&#x27;0&#x27;</span>)       <span class="keyword">IN</span> (<span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;9&#x27;</span>)   <span class="comment">/* 환불하지 않은 처방 */</span></span><br><span class="line">                        <span class="keyword">OR</span> NVL(EXAM.RCIV_STAT_CD, <span class="string">&#x27;0&#x27;</span>)       <span class="keyword">IN</span> (<span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;9&#x27;</span>)   <span class="comment">/* 환불하지 않은 처방 */</span></span><br><span class="line">                        <span class="keyword">OR</span> NVL(BLOD.RCIV_STAT_CD, <span class="string">&#x27;0&#x27;</span>)       <span class="keyword">IN</span> (<span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;9&#x27;</span>)</span><br><span class="line">                        )   <span class="comment">/* 환불하지 않은 처방 */</span>      </span><br><span class="line">                    <span class="keyword">AND</span> ATBS.RCIV_DT                      <span class="keyword">IS</span> <span class="keyword">NOT</span> <span class="literal">NULL</span></span><br><span class="line">                    <span class="keyword">AND</span> ATBS.RCIV_TM                      <span class="keyword">IS</span> <span class="keyword">NOT</span> <span class="literal">NULL</span></span><br><span class="line">            &lt;/otherwise&gt;</span><br><span class="line">        &lt;/<span class="keyword">choose</span>&gt;</span><br><span class="line">        &lt;<span class="keyword">choose</span>&gt;</span><br><span class="line">            &lt;<span class="keyword">when</span> <span class="keyword">test</span>=<span class="string">&quot;irPformDiv != null and irPformDiv != &#x27;&#x27; and irPformDiv == &#x27;HNDV&#x27;.toString() &quot;</span>&gt;</span><br><span class="line">                    <span class="keyword">AND</span> ATBS.ORDR_PFORM_LOC_CD            <span class="keyword">IN</span> (<span class="string">&#x27;OPIV&#x27;</span>,<span class="string">&#x27;OPIV3&#x27;</span>,<span class="string">&#x27;PEDIV&#x27;</span>,<span class="string">&#x27;PIVC&#x27;</span>,<span class="string">&#x27;OUT&#x27;</span>)</span><br><span class="line">                    <span class="keyword">AND</span> ATBS.ORDR_PFORM_LOC_CD            != <span class="keyword">CASE</span> <span class="keyword">WHEN</span> CLND.MDEX_HLDY_CD = <span class="string">&#x27;2&#x27;</span> <span class="keyword">THEN</span> <span class="string">&#x27;OUT&#x27;</span> <span class="keyword">ELSE</span> <span class="string">&#x27;*&#x27;</span> <span class="keyword">END</span>  <span class="comment">/* 평일에는 OUT 환자 보이지 않도록 제외 */</span></span><br><span class="line">                    <span class="keyword">AND</span> ATBS.ORDR_PFORM_LOC_CD             = <span class="keyword">DECODE</span>(<span class="comment">#&#123;ordrPformLocCd, jdbcType=VARCHAR&#125;, &#x27;&#x27;, ATBS.ORDR_PFORM_LOC_CD, #&#123;ordrPformLocCd, jdbcType=VARCHAR&#125;)</span></span><br><span class="line">                    <span class="keyword">AND</span> ATIN.PFORM_STAT_CD                 = <span class="string">&#x27;TR&#x27;</span>                                     <span class="comment">/* 수행상태코드 : 인계  */</span></span><br><span class="line">            &lt;/<span class="keyword">when</span>&gt;</span><br><span class="line">            &lt;otherwise&gt;</span><br><span class="line">                    <span class="keyword">AND</span> NVL(ATBS.REAL_ORDR_LOC_USE_CD, ATBS.ORDR_PFORM_LOC_CD) <span class="keyword">IN</span> (<span class="string">&#x27;OPIV&#x27;</span>,<span class="string">&#x27;OPIV3&#x27;</span>,<span class="string">&#x27;PEDIV&#x27;</span>,<span class="string">&#x27;PIVC&#x27;</span>,<span class="string">&#x27;OUT&#x27;</span>)</span><br><span class="line">                    <span class="keyword">AND</span> NVL(ATBS.REAL_ORDR_LOC_USE_CD, ATBS.ORDR_PFORM_LOC_CD) != <span class="keyword">CASE</span> <span class="keyword">WHEN</span> CLND.MDEX_HLDY_CD = <span class="string">&#x27;2&#x27;</span> <span class="keyword">THEN</span> <span class="string">&#x27;OUT&#x27;</span> <span class="keyword">ELSE</span> <span class="string">&#x27;*&#x27;</span> <span class="keyword">END</span>  <span class="comment">/* 평일에는 OUT 환자 보이지 않도록 제외 */</span></span><br><span class="line">                    <span class="keyword">AND</span> NVL(ATBS.REAL_ORDR_LOC_USE_CD, ATBS.ORDR_PFORM_LOC_CD)  = <span class="keyword">DECODE</span>(<span class="comment">#&#123;ordrPformLocCd, jdbcType=VARCHAR&#125;, &#x27;&#x27;, NVL(ATBS.REAL_ORDR_LOC_USE_CD, ATBS.ORDR_PFORM_LOC_CD), #&#123;ordrPformLocCd, jdbcType=VARCHAR&#125;)</span></span><br><span class="line">                &lt;<span class="keyword">if</span> <span class="keyword">test</span>=<span class="string">&quot;irPformDiv != null and irPformDiv != &#x27;&#x27; and irPformDiv == &#x27;BEFOR&#x27;.toString()&quot;</span>&gt;</span><br><span class="line">                    <span class="keyword">AND</span> ATBS.ORDR_PFORM_STAT_CD           <span class="keyword">IN</span> (<span class="string">&#x27;N&#x27;</span>, <span class="string">&#x27;P&#x27;</span>)                        <span class="comment">/* 처방수행상태코드 */</span></span><br><span class="line">                &lt;/<span class="keyword">if</span>&gt;</span><br><span class="line">                    <span class="keyword">AND</span> ATBS.ORDR_PFORM_STAT_CD            = <span class="keyword">DECODE</span>(<span class="comment">#&#123;irPformDiv, jdbcType=VARCHAR&#125;, &#x27;FINSH&#x27;, &#x27;Y&#x27;, ATBS.ORDR_PFORM_STAT_CD)                                 /* 처방수행상태코드 */</span></span><br><span class="line">                    <span class="keyword">AND</span> (</span><br><span class="line">                         ATIN.PFORM_STAT_CD                = <span class="keyword">DECODE</span>(<span class="comment">#&#123;irPformDiv, jdbcType=VARCHAR&#125;, &#x27;INBL&#x27;, &#x27;RF&#x27;, ATIN.PFORM_STAT_CD)</span></span><br><span class="line">                      <span class="keyword">OR</span> ATIN.PFORM_STAT_CD                = <span class="keyword">DECODE</span>(<span class="comment">#&#123;irPformDiv, jdbcType=VARCHAR&#125;, &#x27;INBL&#x27;, &#x27;SK&#x27;, ATIN.PFORM_STAT_CD)</span></span><br><span class="line">                      <span class="keyword">OR</span> ATIN.PFORM_STAT_CD                = <span class="keyword">DECODE</span>(<span class="comment">#&#123;irPformDiv, jdbcType=VARCHAR&#125;, &#x27;INBL&#x27;, &#x27;ZZ&#x27;, ATIN.PFORM_STAT_CD)</span></span><br><span class="line">                      <span class="keyword">OR</span> ATIN.PFORM_STAT_CD                = <span class="keyword">DECODE</span>(<span class="comment">#&#123;irPformDiv, jdbcType=VARCHAR&#125;, &#x27;INBL&#x27;, &#x27;DC&#x27;, ATIN.PFORM_STAT_CD)</span></span><br><span class="line">                        )</span><br><span class="line">                    <span class="keyword">AND</span> ATIN.PFORM_STAT_CD                 = <span class="keyword">DECODE</span>(<span class="comment">#&#123;irPformDiv, jdbcType=VARCHAR&#125;, &#x27;RELES&#x27;, &#x27;RL&#x27;, ATIN.PFORM_STAT_CD)                                     /* 수행상태코드 : 불출 */</span></span><br><span class="line">            &lt;/otherwise&gt;</span><br><span class="line">        &lt;/<span class="keyword">choose</span>&gt;</span><br><span class="line">        &lt;![CDATA[</span><br><span class="line">                 ) JUSA</span><br><span class="line">            <span class="keyword">WHERE</span> <span class="string">&#x27;Y&#x27;</span> = <span class="keyword">CASE</span> <span class="keyword">WHEN</span> <span class="comment">#&#123;irPformDiv, jdbcType=VARCHAR&#125; IN (&#x27;FINSH&#x27;, &#x27;BEFOR&#x27;) </span></span><br><span class="line">                              <span class="keyword">AND</span> (JUSA.RL_YN = <span class="string">&#x27;Y&#x27;</span> <span class="keyword">OR</span> JUSA.RF_YN = <span class="string">&#x27;Y&#x27;</span>)  <span class="keyword">THEN</span> <span class="string">&#x27;N&#x27;</span></span><br><span class="line">                             <span class="keyword">ELSE</span> <span class="string">&#x27;Y&#x27;</span> <span class="keyword">END</span>   <span class="comment">/* 인계, 수행불능, 불출은 수행전과 수행완료에 보이지 않도록 막음 */</span></span><br><span class="line">            <span class="keyword">ORDER</span> <span class="keyword">BY</span> RCIV_DTM</span><br><span class="line">                   , PATNO</span><br><span class="line">                   , IR_TASK_CD_SEQ</span><br><span class="line">        ]]&gt;</span><br><span class="line">    &lt;/<span class="keyword">select</span>&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    &lt;!<span class="comment">-- 외래주사실 환자별 수행대상 목록조회 --&gt;</span></span><br><span class="line">    &lt;<span class="keyword">select</span> <span class="keyword">id</span>=<span class="string">&quot;retrievePformTrgetListByPat&quot;</span> parameterType=<span class="string">&quot;kr.amc.amis.mc.nr.pm.entity.IrPformTrgetListByPatDTO&quot;</span> resultType=<span class="string">&quot;kr.amc.amis.mc.nr.pm.entity.IrPformTrgetListByPatDTO&quot;</span>&gt;</span><br><span class="line">        &lt;![CDATA[</span><br><span class="line">            <span class="keyword">SELECT</span> <span class="comment">/* SQLID=kr.amc.amis.mc.nr.pm.store.mapper.IrPatInfoMapper.retrievePformTrgetListByPat */</span></span><br><span class="line">                   *</span><br><span class="line">              <span class="keyword">FROM</span> (</span><br><span class="line">                   <span class="keyword">SELECT</span> <span class="keyword">DISTINCT</span></span><br><span class="line">                          ATBS.PATNO                   <span class="keyword">AS</span> PATNO               <span class="comment">/* 병원등록번호 */</span></span><br><span class="line">                        , ATBS.VIST_SN                 <span class="keyword">AS</span> VIST_SN             <span class="comment">/* 내원일련번호 */</span></span><br><span class="line">                        , ATBS.PFORM_DT                <span class="keyword">AS</span> PFORM_DT            <span class="comment">/* 수행일자 */</span></span><br><span class="line">                        , ATBS.HOPE_DT                 <span class="keyword">AS</span> HOPE_DT             <span class="comment">/* 희망일자 */</span></span><br><span class="line">                        , PATN.MDDP_CD                 <span class="keyword">AS</span> MDDP_CD             <span class="comment">/* 진료과코드 */</span></span><br><span class="line">                        , PATN.ATNN_EMPNO              <span class="keyword">AS</span> ATNN_EMPNO          <span class="comment">/* 진료의사번 */</span></span><br><span class="line">                        , FN_ZZ_GET_USER_NM(PATN.ATNN_EMPNO, <span class="string">&#x27;K&#x27;</span>) <span class="keyword">AS</span> ATNN_NM  <span class="comment">/* 진료의성명 */</span></span><br><span class="line">                        , INFO.PAT_NM                  <span class="keyword">AS</span> PAT_NM              <span class="comment">/* 환자성명 */</span></span><br><span class="line">                        , INFO.SEX_DIV_NM              <span class="keyword">AS</span> SEX_DIV_NM          <span class="comment">/* 성별구분명 */</span></span><br><span class="line">                        , INFO.PAT_BIRTHDT             <span class="keyword">AS</span> PAT_BIRTHDT         <span class="comment">/* 환자생년월일 */</span></span><br><span class="line">                        , INFO.AGE_CNTE                <span class="keyword">AS</span> AGE_CNTE            <span class="comment">/* 나이 */</span></span><br><span class="line">                         , (</span><br><span class="line">                           <span class="keyword">SELECT</span> <span class="string">&#x27;Y&#x27;</span></span><br><span class="line">                             <span class="keyword">FROM</span> V_MRNRRFLIF  FLIF                  <span class="comment">/* 낙상사정등록내역 */</span></span><br><span class="line">                            <span class="keyword">WHERE</span> FLIF.PATNO       = ATBS.PATNO</span><br><span class="line">                              <span class="keyword">AND</span> FLIF.DRAWUP_DT   = ATBS.HOPE_DT</span><br><span class="line">                              <span class="keyword">AND</span> FLIF.REC_VALD_CD = <span class="string">&#x27;V&#x27;</span></span><br><span class="line">                              <span class="keyword">AND</span> FLIF.FLDW_ASSM_CHK_YN = <span class="string">&#x27;Y&#x27;</span></span><br><span class="line">                              <span class="keyword">AND</span> <span class="keyword">ROWNUM</span> = <span class="number">1</span></span><br><span class="line">                           )                            <span class="keyword">AS</span>  FLDW_REG_YN        <span class="comment">/* 낙상등록여부 */</span></span><br><span class="line">                        , (</span><br><span class="line">                           <span class="keyword">SELECT</span> (<span class="keyword">SELECT</span> INHOSP_DIAG_ENG_NM</span><br><span class="line">                                     <span class="keyword">FROM</span> V_MSMACDGCD  <span class="comment">/* 원내진단코드 뷰 */</span></span><br><span class="line">                                    <span class="keyword">WHERE</span> INHOSP_DIAG_CD = DIAG.INHOSP_DIAG_CD</span><br><span class="line">                                      <span class="keyword">AND</span> USE_YN = <span class="string">&#x27;Y&#x27;</span></span><br><span class="line">                                      <span class="keyword">AND</span> <span class="keyword">ROWNUM</span> = <span class="number">1</span>)</span><br><span class="line">                             <span class="keyword">FROM</span> V_OOOSMDIAG  DIAG <span class="comment">/* 원내진단코드 뷰 */</span></span><br><span class="line">                            <span class="keyword">WHERE</span> DIAG.PATNO    = ATBS.PATNO</span><br><span class="line">                              <span class="keyword">AND</span> DIAG.VIST_SN  = ATBS.VIST_SN</span><br><span class="line">                              <span class="keyword">AND</span> DIAG.MAINDIAG_YN = <span class="string">&#x27;Y&#x27;</span></span><br><span class="line">                              <span class="keyword">AND</span> <span class="keyword">ROWNUM</span> = <span class="number">1</span></span><br><span class="line">                          )                            <span class="keyword">AS</span> INHOSP_DIAG_ENG_NM  <span class="comment">/* 원내진단영문명 */</span></span><br><span class="line">                        , (</span><br><span class="line">                          <span class="keyword">SELECT</span> RCIV_DT || RCIV_TM</span><br><span class="line">                            <span class="keyword">FROM</span> V_WMMCRPROF_MC PROF</span><br><span class="line">                           <span class="keyword">WHERE</span> PROF.PATNO   = ATBS.PATNO</span><br><span class="line">                             <span class="keyword">AND</span> PROF.VIST_SN = ATBS.VIST_SN</span><br><span class="line">                             <span class="keyword">AND</span> PROF.ORDR_NO = ATBS.ORDR_PFORM_NO</span><br><span class="line">                             <span class="keyword">AND</span> <span class="keyword">ROWNUM</span>       = <span class="number">1</span></span><br><span class="line">                          )                            <span class="keyword">AS</span> RCIV_DTM            <span class="comment">/* 수납일시 */</span></span><br><span class="line">                         , (</span><br><span class="line">                           <span class="keyword">SELECT</span> <span class="string">&#x27;Y&#x27;</span></span><br><span class="line">                             <span class="keyword">FROM</span> V_OOODMBLOD  BLOD  <span class="comment">/* 수혈처방기본 */</span></span><br><span class="line">                            <span class="keyword">WHERE</span> BLOD.PATNO           = ATBS.PATNO</span><br><span class="line">                              <span class="keyword">AND</span> BLOD.VIST_SN         = ATBS.VIST_SN</span><br><span class="line">                              <span class="keyword">AND</span> BLOD.ORDR_TITL_CD   != <span class="string">&#x27;16&#x27;</span>   <span class="comment">/* 의사가 입력한 처방  */</span></span><br><span class="line">                              <span class="keyword">AND</span> BLOD.VALD_YN         = <span class="string">&#x27;Y&#x27;</span></span><br><span class="line">                              <span class="keyword">AND</span> BLOD.ORDR_CANCEL_CD  = <span class="string">&#x27;N&#x27;</span></span><br><span class="line">                              <span class="keyword">AND</span> <span class="keyword">ROWNUM</span> = <span class="number">1</span></span><br><span class="line">                           )                            <span class="keyword">AS</span> BLDTR_ORDR_YN       <span class="comment">/* 수혈처방여부 */</span></span><br><span class="line">                         , (</span><br><span class="line">                           <span class="keyword">SELECT</span> <span class="string">&#x27;Y&#x27;</span></span><br><span class="line">                             <span class="keyword">FROM</span> V_OOODMEXAM  EXAM  <span class="comment">/* 검사치료처방기본 */</span></span><br><span class="line">                            <span class="keyword">WHERE</span> EXAM.PATNO           = ATBS.PATNO</span><br><span class="line">                              <span class="keyword">AND</span> EXAM.VIST_SN         = ATBS.VIST_SN</span><br><span class="line">                              <span class="keyword">AND</span> EXAM.ORDR_TITL_CD   != <span class="string">&#x27;16&#x27;</span>   <span class="comment">/* 의사가 입력한 처방  */</span></span><br><span class="line">                              <span class="keyword">AND</span> EXAM.VALD_YN         = <span class="string">&#x27;Y&#x27;</span></span><br><span class="line">                              <span class="keyword">AND</span> EXAM.ORDR_CANCEL_CD  = <span class="string">&#x27;N&#x27;</span></span><br><span class="line">                              <span class="keyword">AND</span> EXAM.ORDR_DELI_SYSM_CD = <span class="string">&#x27;O&#x27;</span></span><br><span class="line">                              <span class="keyword">AND</span> <span class="keyword">ROWNUM</span> = <span class="number">1</span></span><br><span class="line">                           )                            <span class="keyword">AS</span> HLIN_ORDR_YN        <span class="comment">/* 행위처방여부 */</span></span><br><span class="line">                          ,<span class="string">&#x27;&#x27;</span> <span class="keyword">AS</span> PWSN_YN    <span class="comment">/* 동명이인여부 */</span></span><br><span class="line">                          ,(  <span class="keyword">SELECT</span>  <span class="string">&#x27;Y&#x27;</span></span><br><span class="line">                              <span class="keyword">FROM</span>   V_OOODMMEDI MEDI</span><br><span class="line">                                   , V_PHINMMEDI PHDI</span><br><span class="line">                              <span class="keyword">WHERE</span> MEDI.PATNO     = ATBS.PATNO</span><br><span class="line">                                <span class="keyword">AND</span> MEDI.VIST_SN   = ATBS.VIST_SN</span><br><span class="line">                                <span class="keyword">AND</span> NVL(MEDI.PREP_ORDR_CLSF_CD, <span class="string">&#x27;0&#x27;</span>) != <span class="string">&#x27;P&#x27;</span> <span class="comment">/* PRE처방이 아닌것 */</span></span><br><span class="line">                                <span class="keyword">AND</span> MEDI.ORDR_TITL_CD        != <span class="string">&#x27;16&#x27;</span>        <span class="comment">/* 의사가 입력한 처방  */</span></span><br><span class="line">                                <span class="keyword">AND</span> MEDI.ACTING_ORGL_ORDR_NO <span class="keyword">IS</span> <span class="literal">NULL</span>        <span class="comment">/* 원처방만 */</span></span><br><span class="line">                                <span class="keyword">AND</span> MEDI.VALD_YN             = <span class="string">&#x27;Y&#x27;</span></span><br><span class="line">                                <span class="keyword">AND</span> MEDI.ORDR_CANCEL_CD      = <span class="string">&#x27;N&#x27;</span></span><br><span class="line">                                <span class="keyword">AND</span> PHDI.PHRM_CD   = MEDI.ORDR_CD</span><br><span class="line">                                <span class="keyword">AND</span> PHDI.MANAGE_MEDI_KND_CD   = <span class="string">&#x27;F&#x27;</span>         <span class="comment">/* 수액여부 */</span></span><br><span class="line">                                <span class="keyword">AND</span> <span class="keyword">ROWNUM</span> = <span class="number">1</span></span><br><span class="line">                           )  <span class="keyword">AS</span> IS_ORDR_YN        <span class="comment">/* 수액처방여부 */</span></span><br><span class="line">                   , (<span class="keyword">SELECT</span> (<span class="keyword">CASE</span> <span class="keyword">WHEN</span> <span class="keyword">COUNT</span>(<span class="number">1</span>) &gt; <span class="number">0</span> <span class="keyword">THEN</span> <span class="string">&#x27;Y&#x27;</span> <span class="keyword">ELSE</span> <span class="string">&#x27;N&#x27;</span> <span class="keyword">END</span>)</span><br><span class="line">                        <span class="keyword">FROM</span> V_WPDCDFAML FAML</span><br><span class="line">                       <span class="keyword">WHERE</span> FAML.PATNO = ATBS.PATNO</span><br><span class="line">                         <span class="keyword">AND</span> ATBS.HOPE_DT  <span class="keyword">BETWEEN</span> FAML.APPLY_ST_DT <span class="keyword">AND</span> FAML.APPLY_END_DT</span><br><span class="line">                         <span class="keyword">AND</span> FAML.VALD_YN = <span class="string">&#x27;Y&#x27;</span>)  <span class="keyword">AS</span> EMP_DSCNT_YN   <span class="comment">/* 직원, 직원가족할인, 할인여부    */</span></span><br><span class="line">                     <span class="keyword">FROM</span> NRDAMATBS    ATBS   <span class="comment">/* 수행대상처방요약기본 */</span></span><br><span class="line">                        , V_WPPIMINFO  INFO   <span class="comment">/* 환자기본_뷰 */</span></span><br><span class="line">                        , V_WJAPMPATN  PATN   <span class="comment">/* 통합접수기본_뷰 */</span></span><br><span class="line">                    <span class="keyword">WHERE</span> ATBS.PATNO          = INFO.PATNO</span><br><span class="line">                      <span class="keyword">AND</span> ATBS.PATNO          = PATN.PATNO</span><br><span class="line">                      <span class="keyword">AND</span> ATBS.VIST_SN        = PATN.VIST_SN</span><br><span class="line">                      <span class="keyword">AND</span> ATBS.VALD_YN        = <span class="string">&#x27;Y&#x27;</span> <span class="comment">/* 유효여부 */</span></span><br><span class="line">        ]]&gt;</span><br><span class="line">            &lt;<span class="keyword">if</span> <span class="keyword">test</span>=<span class="string">&quot;inqryStDt != null and inqryStDt != &#x27;&#x27; and inqryEndDt != null and inqryEndDt != &#x27;&#x27;&quot;</span>&gt;</span><br><span class="line">                      <span class="keyword">AND</span> ATBS.HOPE_DT <span class="keyword">BETWEEN</span> <span class="comment">#&#123;inqryStDt&#125;</span></span><br><span class="line">                                            <span class="keyword">AND</span> <span class="comment">#&#123;inqryEndDt&#125;</span></span><br><span class="line">            &lt;/<span class="keyword">if</span>&gt;</span><br><span class="line">            &lt;<span class="keyword">if</span> <span class="keyword">test</span>=<span class="string">&quot;ordrPformLocCd != null and ordrPformLocCd != &#x27;&#x27;&quot;</span>&gt;</span><br><span class="line">                      <span class="keyword">AND</span> ATBS.ORDR_PFORM_LOC_CD = <span class="comment">#&#123;ordrPformLocCd&#125;</span></span><br><span class="line">            &lt;/<span class="keyword">if</span>&gt;</span><br><span class="line">            &lt;<span class="keyword">if</span> <span class="keyword">test</span>=<span class="string">&quot;patno != null and patno != &#x27;&#x27;&quot;</span>&gt;</span><br><span class="line">                      <span class="keyword">AND</span> ATBS.PATNO          = <span class="comment">#&#123;patno&#125;</span></span><br><span class="line">            &lt;/<span class="keyword">if</span>&gt;</span><br><span class="line">        &lt;![CDATA[</span><br><span class="line">                   )</span><br><span class="line">             <span class="keyword">WHERE</span> RCIV_DTM <span class="keyword">IS</span> <span class="keyword">NOT</span> <span class="literal">NULL</span></span><br><span class="line">             <span class="keyword">ORDER</span> <span class="keyword">BY</span></span><br><span class="line">                   RCIV_DTM <span class="keyword">DESC</span></span><br><span class="line">        ]]&gt;</span><br><span class="line">    &lt;/<span class="keyword">select</span>&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    &lt;!<span class="comment">-- 동명이인 제거를 위한 조회 --&gt;</span></span><br><span class="line">    &lt;<span class="keyword">select</span> <span class="keyword">id</span>=<span class="string">&quot;retrievePformTrgetListForPwsn&quot;</span> parameterType=<span class="string">&quot;kr.amc.amis.mc.nr.pm.entity.IrPformTrgetListByPformDtDTO&quot;</span> resultType=<span class="string">&quot;kr.amc.amis.mc.nr.pm.entity.IrPformTrgetListByPformDtDTO&quot;</span>&gt;</span><br><span class="line">        &lt;![CDATA[</span><br><span class="line">            <span class="keyword">SELECT</span> <span class="comment">/* SQLID=kr.amc.amis.mc.nr.pm.store.mapper.IrPatInfoMapper.retrievePformTrgetListForPwsn */</span></span><br><span class="line">                   ATBS.PATNO                   <span class="keyword">AS</span> PATNO               <span class="comment">/* 병원등록번호 */</span></span><br><span class="line">                 , INFO.PAT_NM                  <span class="keyword">AS</span> PAT_NM              <span class="comment">/* 환자성명 */</span></span><br><span class="line">              <span class="keyword">FROM</span> NRDAMATBS    ATBS</span><br><span class="line">                 , V_WPPIMINFO  INFO</span><br><span class="line">                 , V_OOODMMEDI  MEDI</span><br><span class="line">                 , V_OOODMEXAM  EXAM</span><br><span class="line">                 , V_OOODMBLOD  BLOD</span><br><span class="line">             <span class="keyword">WHERE</span> ATBS.PATNO             = INFO.PATNO</span><br><span class="line">               <span class="keyword">AND</span> ATBS.ORDR_PFORM_NO     = MEDI.ORDR_NO(+)</span><br><span class="line">               <span class="keyword">AND</span> ATBS.ORDR_PFORM_NO     = EXAM.ORDR_NO(+)</span><br><span class="line">               <span class="keyword">AND</span> ATBS.ORDR_PFORM_NO     = BLOD.ORDR_NO(+)</span><br><span class="line">               <span class="keyword">AND</span> NVL(MEDI.PREP_ORDR_CLSF_CD, <span class="string">&#x27;0&#x27;</span>)  != <span class="string">&#x27;P&#x27;</span>  <span class="comment">/* PRE처방이 아닌것 */</span></span><br><span class="line">               <span class="keyword">AND</span> NVL(MEDI.ORDR_TITL_CD, <span class="string">&#x27;0&#x27;</span>)       != <span class="string">&#x27;16&#x27;</span>        <span class="comment">/* 의사가 입력한 처방  */</span></span><br><span class="line">               <span class="keyword">AND</span> MEDI.ACTING_ORGL_ORDR_NO         <span class="keyword">IS</span> <span class="literal">NULL</span>        <span class="comment">/* 원처방만 */</span></span><br><span class="line">               <span class="keyword">AND</span> NVL(MEDI.VALD_YN, <span class="string">&#x27;Y&#x27;</span>)             = <span class="string">&#x27;Y&#x27;</span></span><br><span class="line">               <span class="keyword">AND</span> NVL(MEDI.ORDR_CANCEL_CD, <span class="string">&#x27;N&#x27;</span>)      = <span class="string">&#x27;N&#x27;</span></span><br><span class="line">               <span class="keyword">AND</span> NVL(MEDI.MDEX_DIV_CD,<span class="string">&#x27;O&#x27;</span>)          = <span class="string">&#x27;O&#x27;</span></span><br><span class="line">               <span class="keyword">AND</span> NVL(MEDI.RCIV_STAT_CD, <span class="string">&#x27;1&#x27;</span>)       <span class="keyword">IN</span> (<span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;9&#x27;</span>)</span><br><span class="line">               <span class="keyword">AND</span> NVL(EXAM.ORDR_TITL_CD, <span class="string">&#x27;0&#x27;</span>)       != <span class="string">&#x27;16&#x27;</span>        <span class="comment">/* 의사가 입력한 처방  */</span></span><br><span class="line">               <span class="keyword">AND</span> NVL(EXAM.VALD_YN, <span class="string">&#x27;Y&#x27;</span>)             = <span class="string">&#x27;Y&#x27;</span></span><br><span class="line">               <span class="keyword">AND</span> NVL(EXAM.ORDR_CANCEL_CD,<span class="string">&#x27;N&#x27;</span>)       = <span class="string">&#x27;N&#x27;</span></span><br><span class="line">               <span class="keyword">AND</span> NVL(EXAM.MDEX_DIV_CD,<span class="string">&#x27;O&#x27;</span>)         <span class="keyword">IN</span> (<span class="string">&#x27;O&#x27;</span>, <span class="string">&#x27;I&#x27;</span>)  <span class="comment">/* 입원처방 Bone Marrow 조회를 위해 I 추가 */</span></span><br><span class="line">               <span class="keyword">AND</span> NVL(EXAM.RCIV_STAT_CD, <span class="string">&#x27;1&#x27;</span>)       <span class="keyword">IN</span> (<span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;9&#x27;</span>)</span><br><span class="line">               <span class="keyword">AND</span> NVL(BLOD.ORDR_TITL_CD, <span class="string">&#x27;0&#x27;</span>)       != <span class="string">&#x27;16&#x27;</span>        <span class="comment">/* 의사가 입력한 처방  */</span></span><br><span class="line">               <span class="keyword">AND</span> NVL(BLOD.VALD_YN,<span class="string">&#x27;Y&#x27;</span>)              = <span class="string">&#x27;Y&#x27;</span></span><br><span class="line">               <span class="keyword">AND</span> NVL(BLOD.ORDR_CANCEL_CD,<span class="string">&#x27;N&#x27;</span>)       = <span class="string">&#x27;N&#x27;</span></span><br><span class="line">               <span class="keyword">AND</span> NVL(BLOD.MDEX_DIV_CD,<span class="string">&#x27;O&#x27;</span>)          = <span class="string">&#x27;O&#x27;</span></span><br><span class="line">               <span class="keyword">AND</span> NVL(BLOD.RCIV_STAT_CD, <span class="string">&#x27;1&#x27;</span>)       <span class="keyword">IN</span> (<span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;9&#x27;</span>)</span><br><span class="line">               <span class="keyword">AND</span> ATBS.VALD_YN                       = <span class="string">&#x27;Y&#x27;</span></span><br><span class="line">               <span class="keyword">AND</span> ATBS.ORDR_DEL_YN                   = <span class="string">&#x27;N&#x27;</span></span><br><span class="line">               <span class="keyword">AND</span> INFO.VALD_YN                       = <span class="string">&#x27;Y&#x27;</span></span><br><span class="line">               <span class="keyword">AND</span> ATBS.HOPE_DT                       = <span class="comment">#&#123;pformDt, jdbcType=VARCHAR&#125;</span></span><br><span class="line">               <span class="keyword">AND</span> ATBS.RCIV_DT                      <span class="keyword">IS</span> <span class="keyword">NOT</span> <span class="literal">NULL</span></span><br><span class="line">               <span class="keyword">AND</span> ATBS.RCIV_TM                      <span class="keyword">IS</span> <span class="keyword">NOT</span> <span class="literal">NULL</span></span><br><span class="line">               <span class="keyword">AND</span> NVL(ATBS.REAL_ORDR_LOC_USE_CD, ATBS.ORDR_PFORM_LOC_CD) <span class="keyword">IN</span> (<span class="string">&#x27;OPIV&#x27;</span>,<span class="string">&#x27;OPIV3&#x27;</span>,<span class="string">&#x27;PEDIV&#x27;</span>,<span class="string">&#x27;PIVC&#x27;</span>)</span><br><span class="line">               <span class="keyword">AND</span> NVL(ATBS.REAL_ORDR_LOC_USE_CD, ATBS.ORDR_PFORM_LOC_CD)  = <span class="keyword">DECODE</span>(<span class="comment">#&#123;ordrPformLocCd, jdbcType=VARCHAR&#125;, &#x27;&#x27;, NVL(ATBS.REAL_ORDR_LOC_USE_CD, ATBS.ORDR_PFORM_LOC_CD), #&#123;ordrPformLocCd, jdbcType=VARCHAR&#125;)</span></span><br><span class="line">        ]]&gt;</span><br><span class="line">    &lt;/<span class="keyword">select</span>&gt;</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    &lt;!<span class="comment">-- 검사 예약일자 조회 --&gt;</span></span><br><span class="line">    &lt;<span class="keyword">select</span> <span class="keyword">id</span>=<span class="string">&quot;retrieveExamResvDtForPformHopeDtUpdate&quot;</span> parameterType=<span class="string">&quot;kr.amc.amis.mc.nr.pm.entity.IrPformTrgetListByPformDtDTO&quot;</span> resultType=<span class="string">&quot;kr.amc.amis.mc.nr.pm.entity.IrPformTrgetListByPformDtDTO&quot;</span>&gt;</span><br><span class="line">        &lt;![CDATA[</span><br><span class="line">            <span class="keyword">SELECT</span> <span class="comment">/* SQLID=kr.amc.amis.mc.nr.pm.store.mapper.IrPatInfoMapper.retrieveExamResvDtForPformHopeDtUpdate */</span></span><br><span class="line">                   BS.ORDR_PFORM_NO   <span class="keyword">AS</span> ORDR_PFORM_NO</span><br><span class="line">                 , HE.EXAM_RESV_DT    <span class="keyword">AS</span> HOPE_DT</span><br><span class="line">              <span class="keyword">FROM</span> NRDAMATBS BS</span><br><span class="line">                 , NRDARATBK BK</span><br><span class="line">                 , V_SEEBMSCHE HE</span><br><span class="line">             <span class="keyword">WHERE</span> BK.ORDR_PFORM_NO        = BS.ORDR_PFORM_NO</span><br><span class="line">               <span class="keyword">AND</span> HE.ORDR_NO              = BS.ORDR_PFORM_NO</span><br><span class="line">               <span class="keyword">AND</span> BS.HOPE_DT             != HE.EXAM_RESV_DT</span><br><span class="line">               <span class="keyword">AND</span> BS.HOPE_DT              = <span class="comment">#&#123;pformDt, jdbcType=VARCHAR&#125;</span></span><br><span class="line">               <span class="keyword">AND</span> BS.VALD_YN              = <span class="string">&#x27;Y&#x27;</span></span><br><span class="line">               <span class="keyword">AND</span> BS.ORDR_DEL_YN          = <span class="string">&#x27;N&#x27;</span>   </span><br><span class="line">               <span class="keyword">AND</span> BK.ORDR_CD             <span class="keyword">IN</span> (<span class="string">&#x27;GJ0021&#x27;</span>, <span class="string">&#x27;GJ0016&#x27;</span>)</span><br><span class="line">               <span class="keyword">AND</span> BS.ORDR_PFORM_LOC_CD   <span class="keyword">IN</span> (<span class="string">&#x27;OPIV&#x27;</span>, <span class="string">&#x27;PIVC&#x27;</span>, <span class="string">&#x27;CHEMO&#x27;</span>)</span><br><span class="line">        ]]&gt;</span><br><span class="line">    &lt;/<span class="keyword">select</span>&gt;    </span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">&lt;/mapper&gt;</span><br></pre></td></tr></table></figure>

</div></article></div><nav class="pagination is-centered mt-4" role="navigation" aria-label="pagination"><div class="pagination-previous"><a href="/page/3/">Previous</a></div><div class="pagination-next is-invisible is-hidden-mobile"><a href="/page/5/">Next</a></div><ul class="pagination-list is-hidden-mobile"><li><a class="pagination-link" href="/">1</a></li><li><a class="pagination-link" href="/page/2/">2</a></li><li><a class="pagination-link" href="/page/3/">3</a></li><li><a class="pagination-link is-current" href="/page/4/">4</a></li></ul></nav></div><!--!--><div class="column column-right is-4-tablet is-4-desktop is-4-widescreen  order-3 is-sticky"><div class="card widget"><div class="card-content"><nav class="level"><div class="level-item has-text-centered flex-shrink-1"><div><figure class="image is-128x128 mx-auto mb-2"><img class="avatar" src="/img/avatar.jpg" alt="ilovemychange"></figure><p class="title is-size-4 is-block line-height-inherit">ilovemychange</p><p class="is-size-6 is-block">쇼트트랙선수 출신의 어느 SI 개발자</p><p class="is-size-6 is-flex justify-content-center"><i class="fas fa-map-marker-alt mr-1"></i><span>Korea/Seoul</span></p></div></div></nav><nav class="level is-mobile"><div class="level-item has-text-centered is-marginless"><div><p class="heading">Posts</p><a href="/archives"><p class="title">33</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">Categories</p><a href="/categories"><p class="title">11</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">Tags</p><a href="/tags"><p class="title">16</p></a></div></div></nav><div class="level"><a class="level-item button is-info is-outlined is-rounded" href="/about" target="_self" rel="noopener">About</a></div><div class="level is-mobile"><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Gmail" href="mailto: ilovemychange@gmail.com"><i class="fab fa-google"></i></a></div></div></div><!--!--><div class="card widget"><div class="card-content"><div class="menu"><h3 class="menu-label">Categories</h3><ul class="menu-list"><li><a class="level is-mobile is-marginless" href="/categories/%EA%B3%A0%EB%AF%BC%EA%B1%B0%EB%A6%AC/"><span class="level-start"><span class="level-item">고민거리</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile is-marginless" href="/categories/%EA%B8%B0%ED%9A%8D-RPA/"><span class="level-start"><span class="level-item">기획 &gt; RPA</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile is-marginless" href="/categories/%EA%B8%B0%ED%9A%8D-%EB%AA%A8%EB%B0%94%EC%9D%BC-%ED%91%9C%EC%A4%80/"><span class="level-start"><span class="level-item">기획 &gt; 모바일 표준</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile is-marginless" href="/categories/%EC%82%AC%EC%97%85%EA%B4%80%EB%A6%AC-%EC%B0%A9%EC%88%98%EB%B3%B4%EA%B3%A0/"><span class="level-start"><span class="level-item">사업관리 &gt; 착수보고</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile is-marginless" href="/categories/%EC%82%AC%EC%97%85%EA%B4%80%EB%A6%AC-%ED%91%9C%EC%A4%80-%EC%82%B0%EC%B6%9C%EB%AC%BC/"><span class="level-start"><span class="level-item">사업관리 &gt; 표준 산출물</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile is-marginless" href="/categories/%EC%86%8C%EC%8A%A4%EC%BD%94%EB%93%9C-%EC%9D%98%EB%A3%8C/"><span class="level-start"><span class="level-item">소스코드 &gt; 의료</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile is-marginless" href="/categories/%EC%98%A4%ED%94%88%EC%86%8C%EC%8A%A4-FHIR-HAPI-FHIR-%EC%84%A4%EC%B9%98/"><span class="level-start"><span class="level-item">오픈소스 &gt; FHIR &gt; HAPI FHIR 설치</span></span><span class="level-end"><span class="level-item tag">7</span></span></a></li><li><a class="level is-mobile is-marginless" href="/categories/%EC%98%A4%ED%94%88%EC%86%8C%EC%8A%A4-FHIR-%EA%B8%B0%ED%9A%8D/"><span class="level-start"><span class="level-item">오픈소스 &gt; FHIR &gt; 기획</span></span><span class="level-end"><span class="level-item tag">4</span></span></a></li><li><a class="level is-mobile is-marginless" href="/categories/%EC%98%A4%ED%94%88%EC%86%8C%EC%8A%A4-%EB%A0%88%EB%93%9C%EB%A7%88%EC%9D%B8/"><span class="level-start"><span class="level-item">오픈소스 &gt; 레드마인</span></span><span class="level-end"><span class="level-item tag">4</span></span></a></li><li><a class="level is-mobile is-marginless" href="/categories/%EC%A0%9C%EC%95%88/"><span class="level-start"><span class="level-item">제안</span></span><span class="level-end"><span class="level-item tag">4</span></span></a></li><li><a class="level is-mobile is-marginless" href="/categories/%EC%A3%BC%EA%B0%84-%EC%97%85%EB%AC%B4%EC%9D%BC%EC%A7%80/"><span class="level-start"><span class="level-item">주간 업무일지</span></span><span class="level-end"><span class="level-item tag">7</span></span></a></li></ul></div></div></div><div class="card widget"><div class="card-content"><div class="menu"><h3 class="menu-label">Tags</h3><div class="field is-grouped is-grouped-multiline"><div class="control"><a class="tags has-addons" href="/tags/Eclipse/"><span class="tag">Eclipse</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/FHIR/"><span class="tag">FHIR</span><span class="tag is-grey-lightest">11</span></a></div><div class="control"><a class="tags has-addons" href="/tags/HAPI/"><span class="tag">HAPI</span><span class="tag is-grey-lightest">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/JDK/"><span class="tag">JDK</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/MySQL/"><span class="tag">MySQL</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/RPA/"><span class="tag">RPA</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Tomcat/"><span class="tag">Tomcat</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/jpaserver/"><span class="tag">jpaserver</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%EA%B3%A0%EB%AF%BC%EA%B1%B0%EB%A6%AC/"><span class="tag">고민거리</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%EB%A0%88%EB%93%9C%EB%A7%88%EC%9D%B8/"><span class="tag">레드마인</span><span class="tag is-grey-lightest">4</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%EB%AA%A8%EB%B0%94%EC%9D%BC-%ED%91%9C%EC%A4%80/"><span class="tag">모바일 표준</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%EC%86%8C%EC%8A%A4%EC%BD%94%EB%93%9C/"><span class="tag">소스코드</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%EC%A0%9C%EC%95%88/"><span class="tag">제안</span><span class="tag is-grey-lightest">4</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%EC%A3%BC%EA%B0%84-%EC%97%85%EB%AC%B4%EC%9D%BC%EC%A7%80/"><span class="tag">주간 업무일지</span><span class="tag is-grey-lightest">7</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%EC%B0%A9%EC%88%98%EB%B3%B4%EA%B3%A0/"><span class="tag">착수보고</span><span class="tag is-grey-lightest">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%ED%91%9C%EC%A4%80/"><span class="tag">표준</span><span class="tag is-grey-lightest">1</span></a></div></div></div></div></div></div></div></div></section><footer class="footer"><div class="container"><div class="level"><div class="level-start"><a class="footer-logo is-block mb-2" href="/">ilovemychange</a><p class="size-small"><span>&copy; 2020 ilovemychange</span>  Powered by <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a> &amp; <a href="https://github.com/ppoffice/hexo-theme-icarus" target="_blank" rel="noopener">Icarus</a></p></div><div class="level-end"><div class="field has-addons"><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Creative Commons" href="https://creativecommons.org/"><i class="fab fa-creative-commons"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Attribution 4.0 International" href="https://creativecommons.org/licenses/by/4.0/"><i class="fab fa-creative-commons-by"></i></a></p></div></div></div></div></footer><script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/moment@2.22.2/min/moment-with-locales.min.js"></script><script>moment.locale("en");</script><script>var IcarusThemeSettings = {
            site: {
                url: 'https://ilovemychange.github.io',
                external_link: {"enable":true,"exclude":[]}
            },
            article: {
                highlight: {
                    clipboard: true,
                    fold: 'unfolded'
                }
            }
        };</script><script src="https://cdn.jsdelivr.net/npm/clipboard@2.0.4/dist/clipboard.min.js" defer></script><script src="/js/animation.js"></script><a id="back-to-top" title="Back to top" href="javascript:;"><i class="fas fa-chevron-up"></i></a><script src="/js/back_to_top.js" defer></script><!--!--><!--!--><script src="https://cdn.jsdelivr.net/npm/lightgallery@1.6.8/dist/js/lightgallery.min.js" defer></script><script src="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/js/jquery.justifiedGallery.min.js" defer></script><script>window.addEventListener("load", () => {
            if (typeof $.fn.lightGallery === 'function') {
                $('.article').lightGallery({ selector: '.gallery-item' });
            }
            if (typeof $.fn.justifiedGallery === 'function') {
                if ($('.justified-gallery > p > .gallery-item').length) {
                    $('.justified-gallery > p > .gallery-item').unwrap();
                }
                $('.justified-gallery').justifiedGallery();
            }
        });</script><!--!--><!--!--><!--!--><script src="/js/main.js" defer></script><div class="searchbox"><div class="searchbox-container"><div class="searchbox-header"><div class="searchbox-input-container"><input class="searchbox-input" type="text" placeholder="Type something..."></div><a class="searchbox-close" href="javascript:;">×</a></div><div class="searchbox-body"></div></div></div><script src="/js/insight.js" defer></script><script>document.addEventListener('DOMContentLoaded', function () {
            loadInsight({"contentUrl":"/content.json"}, {"hint":"Type something...","untitled":"(Untitled)","posts":"Posts","pages":"Pages","categories":"Categories","tags":"Tags"});
        });</script></body></html>